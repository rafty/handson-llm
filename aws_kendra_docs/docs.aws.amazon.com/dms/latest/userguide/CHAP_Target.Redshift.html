<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Using an Amazon Redshift database as a target for AWS Database Migration Service - AWS Database Migration Service</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="CHAP_Target.Redshift" /><meta name="default_state" content="CHAP_Target.Redshift" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Target.Redshift.html" /><meta name="description" content="Use an Amazon Redshift database as a target for data migration using AWS Database Migration Service." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Database Migration Service" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Migrate databases to AWS easily and securely using AWS Database Migration Service (AWS DMS) with this User Guide." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Target.Redshift.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Target.Redshift.html" hreflang="x-default" /><meta name="feedback-item" content="DMS" /><meta name="this_doc_product" content="AWS Database Migration Service" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'dms'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Using an Amazon Redshift database as a target for AWS Database Migration Service" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Using an Amazon Redshift database as a target for AWS Database Migration Service - AWS Database Migration Service</title><meta name="pdf" content="/pdfs/dms/latest/userguide/dms-ug.pdf#CHAP_Target.Redshift" /><meta name="github" content="https://github.com/awsdocs/aws-dms-user-guide/tree/main/doc_source/CHAP_Target.Redshift.md" /><meta name="rss" content="aws-dms-updates.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=3" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=DMS&amp;topic_url=http://docs.aws.amazon.com/en_us/dms/latest/userguide/CHAP_Target.Redshift.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/dms/latest/userguide/CHAP_Target.Redshift.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/dms/latest/userguide/CHAP_Target.Redshift.html" /><meta name="keywords" content="Amazon Database Migration Service,Amazon DMS,Importing Data to Amazon Web Services,replication instance" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Database Migration Service",
        "item" : "https://docs.aws.amazon.com/dms/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/dms/latest/userguide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Working with AWS DMS endpoints",
        "item" : "https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Endpoints.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Targets for data migration",
        "item" : "https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Target.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Using an Amazon Redshift database as a target for AWS Database Migration Service",
        "item" : "https://docs.aws.amazon.com/dms/latest/userguide/CHAP_Target.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/dms/latest/userguide/dms-ug.pdf#CHAP_Target.Redshift" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/aws-dms-user-guide/tree/main/doc_source/CHAP_Target.Redshift.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/dms/index.html">AWS Database Migration Service</a><a href="Welcome.html">User Guide</a></div><div id="page-toc-src"><a href="#CHAP_Target.Redshift.Prerequisites">Prerequisites for Amazon Redshift
                    as a target</a><a href="#CHAP_Target.Redshift.Privileges">User account privileges for Redshift as a target</a><a href="#CHAP_Target.Redshift.Limitations">Limitations on Amazon Redshift as a target</a><a href="#CHAP_Target.Redshift.Configuration">Configuring Amazon Redshift as
                    a target</a><a href="#CHAP_Target.Redshift.EnhancedVPC">Using enhanced VPC 
                    routing with Amazon Redshift as a target</a><a href="#CHAP_Target.Redshift.KMSKeys">Creating and using AWS KMS keys</a><a href="#CHAP_Target.Redshift.ConnectionAttrib">Endpoint settings</a><a href="#CHAP_Target.Redshift.EndpointSettings">Using a data encryption key, and an Amazon S3 bucket</a><a href="#CHAP_Target.Redshift.ParallelApply">Multithreaded task settings for Amazon Redshift</a><a href="#CHAP_Target.Redshift.DataTypes">Target data types for Amazon Redshift</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="CHAP_Target.Redshift">Using an Amazon Redshift database as a target for
                AWS Database Migration Service</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>You can migrate data to Amazon Redshift databases using AWS Database Migration Service. Amazon Redshift is a fully managed,
            petabyte-scale data warehouse service in the cloud. With an Amazon Redshift database as a target,
            you can migrate data from all of the other supported source databases.</p><p> The Amazon Redshift cluster must be in the same AWS account and same AWS Region as the
            replication instance. </p><p>During a database migration to Amazon Redshift, AWS DMS first moves data to an Amazon S3 bucket.
            When the files reside in an Amazon S3 bucket, AWS DMS then transfers them to the proper
            tables in the Amazon Redshift data warehouse. AWS DMS creates the S3 bucket in the same AWS
            Region as the Amazon Redshift database. The AWS DMS replication instance must be located in that
            same AWS Region . </p><p>If you use the AWS CLI or DMS API to migrate data to Amazon Redshift, set up an AWS Identity and Access Management (IAM)
            role to allow S3 access. For more information about creating this IAM role, see <a href="./security-iam.html#CHAP_Security.APIRole">Creating the IAM roles to use with the
            AWS CLI and AWS DMS API</a>.</p><p>The Amazon Redshift endpoint provides full automation for the following:</p><div class="itemizedlist">
             
             
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>Schema generation and data type mapping</p>
            </li><li class="listitem">
                <p>Full load of source database tables</p>
            </li><li class="listitem">
                <p>Incremental load of changes made to source tables</p>
            </li><li class="listitem">
                <p>Application of schema changes in data definition language (DDL) made to the
                    source tables</p>
            </li><li class="listitem">
                <p>Synchronization between full load and change data capture (CDC)
                    processes.</p>
            </li></ul></div><p>AWS Database Migration Service supports both full load and change processing operations. AWS DMS reads
            the data from the source database and creates a series of comma-separated value (.csv)
            files. For full-load operations, AWS DMS creates files for each table. AWS DMS
            then copies the table files for each table to a separate folder in Amazon S3. When the files
            are uploaded to Amazon S3, AWS DMS sends a copy command and the data in the files are
            copied into Amazon Redshift. For change-processing operations, AWS DMS copies the net changes to
            the .csv files. AWS DMS then uploads the net change files to Amazon S3 and copies the data
            to Amazon Redshift.</p><p>For additional details on working with Amazon Redshift as a target for AWS DMS, see the following
            sections: </p><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#CHAP_Target.Redshift.Prerequisites">Prerequisites for using an Amazon Redshift
                    database as a target for AWS Database Migration Service</a></li><li><a href="#CHAP_Target.Redshift.Privileges">Privileges required for
                    using Redshift as a target</a></li><li><a href="#CHAP_Target.Redshift.Limitations">Limitations on using Amazon Redshift as a
                    target for AWS Database Migration Service</a></li><li><a href="#CHAP_Target.Redshift.Configuration">Configuring an Amazon Redshift database as
                    a target for AWS Database Migration Service</a></li><li><a href="#CHAP_Target.Redshift.EnhancedVPC">Using enhanced VPC routing with
                    Amazon Redshift as a target for AWS Database Migration Service</a></li><li><a href="#CHAP_Target.Redshift.KMSKeys">Creating and using AWS KMS keys to
                    encrypt Amazon Redshift target data</a></li><li><a href="#CHAP_Target.Redshift.ConnectionAttrib">Endpoint settings 
                    when using Amazon Redshift as a target for AWS DMS</a></li><li><a href="#CHAP_Target.Redshift.EndpointSettings">Using a data encryption key, and an Amazon S3 bucket as intermediate storage</a></li><li><a href="#CHAP_Target.Redshift.ParallelApply">Multithreaded task settings for Amazon Redshift</a></li><li><a href="#CHAP_Target.Redshift.DataTypes">Target data types for Amazon Redshift</a></li></ul></div>
            <h2 id="CHAP_Target.Redshift.Prerequisites">Prerequisites for using an Amazon Redshift
                    database as a target for AWS Database Migration Service</h2>

            <p>The following list describes the prerequisites necessary for working with Amazon Redshift as
                a target for data migration:</p>
            <div class="itemizedlist">
                 
                 
                 
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>Use the AWS Management Console to launch an Amazon Redshift cluster. Note the basic
                        information about your AWS account and your Amazon Redshift cluster, such as your
                        password, user name, and database name. You need these values when creating
                        the Amazon Redshift target endpoint. </p>
                </li><li class="listitem">
                    <p>The Amazon Redshift cluster must be in the same AWS account and the same AWS Region
                        as the replication instance.</p>
                </li><li class="listitem">
                    <p>The AWS DMS replication instance needs network connectivity to the Amazon Redshift
                        endpoint (hostname and port) that your cluster uses.</p>
                </li><li class="listitem">
                    <p>AWS DMS uses an Amazon S3 bucket to transfer data to the Amazon Redshift database. For AWS DMS
                        to create the bucket, the console uses an IAM role,
                            <code class="code">dms-access-for-endpoint</code>. If you use the AWS CLI or DMS API to
                        create a database migration with Amazon Redshift as the target database, you must
                        create this IAM role. For more information about creating this role, see
                            <a href="./security-iam.html#CHAP_Security.APIRole">Creating the IAM roles to use with the
            AWS CLI and AWS DMS API</a>. </p>
                </li><li class="listitem">
                    <p>AWS DMS converts BLOBs, CLOBs, and NCLOBs to a VARCHAR on the target
                        Amazon Redshift instance. Amazon Redshift doesn't support VARCHAR data types
                        larger than 64 KB, so you can't store traditional LOBs on Amazon Redshift.
                    </p>
                </li><li class="listitem">
                    <p>Set the target metadata task setting <a href="./CHAP_Tasks.CustomizingTasks.TaskSettings.ChangeProcessingTuning.html">BatchApplyEnabled</a> to <code class="code">true</code> for 
                        AWS DMS to handle changes to Amazon Redshift target tables during CDC. 
                        A Primary Key on both the source and target table is required.  Without 
                        a Primary Key, changes are applied statement by statement. And that can 
                        adversely affect task performance during CDC by causing target latency 
                        and impacting the cluster commit queue.
                    </p>
                </li></ul></div>
         
            <h2 id="CHAP_Target.Redshift.Privileges">Privileges required for
                    using Redshift as a target</h2>
           
            <p>Use the GRANT command to define access privileges for a user or user group. Privileges 
                include access options such as being able to read data in tables and views, write data, 
                and create tables. For more information about using GRANT with Amazon Redshift, see 
                <a href="https://docs.aws.amazon.com//redshift/latest/dg/r_GRANT.html">GRANT</a> in 
                the <em> Amazon Redshift Database Developer Guide</em>.
            </p>
            <p>The following is the syntax to give specific privileges for a table, database, schema, 
                function, procedure, or language-level privileges on Amazon Redshift tables and views.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">GRANT <span>{</span> <span>{</span> SELECT | INSERT | UPDATE | DELETE | REFERENCES } [,...] | ALL [ PRIVILEGES ] }
    ON <span>{</span> [ TABLE ] table_name [, ...] | ALL TABLES IN SCHEMA schema_name [, ...] }
    TO <span>{</span> username [ WITH GRANT OPTION ] | GROUP group_name | PUBLIC } [, ...]

GRANT <span>{</span> <span>{</span> CREATE | TEMPORARY | TEMP } [,...] | ALL [ PRIVILEGES ] }
    ON DATABASE db_name [, ...]
    TO <span>{</span> username [ WITH GRANT OPTION ] | GROUP group_name | PUBLIC } [, ...]

GRANT <span>{</span> <span>{</span> CREATE | USAGE } [,...] | ALL [ PRIVILEGES ] }
    ON SCHEMA schema_name [, ...]
    TO <span>{</span> username [ WITH GRANT OPTION ] | GROUP group_name | PUBLIC } [, ...]

GRANT <span>{</span> EXECUTE | ALL [ PRIVILEGES ] }
    ON <span>{</span> FUNCTION function_name ( [ [ argname ] argtype [, ...] ] ) [, ...] | ALL FUNCTIONS IN SCHEMA schema_name [, ...] }
    TO <span>{</span> username [ WITH GRANT OPTION ] | GROUP group_name | PUBLIC } [, ...]

GRANT <span>{</span> EXECUTE | ALL [ PRIVILEGES ] }
    ON <span>{</span> PROCEDURE procedure_name ( [ [ argname ] argtype [, ...] ] ) [, ...] | ALL PROCEDURES IN SCHEMA schema_name [, ...] }
    TO <span>{</span> username [ WITH GRANT OPTION ] | GROUP group_name | PUBLIC } [, ...]

GRANT USAGE 
    ON LANGUAGE language_name [, ...]
    TO <span>{</span> username [ WITH GRANT OPTION ] | GROUP group_name | PUBLIC } [, ...]             
</code></pre>
            <p>The following is the syntax for column-level privileges on Amazon Redshift tables and views. </p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">GRANT <span>{</span> <span>{</span> SELECT | UPDATE } ( column_name [, ...] ) [, ...] | ALL [ PRIVILEGES ] ( column_name [,...] ) }
     ON <span>{</span> [ TABLE ] table_name [, ...] }
     TO <span>{</span> username | GROUP group_name | PUBLIC } [, ...]            
</code></pre>
            <p>The following is the syntax for the ASSUMEROLE privilege 
                granted to users and groups with a specified role.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">GRANT ASSUMEROLE
    ON <span>{</span> 'iam_role' [, ...] | ALL }
    TO <span>{</span> username | GROUP group_name | PUBLIC } [, ...]
    FOR <span>{</span> ALL | COPY | UNLOAD } [, ...]    
</code></pre>            
         
            <h2 id="CHAP_Target.Redshift.Limitations">Limitations on using Amazon Redshift as a
                    target for AWS Database Migration Service</h2>


            <p>The following limitations apply when using an Amazon Redshift database as a target:</p>
            <div class="itemizedlist">
                 
                 
                 
                 
                 
                 
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>Don’t enable versioning for the S3 bucket you use as intermediate storage for your Amazon Redshift target.
                        If you need S3 versioning, use lifecycle policies to actively delete old versions. Otherwise,
                        you might encounter endpoint test connection failures because of an S3 <code class="code">list-object</code>
                        call timeout. To create a lifecycle policy for an S3 bucket, see
                        <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lifecycle-mgmt.html">
                            Managing your storage lifecycle</a>.
                        To delete a version of an S3 object, see
                        <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/DeletingObjectVersions.html">
                            Deleting object versions from a versioning-enabled bucket</a>.</p>
                </li><li class="listitem">
                    <p>The following DDL is not supported:</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">
ALTER TABLE <code class="replaceable">table name</code> MODIFY COLUMN <code class="replaceable">column name</code> <code class="replaceable">data type</code>;
 </code></pre>
                </li><li class="listitem">
                    <p> AWS DMS cannot migrate or replicate changes to a schema with a name that
                        begins with underscore (_). If you have schemas that have a name that begins
                        with an underscore, use mapping transformations to rename the schema on the
                        target. </p>
                </li><li class="listitem">
                    <p> Amazon Redshift doesn't support VARCHARs larger than 64 KB. LOBs from
                        traditional databases can't be stored in Amazon Redshift.</p>
                </li><li class="listitem">
                    <p> Applying a DELETE statement to a table with a multi-column primary key is
                        not supported when any of the primary key column names use a reserved word.
                        Go <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_pg_keywords.html">here</a> to see a list of Amazon Redshift reserved words.</p>
                </li><li class="listitem">
                    <p>You may experience performance issues if your source system performs UPDATE operations on the primary key of a 
                        source table. These performance issues occur when applying changes to the target. 
                        This is because UPDATE (and DELETE) operations depend on the primary key value 
                        to identify the target row. If you update the primary key of a source table, your task log will contain 
                        messages like the following:</p>
                        
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">Update on table 1 changes PK to a PK that was previously updated in the same bulk update.</code></pre>
                    
                </li><li class="listitem">
                    <p>DMS doesn't support custom DNS names when configuring an endpoint for a Redshift cluster, 
                        and you need to use the Amazon provided DNS name. Since the Amazon Redshift cluster must be in the same AWS 
                        account and Region as the replication instance, validation fails if you use a custom DNS endpoint.</p>
                </li><li class="listitem">
                    <p>Amazon Redshift has a default 4-hour idle session timeout. When there isn't any activity within 
                        the DMS replication task, Redshift disconnects the session after 4 hours. Errors can result 
                        from DMS being unable to connect and potentially needing to restart. As a workaround, set a 
                        SESSION TIMEOUT limit greater than 4 hours for the DMS replication user.  Or, see the description of 
                        <a href="https://docs.aws.amazon.com/redshift/latest/dg/r_ALTER_USER.html">ALTER USER</a> in the 
                        <em>Amazon Redshift Database Developer Guide</em>.</p>
                </li><li class="listitem">
                    <p>When AWS DMS replicates source table data without a primary or unique key, CDC latency 
                        might be high resulting in an unacceptable level of performance.</p>
                </li></ul></div>
         
            <h2 id="CHAP_Target.Redshift.Configuration">Configuring an Amazon Redshift database as
                    a target for AWS Database Migration Service</h2>

            <p>AWS Database Migration Service must be configured to work with the Amazon Redshift instance. The following table
                describes the configuration properties available for the Amazon Redshift endpoint.</p>
            <div class="table-container"><div class="table-contents"><table id="w350aac29c13c19c27b5"><thead>

                        <tr>
                            <th><p>Property</p></th>
                            <th><p>Description</p></th>

                        </tr>
                    </thead>
                        <tr>
                            <td><p>server</p></td>
                            <td><p>The name of the Amazon Redshift cluster you are using.</p></td>

                        </tr>
                        <tr>
                            <td><p>port</p></td>
                            <td><p>The port number for Amazon Redshift. The default value is
                                5439.</p></td>

                        </tr>
                        <tr>
                            <td><p>username</p></td>
                            <td><p>An Amazon Redshift user name for a registered user.</p></td>

                        </tr>
                        <tr>
                            <td><p>password</p></td>
                            <td><p>The password for the user named in the username
                                    property.</p></td>

                        </tr>
                        <tr>
                            <td><p>database</p></td>
                            <td><p>The name of the Amazon Redshift data warehouse (service) you are
                                    working with.</p></td>
                        </tr>
                    </table></div></div>
            <p>If you want to add extra connection string attributes to your Amazon Redshift endpoint, you
                can specify the <code class="code">maxFileSize</code> and <code class="code">fileTransferUploadStreams</code>
                attributes. For more information on these attributes, see <a href="#CHAP_Target.Redshift.ConnectionAttrib">Endpoint settings 
                    when using Amazon Redshift as a target for AWS DMS</a>.</p>
         
            <h2 id="CHAP_Target.Redshift.EnhancedVPC">Using enhanced VPC routing with
                    Amazon Redshift as a target for AWS Database Migration Service</h2>

            <p>If you use Enhanced VPC Routing with your
                Amazon Redshift target, all COPY traffic between your Amazon Redshift cluster and your
                data repositories goes through your VPC. Because Enhanced VPC
                    Routing affects the way that Amazon Redshift accesses other resources, COPY
                commands might fail if you haven't configured your VPC correctly.</p>
            <p>AWS DMS can be affected by this behavior because it uses the COPY command to
                move data in S3 to an Amazon Redshift cluster.</p>
            <p>Following are the steps AWS DMS takes to load data into an Amazon Redshift target:</p>
            <div class="orderedlist">
                 
                 
                 
            <ol><li>
                    <p>AWS DMS copies data from the source to .csv files on the replication
                        server.</p>
                </li><li>
                    <p>AWS DMS uses the AWS SDK to copy the .csv files into an S3 bucket on
                        your account.</p>
                </li><li>
                    <p>AWS DMS then uses the COPY command in Amazon Redshift to copy data from the .csv
                        files in S3 to an appropriate table in Amazon Redshift.</p>
                </li></ol></div>
            <p>If Enhanced VPC Routing is not enabled, Amazon Redshift routes traffic
                through the internet, including traffic to other services within the AWS network. If
                the feature is not enabled, you do not have to configure the network path. If the
                feature is enabled, you must specifically create a network path between your
                cluster's VPC and your data resources. For more information on the configuration
                required, see <a href="https://docs.aws.amazon.com/redshift/latest/mgmt/enhanced-vpc-routing.html">Enhanced VPC
                    routing</a> in the Amazon Redshift documentation. </p>
         
            <h2 id="CHAP_Target.Redshift.KMSKeys">Creating and using AWS KMS keys to
                    encrypt Amazon Redshift target data</h2>
                        <p>You can encrypt your target data pushed to Amazon S3 before it is copied to
                Amazon Redshift. To do so, you can create and use custom AWS KMS keys. You can use the key you
                created to encrypt your target data using one of the following mechanisms when you
                create the Amazon Redshift target endpoint:</p>
            <div class="itemizedlist">
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>Use the following option when you run the <code class="code">create-endpoint</code>
                        command using the AWS CLI.</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">--redshift-settings '<span>{</span>"EncryptionMode": "SSE_KMS", "ServerSideEncryptionKmsKeyId": "<code class="replaceable">your-kms-key-ARN</code>"}'</code></pre>
                    <p>Here, <code class="code"><code class="replaceable">your-kms-key-ARN</code></code> is the
                        Amazon Resource Name (ARN) for your KMS key. For more information, see <a href="#CHAP_Target.Redshift.EndpointSettings">Using a data encryption key, and an Amazon S3 bucket as intermediate storage</a>.</p>
                </li><li class="listitem">
                    <p>Set the extra connection attribute <code class="code">encryptionMode</code> to the
                        value <code class="code">SSE_KMS</code> and the extra connection attribute
                            <code class="code">serverSideEncryptionKmsKeyId</code> to the ARN for your KMS key.
                        For more information, see <a href="#CHAP_Target.Redshift.ConnectionAttrib">Endpoint settings 
                    when using Amazon Redshift as a target for AWS DMS</a>.</p>
                </li></ul></div>
            <p>To encrypt Amazon Redshift target data using a KMS key, you need an AWS Identity and Access Management (IAM) role
                that has permissions to access Amazon Redshift data. This IAM role is then accessed in a
                policy (a key policy) attached to the encryption key that you create. You can do
                this in your IAM console by creating the following:</p>
            <div class="itemizedlist">
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>An IAM role with an AWS-managed policy.</p>
                </li><li class="listitem">
                    <p>A KMS key with a key policy that references this role.</p>
                </li></ul></div>
            <p>The following procedures describe how to do this.</p>
            <div class="procedure"><h6>To create an IAM role with the required AWS-managed policy</h6><ol><li><p>Open the IAM console at
         <a href="https://console.aws.amazon.com/iam/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/iam/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
                    <p>In the navigation pane, choose <b>Roles</b>. The
                            <b>Roles</b> page opens.</p>
                </li><li>
                    <p>Choose <b>Create role</b>. The <b>Create
                            role</b> page opens.</p>
                </li><li>
                    <p>With <b>AWS service</b> chosen as the trusted entity, choose
                            <b>DMS</b> as the service to use the role.</p>
                </li><li>
                    <p>Choose <b>Next: Permissions</b>. The <b>Attach
                            permissions policies</b> page appears.</p>
                </li><li>
                    <p>Find and select the <code class="code">AmazonDMSRedshiftS3Role</code> policy.</p>
                </li><li>
                    <p>Choose <b>Next: Tags</b>. The <b>Add tags</b>
                        page appears. Here, you can add any tags you want.</p>
                </li><li>
                    <p>Choose <b>Next: Review</b> and review your results.</p>
                </li><li>
                    <p>If the settings are what you need, enter a name for the role (for example,
                            <code class="code">DMS-Redshift-endpoint-access-role</code>), and any additional
                        description, then choose <b>Create role</b>. The
                            <b>Roles</b> page opens with a message indicating that
                        your role has been created.</p>
                </li></ol></div>
            <p>You have now created the new role to access Amazon Redshift resources for encryption with a
                specified name, for example <code class="code">DMS-Redshift-endpoint-access-role</code>.</p>
            <div class="procedure"><h6>To create an AWS KMS encryption key with a key policy that references your
                    IAM role</h6><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>For more information about how AWS DMS works with AWS KMS encryption keys, see
                            <a href="./CHAP_Security.html#CHAP_Security.EncryptionKey">Setting an encryption key and
                specifying AWS KMS permissions</a>.</p></div></div><ol><li>
     <p>Sign in to the AWS Management Console and open the AWS Key Management Service (AWS KMS) console at <a href="https://console.aws.amazon.com/kms" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/kms</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
    </li><li>
     <p>To change the AWS Region, use the Region selector in the upper-right corner of the page.</p>
    </li><li>
                    <p>In the navigation pane, choose <b>Customer managed keys</b>.</p>
                </li><li>
                    <p>Choose <b>Create key</b>. The <b>Configure
                            key</b> page opens.</p>
                </li><li>
                    <p>For <b>Key type</b>, choose
                        <b>Symmetric</b>.</p>
                    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>When you create this key, you can only create a symmetric key, because
                            all AWS services, such as Amazon Redshift, only work with symmetric encryption
                            keys.</p></div></div>
                </li><li>
                    <p>Choose <b>Advanced Options</b>. For <b>Key material
                            origin</b>, make sure that <b>KMS</b> is chosen,
                        then choose <b>Next</b>. The <b>Add labels</b>
                        page opens.</p>
                </li><li>
                    <p>For <b>Create alias and description</b>, enter an alias for
                        the key (for example, <code class="code">DMS-Redshift-endpoint-encryption-key</code>) and
                        any additional description.</p>
                </li><li>
                    <p>For <b>Tags</b>, add any tags that you want to help identify
                        the key and track its usage, then choose <b>Next</b>. The
                            <b>Define key administrative permissions</b> page opens
                        showing a list of users and roles that you can choose from.</p>
                </li><li>
                    <p>Add the users and roles that you want to manage the key. Make sure that
                        these users and roles have the required permissions to manage the key.
                    </p>
                </li><li>
                    <p>For <b>Key deletion</b>, choose whether key
                        administrators can delete the key, then choose <b>Next</b>.
                        The <b>Define key usage permissions</b> page opens showing an
                        additional list of users and roles that you can choose from.</p>
                </li><li>
                    <p>For <b>This account</b>, choose the available users you want
                        to perform cryptographic operations on Amazon Redshift targets. Also choose the role
                        that you previously created in <b>Roles</b> to enable access
                        to encrypt Amazon Redshift target objects, for example
                            <code class="code">DMS-Redshift-endpoint-access-role</code>).</p>
                </li><li>
                    <p>If you want to add other accounts not listed to have this same access, for
                            <b>Other AWS accounts</b>, choose <b>Add another
                            AWS account</b>, then choose <b>Next</b>. The
                            <b>Review and edit key policy</b> page opens, showing the
                        JSON for the key policy that you can review and edit by typing into the
                        existing JSON. Here, you can see where the key policy references the role
                        and users (for example, <code class="code">Admin</code> and <code class="code">User1</code>) that you
                        chose in the previous step. You can also see the different key actions
                        permitted for the different principals (users and roles), as shown in the following
                        example.</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
  "Id": "key-consolepolicy-3",
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Sid": "Enable IAM User Permissions",
      "Effect": "Allow",
      "Principal": <span>{</span>
        "AWS": [
          "arn:aws:iam::111122223333:root"
        ]
      },
      "Action": "kms:*",
      "Resource": "*"
    },
    <span>{</span>
      "Sid": "Allow access for Key Administrators",
      "Effect": "Allow",
      "Principal": <span>{</span>
        "AWS": [
          "arn:aws:iam::111122223333:role/Admin"
        ]
      },
      "Action": [
        "kms:Create*",
        "kms:Describe*",
        "kms:Enable*",
        "kms:List*",
        "kms:Put*",
        "kms:Update*",
        "kms:Revoke*",
        "kms:Disable*",
        "kms:Get*",
        "kms:Delete*",
        "kms:TagResource",
        "kms:UntagResource",
        "kms:ScheduleKeyDeletion",
        "kms:CancelKeyDeletion"
      ],
      "Resource": "*"
    },
    <span>{</span>
      "Sid": "Allow use of the key",
      "Effect": "Allow",
      "Principal": <span>{</span>
        "AWS": [
          "arn:aws:iam::111122223333:role/DMS-Redshift-endpoint-access-role",
          "arn:aws:iam::111122223333:role/Admin",
          "arn:aws:iam::111122223333:role/User1"
        ]
      },
      "Action": [
        "kms:Encrypt",
        "kms:Decrypt",
        "kms:ReEncrypt*",
        "kms:GenerateDataKey*",
        "kms:DescribeKey"
      ],
      "Resource": "*"
    },
    <span>{</span>
      "Sid": "Allow attachment of persistent resources",
      "Effect": "Allow",
      "Principal": <span>{</span>
        "AWS": [
          "arn:aws:iam::111122223333:role/DMS-Redshift-endpoint-access-role",
          "arn:aws:iam::111122223333:role/Admin",
          "arn:aws:iam::111122223333:role/User1"
        ]
      },
      "Action": [
        "kms:CreateGrant",
        "kms:ListGrants",
        "kms:RevokeGrant"
      ],
      "Resource": "*",
      "Condition": <span>{</span>
        "Bool": <span>{</span>
          "kms:GrantIsForAWSResource": true
        }
      }
    }
  ]</code></pre>
                </li><li>
                    <p>Choose <b>Finish</b>. The <b>Encryption

                            keys</b> page opens with a message indicating that your AWS KMS key has been created.</p>
                </li></ol></div>
            <p>You have now created a new KMS key with a specified alias (for example,
                    <code class="code">DMS-Redshift-endpoint-encryption-key</code>). This key enables AWS DMS to
                encrypt Amazon Redshift target data.</p>
         
            <h2 id="CHAP_Target.Redshift.ConnectionAttrib">Endpoint settings 
                    when using Amazon Redshift as a target for AWS DMS</h2>

            <p>You can use endpoint settings to configure your Amazon Redshift target database similar to using
                extra connection attributes. You specify the settings when you create the target
                endpoint using the AWS DMS console, or by using the <code class="code">create-endpoint</code> command in the 
                <a href="https://docs.aws.amazon.com/cli/latest/reference/dms/index.html">AWS CLI</a>, with the 
                <code class="code">--redshift-settings '<span>{</span>"<code class="replaceable">EndpointSetting"</code>:
                    <code class="replaceable">"value"</code>, <code class="replaceable">...</code>}'</code> JSON syntax.</p> 
            <p>The following table shows the endpoint settings that you can use with Amazon Redshift as a target.</p>


            <div class="table-container"><div class="table-contents"><table id="w350aac29c13c19c33b7"><thead>
                        <tr>
                            <th>Name</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                        <tr>
                            <td><p><code class="code">MaxFileSize</code></p></td>
                            <td>
                                <p>Specifies the maximum size (in KB) of any .csv file used to
                                    transfer data to Amazon Redshift.</p>
                                <p>Default value: 32768 KB (32 MB)</p>
                                <p>Valid values: 1–1,048,576</p>
                                <p>Example: <code class="code">--redshift-settings '<span>{</span>"MaxFileSize": 512}'</code></p>
                            </td>
                        </tr>
                        <tr>
                            <td><p><code class="code">FileTransferUploadStreams</code></p></td>
                            <td>
                                <p>Specifies the number of threads used to upload a single file. </p>
                                <p>Default value: 10</p>
                                <p>Valid values: 1–64</p>
                                <p>Example: <code class="code">--redshift-settings '<span>{</span>"FileTransferUploadStreams": 20}'</code></p>
                            </td>
                        </tr>
                        <tr>
                            <td><p><code class="code">Acceptanydate</code></p>
                            </td>
                            <td>
                                <p>Specifies if any date format is accepted, including invalid
                                    dates formats such as 0000-00-00. Boolean value.</p>
                                <p>Default value: false</p>
                                <p>Valid values: true | false</p>
                                <p>Example: <code class="code">--redshift-settings '<span>{</span>"Acceptanydate": true}'</code></p>                                
                            </td>
                        </tr>
                        <tr>
                            <td><p><code class="code">Dateformat</code></p></td>
                            <td>
                                <p>Specifies the date format. This is a string input and is empty
                                    by default. The default format is YYYY-MM-DD but you can change
                                    it to, for example, DD-MM-YYYY. If your date or time values use
                                    different formats, use the <code class="code">auto</code> argument with the
                                        <code class="code">Dateformat</code> parameter. The <code class="code">auto</code>
                                    argument recognizes several formats that are not supported when
                                    using a <code class="code">Dateformat</code> string. The <code class="code">auto</code>
                                    keyword is case-sensitive.</p>
                                <p>Default value: empty</p>
                                <p>Valid values: "<code class="replaceable">dateformat_string</code>" or <code class="code">auto</code></p>
                                <p>Example:<code class="code">--redshift-settings '<span>{</span>"Dateformat": "auto"}'</code></p>
                            </td>
                        </tr>
                        <tr>
                            <td><p><code class="code">Timeformat</code></p></td>
                            <td>
                                <p>Specifies the time format. This is a string input and is empty
                                    by default. The <code class="code">auto</code> argument recognizes several
                                    formats that aren't supported when using a
                                        <code class="code">Timeformat</code> string. If your date and time values
                                    use formats different from each other, use the <code class="code">auto</code>
                                    argument with the <code class="code">Timeformat</code> parameter. </p>
                                <p>Default value: 10</p>
                                <p>Valid values: "<code class="replaceable">Timeformat_string</code>" | "auto" | "epochsecs" |
                                    "epochmillisecs" </p>
                                <p>Example:<code class="code">--redshift-settings '<span>{</span>"Timeformat": "auto"}'</code></p>
                            </td>
                        </tr>
                        <tr>
                            <td><p><code class="code">Emptyasnull</code></p></td>
                            <td>
                                <p>Specifies whether AWS DMS should migrate empty CHAR and VARCHAR
                                    fields as null. A value of true sets empty CHAR and VARCHAR
                                    fields as null.</p>
                                <p>Default value: false</p>
                                <p>Valid values: true | false</p>
                                <p>Example: <code class="code">--redshift-settings '<span>{</span>"Emptyasnull": true}'</code></p>                                
                            </td>
                        </tr>
                        <tr>
                            <td><code class="code">TruncateColumns</code></td>
                            <td>
                                <p>Truncates data in columns to the appropriate number of
                                    characters so that it fits the column specification. Applies
                                    only to columns with a VARCHAR or CHAR data type, and rows 4 MB
                                    or less in size. </p>
                                <p>Default value: false</p>
                                <p>Valid values: true | false</p>
                                <p>Example: <code class="code">--redshift-settings '<span>{</span>"TruncateColumns": true}'</code></p>                                
                            </td>
                        </tr>
                        <tr>
                            <td><code class="code">RemoveQuotes</code></td>
                            <td>
                                <p>Removes surrounding quotation marks from strings in the
                                    incoming data. All characters within the quotation marks,
                                    including delimiters, are retained. For more information about
                                    removing quotes for an Amazon Redshift target, see the <a href="https://docs.aws.amazon.com/redshift/latest/dg/copy-parameters-data-conversion.html#copy-removequotes">Amazon Redshift Database Developer Guide</a>.</p>
                                <p>Default value: false</p>
                                <p>Valid values: true | false</p>
                                <p>Example: <code class="code">--redshift-settings '<span>{</span>"RemoveQuotes": true}'</code></p>                                
                            </td>
                        </tr>
                        <tr>
                            <td><code class="code">TrimBlanks</code></td>
                            <td>
                                <p>Removes the trailing white-space characters from a VARCHAR
                                    string. This parameter applies only to columns with a VARCHAR
                                    data type.</p>
                                <p>Default value: false</p>
                                <p>Valid values: true | false</p>
                                <p>Example: <code class="code">--redshift-settings '<span>{</span>"TrimBlanks": true}'</code></p>                                
                            </td>
                        </tr>
                        <tr>
                            <td><code class="code">EncryptionMode</code></td>
                            <td>Specifies the server-side encryption mode that you want to use to
                                push your data to S3 before it is copied to Amazon Redshift. The valid values
                                are <code class="code">SSE_S3</code> (S3 server-side encryption) or
                                <code class="code">SSE_KMS</code> (KMS key encryption). If you choose
                                    <code class="code">SSE_KMS</code>, set the
                                    <code class="code">ServerSideEncryptionKmsKeyId</code> parameter to the
                                Amazon Resource Name (ARN) for the KMS key to be used for
                                encryption. <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You can also use the CLI <code class="code">modify-endpoint</code>
                                        command to change the value of the
                                            <code class="code">EncryptionMode</code> setting for an existing
                                        endpoint from <code class="code">SSE_KMS</code> to <code class="code">SSE_S3</code>.
                                        But you can't change the <code class="code">EncryptionMode</code> value
                                        from <code class="code">SSE_S3</code> to <code class="code">SSE_KMS</code>.</p></div></div><p>Default value: <code class="code">SSE_S3</code></p>
                                <p>Valid values: <code class="code">SSE_S3</code> or
                                    <code class="code">SSE_KMS</code></p>
                                <p>Example:<code class="code">--redshift-settings '<span>{</span>"EncryptionMode": "SSE_S3"}'</code></p>                                
                            </td>
                        </tr>
                        <tr>
                            <td><code class="code">ServerSideEncryptionKmsKeyId</code></td>
                            <td>If you set <code class="code">EncryptionMode</code> to <code class="code">SSE_KMS</code>,
                                set this parameter to the ARN for the KMS key. You can find this ARN
                                by selecting the key alias in the list of AWS KMS keys created for your
                                account. When you create the key, you must associate specific
                                policies and roles with it. For more information, see <a href="#CHAP_Target.Redshift.KMSKeys">Creating and using AWS KMS keys to
                    encrypt Amazon Redshift target data</a>.
                                <p>Example: <code class="code">--redshift-settings '<span>{</span>"ServerSideEncryptionKmsKeyId":"arn:aws:kms:us-east-1:111122223333:key/11a1a1a1-aaaa-9999-abab-2bbbbbb222a2"}'</code></p>                               

                            </td>
                        </tr>
                        <tr>
                            <td><code class="code">EnableParallelBatchInMemoryCSVFiles</code></td>
                            <td>Set this attribute to <code class="code">false</code> when using the
                                <code class="code">ParallelLoadThreads</code> task setting. The
                                <code class="code">EnableParallelBatchInMemoryCSVFiles</code> setting 
                                improves performance of larger multithreaded full load tasks by
                                having DMS write to disk instead of memory. The default value is
                                <code class="code">true</code>.</td>
                        </tr>
                        <tr>
                            <td><code class="code">CompressCsvFile</code></td>
                            <td>Use this attribute to compress data sent to a Amazon Redshift target during migration.  The default value 
                                is <code class="code">true</code>, and compression is enabled by default.</td>
                        </tr>
                    </table></div></div>
         
    <h2 id="CHAP_Target.Redshift.EndpointSettings">Using a data encryption key, and an Amazon S3 bucket as intermediate storage</h2>
    
    
    <p>You can use Amazon Redshift target endpoint settings to configure the following:</p>
    <div class="itemizedlist">
         
         
         
    <ul class="itemizedlist"><li class="listitem">
            <p>A custom AWS KMS data encryption key. You can then use this key to encrypt
                your data pushed to Amazon S3 before it is copied to Amazon Redshift.</p>
        </li><li class="listitem">
            <p>A custom S3 bucket as intermediate storage for data migrated to
                Amazon Redshift.</p>
        </li><li class="listitem">
            <p>Map a boolean as a boolean from a PostgreSQL source. By default, a BOOLEAN
                type is migrated as varchar(1). You can specify <code class="code">MapBooleanAsBoolean</code>
                to let your Redshift target migrate the boolean type as boolean, as shown in the
                example following.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">--redshift-settings '<span>{</span>"MapBooleanAsBoolean": true}'</code></pre>                   
        </li></ul></div>
     
        <h3 id="CHAP_Target.Redshift.EndpointSettings.KMSkeys">KMS key settings
                for data encryption</h3>
        <p>The following examples show configuring a custom KMS key to encrypt your data
            pushed to S3. To start, you might make the following
            <code class="code">create-endpoint</code> call using the AWS CLI.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws dms create-endpoint --endpoint-identifier redshift-target-endpoint --endpoint-type target 
--engine-name redshift --username <code class="replaceable">your-username</code> --password <code class="replaceable">your-password</code> 
--server-name <code class="replaceable">your-server-name</code> --port 5439 --database-name <code class="replaceable">your-db-name</code> 
--redshift-settings '<span>{</span>"EncryptionMode": "SSE_KMS", 
"ServerSideEncryptionKmsKeyId": "arn:aws:kms:us-east-1:111122223333:key/24c3c5a1-f34a-4519-a85b-2debbef226d1"}'</code></pre>
        <p>Here, the JSON object specified by <code class="code">--redshift-settings</code> option
            defines two parameters. One is an <code class="code">EncryptionMode</code> parameter with the
            value <code class="code">SSE_KMS</code>. The other is an
            <code class="code">ServerSideEncryptionKmsKeyId</code> parameter with the value
            <code class="code">arn:aws:kms:us-east-1:111122223333:key/24c3c5a1-f34a-4519-a85b-2debbef226d1</code>.
            This value is an Amazon Resource Name (ARN) for your custom KMS key.</p>
        <p>By default, S3 data encryption occurs using S3 server-side encryption. For the
            previous example's Amazon Redshift target, this is also equivalent of specifying its
            endpoint settings, as in the following example.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws dms create-endpoint --endpoint-identifier redshift-target-endpoint --endpoint-type target 
--engine-name redshift --username <code class="replaceable">your-username</code> --password <code class="replaceable">your-password</code> 
--server-name <code class="replaceable">your-server-name</code> --port 5439 --database-name <code class="replaceable">your-db-name</code> 
--redshift-settings '<span>{</span>"EncryptionMode": "SSE_S3"}'</code></pre>
        <p>For more information about working with S3 server-side encryption, see <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/serv-side-encryption.html">Protecting data using server-side encryption</a> in the
            <em>Amazon Simple Storage Service User Guide.</em></p>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You can also use the CLI <code class="code">modify-endpoint</code> command to change
                the value of the <code class="code">EncryptionMode</code> parameter for an existing
                endpoint from <code class="code">SSE_KMS</code> to <code class="code">SSE_S3</code>. But you can’t
                change the <code class="code">EncryptionMode</code> value from <code class="code">SSE_S3</code> to
                <code class="code">SSE_KMS</code>.</p></div></div>
        
     
     
        <h3 id="CHAP_Target.Redshift.EndpointSettings.S3Buckets">Amazon S3 bucket
                settings</h3>
        <p>When you migrate data to an Amazon Redshift target endpoint, AWS DMS uses a default Amazon S3
            bucket as intermediate task storage before copying the migrated data to Amazon Redshift.
            For example, the examples shown for creating an Amazon Redshift target endpoint with a AWS KMS
            data encryption key use this default S3 bucket (see <a href="#CHAP_Target.Redshift.EndpointSettings.KMSkeys">KMS key settings
                for data encryption</a>). </p>
        <p>You can instead specify a custom S3 bucket for this intermediate storage by
            including the following parameters in the value of your
            <code class="code">--redshift-settings</code> option on the AWS CLI
            <code class="code">create-endpoint</code> command:</p>
        <div class="itemizedlist">
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><code class="code">BucketName</code> – A string you specify as the name of
                    the S3 bucket storage.</p>
            </li><li class="listitem">
                <p><code class="code">BucketFolder</code> – (Optional) A string you can specify
                    as the name of the storage folder in the specified S3 bucket.</p>
            </li><li class="listitem">
                <p><code class="code">ServiceAccessRoleArn</code> – The ARN of an IAM role that
                    permits administrative access to the S3 bucket. Typically, you create
                    this role based on the <code class="code">AmazonDMSRedshiftS3Role</code> policy. For
                    an example, see the procedure to create an IAM role with the required
                    AWS-managed policy in <a href="#CHAP_Target.Redshift.KMSKeys">Creating and using AWS KMS keys to
                    encrypt Amazon Redshift target data</a>.</p>
                <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>If you specify the ARN of a different IAM role using the
                        <code class="code">--service-access-role-arn</code> option of the
                        <code class="code">create-endpoint</code> command, this IAM role option takes
                        precedence.</p></div></div>
            </li></ul></div>
        <p>The following example shows how you might use these parameters to specify a
            custom Amazon S3 bucket in the following <code class="code">create-endpoint</code> call using the
            AWS CLI. </p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws dms create-endpoint --endpoint-identifier redshift-target-endpoint --endpoint-type target 
--engine-name redshift --username <code class="replaceable">your-username</code> --password <code class="replaceable">your-password</code> 
--server-name <code class="replaceable">your-server-name</code> --port 5439 --database-name <code class="replaceable">your-db-name</code> 
--redshift-settings '<span>{</span>"ServiceAccessRoleArn": "<code class="replaceable">your-service-access-ARN</code>", 
"BucketName": "<code class="replaceable">your-bucket-name</code>", "BucketFolder": "<code class="replaceable">your-bucket-folder-name</code>"}'</code></pre>
     
 
            <h2 id="CHAP_Target.Redshift.ParallelApply">Multithreaded task settings for Amazon Redshift</h2>
            <p>You can improve performance of full load and change data capture (CDC) tasks for an Amazon Redshift 
                target endpoint by using multithreaded task settings. They enable you to
                specify the number of concurrent threads and the number of records to store in a buffer.</p>

             
                <h3 id="CHAP_Target.Redshift.ParallelApply.FullLoad">Multithreaded full load task settings for Amazon Redshift</h3>
                <p>To promote full load performance, you can use the following <code class="code">ParallelLoad*</code> task settings:</p>
                <div class="itemizedlist">
                     
                      
                <ul class="itemizedlist"><li class="listitem">
                        <p><code class="code">ParallelLoadThreads</code> – Specifies the number of
                        concurrent threads that DMS uses during a full load to push data records to
                        an Amazon Redshift target endpoint. The default value is zero (0) and the maximum value
                        is 32. For more information, see 
                            <a href="./CHAP_Tasks.CustomizingTasks.TaskSettings.FullLoad.html">Full-load
                        task settings</a>.</p>
                        <p>You can use the <code class="code">enableParallelBatchInMemoryCSVFiles</code>
                            attribute set to <code class="code">false</code> when using the
                            <code class="code">ParallelLoadThreads</code> task setting.  The attribute
                            improves performance of larger multithreaded full load tasks by having
                            DMS write to disk instead of memory. The default value is
                            <code class="code">true</code>.</p>
                    </li><li class="listitem">
                        <p><code class="code">ParallelLoadBufferSize</code> – Specifies the maximum
                            data record requests while using parallel load threads with Redshift
                            target. The default value is 100 and the maximum value is 1,000. We
                            recommend you use this option when ParallelLoadThreads &gt; 1 (greater than
                            one).</p>
                    </li></ul></div>
                <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Support for the use of <code class="code">ParallelLoad*</code> task settings during FULL LOAD to 
                        Amazon Redshift target endpoints is available in AWS DMS versions 3.4.5 and
                        higher.</p><p>The <code class="code">ReplaceInvalidChars</code> Redshift endpoint setting is not
                        supported for use during change data capture (CDC) or during a parallel load
                        enabled FULL LOAD migration task. It is supported for FULL LOAD migration
                        when parallel load isn’t enabled. For more information see <a href="https://docs.aws.amazon.com/dms/latest/APIReference/API_RedshiftSettings.html">RedshiftSettings</a> in the
                        <em>AWS Database Migration Service API Reference</em></p></div></div>
             
            
             
                <h3 id="CHAP_Target.Redshift.ParallelApply.CDC">Multithreaded CDC task settings for Amazon Redshift</h3>
            <p>To promote CDC performance, you can use the following <code class="code">ParallelApply*</code> task settings:</p>
            <div class="itemizedlist">
                 
                  
            <ul class="itemizedlist"><li class="listitem">
                    <p><code class="code">ParallelApplyThreads</code> – Specifies the number of
                        concurrent threads that AWS DMS uses during a CDC load to push data records to
                        a Amazon Redshift target endpoint. The default value is zero (0) and the maximum value
                        is 32. The minimum recommended value equals the number of slices in your cluster.</p>
                </li><li class="listitem">
                    <p><code class="code">ParallelApplyBufferSize</code> – Specifies the maximum data
                        record requests while using parallel apply threads with Redshift target. The
                        default value is 100 and the maximum value is 1,000. We recommend to use
                        this option when ParallelApplyThreads &gt; 1 (greater than one). </p>
                    <p>To obtain the most benefit for Redshift as a target, we recommend that the
                        value of <code class="code">ParallelApplyBufferSize</code> be at least two times (double
                        or more) the number of <code class="code">ParallelApplyThreads</code>.</p>
                </li></ul></div>
            
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Support for the use of <code class="code">ParallelApply*</code> task settings during CDC to
                    Amazon Redshift target endpoints is available in AWS DMS versions 3.4.3 and
                    higher.</p></div></div>
            
            <p>The level of parallelism applied depends on the correlation between the total
                    <em>batch size</em> and the <em>maximum file size</em> used to transfer data. When using multithreaded
                CDC task settings with a Redshift target, benefits are gained when batch size is
                large in relation to the maximum file size. For example, you can use the following
                combination of endpoint and task settings to tune for optimal performance. </p>
            
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">// Redshift endpoint setting
                
        MaxFileSize=250000;

// Task settings

        BatchApplyEnabled=true;
        BatchSplitSize =8000;
        BatchApplyTimeoutMax =1800;
        BatchApplyTimeoutMin =1800;
        ParallelApplyThreads=32;
        ParallelApplyBufferSize=100;
            </code></pre>

            <p>Using the settings above, a customer with a heavy transactional workload benefits
                by their 8000 MB batch buffer getting filled in 1800 seconds, utilizing 32 parallel
                threads with a 250 MB maximum file size.</p>
            <p>For more information, see 
                <a href="./CHAP_Tasks.CustomizingTasks.TaskSettings.ChangeProcessingTuning.html">Change processing tuning settings</a>.</p>
            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>DMS queries that run during ongoing replication to a Redshift cluster can share the same 
                WLM (workload management) queue with other application queries that are running. So, 
                consider properly configuring WLM properties to influence performance during ongoing replication 
                to a Redshift target. For example, if other parallel ETL queries are running, DMS runs slower 
                and performance gains are lost.</p></div></div>

             
         
            <h2 id="CHAP_Target.Redshift.DataTypes">Target data types for Amazon Redshift</h2>

            <p>The Amazon Redshift endpoint for AWS DMS supports most Amazon Redshift data types. The following
                table shows the Amazon Redshift target data types that are supported when using AWS DMS and
                the default mapping from AWS DMS data types.</p>
            <p>For additional information about AWS DMS data types, see <a href="./CHAP_Reference.DataTypes.html">Data types for AWS Database Migration Service</a>.</p>
            <div class="table-container"><div class="table-contents"><table id="w350aac29c13c19c39b7"><thead>

                        <tr>
                            <th><p>AWS DMS data types</p></th>
                            <th><p>Amazon Redshift data types</p></th>
                        </tr>
                    </thead>
                        <tr>
                            <td><p>BOOLEAN</p></td>
                            <td><p>BOOL</p></td>
                        </tr>
                        <tr>
                            <td><p>BYTES</p></td>
                            <td><p>VARCHAR (Length)</p></td>
                        </tr>
                        <tr>
                            <td><p>DATE</p></td>
                            <td><p>DATE</p></td>
                        </tr>
                        <tr>
                            <td><p>TIME</p></td>
                            <td><p>VARCHAR(20)</p></td>
                        </tr>
                        <tr>
                            <td><p>DATETIME</p></td>
                            <td>  
                                <p>If the scale is =&gt; 0 and =&lt; 6, depending on Redshift target column type, then one of the following:</p>
                                <p>TIMESTAMP (s)</p>
                                <p>TIMESTAMPTZ (s) — If source timestamp contains a zone
                                    offset (such as in SQL Server or Oracle) it converts to UTC on
                                    insert/update. If it doesn't contain an offset, then time
                                    is considered in UTC already.</p>
                                <p>If the scale is =&gt; 7 and =&lt; 9, then: </p>
                                <p>VARCHAR (37)</p></td>
                        </tr>
                        <tr>
                            <td><p>INT1</p></td>
                            <td><p>INT2</p></td>
                        </tr>
                        <tr>
                            <td><p>INT2</p></td>
                            <td><p>INT2</p></td>
                        </tr>
                        <tr>
                            <td><p>INT4</p></td>
                            <td><p>INT4</p></td>
                        </tr>
                        <tr>
                            <td><p>INT8</p></td>
                            <td><p>INT8</p></td>
                        </tr>
                        <tr>
                            <td><p>NUMERIC</p></td>
                            <td><p>If the scale is =&gt; 0 and =&lt; 37, then: </p>
                                <p>NUMERIC (p,s) </p>
                                <p>If the scale is =&gt; 38 and =&lt; 127, then: </p>
                                <p>VARCHAR (Length)</p></td>
                        </tr>
                        <tr>
                            <td><p>REAL4</p></td>
                            <td><p>FLOAT4</p></td>
                        </tr>
                        <tr>
                            <td><p>REAL8</p></td>
                            <td><p>FLOAT8</p></td>
                        </tr>
                        <tr>
                            <td><p>STRING</p></td>
                            <td><p>If the length is 1–65,535, then use VARCHAR (length
                                    in bytes) </p>
                                <p>If the length is 65,536–2,147,483,647, then use VARCHAR
                                    (65535)</p></td>
                        </tr>
                        <tr>
                            <td><p>UINT1</p></td>
                            <td><p>INT2</p></td>
                        </tr>
                        <tr>
                            <td><p>UINT2</p></td>
                            <td><p>INT2</p></td>
                        </tr>
                        <tr>
                            <td><p>UINT4</p></td>
                            <td><p>INT4</p></td>
                        </tr>
                        <tr>
                            <td><p>UINT8</p></td>
                            <td><p>NUMERIC (20,0)</p></td>
                        </tr>
                        <tr>
                            <td><p>WSTRING</p></td>
                            <td>
                                <p>If the length is 1–65,535, then use NVARCHAR (length in
                                    bytes) </p>
                                <p>If the length is 65,536–2,147,483,647, then use
                                    NVARCHAR (65535)</p></td>
                        </tr>


                        <tr>
                            <td><p>BLOB</p></td>
                            <td><p>VARCHAR (maximum LOB size *2) </p>
                                <p>The maximum LOB size cannot exceed 31 KB. Amazon Redshift
                                    doesn't support VARCHARs larger than 64 KB.</p></td>
                        </tr>
                        <tr>
                            <td><p>NCLOB</p></td>
                            <td><p>NVARCHAR (maximum LOB size) </p>
                                <p>The maximum LOB size cannot exceed 63 KB. Amazon Redshift
                                    doesn't support VARCHARs larger than 64 KB.</p></td>
                        </tr>
                        <tr>
                            <td><p>CLOB</p></td>
                            <td><p>VARCHAR (maximum LOB size) </p>
                                <p>The maximum LOB size cannot exceed 63 KB. Amazon Redshift
                                    doesn't support VARCHARs larger than 64 KB.</p></td>
                        </tr>
                    </table></div></div>

        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./CHAP_Target.MySQL.html">Using MySQL as a target</div><div id="next" class="next-link" accesskey="n" href="./CHAP_Target.SAP.html">Using SAP ASE as a target</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=DMS&amp;topic_url=https://docs.aws.amazon.com/en_us/dms/latest/userguide/CHAP_Target.Redshift.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=DMS&amp;topic_url=https://docs.aws.amazon.com/en_us/dms/latest/userguide/CHAP_Target.Redshift.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>