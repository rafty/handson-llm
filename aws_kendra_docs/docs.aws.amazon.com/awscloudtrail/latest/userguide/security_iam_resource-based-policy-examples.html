<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS CloudTrail resource-based policy examples - AWS CloudTrail</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="security_iam_resource-based-policy-examples" /><meta name="default_state" content="security_iam_resource-based-policy-examples" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" /><meta name="description" content="CloudTrail supports resource-based permissions policies for CloudTrail channels used for CloudTrail Lake integrations. For more information about creating integrations with CloudTrail Lake, see ." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS CloudTrail" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Get a history of actions taken by a user, role, or an AWS service account with AWS CloudTrail." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" hreflang="x-default" /><meta name="feedback-item" content="CloudTrail" /><meta name="this_doc_product" content="AWS CloudTrail" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'cloudtrail'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="AWS CloudTrail resource-based policy examples" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS CloudTrail resource-based policy examples - AWS CloudTrail</title><meta name="pdf" content="/pdfs/awscloudtrail/latest/userguide/awscloudtrail-ug.pdf#security_iam_resource-based-policy-examples" /><meta name="github" content="https://github.com/awsdocs/aws-cloudtrail-user-guide/tree/master/doc_source/security_iam_resource-based-policy-examples.md" /><meta name="rss" content="aws-cloudtrail-document-history.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=168" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudTrail&amp;topic_url=http://docs.aws.amazon.com/en_us/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html" /><meta name="keywords" content="CloudTrail,Trail" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS CloudTrail",
        "item" : "https://docs.aws.amazon.com/cloudtrail/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/awscloudtrail/latest/userguide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Security in AWS CloudTrail",
        "item" : "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/WhatIsCloudTrail-Security.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Identity and Access Management for AWS CloudTrail",
        "item" : "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/security-iam.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "AWS CloudTrail resource-based policy examples",
        "item" : "https://docs.aws.amazon.com/awscloudtrail/latest/userguide/security-iam.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/awscloudtrail/latest/userguide/awscloudtrail-ug.pdf#security_iam_resource-based-policy-examples" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/aws-cloudtrail-user-guide/tree/master/doc_source/security_iam_resource-based-policy-examples.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/cloudtrail/index.html">AWS CloudTrail</a><a href="cloudtrail-user-guide.html">User Guide</a></div><div id="page-toc-src"><a href="#security_iam_resource-based-policy-examples-principals">Example: Providing
               channel access to principals</a><a href="#security_iam_resource-based-policy-examples-externalID">Example: Using an external ID to prevent against confused deputy</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="security_iam_resource-based-policy-examples">AWS CloudTrail resource-based policy examples</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>CloudTrail supports resource-based permissions policies for CloudTrail channels used for CloudTrail Lake integrations. 
         For more information about creating integrations with CloudTrail Lake, see <a href="./query-event-data-store-integration.html">Create an integration with an event
                source outside of AWS</a>. </p><p>The information required for the policy is determined by the integration
         type.</p><div class="itemizedlist">
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>For a direction integration, CloudTrail requires the policy to contain the partner's
               AWS account IDs, and requires you to enter the unique external ID provided by the
               partner. CloudTrail automatically adds the partner's AWS account IDs to the resource
               policy when you create an integration using the CloudTrail console. Refer to the <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/query-event-data-store-integration.html#cloudtrail-lake-partner-information#lake-integration-partner-documentation">partner's documentation</a> to learn how to get the AWS account numbers
               required for the policy.</p>
         </li><li class="listitem">
            <p>For a solution integration, you must specify at least one AWS account ID as
               principal, and can optionally enter an external ID to prevent against confused
               deputy.</p>
         </li></ul></div><p>The following are requirements for the resource-based policy:</p><div class="itemizedlist">
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>The resource ARN defined in the policy must match the channel ARN the policy is attached to.</p>
         </li><li class="listitem">
            <p> The policy contains only one action: <code class="code">cloudtrail-data:PutAuditEvents</code>
            </p>
         </li><li class="listitem">
            <p> The policy contains at least one statement. The policy can have a maximum of 20
               statements. </p>
         </li><li class="listitem">
            <p>
               Each statement contains at least one principal. A statement can have a maximum of 50 principals.
            </p>
         </li></ul></div><p>The channel owner can call the <code class="code">PutAuditEvents</code> API on the channel unless the policy denies the owner access to the resource.</p><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#security_iam_resource-based-policy-examples-principals">Example: Providing
               channel access to principals</a></li><li><a href="#security_iam_resource-based-policy-examples-externalID">Example: Using an external ID to prevent against confused deputy</a></li></ul></div>
         <h2 id="security_iam_resource-based-policy-examples-principals">Example: Providing
               channel access to principals</h2>
         
         <p>The following example grants permissions to the principals with the ARNs
            <code class="code">arn:aws:iam::111122223333:root</code>, <code class="code">arn:aws:iam::444455556666:root</code>, and 
            <code class="code">arn:aws:iam::123456789012:root</code> to call the <a href="https://docs.aws.amazon.com/awscloudtraildata/latest/APIReference/API_PutAuditEvents.html">PutAuditEvents</a> API on the CloudTrail channel with the ARN <code class="code">arn:aws:cloudtrail:us-east-1:777788889999:channel/EXAMPLE-80b5-40a7-ae65-6e099392355b</code>. </p>
         
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight "><span>{</span>
    "Version": "2012-10-17",
    "Statement":
    [
        <span>{</span>
            "Sid": "ChannelPolicy",
            "Effect": "Allow",
            "Principal":
            <span>{</span>
                "AWS":
                [
                    "arn:aws:iam::111122223333:root",
                    "arn:aws:iam::444455556666:root",
                    "arn:aws:iam::123456789012:root"
                ]
            },
            "Action": "cloudtrail-data:PutAuditEvents",
            "Resource": "arn:aws:cloudtrail:us-east-1:777788889999:channel/EXAMPLE-80b5-40a7-ae65-6e099392355b"
        }
    ]
}</code></pre>
       
         <h2 id="security_iam_resource-based-policy-examples-externalID">Example: Using an external ID to prevent against confused deputy</h2>
         <p>The following example uses an external ID to address and prevent against <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cross-service-confused-deputy-prevention.html">confused deputy</a>. 
            The confused deputy problem is a security issue where an entity that doesn't have 
            permission to perform an action can coerce a more-privileged entity to perform the action. 
         </p>
         
         <p>The integration partner creates the external ID to use in the policy. Then, it
            provides the external ID to you as part of creating the integration. The value can be
            any unique string, such as a passphrase or account number. </p>
         
         <p>The example grants permissions to the principals with the ARNs
            <code class="code">arn:aws:iam::111122223333:root</code>, <code class="code">arn:aws:iam::444455556666:root</code>, and 
            <code class="code">arn:aws:iam::123456789012:root</code> to call the <a href="https://docs.aws.amazon.com/awscloudtraildata/latest/APIReference/API_PutAuditEvents.html">PutAuditEvents</a> API on the CloudTrail channel resource if the call to the <code class="code">PutAuditEvents</code> API includes the 
            external ID value defined in the policy. </p>
         
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight "><span>{</span>
    "Version": "2012-10-17",
    "Statement":
    [
        <span>{</span>
            "Sid": "ChannelPolicy",
            "Effect": "Allow",
            "Principal":
            <span>{</span>
                "AWS":
                [
                    "arn:aws:iam::111122223333:root",
                    "arn:aws:iam::444455556666:root",
                    "arn:aws:iam::123456789012:root"
                ]
            },
            "Action": "cloudtrail-data:PutAuditEvents",
            "Resource": "arn:aws:cloudtrail:us-east-1:777788889999:channel/EXAMPLE-80b5-40a7-ae65-6e099392355b",
            "Condition":
            <span>{</span>
                "StringEquals":
                <span>{</span>
                    "cloudtrail:ExternalId": "uniquePartnerExternalID"
                }
            }
        }
    ]
}</code></pre>
         
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./security_iam_id-based-policy-examples.html">Identity-based policy examples</div><div id="next" class="next-link" accesskey="n" href="./create-s3-bucket-policy-for-cloudtrail.html">Amazon S3 bucket policy for CloudTrail</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudTrail&amp;topic_url=https://docs.aws.amazon.com/en_us/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=CloudTrail&amp;topic_url=https://docs.aws.amazon.com/en_us/awscloudtrail/latest/userguide/security_iam_resource-based-policy-examples.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>