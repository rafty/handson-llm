<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Using service-linked roles for Amazon EFS - Amazon Elastic File System</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="using-service-linked-roles" /><meta name="default_state" content="using-service-linked-roles" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/efs/latest/ug/using-service-linked-roles.html" /><meta name="description" content="How to use a service-linked role to give Amazon EFS access to resources in your AWS account." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Elastic File System" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Use Amazon Elastic File System to set up, operate, and scale shared file storage in the Amazon Web Services (AWS) cloud." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/efs/latest/ug/using-service-linked-roles.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/efs/latest/ug/using-service-linked-roles.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/efs/latest/ug/using-service-linked-roles.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/efs/latest/ug/using-service-linked-roles.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/efs/latest/ug/using-service-linked-roles.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/efs/latest/ug/using-service-linked-roles.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/efs/latest/ug/using-service-linked-roles.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/efs/latest/ug/using-service-linked-roles.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/efs/latest/ug/using-service-linked-roles.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/efs/latest/ug/using-service-linked-roles.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/efs/latest/ug/using-service-linked-roles.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/efs/latest/ug/using-service-linked-roles.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/efs/latest/ug/using-service-linked-roles.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/efs/latest/ug/using-service-linked-roles.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/efs/latest/ug/using-service-linked-roles.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/efs/latest/ug/using-service-linked-roles.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/efs/latest/ug/using-service-linked-roles.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/efs/latest/ug/using-service-linked-roles.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/efs/latest/ug/using-service-linked-roles.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/efs/latest/ug/using-service-linked-roles.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/efs/latest/ug/using-service-linked-roles.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/efs/latest/ug/using-service-linked-roles.html" hreflang="x-default" /><meta name="feedback-item" content="EFS" /><meta name="this_doc_product" content="Amazon Elastic File System" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'efs'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Using service-linked roles for Amazon EFS" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Using service-linked roles for Amazon EFS - Amazon Elastic File System</title><meta name="pdf" content="/pdfs/efs/latest/ug/efs-ug.pdf#using-service-linked-roles" /><meta name="github" content="https://github.com/awsdocs/amazon-efs-user-guide/tree/main/doc_source/using-service-linked-roles.md" /><meta name="rss" content="amazon-efs-doc-updates.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=222" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=EFS&amp;topic_url=http://docs.aws.amazon.com/en_us/efs/latest/ug/using-service-linked-roles.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/efs/latest/ug/using-service-linked-roles.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/efs/latest/ug/using-service-linked-roles.html" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Elastic File System (EFS)",
        "item" : "https://docs.aws.amazon.com/efs/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/efs/latest/ug"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Security in Amazon EFS",
        "item" : "https://docs.aws.amazon.com/efs/latest/ug/security-considerations.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Identity and access management for Amazon Elastic File System",
        "item" : "https://docs.aws.amazon.com/efs/latest/ug/security-iam.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Using service-linked roles for Amazon EFS",
        "item" : "https://docs.aws.amazon.com/efs/latest/ug/security-iam.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/efs/latest/ug/efs-ug.pdf#using-service-linked-roles" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/amazon-efs-user-guide/tree/main/doc_source/using-service-linked-roles.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/efs/index.html">Amazon Elastic File System (EFS)</a><a href="whatisefs.html">User Guide</a></div><div id="page-toc-src"><a href="#slr-permissions">Service-linked role permissions for Amazon EFS</a><a href="#create-slr">Creating a service-linked role for Amazon EFS</a><a href="#edit-slr">Editing a service-linked role for Amazon EFS</a><a href="#delete-slr">Deleting a service-linked role for Amazon EFS</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="using-service-linked-roles">Using service-linked roles for Amazon EFS</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Amazon Elastic File System uses an AWS Identity and Access Management (IAM)<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-linked-role">
      service-linked role</a>. The Amazon EFS service-linked role is a unique type of IAM
    role that is linked directly to Amazon EFS. The predefined Amazon EFS service-linked role
    includes permissions that the service requires to call other AWS services on your behalf. </p><p>A service-linked role makes setting up Amazon EFS easier because you don't have to
    manually add the necessary permissions. Amazon EFS defines the permissions of its
    service-linked role, and only Amazon EFS can assume its role. The
    defined permissions include the trust policy and the permissions policy, and that permissions
    policy can't be attached to any other IAM entity.</p><p>You can delete the Amazon EFS service-linked role only after first deleting your Amazon EFS file systems. This
    protects your Amazon EFS resources because you can't inadvertently remove permission to
    access the resources.</p><p>The service-linked role enables all API calls to be visible through AWS CloudTrail. This helps
    with monitoring and auditing requirements because you can track all actions that Amazon EFS performs
    on your behalf. For more information, see <a href="./logging-using-cloudtrail.html#efs-service-linked-role-ct">Log entries for EFS service-linked roles</a>.</p>
    <h2 id="slr-permissions">Service-linked role permissions for Amazon EFS</h2>
    <p>Amazon EFS uses the service-linked role named <code class="code">AWSServiceRoleForAmazonElasticFileSystem</code>
      to allow Amazon EFS to call and manage AWS resources on behalf of your EFS file systems.</p>
    <p>The AWSServiceRoleForAmazonElasticFileSystem service-linked role trusts the following services to assume the
      role:</p>
    <div class="itemizedlist">
       
    <ul class="itemizedlist"><li class="listitem">
        <p><code class="code">elasticfilesystem.amazonaws.com</code></p>
      </li></ul></div>
    <p>The role permissions policy allows Amazon EFS to complete the actions included in the policy definition JSON:</p>
    
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "backup-storage:MountCapsule",
                "ec2:CreateNetworkInterface",
                "ec2:DeleteNetworkInterface",
                "ec2:DescribeSecurityGroups",
                "ec2:DescribeSubnets",
                "ec2:DescribeNetworkInterfaceAttribute",
                "ec2:ModifyNetworkInterfaceAttribute",
                "tag:GetResources"
            ],
            "Resource": "*"
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kms:DescribeKey"
            ],
            "Resource": "arn:aws:kms:*:*:key/*"
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "backup:CreateBackupVault",
                "backup:PutBackupVaultAccessPolicy"
            ],
            "Resource": [
                "arn:aws:backup:*:*:backup-vault:aws/efs/automatic-backup-vault"
            ]
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "backup:CreateBackupPlan",
                "backup:CreateBackupSelection"
            ],
            "Resource": [
                "arn:aws:backup:*:*:backup-plan:*"
            ]
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "iam:CreateServiceLinkedRole"
            ],
            "Resource": "*",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "iam:AWSServiceName": [
                        "backup.amazonaws.com"
                    ]
                }
            }
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "iam:PassRole"
            ],
            "Resource": [
                "arn:aws:iam::*:role/aws-service-role/backup.amazonaws.com/AWSServiceRoleForBackup"
            ],
            "Condition": <span>{</span>
                "StringLike": <span>{</span>
                    "iam:PassedToService": "backup.amazonaws.com"
                }
            }
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "elasticfilesystem:DescribeFileSystems",
                "elasticfilesystem:CreateReplicationConfiguration",
                "elasticfilesystem:DescribeReplicationConfigurations",
                "elasticfilesystem:DeleteReplicationConfiguration"
            ],
            "Resource": "*"
        }
    ]
}</code></pre>
    
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>
         You must manually configure IAM permissions for AWS KMS when creating a new Amazon EFS file system that is encrypted at rest. 
        To learn more, see <a href="./encryption-at-rest.html">Encrypting data at rest</a>.
      </p></div></div>
   
    <h2 id="create-slr">Creating a service-linked role for Amazon EFS</h2>
    <p>You must configure permissions to allow an IAM entity (such as a user, group, or role)
      to create a service-linked role. Do this by adding the 
      <code class="code">iam:CreateServiceLinkedRole</code> permission to an IAM entity as 
      shown in the following example.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Action": "iam:CreateServiceLinkedRole",
    "Effect": "Allow",
    "Resource": "*",
    "Condition": <span>{</span>
        "StringEquals": <span>{</span>
            "iam:AWSServiceName": [
                "elasticfilesystem.amazonaws.com"
            ]
        }
    }
}</code></pre>
    <p>For more information, see 
      <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/using-service-linked-roles.html#service-linked-role-permissions">
        Service-Linked Role Permissions</a>
      in the <em>IAM User Guide</em>.</p>
    <p>You don't need to manually create a service-linked role. When you
      create mount targets or a replication configuration for your EFS file system in the AWS Management Console, the AWS CLI, or the AWS API, Amazon EFS
      creates the service-linked role for you. </p>
    
    <p>If you delete this service-linked role, and then need to create it again, you can use the
      same process to recreate the role in your account. When you create mount targets or a replication configuration for your EFS file system,
      Amazon EFS creates the service-linked role for you again. </p>
    
   
    <h2 id="edit-slr">Editing a service-linked role for Amazon EFS</h2>
    <p>Amazon EFS doesn't allow you to edit the <code class="code">AWSServiceRoleForAmazonElasticFileSystem</code> service-linked role. After you
      create a service-linked role, you cannot change the name of the role because various entities
      might reference the role. However, you can edit the description of the role using IAM. For
      more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/using-service-linked-roles.html#edit-service-linked-role">Editing
        a Service-Linked Role</a> in the <em>IAM User Guide</em>.</p>
   
    <h2 id="delete-slr">Deleting a service-linked role for Amazon EFS</h2>
    
    <p>If you no longer need to use a feature or service that requires a service-linked role, we
      recommend that you delete that role. That way you don't have an unused entity that is not
      actively monitored or maintained. However, you must clean up the resources for your
      service-linked role before you can manually delete it.</p>    
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>If the Amazon EFS service is using the role when you try to delete the resources,
        then the deletion might fail. If that happens, wait for a few minutes and try the
        operation again.</p></div></div>
    <div class="procedure"><h6>To delete Amazon EFS resources used by the AWSServiceRoleForAmazonElasticFileSystem</h6><p>Complete the following steps to delete Amazon EFS resources used by the AWSServiceRoleForAmazonElasticFileSystem. 
        For the detailed procedure, see <a href="./gs-step-five-cleanup.html">Step 4: Clean up resources and protect your AWS
        account</a>.</p><ol><li>
        <p>On your Amazon EC2 instance, unmount the Amazon EFS file system. </p>
      </li><li>
        <p>Delete the Amazon EFS file system. </p>
      </li><li>
        <p>Delete the custom security group for the file system. </p>
        <div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Warning</h6></div><div class="awsdocs-note-text"><p>If you used the default security group for your virtual private cloud (VPC),
              <b>do not</b> delete that security group.</p></div></div>
      </li></ol></div>
    <p><b>To manually delete the service-linked role using
      IAM</b></p>
    <p>Use the IAM console, the AWS CLI, or the AWS API to delete the AWSServiceRoleForAmazonElasticFileSystem
      service-linked role. For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/using-service-linked-roles.html#delete-service-linked-role">Deleting a
        Service-Linked Role</a> in the <em>IAM User Guide</em>.</p>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./using-tags-efs.html">Using tags with Amazon EFS</div><div id="next" class="next-link" accesskey="n" href="./security_iam_troubleshoot.html">Troubleshooting</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=EFS&amp;topic_url=https://docs.aws.amazon.com/en_us/efs/latest/ug/using-service-linked-roles.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=EFS&amp;topic_url=https://docs.aws.amazon.com/en_us/efs/latest/ug/using-service-linked-roles.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>