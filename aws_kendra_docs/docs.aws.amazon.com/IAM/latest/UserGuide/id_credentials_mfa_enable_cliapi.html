<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Enabling and managing virtual MFA devices (AWS CLI or AWS API) - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="id_credentials_mfa_enable_cliapi" /><meta name="default_state" content="id_credentials_mfa_enable_cliapi" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" /><meta name="description" content="Use command line tools or the IAM API to enable a virtual multi-factor authentication (MFA) device in IAM." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Control access to your AWS resources with user identity (authentication) and with policies that define specific permissions (authorization)." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Enabling and managing virtual MFA devices (AWS CLI or AWS API)" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Enabling and managing virtual MFA devices (AWS CLI or AWS API) - AWS Identity and Access Management</title><meta name="pdf" content="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#id_credentials_mfa_enable_cliapi" /><meta name="github" content="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/id_credentials_mfa_enable_cliapi.md" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM user,user,IAM group,group,IAM role,role,permission policy,trust policy,policy,access key,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "IAM Identities (users, user groups, and roles)",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "IAM users",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Using multi-factor authentication (MFA) in AWS",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Enabling MFA devices for users in AWS",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "Enabling and managing virtual MFA devices (AWS CLI or AWS API)",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#id_credentials_mfa_enable_cliapi" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/id_credentials_mfa_enable_cliapi.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">User Guide</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="id_credentials_mfa_enable_cliapi">Enabling and managing virtual MFA devices
      (AWS CLI or AWS API)</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>You can use AWS CLI commands or AWS API operations to enable a virtual MFA device for an
    IAM user. You cannot enable an MFA device for the AWS account root user with the AWS CLI, AWS API, Tools for Windows PowerShell,
    or any other command line tool. However, you can use the AWS Management Console to enable an MFA device for
    the root user.
    </p><p>When you enable an MFA device from the AWS Management Console, the console performs multiple steps for
    you. If you instead create a virtual device using the AWS CLI, Tools for Windows PowerShell, or AWS API, then you must
    perform the steps manually and in the correct order. For example, to create a virtual MFA
    device, you must create the IAM object and extract the code as either a string or a QR code
    graphic. Then you must sync the device and associate it with an IAM user. See the <b>Examples</b> section of <a href="https://docs.aws.amazon.com/powershell/latest/reference/Index.html?page=New-IAMVirtualMFADevice.html&amp;tocid=New-IAMVirtualMFADevice">New-IAMVirtualMFADevice</a> for more details. For a physical device, you skip the
    creation step and go directly to syncing the device and associating it with the user. </p><p>You can attach tags to your IAM resources, including virtual MFA devices, to identify,
    organize, and control access to them. You can tag virtual MFA devices only when you use the
    AWS CLI or AWS API.</p><p>An IAM user using the SDK or CLI can enable an additional MFA device by calling <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_EnableMFADevice.html"><code class="code">EnableMFADevice</code></a> or deactivate an existing MFA device by calling <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeactivateMFADevice.html"><code class="code">DeactivateMFADevice</code></a>. To do this successfully, they must first call
      <a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_GetSessionToken.html"><code class="code">GetSessionToken</code></a> and submit MFA codes with an existing MFA device. This
    call returns temporary security credentials that can then be used to sign API operations that
    require MFA authentication. For an example request and response, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp_request.html#api_getsessiontoken"><code class="code">GetSessionToken</code>â€”temporary credentials for users in untrusted
      environments</a>. </p>
    <h6>To create the virtual device entity in IAM to represent a virtual MFA device</h6>
    <p>These commands provide an ARN for the device that is used in place of a serial number in
      many of the following commands.</p>
  <div class="itemizedlist">
     
     
  <ul class="itemizedlist"><li class="listitem">
      <p>AWS CLI: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/create-virtual-mfa-device.html"><code class="code">aws iam create-virtual-mfa-device</code></a>
      </p>
    </li><li class="listitem">
      <p>AWS API: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreateVirtualMFADevice.html"><code class="code">CreateVirtualMFADevice</code></a>
      </p>
    </li></ul></div>
    <h6>To enable an MFA device for use with AWS</h6>
    <p>These commands synchronize the device with AWS and associate it with a user. If the
      device is virtual, use the ARN of the virtual device as the serial number.</p>
  <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>Submit your request immediately after generating the authentication codes. If you generate
      the codes and then wait too long to submit the request, the MFA device successfully associates
      with the user but the MFA device becomes out of sync. This happens because time-based one-time
      passwords (TOTP) expire after a short period of time. If this happens, you can resynchronize
      the device using the commands described below.</p></div></div><div class="itemizedlist">
     
     
  <ul class="itemizedlist"><li class="listitem">
      <p>AWS CLI: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/enable-mfa-device.html"><code class="code">aws
            iam enable-mfa-device</code></a>
      </p>
    </li><li class="listitem">
      <p>AWS API: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_EnableMFADevice.html"><code class="code">EnableMFADevice</code></a>
      </p>
    </li></ul></div>
    <h6>To deactivate a device</h6>
    <p>Use these commands to disassociate the device from the user and deactivate it. If the
      device is virtual, use the ARN of the virtual device as the serial number. You must also
      separately delete the virtual device entity. </p>
  <div class="itemizedlist">
     
     
  <ul class="itemizedlist"><li class="listitem">
      <p>AWS CLI: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/deactivate-mfa-device.html"><code class="code">aws iam deactivate-mfa-device</code></a>
      </p>
    </li><li class="listitem">
      <p>AWS API: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeactivateMFADevice.html"><code class="code">DeactivateMFADevice</code></a></p>
    </li></ul></div>
    <h6>To list virtual MFA device entities</h6>
    <p>Use these commands to list virtual MFA device entities.</p>
  <div class="itemizedlist">
     
     
  <ul class="itemizedlist"><li class="listitem">
      <p>AWS CLI: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/list-virtual-mfa-devices.html"><code class="code">aws iam list-virtual-mfa-devices</code></a>
      </p>
    </li><li class="listitem">
      <p>AWS API: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_ListVirtualMFADevices.html"><code class="code">ListVirtualMFADevices</code></a>
      </p>
    </li></ul></div>
    <h6>To tag a virtual MFA device</h6>
    <p>Use these commands to tag a virtual MFA device.</p>
  <div class="itemizedlist">
     
     
  <ul class="itemizedlist"><li class="listitem">
      <p>AWS CLI: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/tag-mfa-device.html"><code class="code">aws iam
            tag-mfa-device</code></a>
      </p>
    </li><li class="listitem">
      <p>AWS API: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_TagMFADevice.html"><code class="code">TagMFADevice</code></a>
      </p>
    </li></ul></div>
    <h6>To list tags for a virtual MFA device</h6>
    <p>Use these commands to list the tags attached to a virtual MFA device.</p>
  <div class="itemizedlist">
     
     
  <ul class="itemizedlist"><li class="listitem">
      <p>AWS CLI: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/list-mfa-device-tags.html"><code class="code">aws iam list-mfa-device-tags</code></a>
      </p>
    </li><li class="listitem">
      <p>AWS API: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_ListMFADeviceTags.html"><code class="code">ListMFADeviceTags</code></a>
      </p>
    </li></ul></div>
    <h6>To untag a virtual MFA device</h6>
    <p>Use these commands to remove tags attached to a virtual MFA device.</p>
  <div class="itemizedlist">
     
     
  <ul class="itemizedlist"><li class="listitem">
      <p>AWS CLI: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/untag-mfa-device.html"><code class="code">aws
            iam untag-mfa-device</code></a>
      </p>
    </li><li class="listitem">
      <p>AWS API: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_UntagMFADevice.html"><code class="code">UntagMFADevice</code></a>
      </p>
    </li></ul></div>
    <h6>To resynchronize an MFA device</h6>
    <p>Use these commands if the device is generating codes that are not accepted by AWS. If
      the device is virtual, use the ARN of the virtual device as the serial number.</p>
  <div class="itemizedlist">
     
     
  <ul class="itemizedlist"><li class="listitem">
      <p>AWS CLI: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/resync-mfa-device.html"><code class="code">aws
            iam resync-mfa-device</code></a>
      </p>
    </li><li class="listitem">
      <p>AWS API: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_ResyncMFADevice.html"><code class="code">ResyncMFADevice</code></a>
      </p>
    </li></ul></div>
    <h6>To delete a virtual MFA device entity in IAM</h6>
    <p>After the device is disassociated from the user, you can delete the device entity.</p>
  <div class="itemizedlist">
     
     
  <ul class="itemizedlist"><li class="listitem">
      <p>AWS CLI: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/delete-virtual-mfa-device.html"><code class="code">aws iam delete-virtual-mfa-device</code></a>
      </p>
    </li><li class="listitem">
      <p>AWS API: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeleteVirtualMFADevice.html"><code class="code">DeleteVirtualMFADevice</code></a>
      </p>
    </li></ul></div>
    <h6>To recover a virtual MFA device that is lost or not working</h6>
    <p>Sometimes, a user's device that hosts the virtual MFA app is lost, replaced, or not
      working. When this happens, the user can't recover it on their own. The user must contact
      an administrator to deactivate the device. For more information, see <a href="./id_credentials_mfa_lost-or-broken.html">What if an MFA device is lost or stops
      working?</a>.</p>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./id_credentials_mfa_enable_physical.html">Enabling a hardware TOTP token
      (console)</div><div id="next" class="next-link" accesskey="n" href="./id_credentials_mfa_checking-status.html">Checking MFA status</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_credentials_mfa_enable_cliapi.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>