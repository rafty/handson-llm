<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Creating a role to delegate permissions to an AWS service - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="id_roles_create_for-service" /><meta name="default_state" content="id_roles_create_for-service" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-service.html" /><meta name="description" content="Create an IAM role that determines what an AWS service is allowed to do with AWS account resources." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Control access to your AWS resources with user identity (authentication) and with policies that define specific permissions (authorization)." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-service.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-service.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Creating a role to delegate permissions to an AWS service" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Creating a role to delegate permissions to an AWS service - AWS Identity and Access Management</title><meta name="pdf" content="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#id_roles_create_for-service" /><meta name="github" content="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/id_roles_create_for-service.md" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_create_for-service.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_create_for-service.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_create_for-service.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM user,user,IAM group,group,IAM role,role,permission policy,trust policy,policy,access key,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "IAM Identities (users, user groups, and roles)",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "IAM roles",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Creating IAM roles",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Creating a role to delegate permissions to an AWS service",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#id_roles_create_for-service" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/id_roles_create_for-service.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">User Guide</a></div><div id="page-toc-src"><a href="#id_roles_create_service-permissions">Service role permissions</a><a href="#roles-creatingrole-service-console">Creating a role for an AWS service
        (console)</a><a href="#roles-creatingrole-service-cli">Creating a role for a service (AWS CLI)</a><a href="#roles-creatingrole-service-api">Creating a role for a service (AWS
        API)</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="id_roles_create_for-service">Creating a role to delegate permissions to an
      AWS service</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Many AWS services require that you
    use roles to allow the service to access resources in other services on your behalf. A role that
    a service assumes to perform actions on your behalf is called a <a href="./id_roles_terms-and-concepts.html#iam-term-service-role">service role</a>. When a role serves a specialized purpose
    for a service, it is categorized as a <a href="./id_roles_terms-and-concepts.html#iam-term-service-role-ec2">service role for
      EC2 instances</a> (for example), or a <a href="./id_roles_terms-and-concepts.html#iam-term-service-linked-role">service-linked role</a>. To see what services support using service-linked roles, or
    whether a service supports any form of temporary credentials, see <a href="./reference_aws-services-that-work-with-iam.html">AWS services that work with
      IAM</a>. To learn how an individual
    service uses roles, choose the service name in the table to view the documentation for that
    service.</p><p>For information about how roles help you to delegate permissions, see <a href="./id_roles_terms-and-concepts.html">Roles terms and concepts</a>.</p>
    <h2 id="id_roles_create_service-permissions">Service role permissions</h2>
    <p>You must configure permissions to allow an IAM entity (user or role) to create or edit a
      service role.</p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The ARN for a service-linked role includes a service principal, which is indicated in
        the following policies as
        <code class="code"><code class="replaceable">SERVICE-NAME</code>.amazonaws.com</code>. Do not try to guess the
        service principal, because it is case-sensitive and the format can vary across AWS
        services. To view the service principal for a service, see its service-linked role
        documentation.</p></div></div>
    <p><b>To allow an IAM entity to create a specific service
        role</b></p>
    <p>Add the following policy to the IAM entity that needs to create the service role. This
      policy allows you to create a service role for the specified service and with a specific name.
      You can then attach managed or inline policies to that role. </p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "iam:AttachRolePolicy",
                "iam:CreateRole",
                "iam:PutRolePolicy"
            ],
            "Resource": "arn:aws:iam::*:role/<code class="replaceable">SERVICE-ROLE-NAME</code>"
        }
    ]
}</code></pre>
    <p><b>To allow an IAM entity to create any service
      role</b></p>
    <p>AWS recommends that you allow only administrative users to create any service role. A
      person with permissions to create a role and attach any policy can escalate their own
      permissions. Instead, create a policy that allows them to create only the roles that they need
      or have an administrator create the service role on their behalf.</p>
    <p>To attach a policy that allows an administrator to access your entire AWS account, use
      the <a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/AdministratorAccess" rel="noopener noreferrer" target="_blank"><span>AdministratorAccess</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> AWS managed policy.</p>

    <p><b>To allow an IAM entity to edit a service role</b></p>
    <p>Add the following policy to the IAM entity that needs to edit the service role.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "EditSpecificServiceRole",
            "Effect": "Allow",
            "Action": [
                "iam:AttachRolePolicy",
                "iam:DeleteRolePolicy",
                "iam:DetachRolePolicy",
                "iam:GetRole",
                "iam:GetRolePolicy",
                "iam:ListAttachedRolePolicies",
                "iam:ListRolePolicies",
                "iam:PutRolePolicy",
                "iam:UpdateRole",
                "iam:UpdateRoleDescription"
            ],
            "Resource": "arn:aws:iam::*:role/<code class="replaceable">SERVICE-ROLE-NAME</code>"
        },
        <span>{</span>
            "Sid": "ViewRolesAndPolicies",
            "Effect": "Allow",
            "Action": [
                "iam:GetPolicy",
                "iam:ListRoles"
            ],
            "Resource": "*"
        }
    ]
}</code></pre>
    <p><b>To allow an IAM entity to delete a specific service
        role</b></p>
    <p>Add the following statement to the permissions policy for the IAM entity that needs to
      delete the specified service role.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "Effect": "Allow",
    "Action": "iam:DeleteRole",
    "Resource": "arn:aws:iam::*:role/<code class="replaceable">SERVICE-ROLE-NAME</code>"
}</code></pre>
    <p><b>To allow an IAM entity to delete any service
      role</b></p>
    <p>AWS recommends that you allow only administrative users to delete any service role.
      Instead, create a policy that allows them to delete only the roles that they need or have an
      administrator delete the service role on their behalf.</p>
    <p>To attach a policy that allows an administrator to access your entire AWS account, use
      the <a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/AdministratorAccess" rel="noopener noreferrer" target="_blank"><span>AdministratorAccess</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> AWS managed policy.</p>
   
    <h2 id="roles-creatingrole-service-console">Creating a role for an AWS service
        (console)</h2>
    <p>You can use the AWS Management Console to create a role for a service. Because some services support
      more than one service role, see the <a href="https://docs.aws.amazon.com/">AWS documentation</a>
      for your service to see which use case to choose. You can learn how to assign the necessary
      trust and permissions policies to the role so that the service can assume the role on your
      behalf. The steps that you can use to control the permissions for your role can vary,
      depending on how the service defines the use cases, and whether or not you create a
      service-linked role.</p>

    
    <div class="procedure"><h6>To create a role for an AWS service (console)</h6><ol><li><p>Sign in to the AWS Management Console and open the IAM console at <a href="https://console.aws.amazon.com/iam/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/iam/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
        <p>In the navigation pane of the IAM console, choose <b>Roles</b>, and
          then choose <b>Create role</b>.</p>
      </li><li>
        <p>For <b>Select trusted entity</b>, choose <b>AWS
            service</b>. </p>
      </li><li>
        <p>Choose the use case for your service. Use cases are defined by the service to include
          the trust policy required by the service. Then, choose <b>Next</b>.</p>
      </li><li>
        <p>If possible, select the policy to use for the permissions policy or choose
            <b>Create policy</b> to open a new browser tab and create a new policy
          from scratch. For more information, see <a href="./access_policies_create-console.html#access_policies_create-start">Creating IAM policies</a>. After you create the policy, close that
          tab and return to your original tab. Select the check box next to the permissions policies
          that you want the service to have.</p>
        <p>Depending on the use case that you selected, the service might allow you to do any of
          the following:</p>
        <div class="itemizedlist">
           
           
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p>Nothing, because the service defines the permissions for the role.</p>
          </li><li class="listitem">
            <p>Choose from a limited set of permissions.</p>
          </li><li class="listitem">
            <p>Choose from any permissions.</p>
          </li><li class="listitem">
            <p>Select no policies at this time, create the policies later, and then attach them
              to the role.</p>
          </li></ul></div>
      </li><li>
        <p>(Optional) Set a <a href="./access_policies_boundaries.html">permissions
            boundary</a>. This is an advanced feature that is available for service roles, but
          not service-linked roles. </p>
        <p>Expand the <b>Permissions boundary</b> section and choose <b>Use
            a permissions boundary to control the maximum role permissions</b>. IAM
          includes a list of the AWS managed and customer managed policies in your account. Select
          the policy to use for the permissions boundary, or choose <b>Create
            policy</b> to open a new browser tab and create a new policy from scratch. For
          more information, see <a href="./access_policies_create-console.html#access_policies_create-start">Creating IAM policies</a>. After you create the policy, close that
          tab and return to your original tab to select the policy to use for the permissions
          boundary.</p>
      </li><li>
        <p>Choose <b>Next</b>.</p>
      </li><li>
        <p>For <b>Role name</b>, the degree of role name customization is defined
          by the service. If the service defines the role's name, this option is not editable. In
          other cases, the service might define a prefix for the role and allow you to enter an
          optional suffix. Some services allow you to specify the entire name of your role.</p>
        <p>If possible, enter a role name or role name suffix to help you identify the purpose of
          this role. Role names must be unique within your AWS account. They are not distinguished
          by case. For example, you cannot create roles named both <code class="userinput">PRODROLE</code>
          and <code class="userinput">prodrole</code>. Because other AWS resources might reference the
          role, you cannot edit the name of the role after it has been created.</p>
      </li><li>
        <p>(Optional) For <b>Description</b>, enter a description for the new
          role.</p>
      </li><li>
        <p>Choose <b>Edit</b> in the <b>Step 1: Select trusted
            entities</b> or <b>Step 2: Add permissions</b> sections to edit the
          use cases and permissions for the role. </p>
      </li><li>
        <p>(Optional) Add metadata to the role by attaching tags as key–value pairs. For
          more information about using tags in IAM, see <a href="./id_tags.html">Tagging IAM resources</a>.</p>
      </li><li>
        <p>Review the role and then choose <b>Create role</b>.</p>
      </li></ol></div>
   
    <h2 id="roles-creatingrole-service-cli">Creating a role for a service (AWS CLI)</h2>
    <p>Creating a role from the AWS CLI involves multiple steps. When you use the console to create
      a role, many of the steps are done for you, but with the AWS CLI you must explicitly perform
      each step yourself. You must create the role and then assign a permissions policy to the role.
      If the service you are working with is Amazon EC2, then you must also create an instance profile
      and add the role to it. Optionally, you can also set the <a href="./access_policies_boundaries.html">permissions boundary</a> for your role.</p>
    <div class="procedure"><h6>To create a role for an AWS service from the AWS CLI</h6><ol><li>
        <p>The following <code class="code"><a href="https://docs.aws.amazon.com/cli/latest/reference/iam/create-role.html">create-role</a></code> command creates a role named <em>Test-Role</em>
          and attaches a trust policy to it:</p>
        <p><code class="prompt">aws iam create-role --role-name Test-Role --assume-role-policy-document
            file://Test-Role-Trust-Policy.json</code></p>

      </li><li>
        <p>Attach a managed permissions policy to the role: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/attach-role-policy.html">aws iam
          attach-role-policy</a>.</p>
        <p>For example, the following <code class="code">attach-role-policy</code> command attaches the AWS
          managed policy named <code class="code">ReadOnlyAccess</code> to the IAM role named
            <code class="code">ReadOnlyRole</code>:</p>
        <p><code class="prompt">aws iam attach-role-policy --policy-arn arn:aws:iam::aws:policy/ReadOnlyAccess
            --role-name ReadOnlyRole</code></p>
        <p> or</p>
        <p>Create an inline permissions policy for the role: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/put-role-policy.html">aws iam put-role-policy</a></p>
        <p>To add an inline permissions policy, see the following example:</p>
        <p>
          <code class="prompt">aws iam put-role-policy --role-name Test-Role --policy-name ExamplePolicy
            --policy-document file://AdminPolicy.json</code></p>
      </li><li>
        <p>(Optional) Add custom attributes to the role by attaching tags: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/tag-role.html">aws iam tag-role</a></p>
        <p>For more information, see <a href="./id_tags_roles.html#id_tags_roles_procs-cli-api">Managing tags on IAM roles (AWS CLI or
                AWS API)</a>.</p>
      </li><li>
        <p>(Optional) Set the <a href="./access_policies_boundaries.html">permissions
            boundary</a> for the role: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/put-role-permissions-boundary.html">aws iam
            put-role-permissions-boundary</a></p>
        <p>A permissions boundary controls the maximum permissions that a role can have.
          Permissions boundaries are an advanced AWS feature.</p>
      </li></ol></div>
    <p>If you are going to use the role with Amazon EC2 or another AWS service that uses Amazon EC2, you
      must store the role in an instance profile. An instance profile is a container for a role that
      can be attached to an Amazon EC2 instance when launched. An instance profile can contain only one
      role, and that limit cannot be increased. If you create the role using the AWS Management Console, the
      instance profile is created for you with the same name as the role. For more information about
      instance profiles, see <a href="./id_roles_use_switch-role-ec2_instance-profiles.html">Using instance profiles</a>. For information about how
      to launch an EC2 instance with a role, see <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/UsingIAM.html#UsingIAMrolesWithAmazonEC2Instances">Controlling Access to
        Amazon EC2 Resources</a> in the <em>Amazon EC2 User Guide for Linux Instances</em>.</p>
    <div class="procedure"><h6>To create an instance profile and store the role in it (AWS CLI)</h6><ol><li>
        <p>Create an instance profile: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/create-instance-profile.html">aws iam create-instance-profile</a></p>
      </li><li>
        <p>Add the role to the instance profile: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/add-role-to-instance-profile.html">aws iam
            add-role-to-instance-profile</a></p>
      </li></ol></div>
    <p>The AWS CLI example command set below demonstrates the first two steps for creating a role
      and attaching permissions. It also shows the two steps for creating an instance profile and
      adding the role to the profile. This example trust policy allows the Amazon EC2 service to assume
      the role and view the <code class="code">example_bucket</code> Amazon S3 bucket. The example also assumes that
      you are running on a client computer running Windows and have already configured your command
      line interface with your account credentials and Region. For more information, see <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html">Configuring the AWS Command Line
        Interface</a>.</p>
    <p>In this example, include the following trust policy in the first command when you create
      the role. This trust policy allows the Amazon EC2 service to assume the role. </p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
  "Version": "2012-10-17",
  "Statement": <span>{</span>
    "Effect": "Allow",
    "Principal": <span>{</span>"Service": "ec2.amazonaws.com"},
    "Action": "sts:AssumeRole"
  }
}</code></pre>
    <p>When you use the second command, you must attach a permissions policy to the role. The
      following example permissions policy allows the role to perform only the
        <code class="code">ListBucket</code> action on the <code class="code">example_bucket</code> Amazon S3 bucket.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
  "Version": "2012-10-17",
  "Statement": <span>{</span>
    "Effect": "Allow",
    "Action": "s3:ListBucket",
    "Resource": "arn:aws:s3:::example_bucket"
  }
}</code></pre>
    <p>To create this <code class="code">Test-Role-for-EC2</code> role, you must first save the previous trust
      policy with the name <code class="code">trustpolicyforec2.json</code> and the previous permissions policy
      with the name <code class="code">permissionspolicyforec2.json</code> to the <code class="code">policies</code> directory
      in your local <code class="code">C:</code> drive. You can then use the following commands to create the
      role, attach the policy, create the instance profile, and add the role to the instance
      profile.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="code" copy="false"># Create the role and attach the trust policy that allows EC2 to assume this role.
$ </code><code class="userinput">aws iam create-role --role-name Test-Role-for-EC2 --assume-role-policy-document file://C:\policies\trustpolicyforec2.json</code>

<code class="code" copy="false"># Embed the permissions policy (in this example an inline policy) to the role to specify what it is allowed to do.
$ </code><code class="userinput">aws iam put-role-policy --role-name Test-Role-for-EC2 --policy-name Permissions-Policy-For-Ec2 --policy-document file://C:\policies\permissionspolicyforec2.json</code>

<code class="code" copy="false"># Create the instance profile required by EC2 to contain the role
$ </code><code class="userinput">aws iam create-instance-profile --instance-profile-name EC2-ListBucket-S3</code>

<code class="code" copy="false"># Finally, add the role to the instance profile
$ </code><code class="userinput">aws iam add-role-to-instance-profile --instance-profile-name EC2-ListBucket-S3 --role-name Test-Role-for-EC2</code></code></pre>
    <p>When you launch the EC2 instance, specify the instance profile name in the
        <b>Configure Instance Details</b> page if you use the AWS console. If you
      use the <code class="code">aws ec2 run-instances</code> CLI command, specify the
        <code class="code">--iam-instance-profile</code> parameter.</p>
   
    <h2 id="roles-creatingrole-service-api">Creating a role for a service (AWS
        API)</h2>
     
      <p>Creating a role from the AWS API involves multiple steps. When you use the console to
        create a role, many of the steps are done for you, but with the API you must explicitly
        perform each step yourself. You must create the role and then assign a permissions policy to
        the role. If the service you are working with is Amazon EC2, then you must also create an
        instance profile and add the role to it. Optionally, you can also set the <a href="./access_policies_boundaries.html">permissions boundary</a> for your role.</p>
      <div class="procedure"><h6>To create a role for an AWS service (AWS API)</h6><ol><li>
          <p>Create a role: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreateRole.html">CreateRole</a></p>
          <p>For the role's trust policy, you can specify a file location.</p>
        </li><li>
          <p>Attach a managed permissions policy to the role: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_AttachRolePolicy.html">AttachRolePolicy</a></p>
          <p> or</p>
          <p>Create an inline permissions policy for the role: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_PutRolePolicy.html">PutRolePolicy</a></p>
        </li><li>
          <p>(Optional) Add custom attributes to the user by attaching tags: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_TagRole.html">TagRole</a></p>
          <p>For more information, see <a href="./id_tags_users.html#id_tags_users_procs-cli-api">Managing tags on IAM users (AWS CLI or
                AWS API)</a>.</p>
        </li><li>
          <p>(Optional) Set the <a href="./access_policies_boundaries.html">permissions
              boundary</a> for the role: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_PutRolePermissionsBoundary.html">PutRolePermissionsBoundary</a></p>
          <p>A permissions boundary controls the maximum permissions that a role can have.
            Permissions boundaries are an advanced AWS feature.</p>
        </li></ol></div>
      <p>If you are going to use the role with Amazon EC2 or another AWS service that uses Amazon EC2,
        you must store the role in an instance profile. An instance profile is a container for a
        role. Each instance profile can contain only one role, and that limit cannot be increased.
        If you create the role in the AWS Management Console, the instance profile is created for you with the
        same name as the role. For more information about instance profiles, see <a href="./id_roles_use_switch-role-ec2_instance-profiles.html">Using instance profiles</a>. For information about
        how to launch an Amazon EC2 instance with a role, see <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/UsingIAM.html#UsingIAMrolesWithAmazonEC2Instances">Controlling Access
          to Amazon EC2 Resources</a> in the <em>Amazon EC2 User Guide for Linux Instances</em>. </p>
      <div class="procedure"><h6>To create an instance profile and store the role in it (AWS API)</h6><ol><li>
          <p>Create an instance profile: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreateInstanceProfile.html">CreateInstanceProfile</a></p>
        </li><li>
          <p>Add the role to the instance profile: <a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_AddRoleToInstanceProfile.html">AddRoleToInstanceProfile</a></p>
        </li></ol></div>
     
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./id_roles_create_for-user.html">Creating a role for an IAM user</div><div id="next" class="next-link" accesskey="n" href="./id_roles_create_for-idp.html">Creating a role for identity federation</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_create_for-service.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_create_for-service.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>