<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Cross-account policy evaluation logic - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="reference_policies_evaluation-logic-cross-account" /><meta name="default_state" content="reference_policies_evaluation-logic-cross-account" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" /><meta name="description" content="Learn how JSON policies are evaluated across two accounts to return either Allow or Deny." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Control access to your AWS resources with user identity (authentication) and with policies that define specific permissions (authorization)." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Cross-account policy evaluation logic" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Cross-account policy evaluation logic - AWS Identity and Access Management</title><meta name="pdf" content="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#reference_policies_evaluation-logic-cross-account" /><meta name="github" content="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/reference_policies_evaluation-logic-cross-account.md" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM user,user,IAM group,group,IAM role,role,permission policy,trust policy,policy,access key,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Reference information for AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "IAM JSON policy reference",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Policy evaluation logic",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_evaluation-logic.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Cross-account policy evaluation logic",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_evaluation-logic.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#reference_policies_evaluation-logic-cross-account" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/reference_policies_evaluation-logic-cross-account.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">User Guide</a></div><div id="page-toc-src"><a href="#policy-eval-cross-account">Determining whether a cross-account request is
        allowed</a><a href="#policies_evaluation_example-cross-account">Example cross-account policy
        evaluation</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="reference_policies_evaluation-logic-cross-account">Cross-account policy
      evaluation logic</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>You can allow a principal in one account to access resources in a second account. This is
    called cross-account access. When you allow cross-account access, the account where the
    principal exists is called the <em>trusted</em> account. The account
    where the resource exists is the <em>trusting</em> account. </p><p>To allow cross-account access, you attach a resource-based policy to the resource that you
    want to share. You must also attach an identity-based policy to the identity that acts as the
    principal in the request. The resource-based policy in the trusting account must specify the
    principal of the trusted account that will have access to the resource. You can specify the entire
    account or its IAM users, federated users, IAM roles, or assumed-role sessions. You can also
    specify an AWS service as a principal. For more information, see <a href="./reference_policies_elements_principal.html#Principal_specifying">Specifying a principal</a>. </p><p>The principal's identity-based policy must allow the requested access to the resource in the
    trusting service. You can do this by specifying the ARN of the resource or by allowing access to
    all resources (<code class="code">*</code>).</p><p>In IAM, you can attach a resource-based policy to an IAM role to allow principals in
    other accounts to assume that role. The role's resource-based policy is called a role trust
    policy. After assuming that role, the allowed principals can use the resulting temporary
    credentials to access multiple resources in your account. This access is defined in the role's
    identity-based permissions policy. To learn how allowing cross-account access using
    roles is different from allowing cross-account access using other resource-based policies, see
      <a href="./id_roles_compare-resource-policies.html">How IAM roles differ from resource-based
      policies</a>. </p><div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>Other services can affect the policy evaluation logic. For example, AWS Organizations supports
        <a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scp.html">service control policies</a>
      that can be applied to principals one or more accounts. AWS Resource Access Manager supports <a href="https://docs.aws.amazon.com/ram/latest/userguide/permissions.html">policy fragments</a> that control which actions that
      principals are allowed to perform on resources that are shared with them.</p></div></div>
    <h2 id="policy-eval-cross-account">Determining whether a cross-account request is
        allowed</h2>
    <p>For cross-account requests, the requester in the trusted <code class="code">AccountA</code> must have
      an identity-based policy. That policy must allow them to make a request to the resource in the
      trusting <code class="code">AccountB</code>. Additionally, the resource-based policy in
        <code class="code">AccountB</code> must allow the requester in <code class="code">AccountA</code> to access the
      resource.</p>
    <p>When you make a cross-account request, AWS performs two evaluations. AWS evaluates the
      request in the trusting account and the trusted account. For more information about how a
      request is evaluated within a single account, see <a href="./reference_policies_evaluation-logic.html#policy-eval-denyallow">Determining whether a request is allowed or denied
        within an account</a>. The request is allowed only if both evaluations
      return a decision of <code class="code">Allow</code>.</p>
    <div class="mediaobject">
       
        <img src="/images/IAM/latest/UserGuide/images/policy_cross-account-eval-simple.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;        Cross-account&#xA;          evaluation&#xA;      " style="max-width:100%" />
       
       
    </div>
    <div class="orderedlist">
       
       
       
       
    <ol><li>
        <p>When a principal in one account makes a request to access a resource in another
          account, this is a cross-account request.</p>
      </li><li>
        <p>The requesting principal exists in the trusted account (<code class="code">AccountA</code>). When
          AWS evaluates this account, it checks the identity-based policy and any policies that
          can limit an identity-based policy. For more information, see <a href="./reference_policies_evaluation-logic.html#policy-eval-basics">Evaluating policies within a single account</a>.</p>
      </li><li>
        <p>The requested resource exists in the trusting account (<code class="code">AccountB</code>). When
          AWS evaluates this account, it checks the resource-based policy that is attached to the
          requested resource and any policies that can limit a resource-based policy. For more
          information, see <a href="./reference_policies_evaluation-logic.html#policy-eval-basics">Evaluating policies within a single account</a>.</p>
      </li><li>
        <p>AWS allows the request only if both account policy evaluations allow the
          request.</p>
      </li></ol></div>
   
    <h2 id="policies_evaluation_example-cross-account">Example cross-account policy
        evaluation</h2>
    <p>The following example demonstrates a scenario where a user in one account is granted
      permissions by a resource-based policy in a second account.</p>
    <p>Assume that Carlos is a developer with an IAM user named <code class="code">carlossalazar</code> in
      account 111111111111. He wants to save a file to the <code class="code">Production-logs</code>
      Amazon S3 bucket in account 222222222222. </p>
    <p>Also assume that the following policy is attached to the <code class="code">carlossalazar</code> IAM
      user.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "AllowS3ListRead",
            "Effect": "Allow",
            "Action": "s3:ListAllMyBuckets",
            "Resource": "*"
        },
        <span>{</span>
            "Sid": "AllowS3ProductionObjectActions",
            "Effect": "Allow",
            "Action": "s3:*Object*",
            "Resource": "arn:aws:s3:::Production/*"
        },
        <span>{</span>
            "Sid": "DenyS3Logs",
            "Effect": "Deny",
            "Action": "s3:*",
            "Resource": [
                "arn:aws:s3:::*log*",
                "arn:aws:s3:::*log*/*"
            ]
        }
    ]
}</code></pre>
    <p>The <code class="code">AllowS3ListRead</code> statement in this policy allows Carlos to view a list of
      all of the buckets in Amazon S3. The <code class="code">AllowS3ProductionObjectActions</code> statement allows
      Carlos full access to objects in the <code class="code">Production</code> bucket. The
        <code class="code">DenyS3Logs</code> statement denies Carlos access to any S3 bucket with
        <code class="code">log</code> in its name. It also denies access to all objects in those buckets.</p>
    <p>Additionally, the following resource-based policy (called a bucket policy) is attached to
      the <code class="code">Production</code> bucket in account 222222222222. </p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "s3:GetObject*",
                "s3:PutObject*",
                "s3:ReplicateObject",
                "s3:RestoreObject"
            ],
            "Principal": <span>{</span> "AWS": "arn:aws:iam::111111111111:user/carlossalazar" },
            "Resource": "arn:aws:s3:::Production/*"
        }
    ]
}</code></pre>
    <p>This policy allows the <code class="code">carlossalazar</code> user to access objects in the
        <code class="code">Production</code> bucket. He can create and edit, but not delete the objects in the
      bucket. He can't manage the bucket itself.</p>
    <p>When Carlos makes his request to save a file to the <code class="code">Production-logs</code> bucket,
      AWS determines what policies apply to the request. In this case, the identity-based policy
      attached to the <code class="code">carlossalazar</code> user is the only policy that applies in account
        <code class="code">111111111111</code>. In account <code class="code">222222222222</code>, there
      is no resource-based policy attached to the <code class="code">Production-logs</code> bucket. When AWS
      evaluates account <code class="code">111111111111</code>, it returns a decision of
        <code class="code">Deny</code>. This is because the <code class="code">DenyS3Logs</code> statement in the
      identity-based policy explicitly denies access to any log buckets. For more information about
      how a request is evaluated within a single account, see <a href="./reference_policies_evaluation-logic.html#policy-eval-denyallow">Determining whether a request is allowed or denied
        within an account</a>.</p>
    <p>Because the request is explicitly denied within one of the accounts, the final decision is
      to deny the request.</p>

    <div class="mediaobject">
       
        <img src="/images/IAM/latest/UserGuide/images/policy_cross-account-eval-example.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;        Request to Production-logs bucket&#xA;      " style="max-width:100%" />
       
       
    </div>
    <p>Assume that Carlos then realizes his mistake and tries to save the file to the
        <code class="code">Production</code> bucket. AWS first checks account
        <code class="code">111111111111</code> to determine if the request is allowed. Only the
      identity-based policy applies, and it allows the request. AWS then checks account
        <code class="code">222222222222</code>. Only the resource-based policy attached to the
        <code class="code">Production</code> bucket applies, and it allows the request. Because both accounts
      allow the request, the final decision is to allow the request.</p>

    <div class="mediaobject">
       
        <img src="/images/IAM/latest/UserGuide/images/policy_cross-account-eval-example-correct.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;        Request to Production bucket&#xA;      " style="max-width:100%" />
       
       
    </div>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./reference_policies_evaluation-logic.html">Policy evaluation logic</div><div id="next" class="next-link" accesskey="n" href="./reference_policies_grammar.html">Policy grammar</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>