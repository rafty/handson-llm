<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS JSON policy elements: NotPrincipal - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="reference_policies_elements_notprincipal" /><meta name="default_state" content="reference_policies_elements_notprincipal" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" /><meta name="description" content="Describes the NotPrincipal element of the AWS JSON policy language." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Control access to your AWS resources with user identity (authentication) and with policies that define specific permissions (authorization)." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="AWS JSON policy elements: NotPrincipal" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS JSON policy elements: NotPrincipal - AWS Identity and Access Management</title><meta name="pdf" content="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#reference_policies_elements_notprincipal" /><meta name="github" content="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/reference_policies_elements_notprincipal.md" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM user,user,IAM group,group,IAM role,role,permission policy,trust policy,policy,access key,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Reference information for AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "IAM JSON policy reference",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "IAM JSON policy elements reference",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "AWS JSON policy elements: NotPrincipal",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#reference_policies_elements_notprincipal" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/reference_policies_elements_notprincipal.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">User Guide</a></div><div id="page-toc-src"><a href="#specifying-notprincipal">Specifying NotPrincipal with
        Deny</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="reference_policies_elements_notprincipal">AWS JSON policy elements:
        NotPrincipal</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>You can use the <code class="code">NotPrincipal</code> element to deny access to all principals <b><em>except</em></b> the IAM user, federated user, IAM
    role, AWS account, AWS service, or other principal specified in the <code class="code">NotPrincipal</code> element.</p><p>You can use it in resource-based policies for some AWS services, including VPC endpoints. Resource-based policies are policies that you embed directly in a resource. You cannot use the <code class="code">NotPrincipal</code> element in an IAM identity-based policy nor in an IAM role trust policy.</p><p><code class="code">NotPrincipal</code> must be used with <code class="code">"Effect":"Deny"</code>. Using it with <code class="code">"Effect":"Allow"</code> is not supported. </p><div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>Very few scenarios require the use of <code class="code">NotPrincipal</code>. We recommend that you
      explore other authorization options before you decide to use <code class="code">NotPrincipal</code>. When you use <code class="code">NotPrincipal</code>, troubleshooting the effects of multiple policy types can be difficult.
      We recommend using the <code class="code">aws:PrincipalArn</code> condition key instead. For more
      information, see <a href="./reference_policies_elements_principal.html#principal-anonymous">All principals</a>.
    </p></div></div>
    <h2 id="specifying-notprincipal">Specifying <code class="code">NotPrincipal</code> with
        <code class="code">Deny</code></h2>
    <p>When you use <code class="code">NotPrincipal</code> with <code class="code">Deny</code>, you must also specify the account ARN of
      the not-denied principal. Otherwise, the policy might deny access to the entire account
      containing the principal. Depending on the service that you include in your policy, AWS
      might validate the account first and then the user. If an assumed-role user (someone who is
      using a role) is being evaluated, AWS might validate the account first, then the role, and
      then the assumed-role user. The assumed-role user is identified by the role session name that
      is specified when they assumed the role. Therefore, we strongly recommend that you explicitly
      include the ARN for a user's account, or include both the ARN for a role and the ARN for the
      account containing that role.</p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>As a best practice, you should include the ARNs for the account in your policy. Some
        services require the account ARN, although this is not required in all cases. Any existing
        policies without the required ARN will continue to work, but new policies that include these
        services must meet this requirement. IAM does not track these services, and therefore
        recommends that you always include the account ARN.</p></div></div>
    <p>The following examples show how to use <code class="code">NotPrincipal</code> and <code class="code">"Effect":
        "Deny"</code> in the same policy statement effectively.</p>
    <div class="example"><h6>Example IAM user in the same or a different account</h6><div class="example-contents"><p>In the following example, all principals <em>except</em> the user named Bob
        in AWS account 444455556666 are explicitly denied access to a resource. Note
        that as a best practice, the <code class="code">NotPrincipal</code> element contains the ARN of both the
        user Bob and the AWS account that Bob belongs to
          (<code class="code">arn:aws:iam::444455556666:root</code>). If the
          <code class="code">NotPrincipal</code> element contained only Bob's ARN, the effect of the policy might
        be to explicitly deny access to the AWS account that contains the user Bob. In some cases,
        a user cannot have more permissions than its parent account, so if Bob's account is
        explicitly denied access then Bob might be unable to access the resource.</p><p>This example works as intended when it is part of a policy statement in a resource-based
        policy that is attached to a resource in either the same or a different AWS account (not
        444455556666). This example by itself does not grant access to Bob, it only omits
        Bob from the list of principals that are explicitly denied. To allow Bob access to the
        resource, another policy statement must explicitly allow access using <code class="code">"Effect":
          "Allow"</code>.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [<span>{</span>
        "Effect": "Deny",
        "NotPrincipal": <span>{</span>"AWS": [
            "arn:aws:iam::444455556666:user/Bob",
            "arn:aws:iam::444455556666:root"
        ]},
        "Action": "s3:*",
        "Resource": [
            "arn:aws:s3:::BUCKETNAME",
            "arn:aws:s3:::BUCKETNAME/*"
        ]
    }]
}</code></pre></div></div>
    <div class="example"><h6>Example IAM role in the same or different account</h6><div class="example-contents"><p>In the following example, all principals <em>except</em> the assumed-role
        user named cross-account-audit-app in AWS account 444455556666 are explicitly
        denied access to a resource. As a best practice, the <code class="code">NotPrincipal</code> element
        contains the ARN of the assumed-role user (cross-account-audit-app), the role
        (cross-account-read-only-role), and the AWS account that the role belongs to
        (444455556666). If the <code class="code">NotPrincipal</code> element was missing the ARN of
        the role, the effect of the policy might be to explicitly deny access to the role.
        Similarly, if the <code class="code">NotPrincipal</code> element was missing the ARN of the AWS account
        that the role belongs to, the effect of the policy might be to explicitly deny access to the
        AWS account and all entities in that account. In some cases, assumed-role users cannot
        have more permissions than their parent role, and roles cannot have more permissions than
        their parent AWS account, so when the role or the account is explicitly denied access, the
        assumed role user might be unable to access the resource. </p><p>This example works as intended when it is part of a policy statement in a resource-based
        policy that is attached to a resource in a different AWS account (not
        444455556666). This example by itself does not allow access to the assumed-role
        user cross-account-audit-app, it only omits cross-account-audit-app from the list of
        principals that are explicitly denied. To give cross-account-audit-app access to the
        resource, another policy statement must explicitly allow access using <code class="code">"Effect":
          "Allow"</code>.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [<span>{</span>
        "Effect": "Deny",
        "NotPrincipal": <span>{</span>"AWS": [
            "arn:aws:sts::444455556666:assumed-role/cross-account-read-only-role/cross-account-audit-app",
            "arn:aws:iam::444455556666:role/cross-account-read-only-role",
            "arn:aws:iam::444455556666:root"
        ]},
        "Action": "s3:*",
        "Resource": [
            "arn:aws:s3:::Bucket_AccountAudit",
            "arn:aws:s3:::Bucket_AccountAudit/*"
        ]
    }]
}</code></pre><p>When you specify an assumed-role session in a <code class="code">NotPrincipal</code> element, you
        cannot use a wildcard (*) to mean "all sessions". Principals must always name a specific
        session.</p></div></div>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./reference_policies_elements_principal.html">Principal</div><div id="next" class="next-link" accesskey="n" href="./reference_policies_elements_action.html">Action</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/reference_policies_elements_notprincipal.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>