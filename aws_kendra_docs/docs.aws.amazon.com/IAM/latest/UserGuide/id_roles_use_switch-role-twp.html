<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Switching to an IAM role (Tools for Windows PowerShell) - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="id_roles_use_switch-role-twp" /><meta name="default_state" content="id_roles_use_switch-role-twp" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" /><meta name="description" content="Use the Tools for Windows PowerShell to switch to an IAM role that provides temporary access to resources in an AWS account." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Control access to your AWS resources with user identity (authentication) and with policies that define specific permissions (authorization)." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Switching to an IAM role (Tools for Windows PowerShell)" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Switching to an IAM role (Tools for Windows PowerShell) - AWS Identity and Access Management</title><meta name="pdf" content="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#id_roles_use_switch-role-twp" /><meta name="github" content="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/id_roles_use_switch-role-twp.md" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM user,user,IAM group,group,IAM role,role,permission policy,trust policy,policy,access key,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "IAM Identities (users, user groups, and roles)",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "IAM roles",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Using IAM roles",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Switching to an IAM role (Tools for Windows PowerShell)",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#id_roles_use_switch-role-twp" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/id_roles_use_switch-role-twp.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">User Guide</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="id_roles_use_switch-role-twp">Switching to an IAM role (Tools for Windows PowerShell)</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>A <em>role</em> specifies a set of permissions that you can use to access AWS
    resources that you need. In that sense, it is similar to a <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id.html">user in AWS Identity and Access Management</a> (IAM). When you sign in as a user, you
    get a specific set of permissions. However, you don't sign in to a role, but once signed in you
    can switch to a role. This temporarily sets aside your original user permissions and instead
    gives you the permissions assigned to the role. The role can be in your own account or any other
    AWS account. For more information about roles, their benefits, and how to create and configure
    them, see <a href="./id_roles.html">IAM roles</a>, and <a href="./id_roles_create.html">Creating IAM roles</a>.</p><div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>The permissions of your IAM user and any roles that you switch to are not cumulative.
      Only one set of permissions is active at a time. When you switch to a role, you temporarily
      give up your user permissions and work with the permissions that are assigned to the role.
      When you exit the role, your user permissions are automatically restored.</p></div></div><p>This section describes how to switch roles when you work at the command line with the
    AWS Tools for Windows PowerShell.</p><p>Imagine that you have an account in the development environment and you occasionally need to
    work with the production environment at the command line using the <a href="http://aws.amazon.com/powershell/" rel="noopener noreferrer" target="_blank"><span>Tools for Windows PowerShell</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. You already have one access key
    credential set available to you. These can be an access key pair assigned to your standard IAM
    user. Or, if you signed-in as a federated user, they can be the access key pair for the role
    initially assigned to you. You can use these credentials to run the <code class="code">Use-STSRole</code>
    cmdlet that passes the ARN of a new role as a parameter. The command returns temporary security
    credentials for the requested role. You can then use those credentials in subsequent PowerShell
    commands with the role's permissions to access resources in production. While you use the role,
    you cannot use your user permissions in the Development account because only one set of
    permissions is in effect at a time.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>For security purposes, administrators can <a href="./cloudtrail-integration.html#cloudtrail-integration_signin-tempcreds">review AWS CloudTrail logs</a> to learn who
      performed an action in AWS. Your administrator might require that you specify a source
      identity or a role session name when you assume the role. For more information, see <a href="./reference_policies_iam-condition-keys.html#ck_sourceidentity">sts:SourceIdentity</a> and <a href="./reference_policies_iam-condition-keys.html#ck_rolesessionname">sts:RoleSessionName</a>.</p></div></div><p>Note that all access keys and tokens are examples only and cannot be used as shown. Replace
    with the appropriate values from your live environment.</p><div class="procedure"><h6>To switch to a role (Tools for Windows PowerShell)</h6><ol><li>
      <p>Open a PowerShell command prompt and configure the default profile to use the access key
        from your current IAM user or from your federated role. If you have previously used the
        Tools for Windows PowerShell, then this is likely already done. Note that you can switch roles only if you are
        signed in as an IAM user, not the AWS account root user.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="powershell "><code class="code" copy="false">PS C:\&gt; </code><code class="userinput">Set-AWSCredentials -AccessKey <code class="code" copy="true"><code class="replaceable">AKIAIOSFODNN7EXAMPLE</code></code> -SecretKey <code class="code" copy="true"><code class="replaceable">wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY</code></code> -StoreAs <code class="replaceable">MyMainUserProfile</code></code>
<code class="code" copy="false">PS C:\&gt; </code><code class="userinput">Initialize-AWSDefaults -ProfileName <code class="replaceable">MyMainUserProfile</code> -Region <code class="replaceable">us-east-2</code></code></code></pre>
      <p>For more information, see <a href="https://docs.aws.amazon.com/powershell/latest/userguide/specifying-your-aws-credentials.html">Using AWS Credentials</a> in the <em>AWS Tools for Windows PowerShell User Guide</em>.</p>
    </li><li>
      <p>To retrieve credentials for the new role, run the following command to switch to the
            <code class="code"><code class="replaceable">RoleName</code></code> role in the 123456789012
        account. You get the role ARN from the account administrator who created the role. The
        command requires that you provide a session name as well. You can choose any text for that.
        The following command requests the credentials and then captures the
          <code class="code">Credentials</code> property object from the returned results object and stores it in
        the <code class="code">$Creds</code> variable.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="powershell "><code class="code" copy="false">PS C:\&gt; </code><code class="userinput">$Creds = (Use-STSRole -RoleArn "arn:aws:iam::<code class="replaceable">123456789012</code>:role/<code class="replaceable">RoleName</code>" -RoleSessionName "<code class="replaceable">MyRoleSessionName</code>").Credentials</code></code></pre>
      <p><code class="code">$Creds</code> is an object that now contains the <code class="code">AccessKeyId</code>,
          <code class="code">SecretAccessKey</code>, and <code class="code">SessionToken</code> elements that you need in the
        following steps. The following sample commands illustrate typical values:</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="powershell "><code class="code" copy="false">PS C:\&gt; </code><code class="userinput">$Creds.AccessKeyId</code>
AKIAIOSFODNN7EXAMPLE

<code class="code" copy="false">PS C:\&gt; </code><code class="userinput">$Creds.SecretAccessKey</code>
wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

<code class="code" copy="false">PS C:\&gt; </code><code class="userinput">$Creds.SessionToken</code>
AQoDYXdzEGcaEXAMPLE2gsYULo+Im5ZEXAMPLEeYjs1M2FUIgIJx9tQqNMBEXAMPLECvSRyh0FW7jEXAMPLEW+vE/7s1HRp
XviG7b+qYf4nD00EXAMPLEmj4wxS04L/uZEXAMPLECihzFB5lTYLto9dyBgSDyEXAMPLE9/g7QRUhZp4bqbEXAMPLENwGPy
Oj59pFA4lNKCIkVgkREXAMPLEjlzxQ7y52gekeVEXAMPLEDiB9ST3UuysgsKdEXAMPLE1TVastU1A0SKFEXAMPLEiywCC/C
s8EXAMPLEpZgOs+6hz4AP4KEXAMPLERbASP+4eZScEXAMPLEsnf87eNhyDHq6ikBQ==

<code class="code" copy="false">PS C:\&gt; </code><code class="userinput">$Creds.Expiration</code>
Thursday, June 18, 2018 2:28:31 PM</code></pre>
    </li><li>
      <p>To use these credentials for any subsequent command, include them with the
          <code class="code">-Credential</code> parameter. For example, the following command uses the
        credentials from the role and works only if the role is granted the
          <code class="code">iam:ListRoles</code> permission and can therefore run the <code class="code">Get-IAMRoles</code>
        cmdlet:</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="powershell ">
        <code class="code" copy="false">PS C:\&gt; </code><code class="userinput">get-iamroles -Credential $Creds</code>
      </code></pre>
    </li><li>
      <p>To return to your original credentials, simply stop using the <code class="code">-Credentials
          $Creds</code> parameter and allow PowerShell to revert to the credentials that are stored
        in the default profile.</p>
    </li></ol></div><awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./id_roles_use_switch-role-cli.html">Switching roles (AWS CLI)</div><div id="next" class="next-link" accesskey="n" href="./id_roles_use_switch-role-api.html">Switching roles (AWS API)</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_use_switch-role-twp.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>