<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Troubleshooting IAM roles - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="troubleshoot_roles" /><meta name="default_state" content="troubleshoot_roles" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/troubleshoot_roles.html" /><meta name="description" content="Diagnose and fix issues that you might encounter when working with IAM roles." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Control access to your AWS resources with user identity (authentication) and with policies that define specific permissions (authorization)." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/troubleshoot_roles.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/troubleshoot_roles.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Troubleshooting IAM roles" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Troubleshooting IAM roles - AWS Identity and Access Management</title><meta name="pdf" content="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#troubleshoot_roles" /><meta name="github" content="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/troubleshoot_roles.md" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/troubleshoot_roles.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/troubleshoot_roles.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/troubleshoot_roles.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM user,user,IAM group,group,IAM role,role,permission policy,trust policy,policy,access key,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Troubleshooting IAM",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/troubleshoot.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Troubleshooting IAM roles",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/troubleshoot.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#troubleshoot_roles" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/troubleshoot_roles.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">User Guide</a></div><div id="page-toc-src"><a href="#troubleshoot_roles_cant-assume-role">I can't assume a role</a><a href="#troubleshoot_roles_new-role-appeared">A new role appeared in my AWS
        account</a><a href="#troubleshoot_roles_cant-edit-delete-role">I can't edit or delete a role in my
        AWS account</a><a href="#troubleshoot_roles_not-auth-passrole">I'm not authorized to perform:
        iam:PassRole</a><a href="#troubleshoot_roles_cant-set-session">Why can't I assume a role with a 12-hour
        session? (AWS CLI, AWS API)</a><a href="#troubleshoot_roles_cant-switch-role-console">I receive an error when I try to
        switch roles in the IAM console </a><a href="#troubleshoot_roles_session-policy">My role has a policy that allows me to
        perform an action, but I get "access denied"</a><a href="#troubleshoot_serviceroles_edited-policy">The service did not create the
        role's default policy version</a><a href="#troubleshoot_serviceroles_console-use-case">There is no use case for a
        service role in the console</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="troubleshoot_roles">Troubleshooting IAM roles</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Use the information here to help you diagnose and fix common issues that you might encounter
    when working with IAM roles.</p><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#troubleshoot_roles_cant-assume-role">I can't assume a role</a></li><li><a href="#troubleshoot_roles_new-role-appeared">A new role appeared in my AWS
        account</a></li><li><a href="#troubleshoot_roles_cant-edit-delete-role">I can't edit or delete a role in my
        AWS account</a></li><li><a href="#troubleshoot_roles_not-auth-passrole">I'm not authorized to perform:
        iam:PassRole</a></li><li><a href="#troubleshoot_roles_cant-set-session">Why can't I assume a role with a 12-hour
        session? (AWS CLI, AWS API)</a></li><li><a href="#troubleshoot_roles_cant-switch-role-console">I receive an error when I try to
        switch roles in the IAM console </a></li><li><a href="#troubleshoot_roles_session-policy">My role has a policy that allows me to
        perform an action, but I get "access denied"</a></li><li><a href="#troubleshoot_serviceroles_edited-policy">The service did not create the
        role's default policy version</a></li><li><a href="#troubleshoot_serviceroles_console-use-case">There is no use case for a
        service role in the console</a></li></ul></div>
    <h2 id="troubleshoot_roles_cant-assume-role">I can't assume a role</h2>
    <p>Check the following:</p>
    <div class="itemizedlist">
       
       
       
       
       
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>To allow users to assume the current role again within a role session, specify the
          role ARN or AWS account ARN as a principal in the role trust policy. AWS services that
          provide compute resources such as Amazon EC2, Amazon ECS, Amazon EKS, and Lambda provide temporary
          credentials and automatically rotate these credentials. This ensures that you always have
          a valid set of credentials. For these services, it's not necessary to assume the current
          role again to obtain temporary credentials. However, if you intend to pass <a href="./id_session-tags.html">session tags</a> or a <a href="./access_policies.html#policies_session">session policy</a>, you need to assume the current role again. To learn how to
          modify a role trust policy to add the principal role ARN or AWS account ARN, see <a href="./roles-managingrole-editing-console.html#roles-managingrole_edit-trust-policy">Modifying a role trust policy
        (console)</a>.</p>
      </li><li class="listitem">
        <p>When you assume a role using the AWS Management Console, make sure to use the exact name of your
          role. Role names are case sensitive when you assume a role.</p>
      </li><li class="listitem">
        <p>When you assume a role using AWS STS API or AWS CLI, make sure to use the exact name of
          your role in the ARN. Role names are case sensitive when you assume a role. </p>
      </li><li class="listitem">
        <p>Verify that your IAM policy grants you permission to call
            <code class="code">sts:AssumeRole</code> for the role that you want to assume. The
            <code class="code">Action</code> element of your IAM policy must allow you to call the
            <code class="code">AssumeRole</code> action. In addition, the <code class="code">Resource</code> element of your
          IAM policy must specify the role that you want to assume. For example, the
            <code class="code">Resource</code> element can specify a role by its Amazon Resource Name (ARN) or by
          a wildcard (*). For example, at least one policy applicable to you must grant permissions
          similar to the following:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">    "Effect": "Allow",
    "Action": "sts:AssumeRole",
    "Resource": "arn:aws:iam::<code class="replaceable">account_id_number</code>:role/<code class="replaceable">role-name-you-want-to-assume</code>"</code></pre>
      </li><li class="listitem">
        <p>Verify that your IAM identity is tagged with any tags that the IAM policy
          requires. For example, in the following policy permissions, the <code class="code">Condition</code>
          element requires that you, as the principal requesting to assume the role, must have a
          specific tag. You must be tagged with <code class="code">department = HR</code> or <code class="code">department =
            CS</code>. Otherwise, you cannot assume the role. To learn about tagging IAM users and
          roles, see <a href="./id_tags.html">Tagging IAM resources</a>.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="">    "Effect": "Allow",
    "Action": "sts:AssumeRole",
    "Resource": "*",
    "Condition": <span>{</span>"StringEquals": <span>{</span>"aws:PrincipalTag/department": [
            "HR",
            "CS"
        ]}}</code></pre>
      </li><li class="listitem">
        <p>Verify that you meet all the conditions that are specified in the role's trust policy.
          A <code class="code">Condition</code> can specify an expiration date, an external ID, or that a request
          must come only from specific IP addresses. Consider the following example: If the current
          date is any time after the specified date, then the policy never matches and cannot grant
          you the permission to assume the role.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">    "Effect": "Allow",
    "Action": "sts:AssumeRole",
    "Resource": "arn:aws:iam::<code class="replaceable">account_id_number</code>:role/<code class="replaceable">role-name-you-want-to-assume</code>"
    "Condition": <span>{</span>
        "DateLessThan" : <span>{</span>
            "aws:CurrentTime" : "<code class="replaceable">2016-05-01T12:00:00Z</code>"
        }
    } </code></pre>
      </li><li class="listitem">
        <p>Verify that the AWS account from which you are calling <code class="code">AssumeRole</code> is a
          trusted entity for the role that you are assuming. Trusted entities are defined as a
            <code class="code">Principal</code> in a role's trust policy. The following example is a trust policy
          that is attached to the role that you want to assume. In this example, the account ID with
          the IAM user that you signed in with must be 123456789012. If your account
          number is not listed in the <code class="code">Principal</code> element of the role's trust policy,
          then you cannot assume the role. It does not matter what permissions are granted to you in
          access policies. Note that the example policy limits permissions to actions that occur
          between July 1, 2017 and December 31, 2017 (UTC), inclusive. If you log in before or after
          those dates, then the policy does not match, and you cannot assume the role. </p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">    "Effect": "Allow",
    "Principal": <span>{</span> "AWS": "arn:aws:iam::<code class="replaceable">123456789012</code>:root" },
    "Action": "sts:AssumeRole",
    "Condition": <span>{</span>
      "DateGreaterThan": <span>{</span>"aws:CurrentTime": "2017-07-01T00:00:00Z"},
      "DateLessThan": <span>{</span>"aws:CurrentTime": "2017-12-31T23:59:59Z"}
    }
</code></pre>
      </li><li class="listitem">
        <p><span class="topcom">Source Identity</span> – Administrators can configure
          roles to require identities to pass a custom string that identifies the person or
          application that is performing actions in AWS, called <em>source
            identity</em>. Verify whether the role being assumed requires that a source
          identity is set. For more information about source identity, see <a href="./id_credentials_temp_control-access_monitor.html">Monitor and control actions
            taken with assumed roles</a>.</p>
      </li></ul></div>
   
    <h2 id="troubleshoot_roles_new-role-appeared">A new role appeared in my AWS
        account</h2>
    <p>Some AWS services require that you use a unique type of service role that is linked
      directly to the service. This <a href="./id_roles_terms-and-concepts.html#iam-term-service-linked-role">service-linked
        role</a> is predefined by the service and includes all the permissions that the service
      requires. This makes setting up a service easier because you don't have to manually add the
      necessary permissions. For general information about service-linked roles, see <a href="./using-service-linked-roles.html">Using service-linked roles</a>.</p>
    <p>You might already be using a service when it begins supporting service-linked roles. If
      so, you might receive an email telling you about a new role in your account. This role
      includes all the permissions that the service needs to perform actions on your behalf. You
      don't need to take any action to support this role. However, you should not delete the role
      from your account. Doing so could remove permissions that the service needs to access AWS
      resources. You can view the service-linked roles in your account by going to the IAM
        <b>Roles</b> page of the IAM console. Service-linked roles appear with
        <b>(Service-linked role)</b> in the <b>Trusted entities</b>
      column of the table.</p>
    <p>For information about which services support service-linked roles, see <a href="./reference_aws-services-that-work-with-iam.html">AWS services that work with
      IAM</a> and look for the services that
      have <b>Yes </b>in the <b>Service-Linked
        Role</b> column. For information about using the service-linked role for a service,
      choose the <b>Yes</b> link.</p>
   
    <h2 id="troubleshoot_roles_cant-edit-delete-role">I can't edit or delete a role in my
        AWS account</h2>
    <p>You cannot delete or edit the permissions for a <a href="./id_roles_terms-and-concepts.html#iam-term-service-linked-role">service-linked role</a> in IAM. These roles
      include predefined trusts and permissions that are required by the service in order to perform
      actions on your behalf. You can use the IAM console, AWS CLI, or API to edit only the
      description of a service-linked role. You can view the service-linked roles in your account by
      going to the IAM <b>Roles</b> page in the console. Service-linked roles appear
      with <b>(Service-linked role)</b> in the <b>Trusted entities</b>
      column of the table. A banner on the role's <b>Summary</b> page also indicates
      that the role is a service-linked role. You can manage and delete these roles only through the
      linked service, if that service supports the action. Be careful when modifying or deleting a
      service-linked role because doing so could remove permissions that the service needs to access
      AWS resources. </p>
    <p>For information about which services support service-linked roles, see <a href="./reference_aws-services-that-work-with-iam.html">AWS services that work with
      IAM</a> and look for the services that
      have <b>Yes </b>in the <b>Service-Linked
        Role</b> column. </p>
   
    <h2 id="troubleshoot_roles_not-auth-passrole">I'm not authorized to perform:
        iam:PassRole</h2>
    <p>When you create a service-linked role, you must have permission to pass that role to the
      service. Some services automatically create a service-linked role in your account when you
      perform an action in that service. For example, Amazon EC2 Auto Scaling creates the
        <code class="code">AWSServiceRoleForAutoScaling</code> service-linked role for you the first time that
      you create an Auto Scaling group. If you try to create an Auto Scaling group without the
        <code class="code">PassRole</code> permission, you receive the following error:</p>
    <p><code class="code">ClientError: An error occurred (AccessDenied) when calling the PutLifecycleHook
        operation: User: arn:aws:sts::111122223333:assumed-role/Testrole/Diego is not authorized to
        perform: iam:PassRole on resource:
        arn:aws:iam::111122223333:role/aws-service-role/autoscaling.amazonaws.com/AWSServiceRoleForAutoScaling</code></p>
    <p>To fix this error, ask your administrator to add the <code class="code">iam:PassRole</code> permission
      for you.</p>
    <p>To learn which services support service-linked roles, see <a href="./reference_aws-services-that-work-with-iam.html">AWS services that work with
      IAM</a>. To learn whether a service
      automatically creates a service-linked role for you, choose the <b>Yes</b> link
      to view the service-linked role documentation for the service.</p>
   
    <h2 id="troubleshoot_roles_cant-set-session">Why can't I assume a role with a 12-hour
        session? (AWS CLI, AWS API)</h2>
    <p>When you use the AWS STS <code class="code">AssumeRole*</code> API or <code class="code">assume-role*</code> CLI
      operations to assume a role, you can specify a value for the <code class="code">DurationSeconds</code>
      parameter. You can specify a value from 900 seconds (15 minutes) up to the <b>Maximum
        session duration</b> setting for the role. If you specify a value higher than this
      setting, the operation fails. This setting can have a maximum value of 12 hours. For example,
      if you specify a session duration of 12 hours, but your administrator set the maximum session
      duration to 6 hours, your operation fails. To learn how to view the maximum value for your
      role, see <a href="./id_roles_use.html#id_roles_use_view-role-max-session">View the maximum session duration setting
        for a role</a>. </p>
    <p>If you use <a href="./id_roles_terms-and-concepts.html#iam-term-role-chaining">role
          chaining</a> (using a role to assume a second role), your session is limited
      to a maximum of one hour. If you then use the <code class="code">DurationSeconds</code> parameter to
      provide a value greater than one hour, the operation fails. </p>
   
    <h2 id="troubleshoot_roles_cant-switch-role-console">I receive an error when I try to
        switch roles in the IAM console </h2>
    <p>The information you enter on the <b>Switch Role</b> page must match the
      information for the role. Otherwise, the operation fails and you receive the following
      error:</p>
    <p><code class="code">Invalid information in one or more fields. Check your information or contact your
        administrator.</code></p>
    <p>If you receive this error, confirm that the following information is correct:</p>
    <div class="itemizedlist">
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p><b>Account ID or alias</b> – The AWS account ID is
          a 12-digit number. Your account might have an alias, which is a friendly identifier such
          as your company name that can be used instead of your AWS account ID. You can use either
          the account ID or the alias in this field.</p>
      </li><li class="listitem">
        <p><b>Role name</b> – Role names are case sensitive. The
          account ID and role name must match what is configured for the role.</p>
      </li></ul></div>
    <p>If you continue to receive an error message, contact your administrator to verify the
      previous information. The role trust policy or the IAM user policy might limit your access.
      Your administrator can verify the permissions for these policies.</p>
   
    <h2 id="troubleshoot_roles_session-policy">My role has a policy that allows me to
        perform an action, but I get "access denied"</h2>
    <p>Your role session might be limited by session policies. When you <a href="./id_credentials_temp_request.html">request temporary security credentials</a>
      programmatically using AWS STS, you can optionally pass inline or managed <a href="./access_policies.html#policies_session">session policies</a>. Session policies are advanced policies
      that you pass as a parameter when you programmatically create a temporary credential session
      for a role. You can pass a single JSON inline session policy document using the
        <code class="code">Policy</code> parameter. You can use the <code class="code">PolicyArns</code> parameter to specify
      up to 10 managed session policies. The resulting session's permissions are the intersection of
      the role's identity-based policies and the session policies. Alternatively, if your
      administrator or a custom program provides you with temporary credentials, they might have
      included a session policy to limit your access.</p>
   
    <h2 id="troubleshoot_serviceroles_edited-policy">The service did not create the
        role's default policy version</h2>
    <p>A service role is a role that a service assumes to perform actions in your account on your
      behalf. When you set up some AWS service environments, you must define a role for the
      service to assume. In some cases, the service creates the service role and its policy in IAM
      for you. Although you can modify or delete the service role and its policy from within IAM,
      AWS does not recommend this. The role and policy are intended for use only by that service.
      If you edit the policy and set up another environment, when the service tries to use the same
      role and policy, the operation can fail.</p>
    <p>For example, when you use AWS CodeBuild for the first time, the service creates a role named
        <code class="code">codebuild-RWBCore-service-role</code>. That service role uses the policy named
        <code class="code">codebuild-RWBCore-managed-policy</code>. If you edit the policy, it creates a new
      version and saves that version as the default version. If you perform a subsequent operation
      in AWS CodeBuild, the service might try to update the policy. If it does, you receive the
      following error:</p>
    <p><code class="code">codebuild.amazon.com did not create the default version (V2) of the
      codebuild-RWBCore-managed-policy policy that is attached to the codebuild-RWBCore-service-role
      role. To continue, detach the policy from any other identities and then delete the policy and
      the role.</code></p>
    <p>If you receive this error, you must make changes in IAM before you can continue with
      your service operation. First, set the default policy version to V1 and try the operation
      again. If V1 was previously deleted, or if choosing V1 doesn't work, then clean up and delete
      the existing policy and role.</p>
    <p>For more information on editing managed policies, see <a href="./access_policies_manage-edit.html#edit-managed-policy-console">Editing customer managed policies
        (console)</a>. For
      more information about policy versions, see <a href="./access_policies_managed-versioning.html">Versioning IAM policies</a>. </p>
    <div class="procedure"><h6>To delete a service role and its policy</h6><ol><li><p>Sign in to the AWS Management Console and open the IAM console at <a href="https://console.aws.amazon.com/iam/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/iam/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
        <p>In the navigation pane, choose <b>Policies</b>.</p>
      </li><li>
        <p>In the list of policies, choose the name of the policy that you want to delete.</p>
      </li><li>
        <p>Choose the
            <b>Entities
            attached</b> tab to view which IAM users, groups, or roles
          use this policy. If any of these identities use the policy, complete the following
          tasks:</p>
        <ol><li>
            <p>Create a new managed policy with the necessary permissions. To ensure that the
              identities have the same permissions before and after your actions, copy the JSON
              policy document from the existing policy. Then create the new managed policy and paste
              the JSON document as described in <a href="./access_policies_create-console.html#access_policies_create-json-editor">Creating Policies using the JSON editor</a>.</p>
          </li><li>
            <p>For each affected identity, attach the new policy and then detach the old one. For
              more information, see <a href="./access_policies_manage-attach-detach.html">Adding and removing IAM identity
      permissions</a>.</p>
          </li></ol>
      </li><li>
        <p>In the navigation pane, choose <b>Roles</b>.</p>
      </li><li>
        <p>In the list of roles, choose the name of the role that you want to delete.</p>
      </li><li>
        <p>Choose the <b>Trust relationships</b> tab to view which entities can
          assume the role. If any entity other than the service is listed, complete the following
          tasks:</p>
        <ol><li>
            <p><a href="./id_roles_create_for-user.html#roles-creatingrole-user-console">Create a new role</a> that
              trusts those entities.</p>
          </li><li>
            <p>The policy that you created in the previous step. If you skipped that step, create
              the new managed policy now.</p>
          </li><li>
            <p>Notify anyone who was assuming the role that they can no longer do so. Provide
              them with information about how to assume the new role and have the same
              permissions.</p>
          </li></ol>
      </li><li>
        <p><a href="./access_policies_manage-delete.html#delete-managed-policy">Delete the policy</a>.</p>
      </li><li>
        <p><a href="./id_roles_manage_delete.html#roles-managingrole-deleting-console">Delete the role</a>.</p>
      </li></ol></div>
   
    <h2 id="troubleshoot_serviceroles_console-use-case">There is no use case for a
        service role in the console</h2>
    <p>Some services require that you manually create a service role to grant the service
      permissions to perform actions on your behalf. If the service is not listed in the IAM
      console, you must manually list the service as the trusted principal. If the documentation for
      the service or feature that you are using does not include instructions for listing the
      service as the trusted principal, provide feedback for the page.</p>
    <p>To manually create a service role, you must know the <a href="./reference_policies_elements_principal.html#principal-services">service principal</a> for the service that will assume the role. A service principal is
      an identifier that is used to grant permissions to a service. The service principal is defined
      by the service. </p>
    <p>You can find the service principal for some services by checking the following:</p>
    <div class="orderedlist">
       
       
       
       
    <ol><li>
        <p>Open <a href="./reference_aws-services-that-work-with-iam.html">AWS services that work with
      IAM</a>.</p>
      </li><li>
        <p>Check whether the service has <b>Yes</b> in the <b>Service-linked
            roles</b> column.</p>
      </li><li>
        <p>Choose the <b>Yes</b> link to view the service-linked role documentation
          for that service.</p>
      </li><li>
        <p>Find the Service-linked role permissions section for that service to view the <a href="./reference_policies_elements_principal.html#principal-services">service principal</a>.</p>
      </li></ol></div>
    <p>You can manually create a service role using <a href="./id_roles_create_for-service.html#roles-creatingrole-service-cli">AWS CLI commands</a> or <a href="./id_roles_create_for-service.html#roles-creatingrole-service-api">AWS API operations</a>. To manually create a
      service role using the IAM console, complete the following tasks:</p>
    <div class="orderedlist">
       
       
       
       
    <ol><li>
        <p>Create an IAM role using your account ID. Do not attach a policy or grant any
          permissions. For details, see <a href="./id_roles_create_for-user.html">Creating a role to delegate permissions to an IAM
      user</a>.</p>
      </li><li>
        <p>Open the role and edit the trust relationship. Instead of trusting the account, the
          role must trust the service. For example, update the following <code class="code">Principal</code>
          element:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">"Principal": <span>{</span> "AWS": "arn:aws:iam::<code class="replaceable">123456789012</code>:root" }</code></pre>
        <p>Change the principal to the value for your service, such as IAM.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">"Principal": <span>{</span> "Service": "<code class="replaceable">iam</code>.amazonaws.com" }</code></pre>
      </li><li>
        <p>Add the permissions that the service requires by attaching permissions policies to the
          role.</p>
      </li><li>
        <p>Return to the service that requires the permissions and use the documented method to
          notify the service about the new service role.</p>
      </li></ol></div>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./troubleshoot_mfa-fido.html">FIDO security keys</div><div id="next" class="next-link" accesskey="n" href="./troubleshoot_iam-ec2.html">IAM and Amazon EC2</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/troubleshoot_roles.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/troubleshoot_roles.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>