<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>How to use an external ID when granting access to your AWS resources to a third party - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="id_roles_create_for-user_externalid" /><meta name="default_state" content="id_roles_create_for-user_externalid" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" /><meta name="description" content="Add an external ID to an IAM policy in order to add security for delegating AWS access to third parties." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Control access to your AWS resources with user identity (authentication) and with policies that define specific permissions (authorization)." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="How to use an external ID when granting access to your AWS resources to a third party" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>How to use an external ID when granting access to your AWS resources to a third party - AWS Identity and Access Management</title><meta name="pdf" content="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#id_roles_create_for-user_externalid" /><meta name="github" content="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/id_roles_create_for-user_externalid.md" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM user,user,IAM group,group,IAM role,role,permission policy,trust policy,policy,access key,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "IAM Identities (users, user groups, and roles)",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "IAM roles",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Common scenarios for roles: Users, applications, and services",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_common-scenarios.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Providing access to AWS accounts owned by third parties",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_common-scenarios_third-party.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "How to use an external ID when granting access to your AWS resources to a third party",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_common-scenarios_third-party.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#id_roles_create_for-user_externalid" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/id_roles_create_for-user_externalid.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">User Guide</a></div><div id="page-toc-src"><a href="#external-id-purpose">Why use an external ID?</a><a href="#external-id-use">When should I use an external ID?</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="id_roles_create_for-user_externalid">How to use an external ID when granting
      access to your AWS resources to a third party</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>At times, you need to give a third party access to your AWS resources (delegate access).
    One important aspect of this scenario is the <em>External ID</em>, optional
    information that you can use in an IAM role trust policy to designate who can assume the
    role.</p><div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>AWS does not treat the external ID as a secret. After you create a secret like an access
      key pair or a password in AWS, you cannot view them again. The external ID for a role can be
      seen by anyone with permission to view the role. </p></div></div><p>In a multi-tenant environment where you support multiple customers with different AWS
    accounts, we recommend using one external ID per AWS account. This ID should be a random
    string generated by the third party.</p><p>To require that the third party provides an external ID when assuming a role, update the
    role's trust policy with the external ID of your choice. </p><p>To provide an external ID when you assume a role, use the AWS CLI or AWS API to assume that
    role. For more information, see the STS <a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html">AssumeRole</a> API operation, or the STS <a href="https://docs.aws.amazon.com/cli/latest/reference/sts/assume-role.html">assume-role</a> CLI
    operation.</p><p>For example, let's say that you decide to hire a third-party company called Example Corp to
    monitor your AWS account and help optimize costs. In order to track your daily spending,
    Example Corp needs to access your AWS resources. Example Corp also monitors many other AWS
    accounts for other customers.</p><p>Do not give Example Corp access to an IAM user and its long-term credentials in your AWS
    account. Instead, use an IAM role and its temporary security credentials. An IAM role
    provides a mechanism to allow a third party to access your AWS resources without needing to
    share long-term credentials (such as an IAM user access key).</p><p>You can use an IAM role to establish a trusted relationship between your AWS account and
    the Example Corp account. After this relationship is established, a member of the Example Corp
    account can call the AWS Security Token Service <a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html">AssumeRole</a>
    API to obtain temporary security credentials. The Example Corp members can then use the
    credentials to access AWS resources in your account. </p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>For more information about the AssumeRole and other AWS API operations that you can call
      to obtain temporary security credentials, see <a href="./id_credentials_temp_request.html">Requesting temporary security credentials</a>.</p></div></div><p>Here's a more detailed breakdown of this scenario:</p><div class="orderedlist">
     
     
     
     
     
  <ol><li>
      <p>You hire Example Corp, so they create a unique customer identifier for you. They provide
        you with this unique customer ID and their AWS account number. You need this information
        to create an IAM role in the next step. </p>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Example Corp can use any string value they want for the ExternalId, as long as it is
          unique for each customer. It can be a customer account number or even a random string of
          characters, as long as no two customers have the same value. It is not intended to be a
          'secret'. Example Corp must provide the ExternalId value to each customer. What is crucial
          is that it must be generated by Example Corp and <b><em>not</em></b> their customers to ensure each external ID is unique.</p></div></div>
    </li><li>
      <p>You sign in to AWS and create an IAM role that gives Example Corp access to your
        resources. Like any IAM role, the role has two policies, a permission policy and a trust
        policy. The role's trust policy specifies who can assume the role. In our sample scenario,
        the policy specifies the AWS account number of Example Corp as the <code class="code">Principal</code>.
        This allows identities from that account to assume the role. In addition, you add a
            <code class="code"><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements.html#Condition">Condition</a></code> element to the trust policy. This <code class="code">Condition</code> tests
        the <code class="code">ExternalId</code> context key to ensure that it matches the unique customer ID
        from Example Corp. For example:</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">    "Principal": <span>{</span>"AWS": "<code class="replaceable">Example Corp's AWS account ID</code>"},
    "Condition": <span>{</span>"StringEquals": <span>{</span>"sts:ExternalId": "<code class="replaceable">Unique ID Assigned by Example Corp</code>"}}</code></pre>
    </li><li>
      <p>The permission policy for the role specifies what the role allows someone to do. For
        example, you could specify that the role allows someone to manage only your Amazon EC2 and Amazon RDS
        resources but not your IAM users or groups. In our sample scenario, you use the permission
        policy to give Example Corp read-only access to all of the resources in your account.</p>
    </li><li>
      <p>After you create the role, you provide the Amazon Resource Name (ARN) of the role to
        Example Corp.</p>
    </li><li>
      <p>When Example Corp needs to access your AWS resources, someone from the company calls
        the AWS <code class="code">sts:AssumeRole</code> API. The call includes the ARN of the role to assume
        and the ExternalId parameter that corresponds to their customer ID.</p>
    </li></ol></div><p>If the request comes from someone using Example Corp's AWS account, and if the role ARN
    and the external ID are correct, the request succeeds. It then provides temporary security
    credentials that Example Corp can use to access the AWS resources that your role
    allows.</p><p>In other words, when a role policy includes an external ID, anyone who wants to assume the
    role must be a principal in the role and must include the correct external ID.</p>
    <h2 id="external-id-purpose">Why use an external ID?</h2>

    <p>In abstract terms, the external ID allows the user that is assuming the role to assert the
      circumstances in which they are operating. It also provides a way for the account owner to
      permit the role to be assumed only under specific circumstances. The primary function of the
      external ID is to address and prevent <a href="./confused-deputy.html">The confused deputy problem</a>.</p>
   
    <h2 id="external-id-use">When should I use an external ID?</h2>

    <p>Use an external ID in the following situations:</p>
    <div class="itemizedlist">
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>You are an AWS account owner and you have configured a role for a third party that
          accesses other AWS accounts in addition to yours. You should ask the third party for an
          external ID that it includes when it assumes your role. Then you check for that external
          ID in your role's trust policy. Doing so ensures that the external party can assume your
          role only when it is acting on your behalf.</p>
      </li><li class="listitem">
        <p>You are in the position of assuming roles on behalf of different customers like
          Example Corp in our previous scenario. You should assign a unique external ID to each
          customer and instruct them to add the external ID to their role's trust policy. You must
          then ensure that you always include the correct external ID in your requests to assume
          roles.</p>
        <p>You probably already have a unique identifier for each of your customers, and this
          unique ID is sufficient for use as an external ID. The external ID is not a special value
          that you need to create explicitly, or track separately, just for this purpose. </p>
        <p>You should always specify the external ID in your <code class="code">AssumeRole</code> API calls.
          In addition when a customer gives you a role ARN, test whether you can assume the role
          both with and without the correct external ID. If you can assume the role without the
          correct external ID, don't store the customer's role ARN in your system. Wait until your
          customer has updated the role trust policy to require the correct external ID. In this way
          you help your customers to do the right thing, which helps to keep both of you protected
          against the confused deputy problem.</p>
      </li></ul></div>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./id_roles_common-scenarios_third-party.html">Providing access to third-party AWS accounts</div><div id="next" class="next-link" accesskey="n" href="./id_roles_common-scenarios_services.html">Providing access to AWS services</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>