<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Troubleshoot signed requests for AWS APIs - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="signature-v4-troubleshooting" /><meta name="default_state" content="signature-v4-troubleshooting" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/signature-v4-troubleshooting.html" /><meta name="description" content="Learn how to troubleshoot common errors related creating a signed request to access AWS." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Control access to your AWS resources with user identity (authentication) and with policies that define specific permissions (authorization)." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/signature-v4-troubleshooting.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/signature-v4-troubleshooting.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Troubleshoot signed requests for AWS APIs" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Troubleshoot signed requests for AWS APIs - AWS Identity and Access Management</title><meta name="pdf" content="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#signature-v4-troubleshooting" /><meta name="github" content="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/signature-v4-troubleshooting.md" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/signature-v4-troubleshooting.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/signature-v4-troubleshooting.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/signature-v4-troubleshooting.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM user,user,IAM group,group,IAM role,role,permission policy,trust policy,policy,access key,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Reference information for AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Signing AWS API requests",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_aws-signing.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Troubleshoot signed requests for AWS APIs",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_aws-signing.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#signature-v4-troubleshooting" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/signature-v4-troubleshooting.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">User Guide</a></div><div id="page-toc-src"><a href="#signature-v4-troubleshooting-canonical-errors">Canonicalization errors</a><a href="#signature-v4-troubleshooting-credential-scope">Credential scope errors</a><a href="#signature-v4-troubleshooting-key-signing">Key signing errors</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="signature-v4-troubleshooting">Troubleshoot signed requests for AWS APIs</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>When you develop code that creates a signed request, you might receive HTTP 403
            <code class="code">SignatureDoesNotMatch</code> errors from the AWS services that you test against.  
            This error means that the signature value in your HTTP request to AWS did not match 
            the signature that the AWS service calculated.</p><div class="highlights" id="inline-topiclist"><h6>Possible causes</h6><ul><li><a href="#signature-v4-troubleshooting-canonical-errors">Canonicalization errors</a></li><li><a href="#signature-v4-troubleshooting-credential-scope">Credential scope errors</a></li><li><a href="#signature-v4-troubleshooting-key-signing">Key signing errors</a></li></ul></div>
            <h2 id="signature-v4-troubleshooting-canonical-errors">Canonicalization errors</h2>
            <p>If you incorrectly calculated the canonical request or the string to sign, the
                signature verification step performed by the service fails with the following error
                message:</p>
            <pre class="screen">The request signature we calculated does not match the signature you provided</pre>
            <p>The error response includes the canonical request and the string to sign that the service 
                calculated. You can compare these strings with the strings that you calculated.</p> 
            <p>You can also verify that you didn't send the request through a proxy that modifies 
                the headers or the request.</p>
         
            <h2 id="signature-v4-troubleshooting-credential-scope">Credential scope errors</h2>
            
            <p>The credential scope restricts a signature to a specific date, Region, and
                service. This string has the following format:</p>
            <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight"><code class="replaceable">YYYYMMDD</code>/<code class="replaceable">region</code>/<code class="replaceable">service</code>/aws4_request</code></pre>
            
             
                <h6>Date</h6>
                <p>If the credential scope does not specify the same date as the
                        x-amz-date header, the signature verification step fails with
                    the following error message:</p>
             
            <pre class="screen">Date in Credential scope does not match YYYYMMDD from ISO-8601 version of date from HTTP</pre>
            <p>If the request specifies a time in the future, the signature verification step fails with the following error message:</p>
            <pre class="screen">Signature not yet current: <code class="replaceable">date</code> is still later than <code class="replaceable">date</code></pre>
            <p>If the request has expired, the signature verification step fails with the following
                error message:</p>
            <pre class="screen">Signature expired: <code class="replaceable">date</code> is now earlier than <code class="replaceable">date</code></pre>
            
             
                <h6>Region</h6>
                <p>If the credential scope does not specify the same Region as the request, the
                    signature verification step fails with the following error message:</p>
             
            <pre class="screen">Credential should be scoped to a valid Region, not <code class="replaceable">region-code</code></pre>
            
             
                <h6>Service</h6>
                <p>If the credential scope does not specify the same service as the
                    host header, the signature verification step fails with the
                    following error message:</p>
             
            <pre class="screen">Credential should be scoped to correct service: '<code class="replaceable">service</code>'</pre>

             
                <h6>Termination string</h6>
                <p>If the credential scope does not end with aws4_request, the
                    signature verification step fails with the following error message:</p>
             
            <pre class="screen">Credential should be scoped with a valid terminator: 'aws4_request'</pre>
         
            <h2 id="signature-v4-troubleshooting-key-signing">Key signing errors</h2>
            <p>Errors that are caused by incorrect derivation of the signing key or improper use of
                cryptography are more difficult to troubleshoot. After you verify that the canonical 
                string and the string to sign are correct, you can also check for one of the following 
                issues:</p>
            <div class="itemizedlist">
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>The secret access key does not match the access key ID that you specified.</p>
                </li><li class="listitem">
                    <p>There is a problem with your key derivation code.</p>
                </li></ul></div>
            <p>To verify that the secret key matches the access key ID, you can test them with a 
                known working implementation. For example, use an AWS SDK or the AWS CLI to make a 
                request to AWS.</p>
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./create-signed-request.html">Create a signed request</div><div id="next" class="next-link" accesskey="n" href="./reference_policies.html">Policy reference</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/signature-v4-troubleshooting.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/signature-v4-troubleshooting.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>