<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Access Analyzer policy check reference - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="access-analyzer-reference-policy-checks" /><meta name="default_state" content="access-analyzer-reference-policy-checks" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" /><meta name="description" content="Learn about the messages that are returned by the policy checks and how to resolve them." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Control access to your AWS resources with user identity (authentication) and with policies that define specific permissions (authorization)." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Access Analyzer policy check reference" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Access Analyzer policy check reference - AWS Identity and Access Management</title><meta name="pdf" content="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#access-analyzer-reference-policy-checks" /><meta name="github" content="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/access-analyzer-reference-policy-checks.md" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM user,user,IAM group,group,IAM role,role,permission policy,trust policy,policy,access key,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Using AWS Identity and Access Management Access Analyzer",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "IAM Access Analyzer policy validation",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-policy-validation.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Access Analyzer policy check reference",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/access-analyzer-policy-validation.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#access-analyzer-reference-policy-checks" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/access-analyzer-reference-policy-checks.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">User Guide</a></div><div id="page-toc-src"><a href="#access-analyzer-reference-policy-checks-error-arn-account-not-allowed">Error – ARN account not allowed</a><a href="#access-analyzer-reference-policy-checks-error-arn-region-not-allowed">Error – ARN Region not allowed</a><a href="#access-analyzer-reference-policy-checks-error-data-type-mismatch">Error – Data type mismatch</a><a href="#access-analyzer-reference-policy-checks-error-duplicate-keys-with-different-case">Error – Duplicate keys with different case</a><a href="#access-analyzer-reference-policy-checks-error-invalid-action">Error – Invalid action</a><a href="#access-analyzer-reference-policy-checks-error-invalid-arn-account">Error – Invalid ARN account</a><a href="#access-analyzer-reference-policy-checks-error-invalid-arn-prefix">Error – Invalid ARN prefix</a><a href="#access-analyzer-reference-policy-checks-error-invalid-arn-region">Error – Invalid ARN Region</a><a href="#access-analyzer-reference-policy-checks-error-invalid-arn-resource">Error – Invalid ARN resource</a><a href="#access-analyzer-reference-policy-checks-error-invalid-arn-service-case">Error – Invalid ARN service case</a><a href="#access-analyzer-reference-policy-checks-error-invalid-condition-data-type">Error – Invalid condition data type</a><a href="#access-analyzer-reference-policy-checks-error-invalid-condition-key-format">Error – Invalid condition key format</a><a href="#access-analyzer-reference-policy-checks-error-invalid-condition-multiple-boolean">Error – Invalid condition multiple Boolean</a><a href="#access-analyzer-reference-policy-checks-error-invalid-condition-operator">Error – Invalid condition operator</a><a href="#access-analyzer-reference-policy-checks-error-invalid-effect">Error – Invalid effect</a><a href="#access-analyzer-reference-policy-checks-error-invalid-global-condition-key">Error – Invalid global condition key</a><a href="#access-analyzer-reference-policy-checks-error-invalid-partition">Error – Invalid partition</a><a href="#access-analyzer-reference-policy-checks-error-invalid-policy-element">Error – Invalid policy element</a><a href="#access-analyzer-reference-policy-checks-error-invalid-principal-format">Error – Invalid principal format</a><a href="#access-analyzer-reference-policy-checks-error-invalid-principal-key">Error – Invalid principal key</a><a href="#access-analyzer-reference-policy-checks-error-invalid-region">Error – Invalid Region</a><a href="#access-analyzer-reference-policy-checks-error-invalid-service">Error – Invalid service</a><a href="#access-analyzer-reference-policy-checks-error-invalid-service-condition-key">Error – Invalid service condition key</a><a href="#access-analyzer-reference-policy-checks-error-invalid-service-in-action">Error – Invalid service in action</a><a href="#access-analyzer-reference-policy-checks-error-invalid-variable-for-operator">Error – Invalid variable for operator</a><a href="#access-analyzer-reference-policy-checks-error-invalid-version">Error – Invalid version</a><a href="#access-analyzer-reference-policy-checks-error-json-syntax-error">Error – Json syntax error</a><a href="#access-analyzer-reference-policy-checks-error-json-syntax-error">Error – Json syntax error</a><a href="#access-analyzer-reference-policy-checks-error-missing-action">Error – Missing action</a><a href="#access-analyzer-reference-policy-checks-error-missing-arn-field">Error – Missing ARN field</a><a href="#access-analyzer-reference-policy-checks-error-missing-arn-region">Error – Missing ARN Region</a><a href="#access-analyzer-reference-policy-checks-error-missing-effect">Error – Missing effect</a><a href="#access-analyzer-reference-policy-checks-error-missing-principal">Error – Missing principal</a><a href="#access-analyzer-reference-policy-checks-error-missing-qualifier">Error – Missing qualifier</a><a href="#access-analyzer-reference-policy-checks-error-missing-resource">Error – Missing resource</a><a href="#access-analyzer-reference-policy-checks-error-missing-statement">Error – Missing statement</a><a href="#access-analyzer-reference-policy-checks-error-null-with-if-exists">Error – Null with if exists</a><a href="#access-analyzer-reference-policy-checks-error-scp-syntax-error-action-wildcard">Error – SCP syntax error action wildcard</a><a href="#access-analyzer-reference-policy-checks-error-scp-syntax-error-allow-condition">Error – SCP syntax error allow condition</a><a href="#access-analyzer-reference-policy-checks-error-scp-syntax-error-allow-notaction">Error – SCP syntax error allow NotAction</a><a href="#access-analyzer-reference-policy-checks-error-scp-syntax-error-allow-resource">Error – SCP syntax error allow resource</a><a href="#access-analyzer-reference-policy-checks-error-scp-syntax-error-notresource">Error – SCP syntax error NotResource</a><a href="#access-analyzer-reference-policy-checks-error-scp-syntax-error-principal">Error – SCP syntax error principal</a><a href="#access-analyzer-reference-policy-checks-error-unique-sids-required">Error – Unique Sids required</a><a href="#access-analyzer-reference-policy-checks-error-unsupported-action-in-policy">Error – Unsupported action in policy</a><a href="#access-analyzer-reference-policy-checks-error-unsupported-element-combination">Error – Unsupported element combination</a><a href="#access-analyzer-reference-policy-checks-error-unsupported-global-condition-key">Error – Unsupported global condition key</a><a href="#access-analyzer-reference-policy-checks-error-unsupported-principal">Error – Unsupported principal</a><a href="#access-analyzer-reference-policy-checks-error-unsupported-resource-arn-in-policy">Error – Unsupported resource ARN in policy</a><a href="#access-analyzer-reference-policy-checks-error-unsupported-sid">Error – Unsupported Sid</a><a href="#access-analyzer-reference-policy-checks-error-unsupported-wildcard-in-principal">Error – Unsupported wildcard in principal</a><a href="#access-analyzer-reference-policy-checks-error-missing-brace-in-variable">Error – Missing brace in variable</a><a href="#access-analyzer-reference-policy-checks-error-missing-quote-in-variable">Error – Missing quote in variable</a><a href="#access-analyzer-reference-policy-checks-error-unsupported-space-in-variable">Error – Unsupported space in variable</a><a href="#access-analyzer-reference-policy-checks-error-empty-variable">Error – Empty variable</a><a href="#access-analyzer-reference-policy-checks-error-variable-unsupported-in-element">Error – Variable unsupported in element</a><a href="#access-analyzer-reference-policy-checks-error-variable-unsupported-in-version">Error – Variable unsupported in version</a><a href="#access-analyzer-reference-policy-checks-error-private-ip-address">Error – Private IP address</a><a href="#access-analyzer-reference-policy-checks-error-private-not-ip-address">Error – Private NotIpAddress</a><a href="#access-analyzer-reference-policy-checks-error-policy-size-exceeds-scp-quota">Error – Policy size exceeds SCP quota</a><a href="#access-analyzer-reference-policy-checks-error-invalid-service-principal-format">Error – Invalid service principal format</a><a href="#access-analyzer-reference-policy-checks-error-missing-tag-key-in-condition">Error – Missing tag key in condition</a><a href="#access-analyzer-reference-policy-checks-error-invalid-vpc-format">Error – Invalid vpc format</a><a href="#access-analyzer-reference-policy-checks-error-invalid-vpce-format">Error – Invalid vpce format</a><a href="#access-analyzer-reference-policy-checks-error-federated-principal-not-supported">Error – Federated principal not supported</a><a href="#access-analyzer-reference-policy-checks-error-unsupported-action-for-condition-key">Error – Unsupported action for condition key</a><a href="#access-analyzer-reference-policy-checks-error-unsupported-action-in-policy">Error – Unsupported action in policy</a><a href="#access-analyzer-reference-policy-checks-error-unsupported-resource-arn-in-policy">Error – Unsupported resource ARN in policy</a><a href="#access-analyzer-reference-policy-checks-error-unsupported-condition-key-for-service-principal">Error – Unsupported condition key for service
                principal</a><a href="#access-analyzer-reference-policy-checks-error-role-trust-policy-syntax-error-notprincipal">Error – Role trust policy syntax error notprincipal</a><a href="#access-analyzer-reference-policy-checks-error-role-trust-policy-unsupported-wildcard-in-principal">Error – Role trust policy unsupported wildcard in
                principal</a><a href="#access-analyzer-reference-policy-checks-error-role-trust-policy-syntax-error-resource">Error – Role trust policy syntax error resource</a><a href="#access-analyzer-reference-policy-checks-error-missing-action-for-condition-key">Error – Missing action for condition key</a><a href="#access-analyzer-reference-policy-checks-error-invalid-federated-principal-syntax-in-role-trust-policy">Error – Invalid federated principal syntax in role trust
                policy</a><a href="#access-analyzer-reference-policy-checks-error-mismatched-action-for-principal">Error – Mismatched action for principal</a><a href="#access-analyzer-reference-policy-checks-error-missing-action-for-roles-anywhere-trust-policy">Error – Missing action for roles anywhere trust policy</a><a href="#access-analyzer-reference-policy-checks-general-warning-create-slr-with-not-resource">General Warning – Create SLR with NotResource</a><a href="#access-analyzer-reference-policy-checks-general-warning-create-slr-with-star-in-action-and-not-resource">General Warning – Create SLR with star in action and
                NotResource</a><a href="#access-analyzer-reference-policy-checks-general-warning-create-slr-with-not-action-and-not-resource">General Warning – Create SLR with NotAction and
                NotResource</a><a href="#access-analyzer-reference-policy-checks-general-warning-create-slr-with-star-in-resource">General Warning – Create SLR with star in resource</a><a href="#access-analyzer-reference-policy-checks-general-warning-create-slr-with-star-in-action-and-resource">General Warning – Create SLR with star in action and
                resource</a><a href="#access-analyzer-reference-policy-checks-general-warning-create-slr-with-star-in-resource-and-not-action">General Warning – Create SLR with star in resource and
                NotAction</a><a href="#access-analyzer-reference-policy-checks-general-warning-deprecated-global-condition-key">General Warning – Deprecated global condition key</a><a href="#access-analyzer-reference-policy-checks-general-warning-invalid-date-value">General Warning – Invalid date value</a><a href="#access-analyzer-reference-policy-checks-general-warning-invalid-role-reference">General Warning – Invalid role reference</a><a href="#access-analyzer-reference-policy-checks-general-warning-invalid-user-reference">General Warning – Invalid user reference</a><a href="#access-analyzer-reference-policy-checks-general-warning-missing-version">General Warning – Missing version</a><a href="#access-analyzer-reference-policy-checks-general-warning-unique-sids-recommended">General Warning – Unique Sids recommended</a><a href="#access-analyzer-reference-policy-checks-general-warning-wildcard-without-like-operator">General Warning – Wildcard without like operator</a><a href="#access-analyzer-reference-policy-checks-general-warning-policy-size-exceeds-identity-policy-quota">General Warning – Policy size exceeds identity policy
                quota</a><a href="#access-analyzer-reference-policy-checks-general-warning-policy-size-exceeds-resource-policy-quota">General Warning – Policy size exceeds resource policy
                quota</a><a href="#access-analyzer-reference-policy-checks-general-warning-type-mismatch">General Warning – Type mismatch</a><a href="#access-analyzer-reference-policy-checks-general-warning-type-mismatch-boolean">General Warning – Type mismatch Boolean</a><a href="#access-analyzer-reference-policy-checks-general-warning-type-mismatch-date">General Warning – Type mismatch date</a><a href="#access-analyzer-reference-policy-checks-general-warning-type-mismatch-ip-range">General Warning – Type mismatch IP range</a><a href="#access-analyzer-reference-policy-checks-general-warning-type-mismatch-number">General Warning – Type mismatch number</a><a href="#access-analyzer-reference-policy-checks-general-warning-type-mismatch-string">General Warning – Type mismatch string</a><a href="#access-analyzer-reference-policy-checks-general-warning-specific-github-repo-and-branch-recommended">General Warning – Specific github repo and branch
                recommended</a><a href="#access-analyzer-reference-policy-checks-general-warning-policy-size-exceeds-role-trust-policy-quota">General Warning – Policy size exceeds role trust policy
                quota</a><a href="#access-analyzer-reference-policy-checks-security-warning-allow-with-not-principal">Security Warning – Allow with NotPrincipal</a><a href="#access-analyzer-reference-policy-checks-security-warning-forallvalues-with-single-valued-key">Security Warning – ForAllValues with single valued key</a><a href="#access-analyzer-reference-policy-checks-security-warning-pass-role-with-not-resource">Security Warning – Pass role with NotResource</a><a href="#access-analyzer-reference-policy-checks-security-warning-pass-role-with-star-in-action-and-not-resource">Security Warning – Pass role with star in action and
                NotResource</a><a href="#access-analyzer-reference-policy-checks-security-warning-pass-role-with-not-action-and-not-resource">Security Warning – Pass role with NotAction and
                NotResource</a><a href="#access-analyzer-reference-policy-checks-security-warning-pass-role-with-star-in-resource">Security Warning – Pass role with star in resource</a><a href="#access-analyzer-reference-policy-checks-security-warning-pass-role-with-star-in-action-and-resource">Security Warning – Pass role with star in action and
                resource</a><a href="#access-analyzer-reference-policy-checks-security-warning-pass-role-with-star-in-resource-and-not-action">Security Warning – Pass role with star in resource and
                NotAction</a><a href="#access-analyzer-reference-policy-checks-security-warning-missing-paired-condition-keys">Security Warning – Missing paired condition keys</a><a href="#access-analyzer-reference-policy-checks-security-warning-deny-with-unsupported-tag-condition-key-for-service">Security Warning – Deny with unsupported tag condition key for
                service</a><a href="#access-analyzer-reference-policy-checks-security-warning-deny-notaction-with-unsupported-tag-condition-key-for-service">Security Warning – Deny NotAction with unsupported tag condition key
                for service</a><a href="#access-analyzer-reference-policy-checks-security-warning-restrict-access-to-service-principal">Security Warning – Restrict access to service
                principal</a><a href="#access-analyzer-reference-policy-checks-security-warning-missing-condition-key-for-oidc-principal">Security Warning – Missing condition key for oidc
                principal</a><a href="#access-analyzer-reference-policy-checks-security-warning-missing-github-repo-condition-key">Security Warning – Missing github repo condition key</a><a href="#access-analyzer-reference-policy-checks-suggestion-empty-array-action">Suggestion – Empty array action</a><a href="#access-analyzer-reference-policy-checks-suggestion-empty-array-condition">Suggestion – Empty array condition</a><a href="#access-analyzer-reference-policy-checks-suggestion-empty-array-condition-forallvalues">Suggestion – Empty array condition ForAllValues</a><a href="#access-analyzer-reference-policy-checks-suggestion-empty-array-condition-foranyvalue">Suggestion – Empty array condition ForAnyValue</a><a href="#access-analyzer-reference-policy-checks-suggestion-empty-array-condition-ifexists">Suggestion – Empty array condition IfExists</a><a href="#access-analyzer-reference-policy-checks-suggestion-empty-array-principal">Suggestion – Empty array principal</a><a href="#access-analyzer-reference-policy-checks-suggestion-empty-array-resource">Suggestion – Empty array resource</a><a href="#access-analyzer-reference-policy-checks-suggestion-empty-object-condition">Suggestion – Empty object condition</a><a href="#access-analyzer-reference-policy-checks-suggestion-empty-object-principal">Suggestion – Empty object principal</a><a href="#access-analyzer-reference-policy-checks-suggestion-empty-sid-value">Suggestion – Empty Sid value</a><a href="#access-analyzer-reference-policy-checks-suggestion-improve-ip-range">Suggestion – Improve IP range</a><a href="#access-analyzer-reference-policy-checks-suggestion-null-with-qualifier">Suggestion – Null with qualifier</a><a href="#access-analyzer-reference-policy-checks-suggestion-private-ip-address-subset">Suggestion – Private IP address subset</a><a href="#access-analyzer-reference-policy-checks-suggestion-private-not-ip-address-subset">Suggestion – Private NotIpAddress subset</a><a href="#access-analyzer-reference-policy-checks-suggestion-redundant-action">Suggestion – Redundant action</a><a href="#access-analyzer-reference-policy-checks-suggestion-redundant-condition-value-num">Suggestion – Redundant condition value num</a><a href="#access-analyzer-reference-policy-checks-suggestion-redundant-resource">Suggestion – Redundant resource</a><a href="#access-analyzer-reference-policy-checks-suggestion-redundant-statement">Suggestion – Redundant statement</a><a href="#access-analyzer-reference-policy-checks-suggestion-wildcard-in-service-name">Suggestion – Wildcard in service name</a><a href="#access-analyzer-reference-policy-checks-suggestion-allow-with-unsupported-tag-condition-key-for-service">Suggestion – Allow with unsupported tag condition key for
                service</a><a href="#access-analyzer-reference-policy-checks-suggestion-allow-notaction-with-unsupported-tag-condition-key-for-service">Suggestion – Allow NotAction with unsupported tag condition key for
                service</a><a href="#access-analyzer-reference-policy-checks-suggestion-recommended-condition-key-for-service-principal">Suggestion – Recommended condition key for service
                principal</a><a href="#access-analyzer-reference-policy-checks-suggestion-irrelevant-condition-key-in-policy">Suggestion – Irrelevant condition key in policy</a><a href="#access-analyzer-reference-policy-checks-suggestion-redundant-principal-in-role-trust-policy">Suggestion – Redundant principal in role trust policy</a><a href="#access-analyzer-reference-policy-checks-suggestion-confirm-audience-claim-type">Suggestion – Confirm audience claim type</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="access-analyzer-reference-policy-checks">Access Analyzer policy check
            reference</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>You can validate your policies using AWS IAM Access Analyzer policy checks. You can create or edit a
   policy using the AWS CLI, AWS API, or JSON policy editor in the IAM console. Access Analyzer validates
   your policy against IAM <a href="./reference_policies_grammar.html">policy grammar</a> and
    <a href="./best-practices.html">best practices</a>. You can view policy validation check
   findings that include security warnings, errors, general warnings, and suggestions for your
   policy. These findings provide actionable recommendations that help you author policies that are
   functional and conform to security best practices. To learn more about validating policies using
   Access Analyzer, see <a href="./access-analyzer-policy-validation.html">IAM Access Analyzer policy validation</a>.</p>
        <h2 id="access-analyzer-reference-policy-checks-error-arn-account-not-allowed">Error – ARN account not allowed</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">ARN account not allowed: The service <span>{</span><span>{</span>service}} does not support specifying an account ID in the resource ARN.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The service <span>{</span><span>{</span>service}} does not support specifying an account ID in the resource ARN."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Remove the account ID from the resource ARN. The resource ARNs for some AWS services do not support specifying an account ID.</p>
<p>For example, Amazon S3 does not support an account ID as a namespace in bucket ARNs. An Amazon S3 bucket name is globally unique, 
and the namespace is shared by all AWS accounts. To view all of the resource types available in Amazon S3, see 
<a href="https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazons3.html#amazons3-resources-for-iam-policies">
Resource types defined by Amazon S3</a> in the <em>Service Authorization Reference</em>.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
         
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_resource.html">Policy resources</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/general/latest/gr/acct-identifiers.html">Account Identifiers</a></p></li><li class="listitem"><p><a href="./reference_identifiers.html#identifiers-arns">Resource ARNs</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">AWS service resources with ARN formats</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-arn-region-not-allowed">Error – ARN Region not allowed</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">ARN Region not allowed: The service <span>{</span><span>{</span>service}} does not support specifying a Region in the resource ARN.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The service <span>{</span><span>{</span>service}} does not support specifying a Region in the resource ARN."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Remove the Region from the resource ARN. The resource ARNs for some AWS services do not support specifying a Region.</p>
<p>For example, IAM is a global service. The Region portion of an IAM resource ARN is always kept blank. IAM resources 
are global, like an AWS account is today. For example, after you sign in as an IAM user, you can access AWS services in any
geographic region.</p>
<div class="itemizedlist">
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_resource.html">Policy resources</a></p></li><li class="listitem"><p><a href="./reference_identifiers.html#identifiers-arns">Resource ARNs</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">AWS service resources with ARN formats</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-data-type-mismatch">Error
                – Data type mismatch</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Data type mismatch: The text does not match the expected JSON data type <span>{</span><span>{</span>data_type}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The text does not match the expected JSON data type <span>{</span><span>{</span>data_type}}."</code></pre>
        <p><b>Resolving the error</b></p>
           
<p>Update the text to use the supported data type.</p>
<p>For example, the <code class="code">Version</code> global condition key requires a <code class="code">String</code> data type. If you provide a date or an integer, the 
data type won't match.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">  
     
      
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_condition-keys.html">Global condition keys</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html">IAM JSON policy elements: Condition operators</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-duplicate-keys-with-different-case">Error – Duplicate keys with different case</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Duplicate keys with different case: The condition key <span>{</span><span>{</span>key}} appears more than once with different capitalization in the same condition block. Remove the duplicate condition keys.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The condition key <span>{</span><span>{</span>key}} appears more than once with different capitalization in the same condition block. Remove the duplicate condition keys."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Review the similar condition keys within the same condition block and use the same capitalization for all instances.</p>
<p>A <em>condition block</em> is the text within the <code class="code">Condition</code> element of a policy statement.
    Condition key <em>names</em> are not case-sensitive. The case-sensitivity of condition key <em>values</em> 
    depends on the condition operator that you use. For more information about case-sensitivity in condition keys, see 
    <a href="./reference_policies_elements_condition.html">IAM JSON policy elements:
        Condition</a>.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
      
     
     
         
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition.html">Conditions</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html#AccessPolicyLanguage_ConditionBlock">Condition block</a></p></li><li class="listitem"><p><a href="./reference_policies_condition-keys.html">Global condition keys</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">AWS service condition keys</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-action">Error
                – Invalid action</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid action: The action <span>{</span><span>{</span>action}} does not exist. Did you mean <span>{</span><span>{</span>valid_action}}?
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The action <span>{</span><span>{</span>action}} does not exist. Did you mean <span>{</span><span>{</span>valid_action}}?"</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The action that you specified is not valid. This can happen if you mis-type the service prefix or the action name. For some common issues, the policy check returns a suggested action.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">     
     
      
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_action.html">Policy actions</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">AWS service actions</a></p></li></ul></div>    

 
    <h3 id="accan-ref-policy-check-message-fix-error-invalid-action-awsmanpol">AWS managed policies with this error</h3>
    <p><a href="./access_policies_managed-vs-inline.html#aws-managed-policies">AWS managed policies</a> enable you to get started with AWS by assigning permissions 
    based on general AWS use cases.</p>
    <p>The following AWS managed policies include invalid actions in their policy statements. Invalid actions do not affect the permissions 
    granted by the policy. When using an AWS managed policy as a reference to create your managed policy, AWS recommends that you remove invalid actions from your policy.</p>
    <div class="itemizedlist">
         
           
    <ul class="itemizedlist"><li class="listitem"><p><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/AmazonEMRFullAccessPolicy_v2" rel="noopener noreferrer" target="_blank"><span>AmazonEMRFullAccessPolicy_v2</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li><li class="listitem"><p><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/CloudWatchSyntheticsFullAccess" rel="noopener noreferrer" target="_blank"><span>CloudWatchSyntheticsFullAccess</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li></ul></div>
 

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-arn-account">Error – Invalid ARN account</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid ARN account: The resource ARN account ID <span>{</span><span>{</span>account}} is not valid. Provide a 12-digit account ID.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The resource ARN account ID <span>{</span><span>{</span>account}} is not valid. Provide a 12-digit account ID."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Update the account ID in the resource ARN. Account IDs are 12-digit integers. To learn how to view your account ID, see 
<a href="https://docs.aws.amazon.com/general/latest/gr/acct-identifiers.html#FindingYourAccountIdentifiers">Finding your AWS account ID</a>.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
         
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_resource.html">Policy resources</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/general/latest/gr/acct-identifiers.html">Account Identifiers</a></p></li><li class="listitem"><p><a href="./reference_identifiers.html#identifiers-arns">Resource ARNs</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">AWS service resources with ARN formats</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-arn-prefix">Error
                – Invalid ARN prefix</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid ARN prefix: Add the required prefix (arn) to the resource ARN.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Add the required prefix (arn) to the resource ARN."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>AWS resource ARNs must include the required <code class="code">arn:</code> prefix.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_resource.html">Policy resources</a></p></li><li class="listitem"><p><a href="./reference_identifiers.html#identifiers-arns">Resource ARNs</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">AWS service resources with ARN formats</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-arn-region">Error
                – Invalid ARN Region</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid ARN Region: The Region <span>{</span><span>{</span>region}} is not valid for this resource. Update the resource ARN to include a supported Region.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The Region <span>{</span><span>{</span>region}} is not valid for this resource. Update the resource ARN to include a supported Region."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The resource type is not supported in the specified Region. For a table of AWS services supported in each Region, 
    see the <a href="https://aws.amazon.com/about-aws/global-infrastructure/regional-product-services/" rel="noopener noreferrer" target="_blank"><span>Region table</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_resource.html">Policy resources</a></p></li><li class="listitem"><p><a href="./reference_identifiers.html#identifiers-arns">Resource ARNs</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/general/latest/gr/rande.html#region-names-codes">Region names and codes</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-arn-resource">Error – Invalid ARN resource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid ARN resource: Resource ARN does not match the expected ARN format. Update the resource portion of the ARN.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Resource ARN does not match the expected ARN format. Update the resource portion of the ARN."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The resource ARN must match the specifications for known resource types. To view the expected ARN format for a service, 
    see <a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">Actions, resources, and condition keys for AWS services</a>.
    Choose the name of the service to view its resource types and ARN formats.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
       
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_resource.html">Policy resources</a></p></li><li class="listitem"><p><a href="./reference_identifiers.html#identifiers-arns">Resource ARNs</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">AWS service resources with ARN formats</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-arn-service-case">Error – Invalid ARN service case</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid ARN service case: Update the service name $<span>{</span>service} in the resource ARN to use all lowercase letters.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Update the service name $<span>{</span>service} in the resource ARN to use all lowercase letters."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The service in the resource ARN must match the specifications (including capitalization) for service prefixes. To view the prefix for a service, 
    see <a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">Actions, resources, and condition keys for AWS services</a>.
    Choose the name of the service and locate its prefix in the first sentence.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
       
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_resource.html">Policy resources</a></p></li><li class="listitem"><p><a href="./reference_identifiers.html#identifiers-arns">Resource ARNs</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">AWS service resources with ARN formats</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-condition-data-type">Error – Invalid condition data type</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid condition data type: The condition value data types do not match. Use condition values of the same JSON data type.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The condition value data types do not match. Use condition values of the same JSON data type."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The value in the condition key-value pair must match the data type of the condition key and condition operator. To view the condition key data type for a service, 
    see <a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">Actions, resources, and condition keys for AWS services</a>.
    Choose the name of the service to view the condition keys for that service.</p>
<p>For example, the <a href="./reference_policies_condition-keys.html#condition-keys-currenttime">CurrentTime</a> global condition key supports 
the <code class="code">Date</code> condition operator. If you provide a string or an integer for the value in the condition block, the data type won't match.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
      
     
     
     
         
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition.html">Conditions</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html#AccessPolicyLanguage_ConditionBlock">Condition block</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html">IAM JSON policy elements: Condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_condition-keys.html">Global condition keys</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">AWS service condition keys</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-condition-key-format">Error – Invalid condition key format</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid condition key format: The condition key format is not valid. Use the format service:keyname.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The condition key format is not valid. Use the format service:keyname."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The key in the condition key-value pair must match the specifications for the service. To view the condition keys for a service, 
    see <a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">Actions, resources, and condition keys for AWS services</a>.
    Choose the name of the service to view the condition keys for that service.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
         
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition.html">Conditions</a></p></li><li class="listitem"><p><a href="./reference_policies_condition-keys.html">Global condition keys</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">AWS service condition keys</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-condition-multiple-boolean">Error – Invalid condition multiple Boolean</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid condition multiple Boolean: The condition key does not support multiple Boolean values. Use a single Boolean value.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The condition key does not support multiple Boolean values. Use a single Boolean value."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The key in the condition key-value pair expects a single Boolean value. When you provide multiple Boolean values, the condition match might not return the results that you expect.</p>
<p>To view the condition keys for a service, 
    see <a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">Actions, resources, and condition keys for AWS services</a>.
    Choose the name of the service to view the condition keys for that service.</p>
<div class="itemizedlist">
     
     
         
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition.html">Conditions</a></p></li><li class="listitem"><p><a href="./reference_policies_condition-keys.html">Global condition keys</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">AWS service condition keys</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-condition-operator">Error – Invalid condition operator</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid condition operator: The condition operator <span>{</span><span>{</span>operator}} is not valid. Use a valid condition operator.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The condition operator <span>{</span><span>{</span>operator}} is not valid. Use a valid condition operator."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Update the condition to use a supported condition operator.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html">IAM JSON policy elements: Condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">Condition element</a></p></li><li class="listitem"><p><a href="./access_policies.html#access_policies-json">Overview of JSON policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-effect">Error
                – Invalid effect</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid effect: The effect <span>{</span><span>{</span>effect}} is not valid. Use Allow or Deny.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The effect <span>{</span><span>{</span>effect}} is not valid. Use Allow or Deny."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Update the <code class="code">Effect</code> element to use a valid effect. Valid values for <code class="code">Effect</code> are <code class="userinput">Allow</code> and <code class="userinput">Deny</code>.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_effect.html">Effect element</a></p></li><li class="listitem"><p><a href="./access_policies.html#access_policies-json">Overview of JSON policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-global-condition-key">Error – Invalid global condition key</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid global condition key: The condition key <span>{</span><span>{</span>key}} does not exist. Use a valid condition key.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The condition key <span>{</span><span>{</span>key}} does not exist. Use a valid condition key."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Update the condition key in the condition key-value pair to use a supported global condition key.</p>
<p>Global condition keys are condition keys with an <code class="code">aws:</code> prefix. AWS services can support global condition keys or provide service-specific 
keys that include their service prefix. For example, IAM condition keys include the <code class="code">iam:</code> prefix. For more information, see 
<a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">Actions, Resources, and Condition Keys for AWS Services</a> 
and choose the service whose keys you want to view.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_condition-keys.html">Global condition keys</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-partition">Error
                – Invalid partition</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid partition: The resource ARN for the service <span>{</span><span>{</span>service}} does not support the partition <span>{</span><span>{</span>partition}}. Use the supported values: <span>{</span><span>{</span>partitions}}
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The resource ARN for the service <span>{</span><span>{</span>service}} does not support the partition <span>{</span><span>{</span>partition}}. Use the supported values: <span>{</span><span>{</span>partitions}}"</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Update the resource ARN to include a supported partition. If you included a supported partition, then the service 
or resource might not support the partition that you included.</p>
<p>A <em>partition</em> is a group of AWS Regions. Each AWS account is scoped to one partition. In Classic Regions, use the 
<code class="code">aws</code> partition. In China Regions, use <code class="code">aws-cn</code>.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
         
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/general/latest/gr/aws-arns-and-namespaces.html">Amazon Resource Names (ARNs) - Partitions</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-policy-element">Error – Invalid policy element</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid policy element: The policy element <span>{</span><span>{</span>element}} is not valid.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The policy element <span>{</span><span>{</span>element}} is not valid."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Update the policy to include only supported JSON policy elements.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements.html">JSON policy elements</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-principal-format">Error – Invalid principal format</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid principal format: The Principal element contents are not valid. Specify a key-value pair in the Principal element.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The Principal element contents are not valid. Specify a key-value pair in the Principal element."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Update the principal to use a supported key-value pair format. </p>
<p>You can specify a principal in a resource-based policy, but not an identity-based policy. </p>
<p>For example, to define access for everyone in an AWS account, use the following principal in your policy:</p>
<pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"Principal": <span>{</span> "AWS": "123456789012" }</code></pre>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_principal.html">JSON policy elements: Principal</a></p></li><li class="listitem"><p><a href="./access_policies_identity-vs-resource.html">Identity-based policies and resource-based policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-principal-key">Error – Invalid principal key</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid principal key: The principal key <span>{</span><span>{</span>principal-key}} is not valid.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The principal key <span>{</span><span>{</span>principal-key}} is not valid."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Update the key in the principal key-value pair to use a supported principal key. The following are supported principal keys:</p>
<div class="itemizedlist">
        
       
       
        
<ul class="itemizedlist"><li class="listitem"><p>AWS</p></li><li class="listitem"><p>CanonicalUser</p></li><li class="listitem"><p>Federated</p></li><li class="listitem"><p>Service</p></li></ul></div>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_principal.html">Principal element</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-region">Error
                – Invalid Region</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid Region: The Region <span>{</span><span>{</span>region}} is not valid. Update the condition value to a suported Region.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The Region <span>{</span><span>{</span>region}} is not valid. Update the condition value to a suported Region."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Update the value of the condition key-value pair to include a supported Region. For a table of AWS services supported in each Region, 
    see the <a href="https://aws.amazon.com/about-aws/global-infrastructure/regional-product-services/" rel="noopener noreferrer" target="_blank"><span>Region table</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_resource.html">Policy resources</a></p></li><li class="listitem"><p><a href="./reference_identifiers.html#identifiers-arns">Resource ARNs</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/general/latest/gr/rande.html#region-names-codes">Region names and codes</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-service">Error
                – Invalid service</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid service: The service <span>{</span><span>{</span>service}} does not exist. Use a valid service name.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The service <span>{</span><span>{</span>service}} does not exist. Use a valid service name."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The service prefix in the action or condition key must match the specifications (including capitalization) for service prefixes. To view the prefix for a service, 
    see <a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">
    Actions, resources, and condition keys for AWS services</a>.
    Choose the name of the service and locate its prefix in the first sentence.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">
    Known services and their actions, resources, and condition keys</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-service-condition-key">Error – Invalid service condition key</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid service condition key: The condition key <span>{</span><span>{</span>key}} does not exist in the service <span>{</span><span>{</span>service}}. Use a valid condition key.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The condition key <span>{</span><span>{</span>key}} does not exist in the service <span>{</span><span>{</span>service}}. Use a valid condition key."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Update the key in the condition key-value pair to use a known condition key for the service. Global condition key names begin with the <code class="code">aws</code> prefix. 
AWS services can provide service-specific keys that include their service prefix. To view the prefix for a service, 
    see <a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">
    Actions, resources, and condition keys for AWS services</a>.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_condition-keys.html">Global condition keys</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">
    Known services and their actions, resources, and condition keys</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-service-in-action">Error – Invalid service in action</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid service in action: The service <span>{</span><span>{</span>service}} specified in the action does not exist. Did you mean <span>{</span><span>{</span>service2}}?
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The service <span>{</span><span>{</span>service}} specified in the action does not exist. Did you mean <span>{</span><span>{</span>service2}}?"</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The service prefix in the action must match the specifications (including capitalization) for service prefixes. To view the prefix for a service, 
    see <a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">
    Actions, resources, and condition keys for AWS services</a>.
    Choose the name of the service and locate its prefix in the first sentence.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_action.html">Action element</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">
    Known services and their actions</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-variable-for-operator">Error – Invalid variable for operator</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid variable for operator: Policy variables can only be used with String and ARN operators.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Policy variables can only be used with String and ARN operators."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>You can use policy variables in the <code class="code">Resource</code> element and in string comparisons in the <code class="code">Condition</code> element. Conditions support variables when 
you use string operators or ARN operators. String operators include <code class="code">StringEquals</code>, <code class="code">StringLike</code>, and <code class="code">StringNotLike</code>. 
ARN operators include <code class="code">ArnEquals</code> and <code class="code">ArnLike</code>. You can't use a policy variable with other operators, such as Numeric, Date, Boolean, 
Binary, IP Address, or Null operators.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
         
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_variables.html#policy-vars-conditionelement">Using policy variables in the Condition element</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">Condition element</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-version">Error
                – Invalid version</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid version: The version $<span>{</span>version} is not valid. Use one of the following versions: $<span>{</span>versions}
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The version $<span>{</span>version} is not valid. Use one of the following versions: $<span>{</span>versions}"</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The <code class="code">Version</code> policy element specifies the language syntax rules that AWS uses to process a policy. To use all of the available 
policy features, include the latest <code class="code">Version</code> element before the <code class="code">Statement</code> element in all of your policies.</p>
<pre class="programlisting"><div class="code-btn-container"></div><code class="">"Version": "2012-10-17"</code></pre>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_version.html">Version element</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-json-syntax-error">Error
                – Json syntax error</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Json syntax error: Fix the JSON syntax error at index <span>{</span><span>{</span>index}} line <span>{</span><span>{</span>line}} column <span>{</span><span>{</span>column}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Fix the JSON syntax error at index <span>{</span><span>{</span>index}} line <span>{</span><span>{</span>line}} column <span>{</span><span>{</span>column}}."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Your policy includes a syntax error. Check your JSON syntax.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
         
       
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://jsonlint.com/" rel="noopener noreferrer" target="_blank"><span>JSON validator</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li><li class="listitem"><p><a href="./reference_policies_elements.html">IAM JSON policy elements reference</a></p></li><li class="listitem"><p><a href="./access_policies.html#access_policies-json">Overview of JSON policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-json-syntax-error">Error
                – Json syntax error</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Json syntax error: Fix the JSON syntax error.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Fix the JSON syntax error."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Your policy includes a syntax error. Check your JSON syntax.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
         
       
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://jsonlint.com/" rel="noopener noreferrer" target="_blank"><span>JSON validator</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li><li class="listitem"><p><a href="./reference_policies_elements.html">IAM JSON policy elements reference</a></p></li><li class="listitem"><p><a href="./access_policies.html#access_policies-json">Overview of JSON policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-missing-action">Error
                – Missing action</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing action: Add an Action or NotAction element to the policy statement.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Add an Action or NotAction element to the policy statement."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>AWS JSON policies must include an <code class="code">Action</code> or <code class="code">NotAction</code> element.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_action.html">Action element</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notaction.html">NotAction element</a></p></li><li class="listitem"><p><a href="./access_policies.html#access_policies-json">Overview of JSON policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-missing-arn-field">Error
                – Missing ARN field</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing ARN field: Resource ARNs must include at least <span>{</span><span>{</span>fields}} fields in the following structure: arn:partition:service:region:account:resource
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Resource ARNs must include at least <span>{</span><span>{</span>fields}} fields in the following structure: arn:partition:service:region:account:resource"</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>All of the fields in the resource ARN must match the specifications for a known resource type. To view the expected ARN format for a service, 
    see <a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">Actions, resources, and condition keys for AWS services</a>.
    Choose the name of the service to view its resource types and ARN formats.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
       
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_resource.html">Policy resources</a></p></li><li class="listitem"><p><a href="./reference_identifiers.html#identifiers-arns">Resource ARNs</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">AWS service resources with ARN formats</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-missing-arn-region">Error
                – Missing ARN Region</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing ARN Region: Add a Region to the <span>{</span><span>{</span>service}} resource ARN.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Add a Region to the <span>{</span><span>{</span>service}} resource ARN."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The resource ARNs for most AWS services require that you specify a Region. For a table of AWS services supported in each Region, 
    see the <a href="https://aws.amazon.com/about-aws/global-infrastructure/regional-product-services/" rel="noopener noreferrer" target="_blank"><span>Region table</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_resource.html">Policy resources</a></p></li><li class="listitem"><p><a href="./reference_identifiers.html#identifiers-arns">Resource ARNs</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/general/latest/gr/rande.html#region-names-codes">Region names and codes</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-missing-effect">Error
                – Missing effect</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing effect: Add an Effect element to the policy statement with a value of Allow or Deny.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Add an Effect element to the policy statement with a value of Allow or Deny."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>AWS JSON policies must include an <code class="code">Effect</code> element with a value of <code class="userinput">Allow</code> and <code class="userinput">Deny</code>.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_effect.html">Effect element</a></p></li><li class="listitem"><p><a href="./access_policies.html#access_policies-json">Overview of JSON policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-missing-principal">Error
                – Missing principal</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing principal: Add a Principal element to the policy statement.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Add a Principal element to the policy statement."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Resource-based policies must include a <code class="code">Principal</code> element.</p>
<p>For example, to define access for everyone in an AWS account, use the following principal in your policy:</p>
<pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"Principal": <span>{</span> "AWS": "123456789012" }</code></pre>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_principal.html">Principal element</a></p></li><li class="listitem"><p><a href="./access_policies_identity-vs-resource.html">Identity-based policies and resource-based policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-missing-qualifier">Error
                – Missing qualifier</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing qualifier: The request context key $<span>{</span>key} has multiple values. Use the ForAllValues or ForAnyValue condition key qualifiers in your policy.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The request context key $<span>{</span>key} has multiple values. Use the ForAllValues or ForAnyValue condition key qualifiers in your policy."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>In the <code class="code">Condition</code> element, you build expressions in which you use condition operators like equal or less than to compare a condition 
in the policy against keys and values in the request context. For requests that include multiple values for a single condition key, you must enclose 
the conditions within brackets like an array ("Key2":["Value2A", "Value2B"]). You must also use the <code class="code">ForAllValues</code> or <code class="code">ForAnyValue</code> 
set operators with the <code class="code">StringLike</code> condition operator. These qualifiers add set-operation functionality to the condition operator so that 
you can test multiple request values against multiple condition values.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_multi-value-conditions.html#reference_policies_multi-key-or-value-conditions">Using multiple condition keys and values</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">Condition element</a></p></li></ul></div>

 
    <h3 id="accan-ref-policy-check-message-fix-error-missing-qualifier-awsmanpol">AWS managed policies with this error</h3>
    <p><a href="./access_policies_managed-vs-inline.html#aws-managed-policies">AWS managed policies</a> enable you to get started with AWS by assigning permissions 
    based on general AWS use cases.</p>
    <p>The following AWS managed policies include a missing qualifier for condition keys in their policy statements. When using the AWS managed policy 
    as a reference to create your customer managed policy, AWS recommends that you add the <code class="code">ForAllValues</code> or <code class="code">ForAnyValue</code> condition key 
    qualifiers to your <code class="code">Condition</code> element.</p>
    <div class="itemizedlist">
           
    <ul class="itemizedlist"><li class="listitem"><p><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/AWSGlueConsoleSageMakerNotebookFullAccess" rel="noopener noreferrer" target="_blank"><span>AWSGlueConsoleSageMakerNotebookFullAccess</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li></ul></div>
 

     
        <h2 id="access-analyzer-reference-policy-checks-error-missing-resource">Error
                – Missing resource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing resource: Add a Resource or NotResource element to the policy statement.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Add a Resource or NotResource element to the policy statement."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Identity-based policies must include a <code class="code">Resource</code> or <code class="code">NotResource</code> element.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_resource.html">Resource element</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notresource.html">NotResource element</a></p></li><li class="listitem"><p><a href="./access_policies_identity-vs-resource.html">Identity-based policies and resource-based policies</a></p></li><li class="listitem"><p><a href="./access_policies.html#access_policies-json">Overview of JSON policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-missing-statement">Error
                – Missing statement</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing statement: Add a statement to the policy
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Add a statement to the policy"</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>A JSON policy must include a statement.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements.html">JSON policy elements</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-null-with-if-exists">Error – Null with if exists</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Null with if exists: The Null condition operator cannot be used with the IfExists suffix. Update the operator or the suffix.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The Null condition operator cannot be used with the IfExists suffix. Update the operator or the suffix."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>You can add <code class="code">IfExists</code> to the end of any condition operator name except the <code class="code">Null</code> condition operator. 
Use a <code class="code">Null</code> condition operator to check if a condition key is present at the time of authorization.
Use <code class="code">...ifExists</code> to say "If the policy key is present in the context of the request, process the key as 
specified in the policy. If the key is not present, evaluate the condition element as true."</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html#Conditions_IfExists">...IfExists condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html#Conditions_Null">Null condition operator</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">Condition element</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-scp-syntax-error-action-wildcard">Error – SCP syntax error action wildcard</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">SCP syntax error action wildcard: SCP actions can include wildcards (*) only at the end of a string. Update <span>{</span><span>{</span>action}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "SCP actions can include wildcards (*) only at the end of a string. Update <span>{</span><span>{</span>action}}."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>AWS Organizations service control policies (SCPs) support specifying values in the <code class="code">Action</code> or <code class="code">NotAction</code> 
elements. However, these values can include wildcards (*) only at the end of the string. This means that you can specify
<code class="code">iam:Get*</code> but not <code class="code">iam:*role</code>.</p>
<p>To specify multiple actions, AWS recommends that you list them individually.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
       
         
         
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_syntax.html#scp-syntax-action">SCP Action and NotAction elements</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_strategies.html">Strategies for using SCPs</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html">AWS Organizations service control policies</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_action.html">IAM JSON policy elements: Action</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-scp-syntax-error-allow-condition">Error – SCP syntax error allow condition</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">SCP syntax error allow condition: SCPs do not support the Condition element with effect Allow. Update the element Condition or the effect.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "SCPs do not support the Condition element with effect Allow. Update the element Condition or the effect."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>AWS Organizations service control policies (SCPs) support specifying values in the <code class="code">Condition</code> element only when you use 
<code class="code">"Effect": "Deny"</code>.</p>
<p>To allow only a single action, you can deny access to everything except the condition that you specify using the 
<code class="code">...NotEquals</code> version of a condition operator. This negates the comparison made by the operator.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
      
         
         
        
        
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_syntax.html#scp-syntax-condition">SCP Condition element</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_strategies.html">Strategies for using SCPs</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html">AWS Organizations service control policies</a></p></li><li class="listitem"><p><a href="./reference_policies_examples_aws_deny-requested-region.html">Example policy: Denies access to AWS based on the requested Region</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html">IAM JSON policy elements: Condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">IAM JSON policy elements: Condition</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-scp-syntax-error-allow-notaction">Error – SCP syntax error allow NotAction</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">SCP syntax error allow NotAction: SCPs do not support NotAction with effect Allow. Update the element NotAction or the effect.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "SCPs do not support NotAction with effect Allow. Update the element NotAction or the effect."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>AWS Organizations service control policies (SCPs) do not support using the <code class="code">NotAction</code> element with <code class="code">"Effect": "Allow"</code>.</p>
<p>You must rewrite the logic to allow a list of actions, or to deny every action that is not listed.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
       
         
         
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_syntax.html#scp-syntax-action">SCP Action and NotAction elements</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_strategies.html">Strategies for using SCPs</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html">AWS Organizations service control policies</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_action.html">IAM JSON policy elements: Action</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-scp-syntax-error-allow-resource">Error – SCP syntax error allow resource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">SCP syntax error allow resource: SCPs do not support Resource with effect Allow. Update the element Resource or the effect.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "SCPs do not support Resource with effect Allow. Update the element Resource or the effect."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>AWS Organizations service control policies (SCPs) support specifying values in the <code class="code">Resource</code> element only when you use 
<code class="code">"Effect": "Deny"</code>.</p>
<p>You must rewrite the logic to allow all resources, or to deny every resource that is listed.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
      
         
       
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_syntax.html#scp-syntax-resource">SCP Resource element</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_strategies.html">Strategies for using SCPs</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html">AWS Organizations service control policies</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-scp-syntax-error-notresource">Error – SCP syntax error NotResource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">SCP syntax error NotResource: SCPs do not support the NotResource element. Update the policy to use Resource instead.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "SCPs do not support the NotResource element. Update the policy to use Resource instead."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>AWS Organizations service control policies (SCPs) do not support the <code class="code">NotResource</code> element.</p>
<p>You must rewrite the logic to allow all resources, or to deny every resource that is listed.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
      
         
       
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_syntax.html#scp-syntax-resource">SCP Resource element</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_strategies.html">Strategies for using SCPs</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html">AWS Organizations service control policies</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-scp-syntax-error-principal">Error – SCP syntax error principal</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">SCP syntax error principal: SCPs do not support specifying principals. Remove the Principal or NotPrincipal element.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "SCPs do not support specifying principals. Remove the Principal or NotPrincipal element."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>AWS Organizations service control policies (SCPs) do not support the <code class="code">Principal</code> or <code class="code">NotPrincipal</code> elements.</p>
<p>You can specify the Amazon Resource Name (ARN) using the <code class="code">aws:PrincipalArn</code> global condition key in the <code class="code">Condition</code> element.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
      
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps_syntax.html">SCP syntax</a></p></li><li class="listitem"><p><a href="./reference_policies_condition-keys.html#condition-keys-principalarn">Global condition keys for principals</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-unique-sids-required">Error – Unique Sids required</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Unique Sids required: Duplicate statement IDs are not supported for this policy type. Update the Sid value.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Duplicate statement IDs are not supported for this policy type. Update the Sid value."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>For some policy types, statement IDs must be unique. The <code class="code">Sid</code> (statement ID) element allows you to enter an optional identifier that 
you provide for the policy statement. You can assign a statement ID value to each statement in a statement array using the <code class="code">SID</code> element. In services that let you specify an ID element, 
such as SQS and SNS, the <code class="code">Sid</code> value is just a sub-ID of the policy document's ID. For example, in IAM, the <code class="code">Sid</code> value must be unique within a JSON policy.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">  
      
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_sid.html">IAM JSON policy elements: Sid</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-unsupported-action-in-policy">Error – Unsupported action in policy</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Unsupported action in policy: The action <span>{</span><span>{</span>action}} is not supported for the resource-based policy attached to the resource type <span>{</span><span>{</span>resourceType}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The action <span>{</span><span>{</span>action}} is not supported for the resource-based policy attached to the resource type <span>{</span><span>{</span>resourceType}}."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Some actions aren't supported in the <code class="code">Action</code> element in the
            resource-based policy attached to a different resource type. For example, AWS Key Management Service actions
            aren't supported in Amazon S3 bucket policies. Specify an action that is supported by
            resource type attached to your resource-based
        policy.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">    
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_action.html">JSON policy elements: Action</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-unsupported-element-combination">Error – Unsupported element combination</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Unsupported element combination: The policy elements $<span>{</span>element1} and $<span>{</span>element2} can not be used in the same statement. Remove one of these elements.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The policy elements $<span>{</span>element1} and $<span>{</span>element2} can not be used in the same statement. Remove one of these elements."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Some combinations of JSON policy elements can't be used together. For example, you cannot use both <code class="code">Action</code> and <code class="code">NotAction</code> 
in the same policy statement. Other pairs that are mutually exclusive include <code class="code">Principal/NotPrincipal</code> and <code class="code">Resource/NotResource</code>.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements.html">IAM JSON policy elements reference</a></p></li><li class="listitem"><p><a href="./access_policies.html#access_policies-json">Overview of JSON policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-unsupported-global-condition-key">Error – Unsupported global condition key</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Unsupported global condition key: The condition key aws:ARN is not supported. Use aws:PrincipalArn or aws:SourceArn instead.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The condition key aws:ARN is not supported. Use aws:PrincipalArn or aws:SourceArn instead."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>AWS does not support using the specified global condition key. Depending on your use case, you can use the <code class="code">aws:PrincipalArn</code> or <code class="code">aws:SourceArn</code>
global condition keys. For example, instead of <code class="code">aws:ARN</code>, use the <code class="code">aws:PrincipalArn</code> to compare the Amazon Resource Name (ARN) of the principal that 
made the request with the ARN that you specify in the policy. Alternatively, use the <code class="code">aws:SourceArn</code> global condition key to compare the Amazon Resource 
Name (ARN) of the resource making a service-to-service request with the ARN that you specify in the policy.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_condition-keys.html">AWS global condition context keys</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-unsupported-principal">Error – Unsupported principal</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Unsupported principal: The policy type $<span>{</span>policy_type} does not support the Principal element. Remove the Principal element.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The policy type $<span>{</span>policy_type} does not support the Principal element. Remove the Principal element."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The <code class="code">Principal</code> element specifies the principal that is allowed or denied access to a resource. You cannot use the <code class="code">Principal</code> element in an IAM identity-based 
policy. You can use it in the trust policies for IAM roles and in resource-based policies. Resource-based policies are policies that you embed directly in a resource. For example, 
you can embed policies in an Amazon S3 bucket or an AWS KMS key.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_principal.html">AWS JSON policy elements: Principal</a></p></li><li class="listitem"><p><a href="./id_roles_compare-resource-policies.html">How IAM roles differ from resource-based policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-unsupported-resource-arn-in-policy">Error – Unsupported resource ARN in policy</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Unsupported resource ARN in policy: The resource ARN is not supported for the resource-based policy attached to the resource type <span>{</span><span>{</span>resourceType}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The resource ARN is not supported for the resource-based policy attached to the resource type <span>{</span><span>{</span>resourceType}}."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Some resource ARNs aren't supported in the <code class="code">Resource</code> element of the
            resource-based policy when the policy is attached to a different resource type. For example, AWS KMS ARNs
            aren't supported in the <code class="code">Resource</code> element for Amazon S3 bucket policies. Specify a
            resource ARN that is supported by a resource type attached to your resource-based
            policy.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_action.html">JSON policy elements: Action</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-unsupported-sid">Error
                – Unsupported Sid</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Unsupported Sid: Update the characters in the Sid element to use one of the following character types: [a-z, A-Z, 0-9]</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Update the characters in the Sid element to use one of the following character types: [a-z, A-Z, 0-9]"</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The <code class="code">Sid</code> element supports uppercase letters, lowercase letters, and numbers.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
      
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_sid.html">IAM JSON policy elements: Sid</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-unsupported-wildcard-in-principal">Error – Unsupported wildcard in principal</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Unsupported wildcard in principal: Wildcards (*, ?) are not supported with the principal key <span>{</span><span>{</span>principal_key}}. Replace the wildcard with a valid principal value.</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Wildcards (*, ?) are not supported with the principal key <span>{</span><span>{</span>principal_key}}. Replace the wildcard with a valid principal value."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The <code class="code">Principal</code> element structure supports using a key-value pair. The principal value specified in the policy includes a wildcard (*). 
You can't include a wildcard with the principal key that you specified. For example, when you specify users in a <code class="code">Principal</code> element, you 
cannot use a wildcard to mean "all users". You must name a specific user or users. Similarly, when you specify an assumed-role session, 
you cannot use a wildcard to mean "all sessions". You must name a specific session. You also cannot use a wildcard to match part of a name or an ARN.</p>
<p>To resolve this finding, remove the wildcard and provide a more specific principal.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_principal.html">AWS JSON policy elements: Principal</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-missing-brace-in-variable">Error – Missing brace in variable</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing brace in variable: The policy variable is missing a closing curly brace. Add } after the variable text.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The policy variable is missing a closing curly brace. Add } after the variable text."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Policy variable structure supports using a <code class="code">$</code> prefix followed by a pair of curly braces (<code class="code"><span>{</span> }</code>). Inside the <code class="code">$<span>{</span> }</code> characters, 
include the name of the value from the request that you want to use in the policy.</p>
<p>To resolve this finding, add the missing brace to make sure the full opening and closing set of braces is present.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_variables.html">IAM policy elements: Variables</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-missing-quote-in-variable">Error – Missing quote in variable</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing quote in variable: The policy variable default value must begin and end with a single quote. Add the missing quote.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The policy variable default value must begin and end with a single quote. Add the missing quote."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>When you add a variable to your policy, you can specify a default value for the variable.
      If a variable is not present, AWS uses the default text that you provide.</p>
    <p>To add a default value to a variable, surround the default value with single quotes
        (<code class="code">' '</code>), and separate the variable text and the default value with a
      comma and space (<code class="code">, </code>).</p>
    <p>For example, if a principal is tagged with <code class="code">team=yellow</code>, they can access the
        <code class="code"><code class="replaceable">DOC-EXAMPLE-BUCKET</code></code> Amazon S3 bucket with the name
        <code class="code"><code class="replaceable">DOC-EXAMPLE-BUCKET</code>-yellow</code>. A policy with this resource might allow team
      members to access their own resources, but not those of other teams. For users without team
      tags, you might set a default value of <code class="code">company-wide</code>. These users can access only
      the <code class="code"><code class="replaceable">DOC-EXAMPLE-BUCKET</code>-company-wide</code> bucket where they can view broad
      information, such as instructions for joining a team.</p>
<pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"Resource":"arn:aws:s3:::<code class="replaceable"><code class="replaceable">DOC-EXAMPLE-BUCKET</code>-</code>$<span>{</span>aws:PrincipalTag/team, '<code class="replaceable">company-wide</code>'}"</code></pre>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_variables.html">IAM policy elements: Variables</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-unsupported-space-in-variable">Error – Unsupported space in variable</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Unsupported space in variable: A space is not supported within the policy variable text. Remove the space.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "A space is not supported within the policy variable text. Remove the space."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Policy variable structure supports using a <code class="code">$</code> prefix followed by a pair of curly braces (<code class="code"><span>{</span> }</code>). Inside the <code class="code">$<span>{</span> }</code> characters, 
include the name of the value from the request that you want to use in the policy. Although you can include a space when you specify a default variable, you cannot include
a space in the variable name.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_variables.html">IAM policy elements: Variables</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-empty-variable">Error
                – Empty variable</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Empty variable: Empty policy variable. Remove the $<span>{</span> } variable structure or provide a variable within the structure.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Empty policy variable. Remove the $<span>{</span> } variable structure or provide a variable within the structure."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Policy variable structure supports using a <code class="code">$</code> prefix followed by a pair of curly braces (<code class="code"><span>{</span> }</code>). Inside the <code class="code">$<span>{</span> }</code> characters, 
include the name of the value from the request that you want to use in the policy.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_variables.html">IAM policy elements: Variables</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-variable-unsupported-in-element">Error – Variable unsupported in element</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Variable unsupported in element: Policy variables are supported in the Resource and Condition elements. Remove the policy variable <span>{</span><span>{</span>variable}} from this element.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Policy variables are supported in the Resource and Condition elements. Remove the policy variable <span>{</span><span>{</span>variable}} from this element."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>You can use policy variables in the <code class="code">Resource</code> element and in string comparisons in the <code class="code">Condition</code> element.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_variables.html">IAM policy elements: Variables</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-variable-unsupported-in-version">Error – Variable unsupported in version</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Variable unsupported in version: To include variables in your policy, use the policy version 2012-10-17 or later.</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "To include variables in your policy, use the policy version 2012-10-17 or later."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>To use policy variables, you must include the <code class="code">Version</code> element and set it to a version that supports policy variables. Variables were introduced in version 
<code class="code">2012-10-17</code>. Earlier versions of the policy language don't support policy variables. If you don't set the <code class="code">Version</code> to <code class="code">2012-10-17</code> or later, 
variables like <code class="code">$<span>{</span>aws:username}</code> are treated as literal strings in the policy.</p>
<p>A <code class="code">Version</code> policy element is different from a policy version. The <code class="code">Version</code> policy element is used within a policy and defines the version of the policy 
language. A policy version, is created when you change a customer managed policy in IAM. The changed policy doesn't overwrite the existing policy. Instead, IAM creates a new 
version of the managed policy.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_variables.html">IAM policy elements: Variables</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_version.html">IAM JSON policy elements: Version</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-private-ip-address">Error
                – Private IP address</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Private IP address: aws:SourceIp works only for public IP address ranges. The values for condition key aws:SourceIp include only private IP addresses and will not have the desired effect. Update the value to include only public IP addresses.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "aws:SourceIp works only for public IP address ranges. The values for condition key aws:SourceIp include only private IP addresses and will not have the desired effect. Update the value to include only public IP addresses."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The global condition key <code class="code">aws:SourceIp</code> works only for public IP address ranges. You receive this error when your policy allows only private IP addresses. 
In this case, the condition would never match.</p>
<div class="itemizedlist"> 
      
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_condition-keys.html#condition-keys-sourceip">aws:SourceIp global condition key</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">IAM JSON policy elements: Condition</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-private-not-ip-address">Error – Private NotIpAddress</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Private NotIpAddress: The values for condition key aws:SourceIp include only private IP addresses and has no effect. aws:SourceIp works only for public IP address ranges. Update the value to include only public IP addresses.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The values for condition key aws:SourceIp include only private IP addresses and has no effect. aws:SourceIp works only for public IP address ranges. Update the value to include only public IP addresses."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The global condition key <code class="code">aws:SourceIp</code> works only for public IP address ranges. You receive this error when you use the <code class="code">NotIpAddress</code> 
condition operator and list only private IP addresses. In this case, the condition would always match and would be ineffective.</p>
<div class="itemizedlist"> 
      
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_condition-keys.html#condition-keys-sourceip">aws:SourceIp global condition key</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">IAM JSON policy elements: Condition</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-policy-size-exceeds-scp-quota">Error – Policy size exceeds SCP quota</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Policy size exceeds SCP quota: The <span>{</span><span>{</span>policySize}} characters in the service control policy (SCP) exceed the <span>{</span><span>{</span>policySizeQuota}} character maximum for SCPs. We recommend that you use multiple granular policies.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The <span>{</span><span>{</span>policySize}} characters in the service control policy (SCP) exceed the <span>{</span><span>{</span>policySizeQuota}} character maximum for SCPs. We recommend that you use multiple granular policies."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>AWS Organizations service control policies (SCPs) support specifying values in the <code class="code">Action</code> or <code class="code">NotAction</code> 
elements. However, these values can include wildcards (*) only at the end of the string. This means that you can specify
<code class="code">iam:Get*</code> but not <code class="code">iam:*role</code>.</p>
<p>To specify multiple actions, AWS recommends that you list them individually.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
       
      
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_reference_limits.html">Quotas for AWS Organizations</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html">AWS Organizations service control policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-service-principal-format">Error – Invalid service principal format</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid service principal format: The service principal does not match the expected format. Use the format <span>{</span><span>{</span>expectedFormat}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The service principal does not match the expected format. Use the format <span>{</span><span>{</span>expectedFormat}}."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The value in the condition key-value pair must match a defined service principal format.</p>
<p>A <em>service principal</em> is an identifier that is used to grant permissions to a service. You can specify a service principal in the <code class="code">Principal</code> element or as a value for some global condition keys and service-specific keys. The service principal is defined by each service.</p>
<p>The identifier for a service principal includes the service name, and is usually in the following format in all lowercase letters:</p>
<p><code class="code"><code class="replaceable">service-name</code>.amazonaws.com</code></p>
<p>Some service-specific keys may use a different format for service principals. For example, the <code class="code">kms:ViaService</code> condition key requires the following format for service principals in all lowercase letters:</p>
<p><code class="code"><code class="replaceable">service-name.AWS_region</code>.amazonaws.com</code></p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
       
      
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_principal.html#principal-services">Service principals</a></p></li><li class="listitem"><p><a href="./reference_policies_condition-keys.html">AWS global condition keys</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/kms/latest/developerguide/policy-conditions.html#conditions-kms-via-service"><code class="code">kms:ViaService</code> condition key</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-missing-tag-key-in-condition">Error – Missing tag key in condition</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing tag key in condition: The condition key <span>{</span><span>{</span>conditionKeyName}} must include a tag key to control access based on tags. Use the format <span>{</span><span>{</span>conditionKeyName}}tag-key and specify a key name for tag-key.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The condition key <span>{</span><span>{</span>conditionKeyName}} must include a tag key to control access based on tags. Use the format <span>{</span><span>{</span>conditionKeyName}}tag-key and specify a key name for tag-key."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>To control access based on tags, you provide tag information in the <a href="./reference_policies_elements_condition.html">condition element</a> of a policy.</p>
<p>For example, to <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_tags.html#access_tags_control-resources">control access to AWS resources</a>, you include the <code class="code">aws:ResourceTag</code> condition key. This key requires the format <code class="code">aws:ResourceTag/<code class="replaceable">tag-key</code></code>. To specify the tag key <code class="code">owner</code> and the tag value <code class="code">JaneDoe</code> in a condition, use the following format.</p>
<pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"Condition": <span>{</span>
    "StringEquals": <span>{</span>"aws:ResourceTag/owner": "JaneDoe"}
}</code></pre>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./access_iam-tags.html">Controlling access using tags</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">Conditions</a></p></li><li class="listitem"><p><a href="./reference_policies_condition-keys.html">Global condition keys</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">AWS service condition keys</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-vpc-format">Error
                – Invalid vpc format</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid vpc format: The VPC identifier in the condition key value is not valid. Use the prefix 'vpc-' followed by 8 or 17 alphanumeric characters.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The VPC identifier in the condition key value is not valid. Use the prefix 'vpc-' followed by 8 or 17 alphanumeric characters."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The <code class="code">aws:SourceVpc</code> condition key must use the prefix <code class="code">vpc-</code> followed by either 8 or 17 alphanumeric characters, for example, <code class="code">vpc-11223344556677889</code> or <code class="code">vpc-12345678</code>.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">  
      
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#condition-keys-sourcevpc">AWS global condition keys: aws:SourceVpc</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-vpce-format">Error – Invalid vpce format</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid vpce format: The VPCE identifier in the condition key value is not valid.  Use the prefix 'vpce-' followed by 8 or 17 alphanumeric characters.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The VPCE identifier in the condition key value is not valid.  Use the prefix 'vpce-' followed by 8 or 17 alphanumeric characters."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The <code class="code">aws:SourceVpce</code> condition key must use the prefix <code class="code">vpce-</code> followed by either 8 or 17 alphanumeric characters, for example, <code class="code">vpce-11223344556677889</code> or <code class="code">vpce-12345678</code>.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">  
      
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#condition-keys-sourcevpce">AWS global condition keys: aws:SourceVpce</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-federated-principal-not-supported">Error – Federated principal not supported</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Federated principal not supported: The policy type does not support a federated identity provider in the principal element. Use a supported principal.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The policy type does not support a federated identity provider in the principal element. Use a supported principal."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The <code class="code">Principal</code> element uses federated principals for trust policies
            attached to IAM roles to provide access through identity federation. Identity policies
            and other resource-based policies don't support a federated identity provider in the
                <code class="code">Principal</code> element. For example, you can't use a SAML principal in an
            Amazon S3 bucket policy. Change the <code class="code">Principal</code> element to a supported principal
            type.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">    
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./id_roles_create_for-idp.html">Creating a role for identity federation</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_principal.html">JSON policy elements: Principal</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-unsupported-action-for-condition-key">Error – Unsupported action for condition key</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Unsupported action for condition key: The following actions: <span>{</span><span>{</span>actions}} are not supported by the condition key <span>{</span><span>{</span>key}}. The condition will not be evaluated for these actions. We recommend that you move these actions to a different statement without this condition key.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The following actions: <span>{</span><span>{</span>actions}} are not supported by the condition key <span>{</span><span>{</span>key}}. The condition will not be evaluated for these actions. We recommend that you move these actions to a different statement without this condition key."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Make sure that the condition key in the <code class="code">Condition</code> element of the policy
            statement applies to every action in the <code class="code">Action</code> element. To ensure that the
            actions you specify are effectively allowed or denied by your policy, you should move the unsupported actions to a different statement without the condition
            key.</p>
<div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>If the <code class="code">Action</code> element has actions with wildcards, IAM Access Analyzer doesn't evaluate those actions for this error.</p></div></div>
<p><b>Related terms</b></p>
<div class="itemizedlist">    
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_action.html">JSON policy elements: Action</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-unsupported-action-in-policy">Error – Unsupported action in policy</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Unsupported action in policy: The action <span>{</span><span>{</span>action}} is not supported for the resource-based policy attached to the resource type <span>{</span><span>{</span>resourceType}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The action <span>{</span><span>{</span>action}} is not supported for the resource-based policy attached to the resource type <span>{</span><span>{</span>resourceType}}."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Some actions aren't supported in the <code class="code">Action</code> element in the
            resource-based policy attached to a different resource type. For example, AWS Key Management Service actions
            aren't supported in Amazon S3 bucket policies. Specify an action that is supported by
            resource type attached to your resource-based
        policy.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">    
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_action.html">JSON policy elements: Action</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-unsupported-resource-arn-in-policy">Error – Unsupported resource ARN in policy</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Unsupported resource ARN in policy: The resource ARN is not supported for the resource-based policy attached to the resource type <span>{</span><span>{</span>resourceType}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The resource ARN is not supported for the resource-based policy attached to the resource type <span>{</span><span>{</span>resourceType}}."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>Some resource ARNs aren't supported in the <code class="code">Resource</code> element of the
            resource-based policy when the policy is attached to a different resource type. For example, AWS KMS ARNs
            aren't supported in the <code class="code">Resource</code> element for Amazon S3 bucket policies. Specify a
            resource ARN that is supported by a resource type attached to your resource-based
            policy.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_action.html">JSON policy elements: Action</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-unsupported-condition-key-for-service-principal">Error – Unsupported condition key for service principal</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Unsupported condition key for service principal: The following condition keys are not supported when used with the service principal: <span>{</span><span>{</span>conditionKeys}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The following condition keys are not supported when used with the service principal: <span>{</span><span>{</span>conditionKeys}}."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>You can specify AWS services in the <code class="code">Principal</code> element of a
            resource-based policy using a <em>service principal</em>, which is an identifier for the service.
            You can't use some condition keys with certain service principals. For example, you can't use
            the <code class="code">aws:PrincipalOrgID</code> condition key with the
            service principal <code class="code">cloudfront.amazonaws.com</code>. You should
            remove condition keys that do not apply to the service principal in the
                <code class="code">Principal</code>
        element.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
      
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_principal.html#principal-services">Service principals</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_principal.html">JSON policy elements: Principal</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-role-trust-policy-syntax-error-notprincipal">Error – Role trust policy syntax error notprincipal</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Role trust policy syntax error notprincipal: Role trust policies do not support NotPrincipal. Update the policy to use a Principal element instead.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Role trust policies do not support NotPrincipal. Update the policy to use a Principal element instead."</code></pre>
        <p><b>Resolving the error</b></p>
         
<p>A role trust policy is a resource-based policy that is attached to an IAM role. Trust policies define which principal entities (accounts, users, roles, and federated users) can assume the role.
    Role trust policies do not support <code class="code">NotPrincipal</code>. Update the policy to use a <code class="code">Principal</code> element instead.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_principal.html">JSON policy elements: Principal</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notprincipal.html">JSON policy elements: NotPrincipal</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-role-trust-policy-unsupported-wildcard-in-principal">Error – Role trust policy unsupported wildcard in principal</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Role trust policy unsupported wildcard in principal: "Principal:" "*" is not supported in the principal element of a role trust policy. Replace the wildcard with a valid principal value.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": ""Principal:" "*" is not supported in the principal element of a role trust policy. Replace the wildcard with a valid principal value."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>A role trust policy is a resource-based policy that is attached to an IAM role. Trust policies define which principal entities (accounts, users, roles, and federated users) can assume the role.
<code class="code">"Principal:" "*"</code> is not supported in the <code class="code">Principal</code> element of a role
            trust policy. Replace the wildcard with a valid principal value.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_principal.html">JSON policy elements: Principal</a></p>
    </li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-role-trust-policy-syntax-error-resource">Error – Role trust policy syntax error resource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Role trust policy syntax error resource: Role trust policies apply to the role that they are attached to. You cannot specify a resource. Remove the Resource or NotResource element.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Role trust policies apply to the role that they are attached to. You cannot specify a resource. Remove the Resource or NotResource element."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>A role trust policy is a resource-based policy that is attached to an IAM role. Trust policies define which principal entities (accounts, users, roles, and federated users) can assume the role.
    Role trust policies apply to the role that they are attached to. You cannot specify a <code class="code">Resource</code> or <code class="code">NotResource</code> element in a role trust policy. Remove the <code class="code">Resource</code> or <code class="code">NotResource</code> element.</p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_resource.html">JSON policy elements: Resource</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notresource.html">JSON policy elements: NotResource</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-missing-action-for-condition-key">Error – Missing action for condition key</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing action for condition key: The <span>{</span><span>{</span>actionName}} action must be in the action block to allow setting values for the condition key <span>{</span><span>{</span>keyName}}. Add <span>{</span><span>{</span>actionName}} to the action block.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The <span>{</span><span>{</span>actionName}} action must be in the action block to allow setting values for the condition key <span>{</span><span>{</span>keyName}}. Add <span>{</span><span>{</span>actionName}} to the action block."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The condition key in the <code class="code">Condition</code> element of the policy
            statement is not evaluated unless the specified action is in the <code class="code">Action</code> element. To ensure that the
            condition keys you specify are effectively allowed or denied by your policy, add the action to the <code class="code">Action</code> element.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem">
        <p><a href="./reference_policies_elements_action.html">JSON policy elements: Action</a></p>
    </li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-invalid-federated-principal-syntax-in-role-trust-policy">Error – Invalid federated principal syntax in role trust policy</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid federated principal syntax in role trust policy: The principal value specifies a federated principal that does not match the expected format. Update the federated principal to a domain name or a SAML metadata ARN.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The principal value specifies a federated principal that does not match the expected format. Update the federated principal to a domain name or a SAML metadata ARN."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The principal value specifies a federated principal that does not match the expected
            format. Update the format of the federated principal to a valid domain name or a SAML
            metadata ARN.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
       
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction_access-management.html#intro-access-roles">Federated users and roles</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-mismatched-action-for-principal">Error – Mismatched action for principal</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Mismatched action for principal: The <span>{</span><span>{</span>actionName}} action is invalid with the following principal(s): <span>{</span><span>{</span>principalNames}}. Use a SAML provider principal with the sts:AssumeRoleWithSAML action or use an OIDC provider principal with the sts:AssumeRoleWithWebIdentity action. Ensure the provider is Federated if you use either of the two options.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The <span>{</span><span>{</span>actionName}} action is invalid with the following principal(s): <span>{</span><span>{</span>principalNames}}. Use a SAML provider principal with the sts:AssumeRoleWithSAML action or use an OIDC provider principal with the sts:AssumeRoleWithWebIdentity action. Ensure the provider is Federated if you use either of the two options."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>The action specified in the <code class="code">Action</code> element of the policy
            statement is invalid with the principal specified in the <code class="code">Principal</code> element.
            For example, you can't use a SAML provider principal with the
                <code class="code">sts:AssumeRoleWithWebIdentity</code> action. You should use a SAML provider
            principal with the <code class="code">sts:AssumeRoleWithSAML</code> action or use an OIDC provider
            principal with the <code class="code">sts:AssumeRoleWithWebIdentity</code> action.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html">AssumeRoleWithSAML</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithWebIdentity.html">AssumeRoleWithWebIdentity</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-error-missing-action-for-roles-anywhere-trust-policy">Error – Missing action for roles anywhere trust policy</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing action for roles anywhere trust policy: The rolesanywhere.amazonaws.com service principal requires the sts:AssumeRole, sts:SetSourceIdentity, and sts:TagSession permissions to assume a role. Add the missing permissions to the policy.</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The rolesanywhere.amazonaws.com service principal requires the sts:AssumeRole, sts:SetSourceIdentity, and sts:TagSession permissions to assume a role. Add the missing permissions to the policy."</code></pre>
        <p><b>Resolving the error</b></p>
        
<p>For IAM Roles Anywhere to be able to assume a role and deliver temporary AWS
            credentials, the role must trust the IAM Roles Anywhere service principal. The IAM
            Roles Anywhere service principal requires the <code class="code">sts:AssumeRole</code>,
                <code class="code">sts:SetSourceIdentity</code>, and <code class="code">sts:TagSession</code> permissions to
            assume a role. If any of the permissions are missing, you must add them to your
            policy.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/rolesanywhere/latest/userguide/trust-model.html">Trust model in AWS Identity and Access Management Roles Anywhere</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-create-slr-with-not-resource">General Warning – Create SLR with NotResource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Create SLR with NotResource: Using the iam:CreateServiceLinkedRole action with NotResource can allow creation of unintended service-linked roles for multiple resources. We recommend that you specify resource ARNs instead.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using the iam:CreateServiceLinkedRole action with NotResource can allow creation of unintended service-linked roles for multiple resources. We recommend that you specify resource ARNs instead."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>The action <code class="code">iam:CreateServiceLinkedRole</code> grants permission to create an IAM role that allows an AWS service to perform actions on your behalf. 
Using <code class="code">iam:CreateServiceLinkedRole</code> in a policy with the <code class="code">NotResource</code> element can allow creating unintended service-linked roles for multiple resources. 
AWS recommends that you specify allowed ARNs in the <code class="code">Resource</code> element instead.</p>
<div class="itemizedlist">
       
      
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreateServiceLinkedRole.html">CreateServiceLinkedRole operation</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notresource.html">IAM JSON policy elements: NotResource</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-create-slr-with-star-in-action-and-not-resource">General Warning – Create SLR with star in action and NotResource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Create SLR with star in action and NotResource: Using an action with a wildcard(*) and NotResource can allow creation of unintended service-linked roles because it can allow iam:CreateServiceLinkedRole permissions on multiple resources. We recommend that you specify resource ARNs instead.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using an action with a wildcard(*) and NotResource can allow creation of unintended service-linked roles because it can allow iam:CreateServiceLinkedRole permissions on multiple resources. We recommend that you specify resource ARNs instead."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>The action <code class="code">iam:CreateServiceLinkedRole</code> grants permission to create an IAM role that allows an AWS service to perform actions on your behalf. Policies
with a wildcard (*) in the <code class="code">Action</code> and that include the <code class="code">NotResource</code> element can allow creation of unintended service-linked roles for multiple resources. 
AWS recommends that you specify allowed ARNs in the <code class="code">Resource</code> element instead.</p>
<div class="itemizedlist">
       
      
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreateServiceLinkedRole.html">CreateServiceLinkedRole operation</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notresource.html">IAM JSON policy elements: NotResource</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-create-slr-with-not-action-and-not-resource">General Warning – Create SLR with NotAction and NotResource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Create SLR with NotAction and NotResource: Using NotAction with NotResource can allow creation of unintended service-linked roles because it allows iam:CreateServiceLinkedRole permissions on multiple resources. We recommend that you specify resource ARNs instead.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using NotAction with NotResource can allow creation of unintended service-linked roles because it allows iam:CreateServiceLinkedRole permissions on multiple resources. We recommend that you specify resource ARNs instead."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>The action <code class="code">iam:CreateServiceLinkedRole</code> grants permission to create an IAM role that allows an AWS service to perform actions on your behalf. 
Using the <code class="code">NotAction</code> element with the <code class="code">NotResource</code> element can allow creating unintended service-linked roles for multiple resources. 
AWS recommends that you rewrite the policy to allow <code class="code">iam:CreateServiceLinkedRole</code> on a limited list of ARNs in the <code class="code">Resource</code> element instead. 
You can also add <code class="code">iam:CreateServiceLinkedRole</code> to the <code class="code">NotAction</code> element.</p>
<div class="itemizedlist">
      
     
     
      
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreateServiceLinkedRole.html">CreateServiceLinkedRole operation</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notaction.html">IAM JSON policy elements: NotAction</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_action.html">IAM JSON policy elements: Action</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notresource.html">IAM JSON policy elements: NotResource</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-create-slr-with-star-in-resource">General Warning – Create SLR with star in resource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Create SLR with star in resource: Using the iam:CreateServiceLinkedRole action with wildcards (*) in the resource can allow creation of unintended service-linked roles. We recommend that you specify resource ARNs instead.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using the iam:CreateServiceLinkedRole action with wildcards (*) in the resource can allow creation of unintended service-linked roles. We recommend that you specify resource ARNs instead."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>The action <code class="code">iam:CreateServiceLinkedRole</code> grants permission to create an IAM role that allows an AWS service to perform actions on your behalf. 
Using <code class="code">iam:CreateServiceLinkedRole</code> in a policy with a wildcard (*) in the <code class="code">Resource</code> element can allow creating unintended service-linked roles for multiple resources. 
AWS recommends that you specify allowed ARNs in the <code class="code">Resource</code> element instead.</p>
<div class="itemizedlist">
       
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreateServiceLinkedRole.html">CreateServiceLinkedRole operation</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>


 
    <h3 id="accan-ref-policy-check-message-fix-general-warning-create-slr-with-star-in-resource-awsmanpol">AWS managed policies with this general warning</h3>
    <p><a href="./access_policies_managed-vs-inline.html#aws-managed-policies">AWS managed policies</a> enable you to get started with AWS by assigning permissions 
    based on general AWS use cases.</p>
    <p>Some of those use cases are for power users within your account. The following AWS managed policies provide power user access and grant permissions to create 
    <a href="./using-service-linked-roles.html">service-linked roles</a> for any AWS service. AWS recommends that you attach the following AWS managed policies to 
    only IAM identities that you consider power users.</p>
    <div class="itemizedlist">
           
           
           
    <ul class="itemizedlist"><li class="listitem"><p><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/PowerUserAccess" rel="noopener noreferrer" target="_blank"><span>PowerUserAccess</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li><li class="listitem"><p><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/AlexaForBusinessFullAccess" rel="noopener noreferrer" target="_blank"><span>AlexaForBusinessFullAccess</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li><li class="listitem"><p><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/AWSOrganizationsServiceTrustPolicy" rel="noopener noreferrer" target="_blank"><span>AWSOrganizationsServiceTrustPolicy</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> 
        – This AWS managed policy provides permissions for use by the AWS Organizations service-linked role. This role allows Organizations to create additional service-linked roles
        for other services in your AWS organization.</p></li></ul></div>
 

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-create-slr-with-star-in-action-and-resource">General Warning – Create SLR with star in action and resource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Create SLR with star in action and resource: Using wildcards (*) in the action and the resource can allow creation of unintended service-linked roles because it allows iam:CreateServiceLinkedRole permissions on all resources. We recommend that you specify resource ARNs instead.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using wildcards (*) in the action and the resource can allow creation of unintended service-linked roles because it allows iam:CreateServiceLinkedRole permissions on all resources. We recommend that you specify resource ARNs instead."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>The action <code class="code">iam:CreateServiceLinkedRole</code> grants permission to create an IAM role that allows an AWS service to perform actions on your behalf. Policies
with a wildcard (*) in the <code class="code">Action</code> and <code class="code">Resource</code> elements can allow creating unintended service-linked roles for multiple resources. This allows 
creating a service-linked role when you specify <code class="code">"Action": "*"</code>, <code class="code">"Action": "iam:*"</code>, or <code class="code">"Action": "iam:Create*"</code>. AWS recommends that you 
specify allowed ARNs in the <code class="code">Resource</code> element instead.</p>
<div class="itemizedlist">
      
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreateServiceLinkedRole.html">CreateServiceLinkedRole operation</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_action.html">IAM JSON policy elements: Action</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>

 
    <h3 id="accan-ref-policy-check-message-fix-general-warning-create-slr-with-star-in-action-and-resource-awsmanpol">AWS managed policies with this general warning</h3>
    <p><a href="./access_policies_managed-vs-inline.html#aws-managed-policies">AWS managed policies</a> enable you to get started with AWS by assigning permissions 
    based on general AWS use cases.</p>
    <p>Some of those use cases are for administrators within your account. The following AWS managed policies provide administrator access and grant permissions to 
    create <a href="./using-service-linked-roles.html">service-linked roles</a> for any AWS service. AWS recommends that you attach the following AWS managed policies 
    to only the IAM identities that you consider administrators.</p>
    <div class="itemizedlist">
          
           
    <ul class="itemizedlist"><li class="listitem"><p><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/AdministratorAccess" rel="noopener noreferrer" target="_blank"><span>AdministratorAccess</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li><li class="listitem"><p><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/IAMFullAccess" rel="noopener noreferrer" target="_blank"><span>IAMFullAccess</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li></ul></div>
 

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-create-slr-with-star-in-resource-and-not-action">General Warning – Create SLR with star in resource and NotAction</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Create SLR with star in resource and NotAction: Using a resource with wildcards (*) and NotAction can allow creation of unintended service-linked roles because it allows iam:CreateServiceLinkedRole permissions on all resources. We recommend that you specify resource ARNs instead.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using a resource with wildcards (*) and NotAction can allow creation of unintended service-linked roles because it allows iam:CreateServiceLinkedRole permissions on all resources. We recommend that you specify resource ARNs instead."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>The action <code class="code">iam:CreateServiceLinkedRole</code> grants permission to create an IAM role that allows an AWS service to perform actions on your behalf. 
Using the <code class="code">NotAction</code> element in a policy with a wildcard (*) in the <code class="code">Resource</code> element can allow creating unintended service-linked roles for multiple resources. 
AWS recommends that you specify allowed ARNs in the <code class="code">Resource</code> element instead. You can also add <code class="code">iam:CreateServiceLinkedRole</code> to the <code class="code">NotAction</code> element.</p>
<div class="itemizedlist">
      
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_CreateServiceLinkedRole.html">CreateServiceLinkedRole operation</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notaction.html">IAM JSON policy elements: NotAction</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_action.html">IAM JSON policy elements: Action</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-deprecated-global-condition-key">General Warning – Deprecated global condition key</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Deprecated global condition key: We recommend that you update aws:ARN to use the newer condition key aws:PrincipalArn.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "We recommend that you update aws:ARN to use the newer condition key aws:PrincipalArn."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>The policy includes a deprecated global condition key. Update the condition key in the condition key-value pair to use a supported global condition key.</p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_condition-keys.html">Global condition keys</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-invalid-date-value">General Warning – Invalid date value</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid date value: The date <span>{</span><span>{</span>date}} might not resolve as expected. We recommend that you use the YYYY-MM-DD format.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The date <span>{</span><span>{</span>date}} might not resolve as expected. We recommend that you use the YYYY-MM-DD format."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>Unix Epoch time describes a point in time that has elapsed since January 1, 1970, minus leap seconds. Epoch time might not resolve to the 
precise time that you expect. AWS recommends that you use the W3C standard for date and time formats. For example, you could specify a complete date,
such as YYYY-MM-DD (1997-07-16), or you could also append the time to the second, such as YYYY-MM-DDThh:mm:ssTZD (1997-07-16T19:20:30+01:00).</p>
<div class="itemizedlist">
       
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://www.w3.org/TR/NOTE-datetime" rel="noopener noreferrer" target="_blank"><span>W3C Date and Time Formats</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li><li class="listitem"><p><a href="./reference_policies_elements_version.html">IAM JSON policy elements: Version</a></p></li><li class="listitem"><p><a href="./reference_policies_condition-keys.html#condition-keys-currenttime">aws:CurrentTime global condition key</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-invalid-role-reference">General Warning – Invalid role reference</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid role reference: The Principal element includes the IAM role ID <span>{</span><span>{</span>roleid}}. We recommend that you use a role ARN instead.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The Principal element includes the IAM role ID <span>{</span><span>{</span>roleid}}. We recommend that you use a role ARN instead."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>AWS recommends that you specify the Amazon Resource Name (ARN) for an IAM role instead of its principal ID. When IAM saves the policy, it will transform 
the ARN into the principal ID for the existing role. AWS includes a safety precaution. If someone deletes and recreates the role, it will have a new ID, and the policy won't match the 
new role's ID. </p>
<div class="itemizedlist">
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_principal.html#principal-roles">Specifying a principal: IAM roles</a></p></li><li class="listitem"><p><a href="./reference_identifiers.html#identifiers-arns">IAM ARNs</a></p></li><li class="listitem"><p><a href="./reference_identifiers.html#identifiers-unique-ids">IAM unique IDs</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-invalid-user-reference">General Warning – Invalid user reference</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Invalid user reference: The Principal element includes the IAM user ID <span>{</span><span>{</span>userid}}. We recommend that you use a user ARN instead.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The Principal element includes the IAM user ID <span>{</span><span>{</span>userid}}. We recommend that you use a user ARN instead."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>AWS recommends that you specify the Amazon Resource Name (ARN) for an IAM user instead of its principal ID. When IAM saves the policy, it will transform 
the ARN into the principal ID for the existing user. AWS includes a safety precaution. If someone deletes and recreates the user, it will have a new ID, and the policy won't match the 
new user's ID. </p>
<div class="itemizedlist">
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_principal.html#principal-users">Specifying a principal: IAM users</a></p></li><li class="listitem"><p><a href="./reference_identifiers.html#identifiers-arns">IAM ARNs</a></p></li><li class="listitem"><p><a href="./reference_identifiers.html#identifiers-unique-ids">IAM unique IDs</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-missing-version">General Warning – Missing version</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing version: We recommend that you specify the Version element to help you with debugging permission issues.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "We recommend that you specify the Version element to help you with debugging permission issues."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>AWS recommends that you include the optional <code class="code">Version</code> parameter in your policy. If you do not include a Version element, the value defaults to <code class="code">2012-10-17</code>, but newer features, 
such as policy variables, will not work with your policy. For example, variables such as <code class="code">$<span>{</span>aws:username}</code> aren't recognized as variables and are instead treated as literal 
strings in the policy.</p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_version.html">IAM JSON policy elements: Version</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-unique-sids-recommended">General Warning – Unique Sids recommended</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Unique Sids recommended: We recommend that you use statement IDs that are unique to your policy. Update the Sid value.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "We recommend that you use statement IDs that are unique to your policy. Update the Sid value."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>AWS recommends that you use unique statement IDs. The <code class="code">Sid</code> (statement ID) element allows you to enter an optional identifier that 
you provide for the policy statement. You can assign a statement ID value to each statement in a statement array using the <code class="code">SID</code> element.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">  
      
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_sid.html">IAM JSON policy elements: Sid</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-wildcard-without-like-operator">General Warning – Wildcard without like operator</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Wildcard without like operator: Your condition value includes a * or ? character. If you meant to use a wildcard (*, ?), update the condition operator to include Like.</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Your condition value includes a * or ? character. If you meant to use a wildcard (*, ?), update the condition operator to include Like."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>The <code class="code">Condition</code> element structure requires that you use a condition operator and a key-value pair. When you specify a condition 
value that uses a wildcard (*, ?), you must use the <code class="code">Like</code> version of the condition operator. For example, instead of the 
<code class="code">StringEquals</code> string condition operator, use <code class="code">StringLike</code>.</p>
<pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"Condition": <span>{</span>"StringLike": <span>{</span>"aws:PrincipalTag/job-category": "admin-*"}}</code></pre>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html">IAM JSON policy elements: Condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">IAM JSON policy elements: Condition</a></p></li></ul></div>

 
    <h3 id="accan-ref-policy-check-message-fix-general-warning-wildcard-without-like-operator-awsmanpol">AWS managed policies with this general warning</h3>
    <p><a href="./access_policies_managed-vs-inline.html#aws-managed-policies">AWS managed policies</a> enable you to get started with AWS by assigning permissions 
    based on general AWS use cases.</p>
    <p>The following AWS managed policies include wildcards in their condition value without a condition operator that includes <code class="code">Like</code> for pattern-matching. 
    When using the AWS managed policy as a reference to create your customer managed policy, AWS recommends that you use a condition operator that supports pattern-matching 
    with wildcards (*, ?), such as <code class="code">StringLike</code>.</p>
    <div class="itemizedlist">
           
    <ul class="itemizedlist"><li class="listitem"><p><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/AWSGlueConsoleSageMakerNotebookFullAccess" rel="noopener noreferrer" target="_blank"><span>AWSGlueConsoleSageMakerNotebookFullAccess</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li></ul></div>
 

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-policy-size-exceeds-identity-policy-quota">General Warning – Policy size exceeds identity policy quota</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Policy size exceeds identity policy quota: The <span>{</span><span>{</span>policySize}} characters in the identity policy, excluding whitespace, exceed the <span>{</span><span>{</span>policySizeQuota}} character maximum for inline and managed policies. We recommend that you use multiple granular policies.</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The <span>{</span><span>{</span>policySize}} characters in the identity policy, excluding whitespace, exceed the <span>{</span><span>{</span>policySizeQuota}} character maximum for inline and managed policies. We recommend that you use multiple granular policies."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>You can attach up to 10 managed policies to an IAM identity (user, group of users, or role). However, the size of each managed policy 
cannot exceed the default quota of 6,144 characters. IAM does not count white space when calculating the size of a policy against 
this quota. Quotas, also referred to as limits in AWS, are the maximum values for the resources, actions, and items in your AWS 
account.</p>
<p>Additionally, you can add as many inline policies as you want to an IAM identity. However, the sum size 
of all inline policies per identity cannot exceed the specified quota.</p>
<p>If your policy is larger than the quota, you can organize your policy into multiple statements and group the statements into multiple
policies.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">   
      
      
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_iam-quotas.html">IAM and AWS STS character quotas</a></p></li><li class="listitem"><p><a href="./access_policies.html#policies-syntax-multiples">Multiple statements and multiple policies</a></p></li><li class="listitem"><p><a href="./access_policies_managed-vs-inline.html#customer-managed-policies">IAM customer managed policies</a></p></li><li class="listitem"><p><a href="./access_policies.html#access_policies-json">Overview of JSON policies</a></p></li><li class="listitem"><p><a href="./reference_policies_grammar.html">IAM JSON policy grammar</a></p></li></ul></div>


 
    <h3 id="accan-ref-policy-check-message-fix-general-warning-policy-size-exceeds-identity-policy-quota-awsmanpol">AWS managed policies with this general warning</h3>
    <p><a href="./access_policies_managed-vs-inline.html#aws-managed-policies">AWS managed policies</a> enable you to get started with AWS by assigning permissions 
    based on general AWS use cases.</p>
    <p>The following AWS managed policies grant permissions to actions across many AWS services and exceed the maximum policy size. When using the 
    AWS managed policy as a reference to create your managed policy, you must split the policy into multiple policies.</p>
    <div class="itemizedlist">
           
           
    <ul class="itemizedlist"><li class="listitem"><p><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/ReadOnlyAccess" rel="noopener noreferrer" target="_blank"><span>ReadOnlyAccess</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li><li class="listitem"><p><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/AWSSupportServiceRolePolicy" rel="noopener noreferrer" target="_blank"><span>AWSSupportServiceRolePolicy</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li></ul></div>
 

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-policy-size-exceeds-resource-policy-quota">General Warning – Policy size exceeds resource policy quota</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Policy size exceeds resource policy quota: The <span>{</span><span>{</span>policySize}} characters in the resource policy exceed the <span>{</span><span>{</span>policySizeQuota}} character maximum for resource policies. We recommend that you use multiple granular policies.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The <span>{</span><span>{</span>policySize}} characters in the resource policy exceed the <span>{</span><span>{</span>policySizeQuota}} character maximum for resource policies. We recommend that you use multiple granular policies."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>Resource-based policies are JSON policy documents that you attach to a resource, such as an Amazon S3 bucket. These policies grant 
the specified principal permission to perform specific actions on that resource and define under what conditions this applies. 
The size of resource-based policies cannot exceed the quota set for that resource. Quotas, also referred to as limits in AWS, 
are the maximum values for the resources, actions, and items in your AWS account.</p>
<p>If your policy is larger than the quota, you can organize your policy into multiple statements and group the statements into multiple
policies.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">   
     
      
      
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./access_policies.html#policies_resource-based">Resource-based policies</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-policies.html">Amazon S3 bucket policies</a></p></li><li class="listitem"><p><a href="./access_policies.html#policies-syntax-multiples">Multiple statements and multiple policies</a></p></li><li class="listitem"><p><a href="./access_policies.html#access_policies-json">Overview of JSON policies</a></p></li><li class="listitem"><p><a href="./reference_policies_grammar.html">IAM JSON policy grammar</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-type-mismatch">General Warning – Type mismatch</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Type mismatch: Use the operator type <span>{</span><span>{</span>allowed}} instead of operator <span>{</span><span>{</span>operator}} for the condition key <span>{</span><span>{</span>key}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Use the operator type <span>{</span><span>{</span>allowed}} instead of operator <span>{</span><span>{</span>operator}} for the condition key <span>{</span><span>{</span>key}}."</code></pre>
        <p><b>Resolving the general warning</b></p>
           
<p>Update the text to use the supported condition operator data type.</p>
<p>For example, the <code class="code">aws:MultiFactorAuthPresent</code> global condition key requires a condition operator with the <code class="code">Boolean</code> data type. If you provide a date or an integer, the 
data type won't match.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">  
     
      
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_condition-keys.html">Global condition keys</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html">IAM JSON policy elements: Condition operators</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-type-mismatch-boolean">General Warning – Type mismatch Boolean</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Type mismatch Boolean: Add a valid Boolean value (true or false) for the condition operator <span>{</span><span>{</span>operator}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Add a valid Boolean value (true or false) for the condition operator <span>{</span><span>{</span>operator}}."</code></pre>
        <p><b>Resolving the general warning</b></p>
            
<p>Update the text to use a Boolean condition operator data type, such as <code class="code">true</code> or <code class="code">false</code>.</p>
<p>For example, the <code class="code">aws:MultiFactorAuthPresent</code> global condition key requires a condition operator with the <code class="code">Boolean</code> data type. If you provide a date or an integer, the 
data type won't match.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">  
     
      
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html#Conditions_Boolean">Boolean condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html">IAM JSON policy elements: Condition operators</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-type-mismatch-date">General Warning – Type mismatch date</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Type mismatch date: The date condition operator is used with an invalid value. Specify a valid date using YYYY-MM-DD or other ISO 8601 date/time format.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The date condition operator is used with an invalid value. Specify a valid date using YYYY-MM-DD or other ISO 8601 date/time format."</code></pre>
        <p><b>Resolving the general warning</b></p>
           
<p>Update the text to use the date condition operator data type, in a <code class="code">YYYY-MM-DD</code> or other ISO 8601 date time format.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">  
     
      
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html#Conditions_Date">Date condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html">IAM JSON policy elements: Condition operators</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-type-mismatch-ip-range">General Warning – Type mismatch IP range</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Type mismatch IP range: The condition operator <span>{</span><span>{</span>operator}} is used with an invalid IP range value. Specify the IP range in standard CIDR format.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The condition operator <span>{</span><span>{</span>operator}} is used with an invalid IP range value. Specify the IP range in standard CIDR format."</code></pre>
        <p><b>Resolving the general warning</b></p>
           
<p>Update the text to use the IP address condition operator data type, in a CIDR format.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">  
     
      
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html#Conditions_IPAddress">IP address condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html">IAM JSON policy elements: Condition operators</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-type-mismatch-number">General Warning – Type mismatch number</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Type mismatch number: Add a valid numeric value for the condition operator <span>{</span><span>{</span>operator}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Add a valid numeric value for the condition operator <span>{</span><span>{</span>operator}}."</code></pre>
        <p><b>Resolving the general warning</b></p>
           
<p>Update the text to use the numeric condition operator data type.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">  
     
      
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html#Conditions_Numeric">Numeric condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html">IAM JSON policy elements: Condition operators</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-type-mismatch-string">General Warning – Type mismatch string</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Type mismatch string: Add a valid base64-encoded string value for the condition operator <span>{</span><span>{</span>operator}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Add a valid base64-encoded string value for the condition operator <span>{</span><span>{</span>operator}}."</code></pre>
        <p><b>Resolving the general warning</b></p>
           
<p>Update the text to use the string condition operator data type.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">  
     
      
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">String condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html">IAM JSON policy elements: Condition operators</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-specific-github-repo-and-branch-recommended">General Warning – Specific github repo and branch recommended</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Specific github repo and branch recommended: Using a wildcard (*) in token.actions.githubusercontent.com:sub can allow requests from more sources than you intended. Specify the value of token.actions.githubusercontent.com:sub with the repository and branch name.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using a wildcard (*) in token.actions.githubusercontent.com:sub can allow requests from more sources than you intended. Specify the value of token.actions.githubusercontent.com:sub with the repository and branch name."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>If you use GitHub as an OIDC IdP, best practice is to limit the entities that can
            assume the role associated with the IAM IdP. When you include a <code class="code">Condition</code> statement in
            a role trust policy, you can limit the role to a specific GitHub organization, repository,
            or branch. You can use the condition key <code class="code">token.actions.githubusercontent.com:sub</code> to
            limit access. We recommend that you limit the condition to a specific set of
            repositories or branches. If you use a wildcard (<code class="code">*</code>) in <code class="code">token.actions.githubusercontent.com:sub</code>, then GitHub Actions from
            organizations or repositories outside of your control are able to assume roles
            associated with the GitHub IAM IdP in your AWS account.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-idp_oidc.html#idp_oidc_Create_GitHub">Configuring a role for GitHub OIDC identity provider</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-general-warning-policy-size-exceeds-role-trust-policy-quota">General Warning – Policy size exceeds role trust policy quota</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Policy size exceeds role trust policy quota: The characters in the role trust policy, excluding whitespace, exceed the character maximum. We recommend that you request a role trust policy length quota increase using Service Quotas and AWS Support Center. If the quotas have already been increased, then you can ignore this warning.</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The characters in the role trust policy, excluding whitespace, exceed the character maximum. We recommend that you request a role trust policy length quota increase using Service Quotas and AWS Support Center. If the quotas have already been increased, then you can ignore this warning."</code></pre>
        <p><b>Resolving the general warning</b></p>
        
<p>IAM and AWS STS have quotas that limit the size of role trust policies. The characters
            in the role trust policy, excluding whitespace, exceed the character maximum. We
            recommend that you request a role trust policy length quota increase using Service Quotas and the AWS Support Center Console.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
       
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_iam-quotas.html">IAM and AWS STS quotas, name requirements, and character limits</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-security-warning-allow-with-not-principal">Security Warning – Allow with NotPrincipal</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Allow with NotPrincipal: Using Allow with NotPrincipal can be overly permissive. We recommend that you use Principal instead.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using Allow with NotPrincipal can be overly permissive. We recommend that you use Principal instead."</code></pre>
        <p><b>Resolving the security warning</b></p>
        
<p>Using <code class="code">"Effect": "Allow"</code> with the <code class="code">NotPrincipal</code> can be overly permissive. For example, this can grant permissions to anonymous principals.
AWS recommends that you specify principals that need access using the <code class="code">Principal</code> element. Alternatively, you can allow broad access and then add another 
statement that uses the <code class="code">NotPrincipal</code> element with <code class="code">“Effect”: “Deny”</code>.</p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_principal.html">AWS JSON policy elements: Principal</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notprincipal.html">AWS JSON policy elements: NotPrincipal</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-security-warning-forallvalues-with-single-valued-key">Security Warning – ForAllValues with single valued key</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">ForAllValues with single valued key: Using ForAllValues qualifier with the single-valued condition key <span>{</span><span>{</span>key}} can be overly permissive. We recommend that you remove ForAllValues:.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using ForAllValues qualifier with the single-valued condition key <span>{</span><span>{</span>key}} can be overly permissive. We recommend that you remove ForAllValues:."</code></pre>
        <p><b>Resolving the security warning</b></p>
        
<p>AWS recommends that you use the <code class="code">ForAllValues</code> only with multivalued
                conditions. The <code class="code">ForAllValues</code> set operator tests whether the value of
                every member of the request set is a subset of the condition key set. The condition
                returns true if every key value in the request matches at least one value in the
                policy. It also returns true if there are no keys in the request, or if the key
                values resolve to a null data set, such as an empty string.</p>
            <p>To learn whether a condition supports a single value or multiple values, review
                the <a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">Actions, resources, and condition keys</a> page for the service. Condition
                keys with the <code class="code">ArrayOf</code> data type prefix are multivalued condition keys.
                For example, Amazon SES supports keys with single values (<code class="code">String</code>) and the
                    <code class="code">ArrayOfString</code> multivalued data type.</p>
            <div class="itemizedlist">
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p><a href="./reference_policies_multi-value-conditions.html#reference_policies_multi-key-or-value-conditions">Using
                            multiple keys and values</a></p>
                </li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-security-warning-pass-role-with-not-resource">Security Warning – Pass role with NotResource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Pass role with NotResource: Using the iam:PassRole action with NotResource can be overly permissive because it can allow iam:PassRole permissions on multiple resources. We recommend that you specify resource ARNs instead.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using the iam:PassRole action with NotResource can be overly permissive because it can allow iam:PassRole permissions on multiple resources. We recommend that you specify resource ARNs instead."</code></pre>
        <p><b>Resolving the security warning</b></p>
        
<p>To configure many AWS services, you must pass an IAM role to the service. To allow this you must grant the <code class="code">iam:PassRole</code> 
permission to an identity (user, group of users, or role). Using <code class="code">iam:PassRole</code> in a policy with the <code class="code">NotResource</code> element 
can allow your principals to access more services or features than you intended. AWS recommends that you specify allowed ARNs in the 
<code class="code">Resource</code> element instead. Additionally, you can reduce permissions to a single service by using the <code class="code">iam:PassedToService</code> 
condition key.</p>
<div class="itemizedlist">
     
     
      
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./id_roles_use_passrole.html">Passing a role to a service</a></p></li><li class="listitem"><p><a href="./reference_policies_iam-condition-keys.html#ck_PassedToService">iam:PassedToService</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notresource.html">IAM JSON policy elements: NotResource</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-security-warning-pass-role-with-star-in-action-and-not-resource">Security Warning – Pass role with star in action and NotResource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Pass role with star in action and NotResource: Using an action with a wildcard (*) and NotResource can be overly permissive because it can allow iam:PassRole permissions on multiple resources. We recommend that you specify resource ARNs instead.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using an action with a wildcard (*) and NotResource can be overly permissive because it can allow iam:PassRole permissions on multiple resources. We recommend that you specify resource ARNs instead."</code></pre>
        <p><b>Resolving the security warning</b></p>
        
<p>To configure many AWS services, you must pass an IAM role to the service. To allow this you must grant the <code class="code">iam:PassRole</code> 
permission to an identity (user, group of users, or role). Policies with a wildcard (*) in the <code class="code">Action</code> and that include the <code class="code">NotResource</code> 
element can allow your principals to access more services or features than you intended. AWS recommends that you specify allowed ARNs in the 
<code class="code">Resource</code> element instead. Additionally, you can reduce permissions to a single service by using the
<code class="code">iam:PassedToService</code> condition key.</p>
<div class="itemizedlist">
     
     
      
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./id_roles_use_passrole.html">Passing a role to a service</a></p></li><li class="listitem"><p><a href="./reference_policies_iam-condition-keys.html#ck_PassedToService">iam:PassedToService</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notresource.html">IAM JSON policy elements: NotResource</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-security-warning-pass-role-with-not-action-and-not-resource">Security Warning – Pass role with NotAction and NotResource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Pass role with NotAction and NotResource: Using NotAction with NotResource can be overly permissive because it can allow iam:PassRole permissions on multiple resources.. We recommend that you specify resource ARNs instead.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using NotAction with NotResource can be overly permissive because it can allow iam:PassRole permissions on multiple resources.. We recommend that you specify resource ARNs instead."</code></pre>
        <p><b>Resolving the security warning</b></p>
        
<p>To configure many AWS services, you must pass an IAM role to the service. To allow this you must grant the <code class="code">iam:PassRole</code> 
permission to an identity (user, group of users, or role). Using the <code class="code">NotAction</code> element and listing some resources in the <code class="code">NotResource</code> 
element can allow your principals to access more services or features than you intended. AWS recommends that you specify allowed ARNs in the 
<code class="code">Resource</code> element instead. Additionally, you can reduce permissions to a single service by using the
<code class="code">iam:PassedToService</code> condition key.</p>
<div class="itemizedlist">
     
     
     
     
      
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./id_roles_use_passrole.html">Passing a role to a service</a></p></li><li class="listitem"><p><a href="./reference_policies_iam-condition-keys.html#ck_PassedToService">iam:PassedToService</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notaction.html">IAM JSON policy elements: NotAction</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_action.html">IAM JSON policy elements: Action</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notresource.html">IAM JSON policy elements: NotResource</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-security-warning-pass-role-with-star-in-resource">Security Warning – Pass role with star in resource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Pass role with star in resource: Using the iam:PassRole action with wildcards (*) in the resource can be overly permissive because it allows iam:PassRole permissions on multiple resources. We recommend that you specify resource ARNs or add the iam:PassedToService condition key to your statement.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using the iam:PassRole action with wildcards (*) in the resource can be overly permissive because it allows iam:PassRole permissions on multiple resources. We recommend that you specify resource ARNs or add the iam:PassedToService condition key to your statement."</code></pre>
        <p><b>Resolving the security warning</b></p>
        
<p>To configure many AWS services, you must pass an IAM role to the service. To allow this you must grant the <code class="code">iam:PassRole</code> 
permission to an identity (user, group of users, or role). Policies that allow <code class="code">iam:PassRole</code> and that include a wildcard (*) in 
the <code class="code">Resource</code> element can allow your principals to access more services or features than you intended. AWS recommends that you 
specify allowed ARNs in the <code class="code">Resource</code> element instead. Additionally, you can reduce permissions to a single service by using the
<code class="code">iam:PassedToService</code> condition key.</p>
<p>Some AWS services include their service namespace in the name of their role. This policy check takes these conventions into account 
while analyzing the policy to generate findings. For example, the following resource ARN might not generate a finding:</p>
<pre class="programlisting"><div class="code-btn-container"></div><code class="json ">arn:aws:iam::*:role/Service*</code></pre>
<div class="itemizedlist">
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./id_roles_use_passrole.html">Passing a role to a service</a></p></li><li class="listitem"><p><a href="./reference_policies_iam-condition-keys.html#ck_PassedToService">iam:PassedToService</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>
 
    <h3 id="accan-ref-policy-check-message-fix-security-warning-pass-role-with-star-in-resource-awsmanpol">AWS managed policies with this security warning</h3>
    <p><a href="./access_policies_managed-vs-inline.html#aws-managed-policies">AWS managed policies</a> enable you to get started with AWS by assigning permissions 
    based on general AWS use cases.</p>
    <p>One of those use cases is for administrators within your account. The following AWS managed policies provide
    administrator access and grant permissions to pass any IAM role to any service. AWS recommends that you attach the following AWS managed 
    policies only to IAM identities that you consider administrators.</p>
    <div class="itemizedlist">
           
    <ul class="itemizedlist"><li class="listitem"><p><a href="https://console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/AdministratorAccess-Amplify" rel="noopener noreferrer" target="_blank"><span>AdministratorAccess-Amplify</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li></ul></div>
    <p>The following AWS managed policies include permissions to <code class="code">iam:PassRole</code> with a wildcard (*) in the resource and are on a
    <a href="./access_policies_managed-deprecated.html">deprecation path</a>. For each of these policies, we updated the permission guidance, such as recommending a new AWS managed policy that 
    supports the use case. To view alternatives to these policies, see the guides for <a href="./reference_aws-services-that-work-with-iam.html">each service</a>.</p>
    <div class="itemizedlist">
           
          
          
          
          
          
          
          
           
          
         
    <ul class="itemizedlist"><li class="listitem"><p>AWSElasticBeanstalkFullAccess</p></li><li class="listitem"><p>AWSElasticBeanstalkService</p></li><li class="listitem"><p>AWSLambdaFullAccess</p></li><li class="listitem"><p>AWSLambdaReadOnlyAccess</p></li><li class="listitem"><p>AWSOpsWorksFullAccess</p></li><li class="listitem"><p>AWSOpsWorksRole</p></li><li class="listitem"><p>AWSDataPipelineRole</p></li><li class="listitem"><p>AmazonDynamoDBFullAccesswithDataPipeline</p></li><li class="listitem"><p>AmazonElasticMapReduceFullAccess</p></li><li class="listitem"><p>AmazonDynamoDBFullAccesswithDataPipeline</p></li><li class="listitem"><p>AmazonEC2ContainerServiceFullAccess</p></li></ul></div>
    <p>The following AWS managed policies provide permissions for only <a href="./using-service-linked-roles.html">service-linked roles</a>, which allow AWS services to perform actions on your behalf.
    You cannot attach these policies to your IAM identities.</p>
    <div class="itemizedlist">
           
    <ul class="itemizedlist"><li class="listitem"><p><a href="https://console.aws.amazon.com/iam/home#/policies/arn:aws:iam::aws:policy/aws-service-role/AWSServiceRoleForAmazonEKSNodegroup" rel="noopener noreferrer" target="_blank"><span>AWSServiceRoleForAmazonEKSNodegroup</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li></ul></div>
 

     
        <h2 id="access-analyzer-reference-policy-checks-security-warning-pass-role-with-star-in-action-and-resource">Security Warning – Pass role with star in action and resource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Pass role with star in action and resource: Using wildcards (*) in the action and the resource can be overly permissive because it allows iam:PassRole permissions on all resources. We recommend that you specify resource ARNs or add the iam:PassedToService condition key to your statement.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using wildcards (*) in the action and the resource can be overly permissive because it allows iam:PassRole permissions on all resources. We recommend that you specify resource ARNs or add the iam:PassedToService condition key to your statement."</code></pre>
        <p><b>Resolving the security warning</b></p>
        
<p>To configure many AWS services, you must pass an IAM role to the service. To allow this you must grant the <code class="code">iam:PassRole</code> 
permission to an identity (user, group of users, or role). Policies with a wildcard (*) in the <code class="code">Action</code> and <code class="code">Resource</code> 
elements can allow your principals to access more services or features than you intended. AWS recommends that you specify allowed ARNs in 
the <code class="code">Resource</code> element instead. Additionally, you can reduce permissions to a single service by using the
<code class="code">iam:PassedToService</code> condition key.</p>
<div class="itemizedlist">
     
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./id_roles_use_passrole.html">Passing a role to a service</a></p></li><li class="listitem"><p><a href="./reference_policies_iam-condition-keys.html#ck_PassedToService">iam:PassedToService</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_action.html">IAM JSON policy elements: Action</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>

 
    <h3 id="accan-ref-policy-check-message-fix-security-warning-pass-role-with-star-in-action-and-resource-awsmanpol">AWS managed policies with this security warning</h3>
    <p><a href="./access_policies_managed-vs-inline.html#aws-managed-policies">AWS managed policies</a> enable you to get started with AWS by assigning permissions 
    based on general AWS use cases.</p>
    <p>Some of those use cases are for administrators within your account. The following AWS managed policies provide administrator access and grant permissions to 
    pass any IAM role to any AWS service. AWS recommends that you attach the following AWS managed policies 
    to only the IAM identities that you consider administrators.</p>
    <div class="itemizedlist">
          
           
    <ul class="itemizedlist"><li class="listitem"><p><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/AdministratorAccess" rel="noopener noreferrer" target="_blank"><span>AdministratorAccess</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li><li class="listitem"><p><a href="https://console.aws.amazon.com/iam/home#policies/arn:aws:iam::aws:policy/IAMFullAccess" rel="noopener noreferrer" target="_blank"><span>IAMFullAccess</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p></li></ul></div>
 

     
        <h2 id="access-analyzer-reference-policy-checks-security-warning-pass-role-with-star-in-resource-and-not-action">Security Warning – Pass role with star in resource and NotAction</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Pass role with star in resource and NotAction: Using a resource with wildcards (*) and NotAction can be overly permissive because it allows iam:PassRole permissions on all resources. We recommend that you specify resource ARNs or add the iam:PassedToService condition key to your statement.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using a resource with wildcards (*) and NotAction can be overly permissive because it allows iam:PassRole permissions on all resources. We recommend that you specify resource ARNs or add the iam:PassedToService condition key to your statement."</code></pre>
        <p><b>Resolving the security warning</b></p>
        
<p>To configure many AWS services, you must pass an IAM role to the service. To allow this you must grant the <code class="code">iam:PassRole</code> 
permission to an identity (user, group of users, or role). Using the <code class="code">NotAction</code> element in a policy with a wildcard (*) in the 
<code class="code">Resource</code> element can allow your principals to access more services or features than you intended. AWS recommends that you specify allowed 
ARNs in the <code class="code">Resource</code> element instead. Additionally, you can reduce permissions to a single service by using the
<code class="code">iam:PassedToService</code> condition key.</p>
<div class="itemizedlist">
     
     
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./id_roles_use_passrole.html">Passing a role to a service</a></p></li><li class="listitem"><p><a href="./reference_policies_iam-condition-keys.html#ck_PassedToService">iam:PassedToService</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notaction.html">IAM JSON policy elements: NotAction</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_action.html">IAM JSON policy elements: Action</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-security-warning-missing-paired-condition-keys">Security Warning – Missing paired condition keys</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing paired condition keys: Using the condition key <span>{</span><span>{</span>conditionKeyName}} can be overly permissive without also using the following condition keys: <span>{</span><span>{</span>recommendedKeys}}. Condition keys like this one are more secure when paired with a related key. We recommend that you add the related condition keys to the same condition block.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using the condition key <span>{</span><span>{</span>conditionKeyName}} can be overly permissive without also using the following condition keys: <span>{</span><span>{</span>recommendedKeys}}. Condition keys like this one are more secure when paired with a related key. We recommend that you add the related condition keys to the same condition block."</code></pre>
        <p><b>Resolving the security warning</b></p>
        
<p>Some condition keys are more secure when paired with other related condition keys.
            AWS recommends that you include the related condition keys in the same condition block
            as the existing condition key. This makes the permissions granted through the policy
            more secure.</p>
        <p>For example, you can use the <code class="code">aws:VpcSourceIp</code> condition key to compare the IP address
            from which a request was made with the IP address that you specify in the policy. AWS
            recommends that you add the related <code class="code">aws:SourceVPC</code> condition key. This checks whether the
            request comes from the VPC that you specify in the policy <em>and</em> the IP address that you
            specify.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_condition-keys.html#condition-keys-vpcsourceip">aws:VpcSourceIp global condition key</a></p></li><li class="listitem"><p><a href="./reference_policies_condition-keys.html#condition-keys-sourcevpc">aws:SourceVPC global condition key</a></p></li><li class="listitem"><p><a href="./reference_policies_condition-keys.html">Global condition keys</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">Condition element</a></p></li><li class="listitem"><p><a href="./access_policies.html#access_policies-json">Overview of JSON policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-security-warning-deny-with-unsupported-tag-condition-key-for-service">Security Warning – Deny with unsupported tag condition key for
                service</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Deny with unsupported tag condition key for service: Using the effect Deny with the tag condition key <span>{</span><span>{</span>conditionKeyName}} and actions for services with the following prefixes can be overly permissive: <span>{</span><span>{</span>serviceNames}}. Actions for the listed services are not denied by this statement. We recommend that you move these actions to a different statement without this condition key.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using the effect Deny with the tag condition key <span>{</span><span>{</span>conditionKeyName}} and actions for services with the following prefixes can be overly permissive: <span>{</span><span>{</span>serviceNames}}. Actions for the listed services are not denied by this statement. We recommend that you move these actions to a different statement without this condition key."</code></pre>
        <p><b>Resolving the security warning</b></p>
        
<p>Using unsupported tag condition keys in the <code class="code">Condition</code> element of a policy
            with <code class="code">"Effect": "Deny"</code> can be overly permissive, because the condition is
            ignored for that service. AWS recommends that you remove the service actions that
            don’t support the condition key and create another statement to deny access to specific
            resources for those actions.</p>
        <p>If you use the <code class="code">aws:ResourceTag</code> condition key and it’s not supported by a
            service action, then the key is not included in the request context. In this case, the
            condition in the <code class="code">Deny</code> statement always returns <code class="code">false</code> and the
            action is never denied. This happens even if the resource is tagged correctly.</p>
        
        <p>When a service supports the <code class="code">aws:ResourceTag</code> condition key, you can use
            tags to control access to that service’s resources. This is known as <a href="./introduction_attribute-based-access-control.html">attribute-based access control
                (ABAC)</a>. Services that don’t support these keys require you to control access
            to resources using <a href="./introduction_attribute-based-access-control.html#introduction_attribute-based-access-control_compare-rbac">resource-based
                access control (RBAC)</a>.</p>
                <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Some services allow support for the <code class="code">aws:ResourceTag</code> condition key for
                a subset of their resources and actions. IAM Access Analyzer returns findings for the
                service actions that are not supported. For example, Amazon S3 supports
                    <code class="code">aws:ResourceTag</code> for a subset of its resources. To view all of the
                resource types available in Amazon S3 that support the <code class="code">aws:ResourceTag</code>
                condition key, see <a href="https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazons3.html#amazons3-resources-for-iam-policies">Resource types defined by Amazon S3</a> in the Service Authorization
                Reference.</p></div></div>
        <p>For example, assume that you want to deny access to untag delete specific resources
            that are tagged with the key-value pair <code class="code">status=Confidential</code>. Also assume
            that AWS Lambda allows you to tag and untag resources, but doesn’t support the
                <code class="code">aws:ResourceTag</code> condition key. To deny the delete actions for
            AWS App Mesh and AWS Backup if this tag is present, use the <code class="code">aws:ResourceTag</code>
            condition key. For Lambda, use a resource naming convention that includes the
                <code class="code">"Confidential"</code> prefix. Then include a separate statement that prevents
            deleting resources with that naming convention.</p>
        <pre class="programlisting"><div class="code-btn-container"></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "DenyDeleteSupported",
            "Effect": "Deny",
            "Action": [
                "appmesh:DeleteMesh", 
                "backup:DeleteBackupPlan"
                ],
            "Resource": "*",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "aws:ResourceTag/<code class="replaceable">status</code>": "<code class="replaceable">Confidential</code>"
                }
            }
        },
        <span>{</span>
            "Sid": "DenyDeleteUnsupported",
            "Effect": "Deny",
            "Action": "lambda:DeleteFunction",
            "Resource": "arn:aws:lambda:<code class="replaceable">*</code>:<code class="replaceable">123456789012</code>:function:<code class="replaceable">status-Confidential*</code>"
        }
    ]
}</code></pre>
<div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Warning</h6></div><div class="awsdocs-note-text"><p>Do not use the …<a href="./reference_policies_elements_condition_operators.html#Conditions_IfExists">IfExists</a> version of the condition operator as a workaround for
                this finding. This means "Deny the action if the key is present in the request
                context and the values match. Otherwise, deny the action." In the previous example,
                including the <code class="code">lambda:DeleteFunction</code> action in the <code class="code">DenyDeleteSupported</code> statement with the
                <code class="code">StringEqualsIfExists</code> operator always denies the action. For that action,
                the key is not present in the context, and every attempt to delete that resource type
                is denied, regardless of whether the resource is tagged.</p></div></div>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_condition-keys.html">Global condition keys</a></p></li><li class="listitem"><p><a href="./introduction_attribute-based-access-control.html#introduction_attribute-based-access-control_compare-rbac">Comparing ABAC to RBAC</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html">IAM JSON policy elements: Condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">Condition element</a></p></li><li class="listitem"><p><a href="./access_policies.html#access_policies-json">Overview of JSON policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-security-warning-deny-notaction-with-unsupported-tag-condition-key-for-service">Security Warning – Deny NotAction with unsupported tag condition key for
                service</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Deny NotAction with unsupported tag condition key for service: Using the effect Deny with NotAction and the tag condition key <span>{</span><span>{</span>conditionKeyName}} can be overly permissive because some service actions are not denied by this statement. This is because the condition key doesn't apply to some service actions. We recommend that you use Action instead of NotAction.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using the effect Deny with NotAction and the tag condition key <span>{</span><span>{</span>conditionKeyName}} can be overly permissive because some service actions are not denied by this statement. This is because the condition key doesn't apply to some service actions. We recommend that you use Action instead of NotAction."</code></pre>
        <p><b>Resolving the security warning</b></p>
        
<p>Using tag condition keys in the <code class="code">Condition</code> element of a policy with
            the element <code class="code">NotAction</code> and <code class="code">"Effect": "Deny"</code> can be overly
            permissive. The condition is ignored for service actions that don’t support the
            condition key. AWS recommends that you rewrite the logic to deny a list of
            actions.</p>
        <p>If you use the <code class="code">aws:ResourceTag</code> condition key with <code class="code">NotAction</code>,
            any new or existing service actions that don’t support the key are not denied. AWS
            recommends that you explicitly list the actions that you want to deny. IAM Access Analyzer
            returns a separate finding for listed actions that don’t support the
                <code class="code">aws:ResourceTag</code> condition key. For more information, see <a href="#access-analyzer-reference-policy-checks-security-warning-deny-with-unsupported-tag-condition-key-for-service">Security Warning – Deny with unsupported tag condition key for
                service</a>. </p>
        
        <p>When a service supports the <code class="code">aws:ResourceTag</code> condition key, you can use
            tags to control access to that service’s resources. This is known as <a href="./introduction_attribute-based-access-control.html">attribute-based access control
                (ABAC)</a>. Services that don’t support these keys require you to control access
            to resources using <a href="./introduction_attribute-based-access-control.html#introduction_attribute-based-access-control_compare-rbac">resource-based
                access control (RBAC)</a>.</p>
        <p><b>Related terms</b></p>
        <div class="itemizedlist">
             
             
             
             
             
        <ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_condition-keys.html">Global condition keys</a></p></li><li class="listitem"><p><a href="./introduction_attribute-based-access-control.html#introduction_attribute-based-access-control_compare-rbac">Comparing ABAC to RBAC</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html">IAM JSON policy elements: Condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">Condition element</a></p></li><li class="listitem"><p><a href="./access_policies.html#access_policies-json">Overview of JSON policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-security-warning-restrict-access-to-service-principal">Security Warning – Restrict access to service principal</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Restrict access to service principal: Granting access to a service principal without specifying a source is overly permissive. Use aws:SourceArn or aws:SourceAccount condition key and scope access to a specific source to grant fine-grained access.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Granting access to a service principal without specifying a source is overly permissive. Use aws:SourceArn or aws:SourceAccount condition key and scope access to a specific source to grant fine-grained access."</code></pre>
        <p><b>Resolving the security warning</b></p>
        
<p>You can specify AWS services in the <code class="code">Principal</code> element of a
            resource-based policy using a <em>service principal</em>, which is an identifier for the service.
            When granting access to a service principal to act on your behalf, restrict
            access. You can prevent overly permissive policies by using the
                <code class="code">aws:SourceAccount</code> or <code class="code">aws:SourceArn</code> condition keys to
            restrict access to a specific source, such as a specific resource ARN or AWS account.
            Restricting access helps you prevent a security issue called the <em>confused deputy problem</em>.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
       
      
      
       
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_principal.html#principal-services">Service principals</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#condition-keys-sourceaccount">AWS global condition keys: aws:SourceAccount</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#condition-keys-sourcearn">AWS global condition keys: aws:SourceArn</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/confused-deputy.html#cross-service-confused-deputy-prevention">The confused deputy problem</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-security-warning-missing-condition-key-for-oidc-principal">Security Warning – Missing condition key for oidc principal</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing condition key for oidc principal: Using an Open ID Connect principal without a condition can be overly permissive. Add condition keys with a prefix that matches your federated OIDC principals to ensure that only the intended identity provider assumes the role.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using an Open ID Connect principal without a condition can be overly permissive. Add condition keys with a prefix that matches your federated OIDC principals to ensure that only the intended identity provider assumes the role."</code></pre>
        <p><b>Resolving the security warning</b></p>
        
<p>Using an Open ID Connect principal without a condition can be overly permissive. Add
            condition keys with a prefix that matches your federated OIDC principals to ensure that
            only the intended identity provider assumes the role.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-idp_oidc.html">Creating a role for web identity or OpenID Connect Federation (console)</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-security-warning-missing-github-repo-condition-key">Security Warning – Missing github repo condition key</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Missing github repo condition key: Granting a federated GitHub principal permissions without a condition key can allow more sources to assume the role than you intended. Add the token.actions.githubusercontent.com:sub condition key and specify the branch and repository name in the value.</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Granting a federated GitHub principal permissions without a condition key can allow more sources to assume the role than you intended. Add the token.actions.githubusercontent.com:sub condition key and specify the branch and repository name in the value."</code></pre>
        <p><b>Resolving the security warning</b></p>
        
<p>If you use GitHub as an OIDC IdP, best practice is to limit the entities that can
            assume the role associated with the IAM IdP. When you include a <code class="code">Condition</code> statement in
            a role trust policy, you can limit the role to a specific GitHub organization, repository,
            or branch. You can use the condition key <code class="code">token.actions.githubusercontent.com:sub</code> to
            limit access. We recommend that you limit the condition to a specific set of
            repositories or branches. If you do not include this condition, then GitHub Actions from
            organizations or repositories outside of your control are able to assume roles
            associated with the GitHub IAM IdP in your AWS account.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-idp_oidc.html#idp_oidc_Create_GitHub">Configuring a role for GitHub OIDC identity provider</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-empty-array-action">Suggestion – Empty array action</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Empty array action: This statement includes no actions and does not affect the policy. Specify actions.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "This statement includes no actions and does not affect the policy. Specify actions."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>Statements must include either an <code class="code">Action</code> or <code class="code">NotAction</code> element that includes a set of actions. When the 
element is empty, the policy statement provides no permissions. Specify actions in the <code class="code">Action</code> element.</p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_action.html">IAM JSON policy elements: Action</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-empty-array-condition">Suggestion – Empty array condition</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Empty array condition: There are no values for the condition key <span>{</span><span>{</span>key}} and it does not affect the policy. Specify conditions.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "There are no values for the condition key <span>{</span><span>{</span>key}} and it does not affect the policy. Specify conditions."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>The optional <code class="code">Condition</code> element structure requires that you use a condition operator and a key-value pair. When the 
condition value is empty, the condition returns <code class="code">true</code> and the policy statement provides no permissions. Specify a condition value.</p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition.html">IAM JSON policy elements: Condition
</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-empty-array-condition-forallvalues">Suggestion – Empty array condition ForAllValues</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Empty array condition ForAllValues: The ForAllValues prefix with an empty condition key matches only if the key <span>{</span><span>{</span>key}} is missing from the request context. To determine if the request context is empty, we recommend that you use the Null condition operator with the value of true instead.</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The ForAllValues prefix with an empty condition key matches only if the key <span>{</span><span>{</span>key}} is missing from the request context. To determine if the request context is empty, we recommend that you use the Null condition operator with the value of true instead."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>The <code class="code">Condition</code> element structure requires that you use a condition operator and a key-value pair. The <code class="code">ForAllValues</code> 
set operator tests whether the value of every member of the request set is a subset of the condition key set. </p>
<p>When you use <code class="code">ForAllValues</code> with an empty condition key, the condition matches only if there are no keys in the request. AWS 
recommends that if you want to test whether a request context is empty, use the <code class="code">Null</code> condition operator instead.</p>
<div class="itemizedlist">
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_multi-value-conditions.html#reference_policies_multi-key-or-value-conditions">Using multiple keys and values</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html#Conditions_Null">Null condition operator</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">IAM JSON policy elements: Condition</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-empty-array-condition-foranyvalue">Suggestion – Empty array condition ForAnyValue</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Empty array condition ForAnyValue: The ForAnyValue prefix with an empty condition key <span>{</span><span>{</span>key}} never matches the request context and it does not affect the policy. Specify conditions.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The ForAnyValue prefix with an empty condition key <span>{</span><span>{</span>key}} never matches the request context and it does not affect the policy. Specify conditions."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>The <code class="code">Condition</code> element structure requires that you use a condition operator and a key-value pair. The <code class="code">ForAnyValues</code> 
set operator tests whether at least one member of the set of request values matches at least one member of the set of condition key values.</p>
<p>When you use <code class="code">ForAnyValues</code> with an empty condition key, the condition never matches. This means that the statement has no effect 
on the policy. AWS recommends that you rewrite the condition.</p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_multi-value-conditions.html#reference_policies_multi-key-or-value-conditions">Using multiple keys and values</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">IAM JSON policy elements: Condition</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-empty-array-condition-ifexists">Suggestion – Empty array condition IfExists</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Empty array condition IfExists: The IfExists suffix with an empty condition key matches only if the key <span>{</span><span>{</span>key}} is missing from the request context. To determine if the request context is empty, we recommend that you use the Null condition operator with the value of true instead.</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The IfExists suffix with an empty condition key matches only if the key <span>{</span><span>{</span>key}} is missing from the request context. To determine if the request context is empty, we recommend that you use the Null condition operator with the value of true instead."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>The <code class="code">...IfExists</code> suffix edits a condition operator. It means that if the policy key is present in the context of the request, process the key as specified 
in the policy. If the key is not present, evaluate the condition element as true.</p>
<p>When you use <code class="code">...IfExists</code> with an empty condition key, the condition matches only if there are no keys in the request. AWS 
recommends that if you want to test whether a request context is empty, use the <code class="code">Null</code> condition operator instead.</p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html#Conditions_IfExists">...IfExists condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">IAM JSON policy elements: Condition</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-empty-array-principal">Suggestion – Empty array principal</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Empty array principal: This statement includes no principals and does not affect the policy. Specify principals.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "This statement includes no principals and does not affect the policy. Specify principals."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>You must use the <code class="code">Principal</code> or <code class="code">NotPrincipal</code> element in the trust policies for IAM roles and in resource-based policies. Resource-based policies 
are policies that you embed directly in a resource.</p>
<p>When you provide an empty array in a statement's <code class="code">Principal</code> element, the statement has no effect on the policy. AWS recommends that you
specify the principals that should have access to the resource.</p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_principal.html">IAM JSON policy elements: Principal</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notprincipal.html">IAM JSON policy elements: NotPrincipal</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-empty-array-resource">Suggestion – Empty array resource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Empty array resource: This statement includes no resources and does not affect the policy. Specify resources.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "This statement includes no resources and does not affect the policy. Specify resources."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>Statements must include either a <code class="code">Resource</code> or a <code class="code">NotResource</code> element.</p>
<p>When you provide an empty array in a statement's resource element, the statement has no effect on the policy. AWS recommends that you
specify Amazon Resource Names (ARNs) for resources.</p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notresource.html">IAM JSON policy elements: NotResource</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-empty-object-condition">Suggestion – Empty object condition</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Empty object condition: This condition block is empty and it does not affect the policy. Specify conditions.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "This condition block is empty and it does not affect the policy. Specify conditions."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>The <code class="code">Condition</code> element structure requires that you use a condition operator and a key-value pair.</p>
<p>When you provide an empty object in a statement's condition element, the statement has no effect on the policy. Remove the optional element or
specify conditions.</p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition.html">IAM JSON policy elements: Condition</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-empty-object-principal">Suggestion – Empty object principal</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Empty object principal: This statement includes no principals and does not affect the policy. Specify principals.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "This statement includes no principals and does not affect the policy. Specify principals."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>You must use the <code class="code">Principal</code> or <code class="code">NotPrincipal</code> element in the trust policies for IAM roles and in resource-based policies. Resource-based policies 
are policies that you embed directly in a resource.</p>
<p>When you provide an empty object in a statement's <code class="code">Principal</code> element, the statement has no effect on the policy. AWS recommends that you
specify the principals that should have access to the resource.</p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_principal.html">IAM JSON policy elements: Principal</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_notprincipal.html">IAM JSON policy elements: NotPrincipal</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-empty-sid-value">Suggestion – Empty Sid value</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Empty Sid value: Add a value to the empty string in the Sid element.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Add a value to the empty string in the Sid element."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>The optional <code class="code">Sid</code> (statement ID) element allows you to enter an identifier that you provide for the policy statement. You can 
assign an <code class="code">Sid</code> value to each statement in a statement array. If you choose to use the <code class="code">Sid</code> element, you must provide a 
string value.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">  
      
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_sid.html">IAM JSON policy elements: Sid</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-improve-ip-range">Suggestion – Improve IP range</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Improve IP range: The non-zero bits in the IP address after the masked bits are ignored. Replace address with <span>{</span><span>{</span>addr}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The non-zero bits in the IP address after the masked bits are ignored. Replace address with <span>{</span><span>{</span>addr}}."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>IP address conditions must be in the standard CIDR format, such as 203.0.113.0/24 or 2001:DB8:1234:5678::/64. When you include non-zero bits
after the masked bits, they are not considered for the condition. AWS recommends that you use the new address included in the message.</p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html#Conditions_IPAddress">IP address condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">IAM JSON policy elements: Condition</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-null-with-qualifier">Suggestion – Null with qualifier</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Null with qualifier: Avoid using the Null condition operator with the ForAllValues or ForAnyValue qualifiers because they always return a true or false respectively.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Avoid using the Null condition operator with the ForAllValues or ForAnyValue qualifiers because they always return a true or false respectively."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>In the <code class="code">Condition</code> element, you build expressions in which you use condition operators like equal or less than to compare a condition 
in the policy against keys and values in the request context. For requests that include multiple values for a single condition key, you must use the 
<code class="code">ForAllValues</code> or <code class="code">ForAnyValue</code> set operators.</p>
<p>When you use the <code class="code">Null</code> condition operator with <code class="code">ForAllValues</code>, the statement always returns <code class="code">true</code>. When you 
use the <code class="code">Null</code> condition operator with <code class="code">ForAnyValue</code>, the statement always returns <code class="code">false</code>. AWS recommends that 
you use the <code class="code">StringLike</code> condition operator with these set operators.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
      
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_multi-value-conditions.html#reference_policies_multi-key-or-value-conditions">Using multiple condition keys and values</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html#Conditions_Null">Null condition operator</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">Condition element</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-private-ip-address-subset">Suggestion – Private IP address subset</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Private IP address subset: The values for condition key aws:SourceIp include a mix of private and public IP addresses. The private addresses will not have the desired effect. aws:SourceIp works only for public IP address ranges. To define permissions for private IP ranges, use aws:VpcSourceIp.</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The values for condition key aws:SourceIp include a mix of private and public IP addresses. The private addresses will not have the desired effect. aws:SourceIp works only for public IP address ranges. To define permissions for private IP ranges, use aws:VpcSourceIp."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>The global condition key <code class="code">aws:SourceIp</code> works only for public IP address ranges.</p>
<p>When your <code class="code">Condition</code> element includes a mix of private and public IP addresses, the statement might not have
the desired effect. You can specify private IP addresses using <code class="code">aws:VpcSourceIP</code>.</p>
<div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The global condition key <code class="code">aws:VpcSourceIP</code> matches only if the request originates from the specified IP address 
and it goes through a VPC endpoint.</p></div></div>
<div class="itemizedlist"> 
      
      
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_condition-keys.html#condition-keys-sourceip">aws:SourceIp global condition key</a></p></li><li class="listitem"><p><a href="./reference_policies_condition-keys.html#condition-keys-vpcsourceip">aws:VpcSourceIp global condition key</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html#Conditions_IPAddress">IP address condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">IAM JSON policy elements: Condition</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-private-not-ip-address-subset">Suggestion – Private NotIpAddress subset</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Private NotIpAddress subset: The values for condition key aws:SourceIp include a mix of private and public IP addresses. The private addresses have no effect. aws:SourceIp works only for public IP address ranges. To define permissions for private IP ranges, use aws:VpcSourceIp.</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The values for condition key aws:SourceIp include a mix of private and public IP addresses. The private addresses have no effect. aws:SourceIp works only for public IP address ranges. To define permissions for private IP ranges, use aws:VpcSourceIp."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>The global condition key <code class="code">aws:SourceIp</code> works only for public IP address ranges.</p>
<p>When your <code class="code">Condition</code> element includes the <code class="code">NotIpAddress</code> condition operator and a mix of private and public 
IP addresses, the statement might not have the desired effect. Every public IP addresses that is not specified in the policy will match. No 
private IP addresses will match. To achieve this effect, you can use <code class="code">NotIpAddress</code> with <code class="code">aws:VpcSourceIP</code> and specify 
the private IP addresses that should not match.</p>
<div class="itemizedlist"> 
      
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_condition-keys.html#condition-keys-sourceip">aws:SourceIp global condition key</a></p></li><li class="listitem"><p><a href="./reference_policies_condition-keys.html#condition-keys-vpcsourceip">aws:VpcSourceIp global condition key</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html#Conditions_IPAddress">IP address condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">IAM JSON policy elements: Condition</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-redundant-action">Suggestion – Redundant action</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Redundant action: The <span>{</span><span>{</span>redundantActionCount}} action(s) are redundant because they provide similar permissions. Update the policy to remove the redundant action such as: <span>{</span><span>{</span>redundantAction}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The <span>{</span><span>{</span>redundantActionCount}} action(s) are redundant because they provide similar permissions. Update the policy to remove the redundant action such as: <span>{</span><span>{</span>redundantAction}}."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>When you use wildcards (*) in the <code class="code">Action</code> element, you can include redundant permissions. AWS recommends 
that you review your policy and include only the permissions that you need. This can help you remove redundant actions.</p>
<p>For example, the following actions include the <code class="code">iam:GetCredentialReport</code> action twice.</p>
<pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"Action": [
        "iam:Get*",
        "iam:List*",
        "iam:GetCredentialReport"
    ],</code></pre>
<p>In this example, permissions are defined for every IAM action that begins with <code class="code">Get</code> or <code class="code">List</code>. When IAM adds additional
get or list operations, this policy will allow them. You might want to allow all of these read-only actions. The <code class="code">iam:GetCredentialReport</code> action
is already included as part of <code class="code">iam:Get*</code>. To remove the duplicate permissions, you could remove <code class="code">iam:GetCredentialReport</code>.</p>
<p>You receive a finding for this policy check when all of the contents of an action are redundant. In this example, if the element included <code class="code">iam:*CredentialReport</code>,
it is not considered redundant. That includes <code class="code">iam:GetCredentialReport</code>, which is redundant, and <code class="code">iam:GenerateCredentialReport</code>, which is not.
Removing either <code class="code">iam:Get*</code> or <code class="code">iam:*CredentialReport</code> would change the policy's permissions.</p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_action.html">IAM JSON policy elements: Action</a></p></li></ul></div>


 
    <h3 id="accan-ref-policy-check-message-fix-suggestion-redundant-action-awsmanpol">AWS managed policies with this suggestion</h3>
    <p><a href="./access_policies_managed-vs-inline.html#aws-managed-policies">AWS managed policies</a> enable you to get started with AWS by assigning permissions 
    based on general AWS use cases.</p>
    <p>Redundant actions do not affect the permissions granted by the policy. When using an AWS managed policy as a reference to create your customer managed policy, AWS recommends that you remove 
    redundant actions from your policy.</p>
 

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-redundant-condition-value-num">Suggestion – Redundant condition value num</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Redundant condition value num: Multiple values in <span>{</span><span>{</span>operator}} are redundant. Replace with the <span>{</span><span>{</span>greatest/least}} single value for <span>{</span><span>{</span>key}}.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Multiple values in <span>{</span><span>{</span>operator}} are redundant. Replace with the <span>{</span><span>{</span>greatest/least}} single value for <span>{</span><span>{</span>key}}."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>When you use numeric condition operators for similar values in a condition key, you can create an overlap that results in redundant permissions.</p>
<p>For example, the following <code class="code">Condition</code> element includes multiple <code class="code">aws:MultiFactorAuthAge</code> conditions that have an age overlap of 1200 seconds.</p>
<pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"Condition": <span>{</span>
        "NumericLessThan": <span>{</span>
          "aws:MultiFactorAuthAge": [
            "2700",
            "3600"
          ]
        }
      }</code></pre>
<p>In this example, the permissions are defined if multi-factor authentication (MFA) was completed less than 3600 seconds (1 hour) ago. You could remove
the redundant <code class="code">2700</code> value.</p>
<div class="itemizedlist">
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html#Conditions_Numeric">Numeric condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">IAM JSON policy elements: Condition</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-redundant-resource">Suggestion – Redundant resource</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Redundant resource: The <span>{</span><span>{</span>redundantResourceCount}} resource ARN(s) are redundant because they reference the same resource. Review the use of wildcards (*)</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The <span>{</span><span>{</span>redundantResourceCount}} resource ARN(s) are redundant because they reference the same resource. Review the use of wildcards (*)"</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>When you use wildcards (*) in Amazon Resource Names (ARNs), you can create redundant resource permissions.</p>
<p>For example, the following <code class="code">Resource</code> element includes multiple ARNs with redundant permissions.</p>
<pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"Resource": [
            "arn:aws:iam::111122223333:role/jane-admin",
            "arn:aws:iam::111122223333:role/jane-s3only",
            "arn:aws:iam::111122223333:role/jane*"
        ],</code></pre>
<p>In this example, the permissions are defined for any role with a name starting with <code class="code">jane</code>. You could remove
the redundant <code class="code">jane-admin</code> and <code class="code">jane-s3only</code> ARNs without changing the resulting permissions. This does 
make the policy dynamic. It will define permissions for any future roles that begin with <code class="code">jane</code>. If the intention 
of the policy is to allow access to a static number of roles, then remove the last ARN and list only the ARNs that should be
defined.</p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>


 
    <h3 id="accan-ref-policy-check-message-fix-suggestion-redundant-resource-awsmanpol">AWS managed policies with this suggestion</h3>
    <p><a href="./access_policies_managed-vs-inline.html#aws-managed-policies">AWS managed policies</a> enable you to get started with AWS by assigning permissions 
    based on general AWS use cases.</p>
    <p>Redundant resources do not affect the permissions granted by the policy. When using an AWS managed policy as a reference to create your customer managed policy, AWS recommends 
    that you remove redundant resources from your policy.</p>
 

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-redundant-statement">Suggestion – Redundant statement</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Redundant statement: The statements are redundant because they provide identical permissions. Update the policy to remove the redundant statement.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The statements are redundant because they provide identical permissions. Update the policy to remove the redundant statement."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>The <code class="code">Statement</code> element is the main element for a policy. This element is required. The <code class="code">Statement</code> element 
can contain a single statement or an array of individual statements.</p>
<p>When you include the same statement more than once in a long policy, the statements are is redundant. You can remove one of the statements without affecting the permissions
granted by the policy. When someone edits a policy, they might change one of the statements without updating the duplicate. This might result in more permissions than intended.</p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_statement.html">IAM JSON policy elements: Statement</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-wildcard-in-service-name">Suggestion – Wildcard in service name</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Wildcard in service name: Avoid using wildcards (*, ?) in the service name because it might grant unintended access to other AWS services with similar names.</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Avoid using wildcards (*, ?) in the service name because it might grant unintended access to other AWS services with similar names."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>When you include the name of an AWS service in a policy, AWS recommends that you do not include wildcards (*, ?). This might
add permissions for future services that you do not intend. For example, there are more than a dozen AWS services with the word
<code class="code">*code*</code> in their name.</p>
<pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"Resource": "arn:aws:*code*::111122223333:*"</code></pre>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_elements_resource.html">IAM JSON policy elements: Resource</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-allow-with-unsupported-tag-condition-key-for-service">Suggestion – Allow with unsupported tag condition key for service</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Allow with unsupported tag condition key for service: Using the effect Allow with the tag condition key <span>{</span><span>{</span>conditionKeyName}} and actions for services with the following prefixes does not affect the policy: <span>{</span><span>{</span>serviceNames}}. Actions for the listed service are not allowed by this statement. We recommend that you move these actions to a different statement without this condition key.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using the effect Allow with the tag condition key <span>{</span><span>{</span>conditionKeyName}} and actions for services with the following prefixes does not affect the policy: <span>{</span><span>{</span>serviceNames}}. Actions for the listed service are not allowed by this statement. We recommend that you move these actions to a different statement without this condition key."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>Using unsupported tag condition keys in the <code class="code">Condition</code> element of a policy
            with <code class="code">"Effect": "Allow"</code> does not affect the permissions granted by the
            policy, because the condition is ignored for that service action. AWS recommends that
            you remove the actions for services that don’t support the condition key and create
            another statement to allow access to specific resources in that service.</p>
        <p>If you use the <code class="code">aws:ResourceTag</code> condition key and it’s not supported by a
            service action, then the key is not included in the request context. In this case, the
            condition in the <code class="code">Allow</code> statement always returns <code class="code">false</code> and the
            action is never allowed. This happens even if the resource is tagged correctly. </p>
        
        <p>When a service supports the <code class="code">aws:ResourceTag</code> condition key, you can use
            tags to control access to that service’s resources. This is known as <a href="./introduction_attribute-based-access-control.html">attribute-based access control
                (ABAC)</a>. Services that don’t support these keys require you to control access
            to resources using <a href="./introduction_attribute-based-access-control.html#introduction_attribute-based-access-control_compare-rbac">resource-based
                access control (RBAC)</a>.</p>
                <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Some services allow support for the <code class="code">aws:ResourceTag</code> condition key for
                a subset of their resources and actions. IAM Access Analyzer returns findings for the
                service actions that are not supported. For example, Amazon S3 supports
                    <code class="code">aws:ResourceTag</code> for a subset of its resources. To view all of the
                resource types available in Amazon S3 that support the <code class="code">aws:ResourceTag</code>
                condition key, see <a href="https://docs.aws.amazon.com/service-authorization/latest/reference/list_amazons3.html#amazons3-resources-for-iam-policies">Resource types defined by Amazon S3</a> in the Service Authorization
                Reference.</p></div></div>
        <p>For example, assume that you want to allow team members to view details for specific
            resources that are tagged with the key-value pair <code class="code">team=BumbleBee</code>. Also
            assume that AWS Lambda allows you to tag resources, but doesn’t support the
                <code class="code">aws:ResourceTag</code> condition key. To allow view actions for
            AWS App Mesh and AWS Backup if this tag is present, use the <code class="code">aws:ResourceTag</code>
            condition key. For Lambda, use a resource naming convention that includes the team name
            as a prefix. Then include a separate statement that allows viewing resources with that
            naming convention.</p>
        <pre class="programlisting"><div class="code-btn-container"></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "AllowViewSupported",
            "Effect": "Allow",
            "Action": [
                "appmesh:DescribeMesh", 
                "backup:GetBackupPlan"
                ],
            "Resource": "*",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "aws:ResourceTag/<code class="replaceable">team</code>": "<code class="replaceable">BumbleBee</code>"
                }
            }
        },
        <span>{</span>
            "Sid": "AllowViewUnsupported",
            "Effect": "Allow",
            "Action": "lambda:GetFunction",
            "Resource": "arn:aws:lambda:<code class="replaceable">*</code>:<code class="replaceable">123456789012</code>:function:<code class="replaceable">team-BumbleBee*</code>"
        }
    ]
}</code></pre>
        <div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Warning</h6></div><div class="awsdocs-note-text"><p>Do not use the <code class="code">Not</code> <a href="./reference_policies_elements_condition_operators.html">version of the condition operator</a> with <code class="code">"Effect": "Allow"</code> as a
            workaround for this finding. These condition operators provide negated matching. This
            means that after the condition is evaluated, the result is negated. In the previous
            example, including the <code class="code">lambda:GetFunction</code> action in the <code class="code">AllowViewSupported</code> statement with
            the <code class="code">StringNotEquals</code> operator always allows the action, regardless of whether the
            resource is tagged.</p><p>Do not use the …<a href="./reference_policies_elements_condition_operators.html#Conditions_IfExists">IfExists</a> version of the condition operator as a workaround for
                this finding. This means "Allow the action if the key is present in the request
                context and the values match. Otherwise, allow the action." In the previous example,
                including the <code class="code">lambda:GetFunction</code> action in the <code class="code">AllowViewSupported</code> statement with the
                <code class="code">StringEqualsIfExists</code> operator always allows the action. For that action,
                the key is not present in the context, and every attempt to view that resource type
                is allowed, regardless of whether the resource is tagged.</p></div></div>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_condition-keys.html">Global condition keys</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html">IAM JSON policy elements: Condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">Condition element</a></p></li><li class="listitem"><p><a href="./access_policies.html#access_policies-json">Overview of JSON policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-allow-notaction-with-unsupported-tag-condition-key-for-service">Suggestion – Allow NotAction with unsupported tag condition key for
                service</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Allow NotAction with unsupported tag condition key for service: Using the effect Allow with NotAction and the tag condition key <span>{</span><span>{</span>conditionKeyName}} allows only service actions that support the condition key. The condition key doesn't apply to some service actions. We recommend that you use Action instead of NotAction.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "Using the effect Allow with NotAction and the tag condition key <span>{</span><span>{</span>conditionKeyName}} allows only service actions that support the condition key. The condition key doesn't apply to some service actions. We recommend that you use Action instead of NotAction."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>Using unsupported tag condition keys in the <code class="code">Condition</code> element of a
            policy with the element <code class="code">NotAction</code> and <code class="code">"Effect": "Allow"</code> does
            not affect the permissions granted by the policy. The condition is ignored for service
            actions that don’t support the condition key. AWS recommends that you rewrite the
            logic to allow a list of actions.</p>
        <p>If you use the <code class="code">aws:ResourceTag</code> condition key with <code class="code">NotAction</code>,
            any new or existing service actions that don’t support the key are not allowed. AWS
            recommends that you explicitly list the actions that you want to allow. IAM Access Analyzer
            returns a separate finding for listed actions that don’t support the
                <code class="code">aws:ResourceTag</code> condition key. For more information, see <a href="#access-analyzer-reference-policy-checks-suggestion-allow-with-unsupported-tag-condition-key-for-service">Suggestion – Allow with unsupported tag condition key for service</a>.</p>
        
        <p>When a service supports the <code class="code">aws:ResourceTag</code> condition key, you can use
            tags to control access to that service’s resources. This is known as <a href="./introduction_attribute-based-access-control.html">attribute-based access control
                (ABAC)</a>. Services that don’t support these keys require you to control access
            to resources using <a href="./introduction_attribute-based-access-control.html#introduction_attribute-based-access-control_compare-rbac">resource-based
                access control (RBAC)</a>.</p>
        <p><b>Related terms</b></p>
        <div class="itemizedlist">
             
             
             
             
             
        <ul class="itemizedlist"><li class="listitem"><p><a href="./reference_policies_condition-keys.html">Global condition keys</a></p></li><li class="listitem"><p><a href="./introduction_attribute-based-access-control.html#introduction_attribute-based-access-control_compare-rbac">Comparing ABAC to RBAC</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition_operators.html">IAM JSON policy elements: Condition operators</a></p></li><li class="listitem"><p><a href="./reference_policies_elements_condition.html">Condition element</a></p></li><li class="listitem"><p><a href="./access_policies.html#access_policies-json">Overview of JSON policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-recommended-condition-key-for-service-principal">Suggestion – Recommended condition key for service principal</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Recommended condition key for service principal: To restrict access to the service principal <span>{</span><span>{</span>servicePrincipalPrefix}} operating on your behalf, we recommend aws:SourceArn or aws:SourceAccount instead of <span>{</span><span>{</span>key}}.</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "To restrict access to the service principal <span>{</span><span>{</span>servicePrincipalPrefix}} operating on your behalf, we recommend aws:SourceArn or aws:SourceAccount instead of <span>{</span><span>{</span>key}}."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>You can specify AWS services in the <code class="code">Principal</code> element of a
            resource-based policy using a <em>service principal</em>, which is an identifier for the service.
            You should use the <code class="code">aws:SourceAccount</code> or <code class="code">aws:SourceArn</code> condition keys when
            granting access to service principals instead of other condition keys, such as <code class="code">aws:Referer</code>.
            This helps you prevent a security issue called the <em>confused deputy problem</em>.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
       
      
      
       
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_principal.html#principal-services">Service principals</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#condition-keys-sourceaccount">AWS global condition keys: aws:SourceAccount</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#condition-keys-sourcearn">AWS global condition keys: aws:SourceArn</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/confused-deputy.html#cross-service-confused-deputy-prevention">The confused deputy problem</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-irrelevant-condition-key-in-policy">Suggestion – Irrelevant condition key in policy</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Irrelevant condition key in policy: The condition key <span>{</span><span>{</span>condition-key}} is not relevant for the <span>{</span><span>{</span>resource-type}} policy.  Use this key in an identity-based policy to govern access to this resource.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The condition key <span>{</span><span>{</span>condition-key}} is not relevant for the <span>{</span><span>{</span>resource-type}} policy.  Use this key in an identity-based policy to govern access to this resource."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>Some condition keys aren't relevant for resource-based policies. For example, the <code class="code">s3:ResourceAccount</code> condition key isn't relevant for the resource-based policy attached to an Amazon S3 bucket or Amazon S3 access point resource type.</p>
<p>You should use the condition key in an identity-based policy to control access to the resource.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="./access_policies_identity-vs-resource.html">Identity-based policies and resource-based policies</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-redundant-principal-in-role-trust-policy">Suggestion – Redundant principal in role trust policy</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Redundant principal in role trust policy: The assumed-role principal <span>{</span><span>{</span>redundant_principal}} is redundant with its parent role <span>{</span><span>{</span>parent_role}}. Remove the assumed-role principal.
</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The assumed-role principal <span>{</span><span>{</span>redundant_principal}} is redundant with its parent role <span>{</span><span>{</span>parent_role}}. Remove the assumed-role principal."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>If you specify both an assumed-role principal and its parent role in the
                <code class="code">Principal</code> element of a policy, it does not allow or deny any different
            permissions. For example, it is redundant if you specify the <code class="code">Principal</code>
            element using the following format:</p>
<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">"Principal": <span>{</span>
            "AWS": [
            "arn:aws:iam::<code class="replaceable">AWS-account-ID</code>:role/<code class="replaceable">rolename</code>",
            "arn:aws:iam::<code class="replaceable">AWS-account-ID</code>:assumed-role/<code class="replaceable">rolename</code>/<code class="replaceable">rolesessionname</code>"
        ]</code></pre>
<p>We recommend removing the assumed-role principal.</p>
<p><b>Related terms</b></p>
<div class="itemizedlist">
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_principal.html#principal-role-session">Role session principals</a></p></li></ul></div>

     
        <h2 id="access-analyzer-reference-policy-checks-suggestion-confirm-audience-claim-type">Suggestion – Confirm audience claim type</h2>
        
        <p>In the AWS Management Console, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="">Confirm audience claim type: The 'aud' (audience) claim key identifies the recipients that the JSON web token is intended for. Audience claims can be multivalued or single-valued. If the claim is multivalued, use a ForAllValues or ForAnyValue qualifier. If the claim is single-valued, do not use a qualifier.</code></pre>
                       
        <p>In programmatic calls to the AWS CLI or AWS API, the finding for this check includes the following message:</p>

        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"findingDetails": "The 'aud' (audience) claim key identifies the recipients that the JSON web token is intended for. Audience claims can be multivalued or single-valued. If the claim is multivalued, use a ForAllValues or ForAnyValue qualifier. If the claim is single-valued, do not use a qualifier."</code></pre>
        <p><b>Resolving the suggestion</b></p>
        
<p>The <code class="code">aud</code> (audience) claim key is a unique identifier for your app that is
            issued to you when you register your app with the IdP and identifies the recipients that
            the JSON web token is intended for. Audience claims can be multivalued or single-valued.
            If the claim is multivalued, use a <code class="code">ForAllValues</code> or <code class="code">ForAnyValue</code>
            condition set operator. If the claim is single-valued, do not use a condition set operator.</p>
        <p><b>Related terms</b></p>
<div class="itemizedlist">
     
     
     
<ul class="itemizedlist"><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-idp_oidc.html">Creating a role
                        for web identity or OpenID Connect Federation (console)</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_multi-value-conditions.html#reference_policies_multi-key-or-value-conditions">Using multiple keys and values</a></p></li><li class="listitem"><p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_single-vs-multi-valued-condition-keys.html">Single-valued vs. multivalued condition keys</a></p></li></ul></div>

    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./access-analyzer-policy-validation.html">IAM Access Analyzer policy validation</div><div id="next" class="next-link" accesskey="n" href="./access-analyzer-policy-generation.html">IAM Access Analyzer policy generation</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/access-analyzer-reference-policy-checks.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>