<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Controlling access to AWS resources using tags - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="access_tags" /><meta name="default_state" content="access_tags" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_tags.html" /><meta name="description" content="Use tags on your AWS resources to control access." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Control access to your AWS resources with user identity (authentication) and with policies that define specific permissions (authorization)." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_tags.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/access_tags.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/access_tags.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/access_tags.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/access_tags.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_tags.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_tags.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/access_tags.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/access_tags.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/access_tags.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/access_tags.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/access_tags.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/access_tags.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/access_tags.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/access_tags.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/access_tags.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/access_tags.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/access_tags.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/access_tags.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/access_tags.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/access_tags.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_tags.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Controlling access to AWS resources using tags" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Controlling access to AWS resources using tags - AWS Identity and Access Management</title><meta name="pdf" content="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#access_tags" /><meta name="github" content="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/access_tags.md" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/access_tags.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/access_tags.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/access_tags.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM user,user,IAM group,group,IAM role,role,permission policy,trust policy,policy,access key,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Access management for AWS resources",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/access.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Policies and permissions in IAM",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Controlling access to AWS resources using tags",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#access_tags" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/access_tags.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">User Guide</a></div><div id="page-toc-src"><a href="#access_tags_control-resources">Controlling access to AWS
                resources</a><a href="#access_tags_control-requests">Controlling access during AWS
                requests</a><a href="#access_tags_control-tag-keys">Controlling access based on tag
                keys</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="access_tags">Controlling access to AWS resources using tags</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>You can use tags to control access to your AWS resources that support tagging, including
        IAM resources. You can tag IAM users and roles to control what they can access. To learn
        how to tag IAM users and roles, see <a href="./id_tags.html">Tagging IAM resources</a>.
        Additionally, you can control access to the following IAM resources: customer managed
        policies, IAM identity providers, instance profiles, server certificates, and virtual MFA
        devices. To view a tutorial for creating and testing a policy that allows IAM roles with
        principal tags to access resources with matching tags, see <a href="./tutorial_attribute-based-access-control.html">IAM tutorial: Define permissions to
         access AWS resources based on tags</a>. Use the information in the
        following section to control access to other AWS resources, including IAM resources,
        without tagging IAM users or roles.</p><p>Before you use tags to control access to your AWS resources, you must understand how
        AWS grants access. AWS is composed of collections of <em>resources</em>. An Amazon EC2 instance is a resource. An Amazon S3 bucket is a resource.
        You can use the AWS API, the AWS CLI, or the AWS Management Console to perform an operation, such as
        creating a bucket in Amazon S3. When you do, you send a <em>request</em> for that operation. Your request specifies an action, a resource, a
            <em>principal entity</em> (user or role), a <em>principal account</em>, and any necessary request information. All
        of this information provides <em>context</em>.</p><p>AWS then checks that you (the principal entity) are authenticated (signed in) and
        authorized (have permission) to perform the specified action on the specified resource.
        During authorization, AWS checks all the policies that apply to the context of your
        request. Most policies are stored in AWS as <a href="./access_policies.html#access_policies-json">JSON
            documents</a> and specify the permissions for principal entities. For more
        information about policy types and uses, see <a href="./access_policies.html">Policies and permissions in IAM</a>.</p><p>AWS authorizes the request only if each part of your request is allowed by the policies.
        To view a diagram and learn more about the IAM infrastructure, see <a href="./intro-structure.html">How IAM works</a>. For details about how IAM
        determines whether a request is allowed, see <a href="./reference_policies_evaluation-logic.html">Policy evaluation logic</a>.</p><p>Tags are another consideration in this process because tags can be attached to the
            <em>resource</em> or passed in the <em>request</em> to services that support tagging. To control access based on tags,
        you provide tag information in the <a href="./reference_policies_elements_condition.html">condition element</a> of a policy. To learn whether an AWS service supports
        controlling access using tags, see <a href="./reference_aws-services-that-work-with-iam.html">AWS services that work with
      IAM</a> and look for the services
        that have <b>Yes </b>in the <b>Authorization
            based on tags</b> column. Choose the name of the service to view the
        authorization and access control documentation for that service.</p><p>You can then create an IAM policy that allows or denies access to a resource based on
        that resource's tag. In that policy, you can use tag condition keys to control access to any
        of the following:</p><div class="itemizedlist">
         
         
         
    <ul class="itemizedlist"><li class="listitem">
            <p><b><a href="#access_tags_control-resources">Resource</a></b> – Control access to AWS service
                resources based on the tags on those resources. To do this, use the <b>ResourceTag/<code class="replaceable">key-name</code></b> condition
                key to determine whether to allow access to the resource based on the tags that are
                attached to the resource.</p>
        </li><li class="listitem">
            <p><b><a href="#access_tags_control-requests">Request</a></b> – Control what tags can be passed in a
                request. To do this, use the <b>aws:RequestTag/<code class="replaceable">key-name</code></b> condition key
                to specify what tag key-value pairs can be passed in a request to tag or untag an
                AWS resource.</p>
        </li><li class="listitem">
            <p><b><a href="#access_tags_control-tag-keys">Any part of the
                        authorization process</a></b> – Use the <b>aws:TagKeys</b> condition key to control whether specific tag
                keys can be used on a resource or in a request. </p>
        </li></ul></div><p>You can create an IAM policy visually, using JSON, or by importing an existing managed
        policy. For details, see <a href="./access_policies_create.html">Creating IAM policies</a>.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Some services allow users to specify tags when they create the resource if they have
            permissions to use the action that creates the resource.</p></div></div>
        <h2 id="access_tags_control-resources">Controlling access to AWS
                resources</h2>
        <p>You can use conditions in your IAM policies to control access to AWS resources
            based on the tags on that resource. You can do this using the global
                    <code class="code">aws:ResourceTag/<code class="replaceable">tag-key</code></code> condition key,
            or a service-specific key. Some services support only the service-specific version of
            this key and not the global version. </p>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Do not use the <code class="code">ResourceTag</code> condition key in a policy with the
                    <code class="code">iam:PassRole</code> action. You cannot use the tag on an IAM role to
                control access to who can pass that role. For more information about permissions
                required to pass a role to a service, see <a href="./id_roles_use_passrole.html">Granting a user permissions to pass a role to an AWS
      service</a>.</p></div></div>
        <p> This example shows how you might create an identity-based policy that allows starting or stopping Amazon EC2 instances. These operations
            are allowed only if the instance tag <code class="code">Owner</code> has the value of the user
            name. This policy defines permissions for programmatic and console access. </p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "ec2:StartInstances",
                "ec2:StopInstances"
            ],
            "Resource": "arn:aws:ec2:*:*:instance/*",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>"aws:ResourceTag/Owner": "$<span>{</span>aws:username}"}
            }
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": "ec2:DescribeInstances",
            "Resource": "*"
        }
    ]
}</code></pre>
        <p>You can attach this policy to the IAM users in your account. If a user named
                <code class="code">richard-roe</code> attempts to start an Amazon EC2 instance, the instance must be
            tagged <code class="code">Owner=richard-roe</code> or <code class="code">owner=richard-roe</code>. Otherwise he
            will be denied access. The tag key <code class="code">Owner</code> matches both <code class="code">Owner</code>
            and <code class="code">owner</code> because condition key names are not case-sensitive. For more
            information, see <a href="./reference_policies_elements_condition.html">IAM JSON policy elements:
        Condition</a>.</p>
        <p>This example shows how you might create an identity-based policy that uses the <code class="code">team</code> principal tag in the resource ARN.
            The policy grants permission to delete Amazon Simple Queue Service queues, but only if the queue name
            starts with the team name followed by <code class="code">-queue</code>. For example,
                <code class="code">qa-queue</code> if <code class="code">qa</code> is the team name for the <code class="code">team</code>
            principal tag.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
      "Version": "2012-10-17",
      "Statement": <span>{</span>
        "Sid": "AllQueueActions",
        "Effect": "Allow",
        "Action": "sqs:DeleteQueue",
        "Resource": "arn:aws:sqs:us-east-2::$<span>{</span>aws:PrincipalTag/<code class="replaceable">team</code>}-queue"
      }
}</code></pre>
     
        <h2 id="access_tags_control-requests">Controlling access during AWS
                requests</h2>
        <p>You can use conditions in your IAM policies to control what tag key-value pairs can
            be passed in a request that tags an AWS resource.</p>
        <p>This example shows how you might create an identity-based policy that allows using the Amazon EC2 <code class="code">CreateTags</code> action to attach
            tags to an instance. You can attach tags only if the tag contains the
                <code class="code">environment</code> key and the <code class="code">preprod</code> or <code class="code">production</code>
            values. If you want, you can use the <code class="code">ForAllValues</code> modifier with the
                <code class="code">aws:TagKeys</code> condition key to indicate that only the key
                <code class="code">environment</code> is allowed in the request. This stops users from including
            other keys, such as accidentally using <code class="code">Environment</code> instead of
                <code class="code">environment</code>. </p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": <span>{</span>
        "Effect": "Allow",
        "Action": "ec2:CreateTags",
        "Resource": "arn:aws:ec2:*:*:instance/*",
        "Condition": <span>{</span>
            "StringEquals": <span>{</span>
                "aws:RequestTag/<code class="replaceable">environment</code>": [
                    "<code class="replaceable">preprod</code>",
                    "<code class="replaceable">production</code>"
                ]
            },
            "ForAllValues:StringEquals": <span>{</span>"aws:TagKeys": "<code class="replaceable">environment</code>"}
        }
    }
}</code></pre>
     
        <h2 id="access_tags_control-tag-keys">Controlling access based on tag
                keys</h2>
        <p>You can use a condition in your IAM policies to control whether specific tag keys
            can be used on a resource or in a request.</p>
        <p>We recommend that when you use policies to control access using tags, you use the
                <a href="./reference_policies_condition-keys.html#condition-keys-tagkeys">aws:TagKeys condition
            key</a>. AWS services that support tags might allow you to create multiple tag key
            names that differ only by case, such as tagging an Amazon EC2 instance with
                <code class="code">stack=production</code> and <code class="code">Stack=test</code>. Key names are not case
            sensitive in policy conditions. This means that if you specify
                <code class="code">"aws:ResourceTag/TagKey1": "Value1"</code> in the condition element of your
            policy, then the condition matches a resource tag key named either <code class="code">TagKey1</code>
            or <code class="code">tagkey1</code>, but not both. To prevent duplicate tags with a key that varies
            only by case, use the <code class="code">aws:TagKeys</code> condition to define the tag keys that
            your users can apply, or use tag policies, available with AWS Organizations. For more information
            see <a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_tag-policies.html">Tag
                Policies</a> in the <em>Organizations User Guide</em>. </p>

        <p>This example shows how you might create an identity-based policy that allows creating and tagging a Secrets Manager secret, but only with
            the tag keys <code class="code">environment</code> or <code class="code">cost-center</code>. The <code class="code">Null</code>
            condition ensures that the condition evaluates to <code class="code">false</code> if there are no
            tags in the request.</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
        "Effect": "Allow",
        "Action": [
            "secretsmanager:CreateSecret",
            "secretsmanager:TagResource"
        ],
        "Resource": "*",
        "Condition": <span>{</span>
            "Null": <span>{</span>
                "aws:TagKeys": "false"
            },
            "ForAllValues:StringEquals": <span>{</span>
                "aws:TagKeys": [
                    "environment",
                    "cost-center"
                ]
            }
        }
}</code></pre>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./access_iam-tags.html">Control access to IAM users and roles using tags</div><div id="next" class="next-link" accesskey="n" href="./access_policies_examples.html">Example policies</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/access_tags.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/access_tags.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>