<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Versioning IAM policies - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="access_policies_managed-versioning" /><meta name="default_state" content="access_policies_managed-versioning" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-versioning.html" /><meta name="description" content="Learn how IAM policy versioning works and how changes to managed policies become new versions of the policy." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Control access to your AWS resources with user identity (authentication) and with policies that define specific permissions (authorization)." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-versioning.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-versioning.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Versioning IAM policies" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Versioning IAM policies - AWS Identity and Access Management</title><meta name="pdf" content="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#access_policies_managed-versioning" /><meta name="github" content="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/access_policies_managed-versioning.md" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/access_policies_managed-versioning.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/access_policies_managed-versioning.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/access_policies_managed-versioning.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM user,user,IAM group,group,IAM role,role,permission policy,trust policy,policy,access key,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Access management for AWS resources",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/access.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Managing IAM policies",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_manage.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Versioning IAM policies",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_manage.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#access_policies_managed-versioning" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/access_policies_managed-versioning.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">User Guide</a></div><div id="page-toc-src"><a href="#policy-version-permissions">Permissions for setting the default version of a
        policy</a><a href="#default-version">Setting the default version of customer managed
        policies</a><a href="#versions-roll-back">Using versions to roll back changes</a><a href="#version-limits">Version limits</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="access_policies_managed-versioning">Versioning IAM policies</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>When you make changes to an IAM customer managed policy, and when AWS makes changes to
    an AWS managed policy, the changed policy doesn't overwrite the existing policy. Instead,
    IAM creates a new <em>version</em> of the managed policy. IAM stores up to five
    versions of your customer managed policies. IAM does not support versioning for inline
    policies. </p><p>The following diagram illustrates versioning for a customer managed policy. In this example,
    the versions 1-4 are saved. You can have up to five managed policy versions saved to IAM. When
    you edit a policy that would create a sixth saved version, you can choose which older version
    should no longer be saved. You can revert to any of the other four saved versions at any
    time.</p><div class="mediaobject">
     
      <img src="/images/IAM/latest/UserGuide/images/policies-managed-policies-versions-overview.diagram.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;      Changes to managed policies become new versions of the policy&#xA;    " />
     
     
      
     
     
  </div><p>A policy version is different from a <code class="code">Version</code> policy element. The
      <code class="code">Version</code> policy element is used within a policy and defines the version of the
    policy language. To learn more about the <code class="code">Version</code> policy element see <a href="./reference_policies_elements_version.html">IAM JSON policy elements:
        Version</a>.</p><p>You can use versions to track changes to a managed policy. For example, you might make a
    change to a managed policy and then discover that the change had unintended effects. In this
    case, you can roll back to a previous version of the managed policy by setting the previous
    version as the <em>default</em> version. </p><p>The following sections explain how you can use versioning for managed policies.</p><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#policy-version-permissions">Permissions for setting the default version of a
        policy</a></li><li><a href="#default-version">Setting the default version of customer managed
        policies</a></li><li><a href="#versions-roll-back">Using versions to roll back changes</a></li><li><a href="#version-limits">Version limits</a></li></ul></div>
    <h2 id="policy-version-permissions">Permissions for setting the default version of a
        policy</h2>
    <p>The permissions that are required to set the default version of a policy correspond to the
      AWS API operations for the task. You can use the <code class="code">CreatePolicyVersion</code> or
        <code class="code">SetDefaultPolicyVersion</code> API operations to set the default version of a policy.
      To allow someone to set the default policy version of an existing policy, you can allow access
      to either the <code class="code">iam:CreatePolicyVersion</code> action or the
        <code class="code">iam:SetDefaultPolicyVersion</code> action. The <code class="code">iam:CreatePolicyVersion</code>
      action allows them to create a new version of the policy and to set that version as the
      default. The <code class="code">iam:SetDefaultPolicyVersion</code> action allows them to set any existing
      version of the policy as the default.</p>
    <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>Denying the <code class="code">iam:SetDefaultPolicyVersion</code> action in a user's policy does not
        stop the user from creating a new policy version and setting it as the default.</p></div></div>
    <p>You can use the following policy to deny a user access to change an existing customer
      managed policy:</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Deny",
            "Action": [
                "iam:CreatePolicyVersion",
                "iam:SetDefaultPolicyVersion"
            ],
            "Resource": "arn:aws:iam::*:policy/<code class="replaceable">POLICY-NAME</code>"
        }
    ]
}</code></pre>
   
    <h2 id="default-version">Setting the default version of customer managed
        policies</h2>
    <p>One of the versions of a managed policy is set as the <em>default</em>
      version. The policy's default version is the operative version—that is, it's the
      version that is in effect for all of the principal entities (users, user groups, and roles)
      that the managed policy is attached to. </p>
    <p>When you create a customer managed policy, the policy begins with a single version
      identified as v1. For managed policies with only a single version, that version is
      automatically set as the default. For customer managed policies with more than one version,
      you choose which version to set as the default. For AWS managed policies, the default
      version is set by AWS. The following diagrams illustrate this concept. </p>
    <div class="mediaobject">
       
        <img src="/images/IAM/latest/UserGuide/images/policies-managed-policies-versions-default-one.diagram.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;        Managed policy with a single version, which is the default version&#xA;      " />
       
       
    </div>
    <p></p>
    <div class="mediaobject">
       
        <img src="/images/IAM/latest/UserGuide/images/policies-managed-policies-versions-default-multiple.diagram.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;        Customer managed policy with three versions, where version v2 is the default&#xA;          version.&#xA;      " />
       
       
    </div>
     
      <p>You can set the default version of a customer managed policy to apply that version to
        every IAM identity (user, user group, and role) where the policy is attached. You cannot
        set the default version for an AWS managed policy or an inline policy.</p>
      <div class="procedure"><h6>To set the default version of a customer managed policy (console)</h6><ol><li><p>Sign in to the AWS Management Console and open the IAM console at <a href="https://console.aws.amazon.com/iam/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/iam/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
          <p>In the navigation pane, choose <b>Policies</b>.</p>
        </li><li>
          <p>In the list of policies, choose the policy name of the policy to set the default
            version of. You can use the search box to filter the list of policies.</p>
        </li><li>
          <p>Choose the
              <b>Policy
              versions</b>
            tab. Select the check box next to the version that you want to set as the default
            version, and then choose <b>Set as default</b>.</p>
        </li></ol></div>
     
    <p>To learn how to set the default version of a customer managed policy from the AWS Command Line Interface or
      the AWS API, see <a href="./access_policies_manage-edit.html#edit-policies-cli-api">Editing customer managed policies (AWS CLI)</a>. </p>
   
    <h2 id="versions-roll-back">Using versions to roll back changes</h2>
    <p>You can set the default version of a customer managed policy to roll back your changes.
      For example, consider the following scenario:</p>
    <p>You create a customer managed policy that allows users to administer a particular Amazon S3
      bucket using the AWS Management Console. Upon creation, your customer managed policy has only one version,
      identified as v1, so that version is automatically set as the default. The policy works as
      intended. </p>
    <p>Later, you update the policy to add permission to administer a second Amazon S3 bucket. IAM
      creates a new version of the policy, identified as v2, that contains your changes. You set
      version v2 as the default, and a short time later your users report that they lack permission
      to use the Amazon S3 console. In this case, you can roll back to version v1 of the policy, which
      you know works as intended. To do this, you set version v1 as the default version. Your users
      are now able to use the Amazon S3 console to administer the original bucket. </p>
    <p>Later, after you determine the error in version v2 of the policy, you update the policy
      again to add permission to administer the second Amazon S3 bucket. IAM creates another new
      version of the policy, identified as v3. You set version v3 as the default, and this version
      works as intended. At this point, you delete version v2 of the policy.</p>
   
    <h2 id="version-limits">Version limits</h2>
    <p>A managed policy can have up to five versions. If you need to make changes to a managed
      policy beyond five versions from the AWS Command Line Interface, or the AWS API, you must first delete one or
      more existing versions. If you use the AWS Management Console, you do not have to delete a version before
      editing your policy. When you save a sixth version, a dialog box appears that prompts you to
      delete one or more nondefault versions of your policy. You can view the JSON policy document
      for each version to help you decide. For details about this dialog box, see <a href="./access_policies_manage-edit.html">Editing IAM policies</a>.</p>
    <p>You can delete any version of the managed policy that you want, except for the default
      version. When you delete a version, the version identifiers for the remaining versions do not
      change. As a result, version identifiers might not be sequential. For example, if you delete
      versions v2 and v4 of a managed policy and add two new versions, the remaining version
      identifiers might be v1, v3, v5, v6, and v7. </p>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./access_policies_manage-attach-detach.html">Add or remove identity permissions</div><div id="next" class="next-link" accesskey="n" href="./access_policies_manage-edit.html">Editing IAM policies</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/access_policies_managed-versioning.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/access_policies_managed-versioning.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>