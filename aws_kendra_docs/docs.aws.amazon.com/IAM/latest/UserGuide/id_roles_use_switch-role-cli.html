<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Switching to an IAM role (AWS CLI) - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="id_roles_use_switch-role-cli" /><meta name="default_state" content="id_roles_use_switch-role-cli" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" /><meta name="description" content="Use the AWS Command Line Interface to switch to an IAM role that provides temporary access to resources in an AWS account." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Control access to your AWS resources with user identity (authentication) and with policies that define specific permissions (authorization)." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Switching to an IAM role (AWS CLI)" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Switching to an IAM role (AWS CLI) - AWS Identity and Access Management</title><meta name="pdf" content="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#id_roles_use_switch-role-cli" /><meta name="github" content="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/id_roles_use_switch-role-cli.md" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM user,user,IAM group,group,IAM role,role,permission policy,trust policy,policy,access key,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "IAM Identities (users, user groups, and roles)",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "IAM roles",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Using IAM roles",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Switching to an IAM role (AWS CLI)",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#id_roles_use_switch-role-cli" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/id_roles_use_switch-role-cli.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">User Guide</a></div><div id="page-toc-src"><a href="#switch-role-cli-scenario-prod-env">Example scenario: Switch to a
            production role</a><a href="#switch-role-cli-scenario-ec2-instance">Example scenario: Allow an instance
            profile role to switch to a role in another account</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="id_roles_use_switch-role-cli">Switching to an IAM role (AWS CLI)</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>A <em>role</em> specifies a set of permissions that you can use to access AWS
      resources that you need. In that sense, it is similar to a <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id.html">user in AWS Identity and Access Management</a> (IAM). When you sign in as a user,
      you get a specific set of permissions. However, you don't sign in to a role, but after signing
      in as a user, you can switch to a role. This temporarily sets aside your original user
      permissions and instead gives you the permissions assigned to the role. The role can be in
      your own account or any other AWS account. For more information about roles, their benefits,
      and how to create and configure them, see <a href="./id_roles.html">IAM roles</a>,
      and <a href="./id_roles_create.html">Creating IAM roles</a>. To learn about the
      different methods that you can use to assume a role, see <a href="./id_roles_use.html">Using IAM roles</a>.</p><div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>The permissions of your IAM user and any roles that you assume are not cumulative.
         Only one set of permissions is active at a time. When you assume a role, you temporarily
         give up your previous user or role permissions and work with the permissions that are
         assigned to the role. When you exit the role, your user permissions are automatically
         restored.</p></div></div><p>You can use a role to run an AWS CLI command when you are signed in as an IAM user. You can
      also use a role to run an AWS CLI command when you are signed in as an <a href="./id_roles_providers.html">externally authenticated user</a> (<a href="./id_roles_providers_saml.html">SAML</a> or <a href="./id_roles_providers_oidc.html">OIDC</a>) that is already using a role. In addition, you can use a role to run an AWS CLI
      command from within an Amazon EC2 instance that is attached to a role through its instance profile.
      You cannot assume a role when you are signed in as the AWS account root user.</p><p><a href="./id_roles_terms-and-concepts.html#iam-term-role-chaining">Role
         chaining</a> – You can also use role chaining, which is using
      permissions from a role to access a second role.</p><p>By default, your role session lasts for one hour. When you assume this role using the
         <code class="code">assume-role*</code> CLI operations, you can specify a value for the
         <code class="code">duration-seconds</code> parameter. This value can range from 900 seconds (15 minutes)
      up to the maximum session duration setting for the role. If you switch roles in the console, 
      your session duration is limited to maximum of one hour. To learn how to view the maximum
      value for your role, see <a href="./id_roles_use.html#id_roles_use_view-role-max-session">View the maximum session duration setting
        for a role</a>. </p><p>If you use role chaining, your session duration is limited to a maximum of one hour. If you
      then use the <code class="code">duration-seconds</code> parameter to provide a value greater than one hour,
      the operation fails.</p>
      <h2 id="switch-role-cli-scenario-prod-env">Example scenario: Switch to a
            production role</h2>
      <p>Imagine that you are an IAM user for working in the development environment. In this
         scenario, you occasionally need to work with the production environment at the command line
         with the <a href="http://aws.amazon.com/cli/" rel="noopener noreferrer" target="_blank"><span>AWS CLI</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. You already have an access
         key credential set available to you. This can be the access key pair that is assigned to
         your standard IAM user. Or, if you signed in as a federated user, it can be the access
         key pair for the role that was initially assigned to you. If your current permissions grant
         you the ability to assume a specific IAM role, then you can identify that role in a
         "profile" in the AWS CLI configuration files. That command is then run with the permissions
         of the specified IAM role, not the original identity. Note that when you specify that
         profile in an AWS CLI command, you are using the new role. In this situation, you cannot make
         use of your original permissions in the development account at the same time. The reason is
         that only one set of permissions can be in effect at a time.</p>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>For security purposes, administrators can <a href="./cloudtrail-integration.html#cloudtrail-integration_signin-tempcreds">review AWS CloudTrail logs</a> to
            learn who performed an action in AWS. Your administrator might require that you
            specify a source identity or a role session name when you assume the role. For more
            information, see <a href="./reference_policies_iam-condition-keys.html#ck_sourceidentity">sts:SourceIdentity</a> and <a href="./reference_policies_iam-condition-keys.html#ck_rolesessionname">sts:RoleSessionName</a>.</p></div></div>
      <div class="procedure"><h6>To switch to a production role (AWS CLI)</h6><ol><li><a id="step-configure-default"></a>
            <p>If you have never used the AWS CLI, then you must first configure your default CLI
               profile. Open a command prompt and set up your AWS CLI installation to use the access
               key from your IAM user or from your federated role. For more information, see
                  <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-getting-started.html#cli-quick-configuration">Configuring the AWS Command Line Interface</a> in the
               <em>AWS Command Line Interface User Guide</em>.</p>
            <p>Run the <a href="https://docs.aws.amazon.com/cli/latest/reference/configure/">aws configure</a> command as
               follows:</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws configure</code></code></pre>
            <p>When prompted, provide the following information:</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">AWS Access Key ID [None]: <code class="code" copy="true"><code class="replaceable">AKIAIOSFODNN7EXAMPLE</code></code>
AWS Secret Access Key [None]: <code class="code" copy="true"><code class="replaceable">wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY</code></code>
Default region name [None]: <code class="code" copy="true"><code class="replaceable">us-east-2</code></code>
Default output format [None]: <code class="code" copy="true"><code class="replaceable">json</code></code></code></pre>
         </li><li>
            <p>Create a new profile for the role in the <code>.aws/config</code> file in
               Unix or Linux, or the <code class="code">C:\Users\USERNAME\.aws\config</code> file in Windows. The
               following example creates a profile called <code class="code">prodaccess</code> that switches to
               the role <code class="code"><code class="replaceable">ProductionAccessRole</code></code> in the
                  <code class="code">123456789012</code> account. You get the role ARN from the account
               administrator who created the role. When this profile is invoked, the AWS CLI uses the
               credentials of the <code class="code">source_profile</code> to request credentials for the role.
               Because of that, the identity referenced as the <code class="code">source_profile</code> must have
                  <code class="code">sts:AssumeRole</code> permissions to the role that is specified in the
                  <code class="code">role_arn</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">[profile prodaccess]
    role_arn = arn:aws:iam::<code class="replaceable">123456789012</code>:role/ProductionAccessRole
    source_profile = default</code></pre>
         </li><li>
            <p>After you create the new profile, any AWS CLI command that specifies the parameter
                  <code class="code">--profile prodaccess</code> runs under the permissions that are attached to
               the IAM role <code class="code">ProductionAccessRole</code> instead of the default user.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iam list-users --profile prodaccess</code></pre>
            <p>This command works if the permissions assigned to the
                  <code class="code">ProductionAccessRole</code> enable listing the users in the current AWS
               account.</p>
         </li><li>
            <p>To return to the permissions granted by your original credentials, run commands
               without the <code class="code">--profile</code> parameter. The AWS CLI reverts to using the
               credentials in your default profile, which you configured in <a href="#step-configure-default">Step 1</a>.</p>
         </li></ol></div>
      <p>For more information, see <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-roles.html">Assuming a
            Role</a> in the <em>AWS Command Line Interface User Guide</em>.</p>
    
      <h2 id="switch-role-cli-scenario-ec2-instance">Example scenario: Allow an instance
            profile role to switch to a role in another account</h2>
      <p>Imagine that you are using two AWS accounts, and you want to allow an application
         running on an Amazon EC2 instance to run <a href="http://aws.amazon.com/cli/" rel="noopener noreferrer" target="_blank"><span>AWS CLI</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>
         commands in both accounts. Assume that the EC2 instance exists in account
            <code class="code">111111111111</code>. That instance includes the <code class="code">abcd</code>
         instance profile role that allows the application to perform read-only Amazon S3 tasks on the
            <code class="code">my-bucket-1</code> bucket within the same <code class="code">111111111111</code>
         account. However, the application must also be allowed to assume the <code class="code">efgh</code>
         cross-account role to perform tasks in account <code class="code">222222222222</code>. To do
         this, the <code class="code">abcd</code> EC2 instance profile role must have the following permissions
         policy:</p>
      <p><b><em>Account 111111111111
                  <code class="code">abcd</code> role permissions policy</em></b></p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "AllowAccountLevelS3Actions",
            "Effect": "Allow",
            "Action": [
                "s3:GetBucketLocation",
                "s3:GetAccountPublicAccessBlock",
                "s3:ListAccessPoints",
                "s3:ListAllMyBuckets"
            ],
            "Resource": "arn:aws:s3:::*"
        },
        <span>{</span>
            "Sid": "AllowListAndReadS3ActionOnMyBucket",
            "Effect": "Allow",
            "Action": [
                "s3:Get*",
                "s3:List*"
            ],
            "Resource": [
                "arn:aws:s3:::my-bucket-1/*",
                "arn:aws:s3:::my-bucket-1"
            ]
        },
        <span>{</span>
            "Sid": "AllowIPToAssumeCrossAccountRole",
            "Effect": "Allow",
            "Action": "sts:AssumeRole",
            "Resource": "arn:aws:iam::222222222222:role/efgh"
        }
    ]
}</code></pre>
      <p>Assume that the <code class="code">efgh</code> cross-account role allows read-only Amazon S3 tasks on the
            <code class="code">my-bucket-2</code> bucket within the same <code class="code">222222222222</code>
         account. To do this, the <code class="code">efgh</code> cross-account role must have the following
         permissions policy:</p>
      <p><b><em>Account 222222222222
                  <code class="code">efgh</code> role permissions policy</em></b></p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "AllowAccountLevelS3Actions",
            "Effect": "Allow",
            "Action": [
                "s3:GetBucketLocation",
                "s3:GetAccountPublicAccessBlock",
                "s3:ListAccessPoints",
                "s3:ListAllMyBuckets"
            ],
            "Resource": "arn:aws:s3:::*"
        },
        <span>{</span>
            "Sid": "AllowListAndReadS3ActionOnMyBucket",
            "Effect": "Allow",
            "Action": [
                "s3:Get*",
                "s3:List*"
            ],
            "Resource": [
                "arn:aws:s3:::my-bucket-2/*",
                "arn:aws:s3:::my-bucket-2"
            ]
        }
    ]
}</code></pre>
      <p>The <code class="code">efgh</code> role must allow the <code class="code">abcd</code> instance profile role to
         assume it. To do this, the <code class="code">efgh</code> role must have the following trust
         policy:</p>
      <p><b><em>Account 222222222222
                  <code class="code">efgh</code> role trust policy</em></b></p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "efghTrustPolicy",
            "Effect": "Allow",
            "Action": "sts:AssumeRole",
            "Principal": <span>{</span>"AWS": "arn:aws:iam::111111111111:role/abcd"}
        }
    ]
}</code></pre>
      <p>To then run AWS CLI commands in account <code class="code">222222222222</code>, you must
         update the CLI configuration file. Identify the <code class="code">efgh</code> role as the "profile" and
         the <code class="code">abcd</code> EC2 instance profile role as the "credential source" in the AWS CLI
         configuration file. Then your CLI commands are run with the permissions of the
            <code class="code">efgh</code> role, not the original <code class="code">abcd</code> role.</p>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>For security purposes, you can use AWS CloudTrail to audit the use of roles in the account.
            To differentiate between role sessions when a role is used by different principals in
            CloudTrail logs, you can use the role session name. When the AWS CLI assumes a role on a user's
            behalf as described in this topic, a role session name is automatically created as
                  <code class="code">AWS-CLI-session-<code class="replaceable">nnnnnnnn</code></code>. Here
               <code class="replaceable">nnnnnnnn</code> is an integer that represents the time in <a href="http://wikipedia.org/wiki/Unix_time" rel="noopener noreferrer" target="_blank"><span>Unix epoch time</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> (the number of
            seconds since midnight UTC on January 1, 1970). For more information, see <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/eventreference.html">CloudTrail Event Reference</a> in the
               <em>AWS CloudTrail User Guide</em>.</p></div></div>
      <div class="procedure"><h6>To allow an EC2 instance profile role to switch to a cross-account role
            (AWS CLI)</h6><ol><li>
            <p>You do not have to configure a default CLI profile. Instead, you can load
               credentials from the EC2 instance profile metadata. Create a new profile for the role
               in the <code>.aws/config</code> file. The following example creates an
                  <code class="code">instancecrossaccount</code> profile that switches to the role
                     <code class="code"><code class="replaceable">efgh</code></code> in the
                  <code class="code">222222222222</code> account. When this profile is invoked, the
               AWS CLI uses the credentials of the EC2 instance profile metadata to request
               credentials for the role. Because of that, the EC2 instance profile role must have
                  <code class="code">sts:AssumeRole</code> permissions to the role specified in the
                  <code class="code">role_arn</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">[profile instancecrossaccount]
role_arn = arn:aws:iam::<code class="replaceable">222222222222</code>:role/efgh
credential_source = Ec2InstanceMetadata</code></pre>
         </li><li>
            <p>After you create the new profile, any AWS CLI command that specifies the parameter
                  <code class="code">--profile instancecrossaccount</code> runs under the permissions that are
               attached to the <code class="code">efgh</code> role in account
               <code class="code">222222222222</code>.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws s3 ls my-bucket-2 --profile instancecrossaccount</code></pre>
            <p>This command works if the permissions that are assigned to the <code class="code">efgh</code>
               role allow listing the users in the current AWS account.</p>
         </li><li>
            <p>To return to the original EC2 instance profile permissions in account
                  <code class="code">111111111111</code>, run the CLI commands without the
                  <code class="code">--profile</code> parameter.</p>
         </li></ol></div>
      <p>For more information, see <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-roles.html">Assuming a
            Role</a> in the <em>AWS Command Line Interface User Guide</em>.</p>
   <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./id_roles_use_switch-role-console.html">Switching roles (console)</div><div id="next" class="next-link" accesskey="n" href="./id_roles_use_switch-role-twp.html">Switching roles (Tools for Windows PowerShell)</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_use_switch-role-cli.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>