<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Query suggestions - Amazon Kendra</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="query-suggestions" /><meta name="default_state" content="query-suggestions" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/kendra/latest/dg/query-suggestions.html" /><meta name="description" content="How to suggest queries in Amazon Kendra and autocomplete the search." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Kendra" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Provides a conceptual overview of Amazon Kendra. Learn about Amazon Kendra features and get started indexing your documents using the console, CLI, and API." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/kendra/latest/dg/query-suggestions.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/query-suggestions.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/query-suggestions.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kendra/latest/dg/query-suggestions.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kendra/latest/dg/query-suggestions.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/query-suggestions.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/query-suggestions.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kendra/latest/dg/query-suggestions.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kendra/latest/dg/query-suggestions.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/query-suggestions.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/query-suggestions.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kendra/latest/dg/query-suggestions.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kendra/latest/dg/query-suggestions.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/query-suggestions.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/query-suggestions.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kendra/latest/dg/query-suggestions.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kendra/latest/dg/query-suggestions.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kendra/latest/dg/query-suggestions.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kendra/latest/dg/query-suggestions.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/kendra/latest/dg/query-suggestions.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/kendra/latest/dg/query-suggestions.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/query-suggestions.html" hreflang="x-default" /><meta name="feedback-item" content="Kendra" /><meta name="this_doc_product" content="Amazon Kendra" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'kendra'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Query suggestions" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Query suggestions - Amazon Kendra</title><meta name="pdf" content="/pdfs/kendra/latest/dg/kendra-dg.pdf#query-suggestions" /><meta name="github" content="https://github.com/awsdocs/amazon-kendra-developer-guide/tree/master/doc_source/query-suggestions.md" /><meta name="rss" content="amazon-kendra-release-notes.rss" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=http://docs.aws.amazon.com/en_us/kendra/latest/dg/query-suggestions.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/kendra/latest/dg/query-suggestions.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/kendra/latest/dg/query-suggestions.html" /><meta name="keywords" content="Kendra,Amazon Kendra,search,intelligent search,natural language,index,question,keyword,data source,connector,FAQ,frequently asked question,query,query suggestions,autocomplete,typeahead" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Kendra",
        "item" : "https://docs.aws.amazon.com/kendra/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Searching indexes",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg/searching.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Query suggestions",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg/searching.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/kendra/latest/dg/kendra-dg.pdf#query-suggestions" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/amazon-kendra-developer-guide/tree/master/doc_source/query-suggestions.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/kendra/index.html">Amazon Kendra</a><a href="what-is-kendra.html">Developer Guide</a></div><div id="page-toc-src"><a href="#query-suggestions-history">Query suggestions using query
                    history</a><a href="#query-suggestions-doc-fields">Query suggestions using document
                    fields</a><a href="#query-suggestions-blocklist">Block certain queries or document
                    field content from suggestions</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="query-suggestions">Query suggestions</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Amazon Kendra
            <em>Query suggestions</em> can help your users type their search queries
            faster and guide their search.</p><p>Amazon Kendra suggests queries relevant to your users based on one of the
            following:</p><div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>Popular queries in the query history or query log</p>
            </li><li class="listitem">
                <p>The contents of document fields/attributes</p>
            </li></ul></div><p>You can set your preference for using the query history or document fields by setting
                    <code class="code">SuggestionTypes</code> as either
                <code class="code">QUERY</code> or <code class="code">DOCUMENT_ATTRIBUTES</code>
            and calling <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_GetQuerySuggestions.html">GetQuerySuggestions</a>. By default, Amazon Kendra uses
            the query history to base suggestions on. If the query history and document fields are
            both activated when you call <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_UpdateQuerySuggestionsConfig.html">UpdateQuerySuggestionsConfig</a> and you haven't set your
                    <code class="code">SuggestionTypes</code> preference to use document fields,
            then Amazon Kendra uses the query history.</p><p>If you use the console, you can base query suggestions on either the query history or
            document fields. You first select your index and then select <b>Query
                suggestions</b> under <b>Enrichments</b> in the navigation
            menu. Then select <b>Configure query suggestions</b>. After you configure
            query suggestions, you are directed to a search console where you can select either the
                <b>Query history</b> or <b>Document fields</b> in the
            right panel and enter a search query in the search bar.</p><p>By default, query suggestions using the query history and document fields are both
            activated at no additional cost. You can deactivate these types of query suggestions at
            any time by using the <code class="code">UpdateQuerySuggestionsConfig</code> API. To
            deactivate query suggestions based on the query history, set
                <code class="code">Mode</code> to <code class="code">DISABLED</code> when
            calling <code class="code">UpdateQuerySuggestionsConfig</code>. To deactivate query
            suggestions based on document fields, set
                <code class="code">AttributeSuggestionsMode</code> to
                    <code class="code">INACTIVE</code> in the document fields configuration and
            then call <code class="code">UpdateQuerySuggestionsConfig&gt;</code>. If you use the
            console, you can deactivate query suggestions in the <b>Query suggestions
                settings</b>.</p><p>Query suggestions are case insensitive. Amazon Kendra converts the query prefix
            and the suggested query to lower case, ignores all single and double quotation marks,
            and replaces multiple white space characters with a single space. Amazon Kendra
            matches all other special characters as they are. Amazon Kendra does not show any
            suggestions if a user types fewer than two characters or more than 60 characters.</p><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#query-suggestions-history">Query suggestions using query
                    history</a></li><li><a href="#query-suggestions-doc-fields">Query suggestions using document
                    fields</a></li><li><a href="#query-suggestions-blocklist">Block certain queries or document
                    field content from suggestions</a></li></ul></div>
            <h2 id="query-suggestions-history">Query suggestions using query
                    history</h2>
            <div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#query-suggestions-history-settings">Settings for selecting
                        queries for suggestions</a></li><li><a href="#query-suggestions-history-clear">Clear suggestions while
                        retaining query history</a></li><li><a href="#query-suggestions-history-none">No suggestions
                        available</a></li></ul></div>
            <p>You can choose to suggest queries relevant to your users based on popular queries
                in the query history or query log. Amazon Kendra uses all of the queries that
                your users search for and learns from these queries to make suggestions to your
                users. Amazon Kendra suggests popular queries to users when they start typing
                their query. Amazon Kendra suggests a query if the prefix or first few
                characters of the query matches what the user starts typing as their query.</p>
            <p>For example, a user starts typing the query 'upcoming events'. Amazon Kendra
                has learned from the query history that many users have searched for 'upcoming
                events 2050' many times. The user sees 'upcoming events 2050' appear directly
                underneath their search bar, autocompleting their search query. The user selects
                this query suggestion, and the document 'New events: What's happening in 2050' is
                returned in the search results.</p>
            <p>You can specify how Amazon Kendra selects eligible queries to suggest to your
                users. For example, you can specify that a query suggestion must have been searched
                by at least 10 unique users (default is three), have been searched within the last
                30 days, and does not contain any words or phrases from your <a href="https://docs.aws.amazon.com/kendra/latest/dg/query-suggestions.html#query-suggestions-blocklist">block
                    list</a>. Amazon Kendra requires that a query has at least one search
                result and contains at least one word of more than four characters.</p>
             
                <h3 id="query-suggestions-history-settings">Settings for selecting
                        queries for suggestions</h3>
                <p>You can configure the following settings for selecting queries for suggestions
                    by using the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_UpdateQuerySuggestionsConfig.html">UpdateQuerySuggestionsConfig</a> API:</p>
                <div class="itemizedlist">
                     
                     
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p><b>Mode</b>—Query suggestions using
                            the query history are either <code class="code">ENABLED</code> or
                                    <code class="code">LEARN_ONLY</code>. Amazon Kendra
                            activates query suggestions by default.
                                <code class="code">LEARN_ONLY</code> turns off query suggestions.
                            If turned off, Amazon Kendra continues to learn suggestions but
                            doesn't make query suggestions to users.</p>
                    </li><li class="listitem">
                        <p><b>Query log time window</b>—How
                            recent your queries are in your query log time window. The time window
                            is an integer value for the number of days from current day to past
                            days.</p>
                    </li><li class="listitem">
                        <p><b>Queries without user
                            information</b>—Set to <code class="code">TRUE</code> to
                            include all queries, or set to <code class="code">FALSE</code> to only
                            include queries with user information. You can use this setting if your
                            search application includes user information, such as the user ID, when
                            a user issues a query. By default, this setting doesn't filter out
                            queries if there's no specific user information associated with the
                            queries. However, you can use this setting to only make suggestions
                            based on queries that include user information.</p>
                    </li><li class="listitem">
                        <p><b>Unique users</b>—The minimum
                            number of unique users who must search a query for the query to be
                            eligible to suggest to your users. This number is an integer
                            value.</p>
                    </li><li class="listitem">
                        <p><b>Query count</b>—The minimum number
                            of times a query must be searched for the query to be eligible to
                            suggest to your users. This number is an integer value.</p>
                    </li></ul></div>
                <p>These settings affect how queries are selected as popular queries to suggest
                    to your users. How you tune your settings will depend on your specific needs,
                    for example:</p>
                <div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>If your users usually search once a month on average, then you can set
                            the number of days in the query log time window to 30 days. By using
                            that setting, you capture most of your users' recent queries before they
                            become outdated in the time window.</p>
                    </li><li class="listitem">
                        <p>If only a small number of your queries include user information, and
                            you don't want to suggest queries based on a small sample size, then you
                            can set queries to include all users.</p>
                    </li><li class="listitem">
                        <p>If you define popular queries as being searched by at least 10 unique
                            users and searched at least 100 times, then you set the unique users to
                            10 and the query count to 100.</p>
                    </li></ul></div>
                <div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Warning</h6></div><div class="awsdocs-note-text"><p>Your changes to settings might not take effect immediately. You can track
                        the settings changes by using the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_DescribeQuerySuggestionsConfig.html">DescribeQuerySuggestionsConfig</a> API. The time
                        for your updated settings to take effect depends on the updates that you
                        make and the number of search queries in your index. Amazon Kendra
                        automatically updates suggestions every 24 hours, after you change a setting
                        or after you apply a <a href="https://docs.aws.amazon.com/kendra/latest/dg/query-suggestions.html#query-suggestions-blocklist">block list</a>.</p></div></div>
                <awsdocs-tabs><dl style="display: none">
                    <dt>CLI</dt><dd tab-id="cli">
                            <p><b>To retrieve query
                                suggestions</b></p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws kendra get-query-suggestions \
 --index-id <code class="replaceable">index-id</code> \
 --query-text "query-text" \
 --suggestion-types '["QUERY"]' \
 --max-suggestions-count 1 // If you want to limit the number of suggestions</code></pre>
                            <p><b>To update query
                                suggestions</b></p>
                            <p>For example, to change the query log time window and the minimum
                                number of times a query must be searched:</p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws kendra update-query-suggestions-config \
 --index-id <code class="replaceable">index-id</code> \
 --query-log-look-back-window-in-days 30 \
 --minimum-query-count 100</code></pre>
                        </dd>
                    <dt>Python</dt><dd tab-id="python">
                            <p><b>To retrieve query
                                suggestions</b></p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import boto3
from botocore.exceptions import ClientError

kendra = boto3.client("kendra")

print("Get query suggestions.")

# Provide the index ID
index_id = "index-id"

# Provide the query text
query_text = "query"

# Provide the query suggestions type
query_suggestions_type = "QUERY"


# If you want to limit the number of suggestions
num_suggestions = 1
 
try:
    query_suggestions_response = kendra.get_query_suggestions(
        IndexId = index_id,
        QueryText = query_text,
        SuggestionTypes = query_suggestions_type,
        MaxSuggestionsCount = num_suggestions
    )

    # Print out the suggestions you received
    if ("Suggestions" in query_suggestions_response.keys()) <span>{</span>
        for (suggestion: query_suggestions_response["Suggestions"]) <span>{</span>
            print(suggestion["Value"]["Text"]["Text"]);
        }
    }
   
except ClientError as e:
        print("%s" % e)

print("Program ends.")</code></pre>
                            <p><b>To update query
                                suggestions</b></p>
                            <p>For example, to change the query log time window and the minimum
                                number of times a query must be searched:</p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import boto3
from botocore.exceptions import ClientError
import pprint
import time

kendra = boto3.client("kendra")

print("Updating query suggestions settings/configuration for an index.")

# Provide the index ID
index_id = "index-id"

# Configure the settings you want to update
minimum_query_count = 100
query_log_look_back_window_in_days = 30

try:
    kendra.update_query_suggestions_config(
        IndexId = index_id,
        MinimumQueryCount = minimum_query_count,
        QueryLogLookBackWindowInDays = query_log_look_back_window_in_days
    )

    print("Wait for Amazon Kendra to update the query suggestions.")

    while True:
        # Get query suggestions description of settings/configuration
        query_sugg_config_response = kendra.describe_query_suggestions_config(
            IndexId = index_id
        )
        
        # If status is not UPDATING, then quit
        status = query_sugg_config_response["Status"]
        print(" Updating query suggestions config. Status: " + status)
        if status != "UPDATING":
            break
        time.sleep(60)

except ClientError as e:
        print("%s" % e)

print("Program ends.")</code></pre>
                        </dd>
                </dl></awsdocs-tabs>
             
             
                <h3 id="query-suggestions-history-clear">Clear suggestions while
                        retaining query history</h3>
                <p>You can clear query suggestions by using the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_DescribeQuerySuggestionsConfig.html">ClearQuerySuggestions</a> API. Clearing suggestions
                    deletes existing query suggestions only, not the queries in the query history.
                    When you clear suggestions, Amazon Kendra learns new suggestions based on
                    new queries added to the query log from the time you cleared suggestions.</p>
                <awsdocs-tabs><dl style="display: none">
                    <dt>CLI</dt><dd tab-id="cli">
                            <p><b>To clear query suggestions</b></p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws  kendra clear-query-suggestions \
 --index-id <code class="replaceable">index-id</code></code></pre>
                        </dd>
                    <dt>Python</dt><dd tab-id="python">
                            <p><b>To clear query suggestions</b></p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import boto3
from botocore.exceptions import ClientError

kendra = boto3.client("kendra")

print("Clearing out query suggestions for an index.")

# Provide the index ID
index_id = "index-id"

try:
    kendra.clear_query_suggestions(
        IndexId = index_id
    )

    # Confirm last cleared date-time and that there are no suggestions
    query_sugg_config_response = kendra.describe_query_suggestions_config(
        IndexId = index_id
    )
    print("Query Suggestions last cleared at: " + str(query_sugg_config_response["LastClearTime"]));
    print("Number of suggestions available from the time of clearing: " + str(query_sugg_config_response["TotalSuggestionsCount"]));
        
except ClientError as e:
        print("%s" % e)

print("Program ends.")</code></pre>
                        </dd>
                </dl></awsdocs-tabs>
             
             
                <h3 id="query-suggestions-history-none">No suggestions
                        available</h3>
                <p>If you don't see suggestions for a query, it could be for one of the following
                    reasons:</p>
                <div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>There are not enough queries in your index for Amazon Kendra to
                            learn from.</p>
                    </li><li class="listitem">
                        <p>Your query suggestions settings are too strict, resulting in most
                            queries being filtered out from suggestions.</p>
                    </li><li class="listitem">
                        <p>You recently cleared suggestions, and Amazon Kendra still needs
                            time for new queries to accumulate in order to learn new
                            suggestions.</p>
                    </li></ul></div>
                <p>You can check your current settings using the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_DescribeQuerySuggestionsConfig.html">DescribeQuerySuggestionsConfig</a> API.</p>
             
         
            <h2 id="query-suggestions-doc-fields">Query suggestions using document
                    fields</h2>
            <div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#query-suggestions-doc-fields-settings">Settings for selecting
                        fields for suggestions</a></li><li><a href="#query-suggestions-doc-fields-user-control">User control in
                        document fields</a></li></ul></div>
            <p>You can choose to suggest queries relevant to your users based on the contents of
                document fields. Instead of using the query history to suggest other popular
                relevant queries, you can use information contained within a document field that is
                useful to autocompleting the query. Amazon Kendra looks for relevant content in
                fields set to <code class="code">Suggestable</code> and that closely aligns with
                your user's query. Then, Amazon Kendra suggests this content to your user when
                they start typing their query.</p>
            <p>For example, if you specify the title field to base suggestions on and a user
                starts typing the query 'How amazon ken...', the most relevant title 'How Amazon Kendra works' could be suggested to autocomplete the search. The user sees
                'How Amazon Kendra works' appear directly underneath their search bar,
                autocompleting their search query. The user selects this query suggestion, and the
                document 'How Amazon Kendra works' is returned in the search results.</p>
            <p>You can use the contents of any document field of
                    <code class="code">String</code> and <code class="code">StringList</code>
                type to suggest a query by setting the field to
                    <code class="code">Suggestable</code> as part of your fields configuration for
                query suggestions. You can also use a <a href="https://docs.aws.amazon.com/kendra/latest/dg/query-suggestions.html#query-suggestions-blocklist">block
                    list</a> so that suggested document fields that contain certain words or
                phrases are not shown to your users. You can use one block list. The block list
                applies whether you set query suggestions to use the query history or document
                fields.</p>
             
                <h3 id="query-suggestions-doc-fields-settings">Settings for selecting
                        fields for suggestions</h3>
                <p>You can configure the following settings for selecting document fields for
                    suggestions using <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_AttributeSuggestionsConfig.html">AttributeSuggestionsConfig</a> and calling the
                        <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_UpdateQuerySuggestionsConfig.html">UpdateQuerySuggestionsConfig</a> API to update the
                    settings at the index level:</p>
                <div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p><b>Field/attribute suggestions
                            mode</b>—Query suggestions using document fields are
                            either <code class="code">ACTIVE</code> or
                                    <code class="code">INACTIVE</code>. Amazon Kendra
                            activates query suggestions by default.</p>
                    </li><li class="listitem">
                        <p><b>Suggestible
                            fields/attributes</b>—The field names or field keys to
                            base suggestions on. These fields must be set to
                                    <code class="code">TRUE</code> for
                                    <code class="code">Suggestable</code>, as part of the fields
                            configuration. You can override the fields configuration at the query
                            level while maintaining the configuration at the index level. Use the
                                <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_GetQuerySuggestions.html">GetQuerySuggestions</a> API to change
                                    <code class="code">AttributeSuggestionConfig</code> at the
                            query level. This configuration at the query level can be useful for
                            quickly experimenting with using different document fields without
                            having to update the configuration at the index level.</p>
                    </li><li class="listitem">
                        <p><b>Additional
                            fields/attributes</b>—The additional fields that you want
                            to include in the response for a query suggestion. These fields are used
                            to provide extra information in the response; however, they are not used
                            to base suggestions on.</p>
                    </li></ul></div>
                <div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Warning</h6></div><div class="awsdocs-note-text"><p>Your changes to settings might not take effect immediately. You can track
                        the settings changes by using the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_DescribeQuerySuggestionsConfig.html">DescribeQuerySuggestionsConfig</a> API. The time
                        for your updated settings to take effect depends on the updates that you
                        make. Amazon Kendra automatically updates suggestions every 24 hours,
                        after you change a setting or after you apply a <a href="https://docs.aws.amazon.com/kendra/latest/dg/query-suggestions.html#query-suggestions-blocklist">block list</a>.</p></div></div>
                <awsdocs-tabs><dl style="display: none">
                    <dt>CLI</dt><dd tab-id="cli">
                            <p>To retrieve query suggestions and override the document fields
                                configuration at the query level instead of having to change the
                                configuration at the index level.</p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws kendra get-query-suggestions \
 --index-id <code class="replaceable">index-id</code> \
 --query-text "query-text" \
 --suggestion-types '["DOCUMENT_ATTRIBUTES"]' \
 --attribute-suggestions-config '<span>{</span>"SuggestionAttributes":'["field/attribute key 1", "field/attribute key 2"]', "AdditionalResponseAttributes":'["response field/attribute key 1", "response field/attribute key 2"]'}' \
 --max-suggestions-count 1 // If you want to limit the number of suggestions</code></pre>
                            <p><b>To update query
                                suggestions</b></p>
                            <p>For example, to change the document fields configuration at the
                                index level:</p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws kendra update-query-suggestions-config \
 --index-id index-id \
 --attribute-suggestions-config '<span>{</span>"SuggestableConfigList": '[<span>{</span>"SuggestableConfig": "_document_title", "Suggestable": true}]', "AttributeSuggestionsMode": "ACTIVE"}'</code></pre>
                        </dd>
                    <dt>Python</dt><dd tab-id="python">
                            <p>To retrieve query suggestions and override the document fields
                                configuration at the query level instead of having to change the
                                configuration at the index level.</p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import boto3
from botocore.exceptions import ClientError

kendra = boto3.client("kendra")

print("Get query suggestions.")

# Provide the index ID
index_id = "index-id"

# Provide the query text
query_text = "query"

# Provide the query suggestions type
query_suggestions_type = "DOCUMENT_ATTRIBUTES"

# Override fields/attributes configuration at query level
configuration = <span>{</span>"SuggestionAttributes":
    '["field/attribute key 1", "field/attribute key 2"]', 
      "AdditionalResponseAttributes":
          '["response field/attribute key 1", "response field/attribute key 2"]'
          }

# If you want to limit the number of suggestions
num_suggestions = 1

try:
    query_suggestions_response = kendra.get_query_suggestions(
        IndexId = index_id,
        QueryText = query_text,
        SuggestionTypes = [query_suggestions_type],
        AttributeSuggestionsConfig = configuration,
        MaxSuggestionsCount = num_suggestions
    )

    # Print out the suggestions you received
    if ("Suggestions" in query_suggestions_response.keys()) <span>{</span>
        for (suggestion: query_suggestions_response["Suggestions"]) <span>{</span>
            print(suggestion["Value"]["Text"]["Text"]);
        }
    }
   
except ClientError as e:
        print("%s" % e)

print("Program ends.")</code></pre>
                            <p><b>To update query
                                suggestions</b></p>
                            <p>For example, to change the document fields configuration at the
                                index level:</p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import boto3
from botocore.exceptions import ClientError
import pprint
import time

kendra = boto3.client("kendra")

print("Updating query suggestions settings/configuration for an index.")

# Provide the index ID
index_id = "index-id"

# Configure the settings you want to update at the index level
configuration = <span>{</span>"SuggestableConfigList": 
    '[<span>{</span>"SuggestableConfig": "_document_title", "Suggestable": true}]', 
       "AttributeSuggestionsMode": "ACTIVE"
       }

try:
    kendra.update_query_suggestions_config(
        IndexId = index_id,
        AttributeSuggestionsConfig = configuration
    )

    print("Wait for Amazon Kendra to update the query suggestions.")

    while True:
        # Get query suggestions description of settings/configuration
        query_sugg_config_response = kendra.describe_query_suggestions_config(
            IndexId = index_id
        )
        
        # If status is not UPDATING, then quit
        status = query_sugg_config_response["Status"]
        print(" Updating query suggestions config. Status: " + status)
        if status != "UPDATING":
            break
        time.sleep(60)

except ClientError as e:
        print("%s" % e)

print("Program ends.")</code></pre>
                        </dd>
                </dl></awsdocs-tabs>
             
             
                <h3 id="query-suggestions-doc-fields-user-control">User control in
                        document fields</h3>
                <p>You can apply user context filtering to the document fields that you want to
                    base query suggestions on. This filters document field information based on the
                    user or their group access to documents. For example, an intern searches the
                    company's portal and doesn't have access to a top-secret company document.
                    Therefore, suggested queries based on the top-secret document's title, or any
                    other suggestible field, is not shown to the intern.</p>
                <p>You can index your documents with an access control list (ACL), defining which
                    users and groups are assigned access to which documents. Then, you can apply
                    user context filtering to your documents fields for query suggestions. User
                    context filtering that is currently set for your index is the same user context
                    filtering applied to your document fields configuration for query suggestions.
                    User context filtering is part of your document fields configuration. You use
                    the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_AttributeSuggestionsConfig.html">AttributeSuggestionsGetConfig</a> and call <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_GetQuerySuggestions.html">GetQuerySuggestions</a>.</p>
             
         
            <h2 id="query-suggestions-blocklist">Block certain queries or document
                    field content from suggestions</h2>
            <p>A <em>block list</em> stops Amazon Kendra from
                suggesting certain queries to your users. A block list is a list of words or phrases
                that you want to exclude from query suggestions. Amazon Kendra excludes queries
                containing an exact match of the words or phrases in the block list.</p>
            <p>You can use a block list to safeguard against offensive words or phrases that
                commonly appear in your query history or document fields and that Amazon Kendra
                could select as suggestions. A block list can also prevent Amazon Kendra from
                suggesting queries that contain information that is not ready to be publicly
                released or announced. For example, your users frequently query about an upcoming
                release of a potential new product. However, you don't want to suggest the product
                because you're not ready to release it.You can block queries that contain the
                product name and product information from suggestions.</p>
            <p>You can create a block list for queries by using the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_CreateQuerySuggestionsBlockList.html">CreateQuerySuggestionsBlockList</a> API. You put each
                block word or phrase on a separate line in a text file. Then you upload the text
                file to your Amazon S3 bucket and provide the path or location to the file in Amazon S3. Amazon Kendra currently supports creating only one block
                list.</p>
            <p>You can replace the text file of your blocked words and phrases in your Amazon S3 bucket. To update the block list in Amazon Kendra, use the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_UpdateQuerySuggestionsBlockList.html">UpdateQuerySuggestionsBlockList</a> API.</p>
            <p>Use the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_DescribeQuerySuggestionsBlockList.html">DescribeQuerySuggestionsBlockList</a> API to get the
                status of your block list.
                    <code class="code">DescribeQuerySuggestionsBlockList</code> can also provide
                you with other useful information, such as the following: </p>
            <div class="itemizedlist">
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>When your block list was last updated</p>
                </li><li class="listitem">
                    <p>How many words or phrases are in your current block list</p>
                </li><li class="listitem">
                    <p>Helpful error messages when creating a block list</p>
                </li></ul></div>
            <p>You can also use the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_ListQuerySuggestionsBlockLists.html">ListQuerySuggestionsBlockLists</a> API to get a list of
                block list summaries for an index.</p>
            <p>To delete your block list, use the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_DeleteQuerySuggestionsBlockList.html">DeleteQuerySuggestionsBlockList</a> API.</p>
            <p>Your updates to the block list might not take effect right away. You can track
                updates by using the <code class="code">DescribeQuerySuggestionsBlockList</code>
                API.</p>
            <awsdocs-tabs><dl style="display: none">
                <dt>CLI</dt><dd tab-id="cli">
                        <p><b>To create a block list</b></p>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws kendra create-query-suggestions-block-list \
 --index-id <code class="replaceable">index-id</code> \
 --name "block-list-name" \
 --description "block-list-description" \
 --source-s3-path "Bucket=bucket-name,Key=query-suggestions/block_list.txt" \
 --role-arn <code class="replaceable">role-arn</code></code></pre>
                        <p><b>To update a block list</b></p>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws kendra update-query-suggestions-block-list \
 --index-id <code class="replaceable">index-id</code> \
 --name "new-block-list-name" \
 --description "new-block-list-description" \
 --source-s3-path "Bucket=bucket-name,Key=query-suggestions/new_block_list.txt" \
 --role-arn <code class="replaceable">role-arn</code></code></pre>
                        <p><b>To delete a block list</b></p>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws kendra delete-query-suggestions-block-list \
 --index-id <code class="replaceable">index-id</code> \
 --id <code class="replaceable">block-list-id</code></code></pre>
                    </dd>
                <dt>Python</dt><dd tab-id="python">
                        <p><b>To create a block list</b></p>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import boto3
from botocore.exceptions import ClientError
import pprint
import time

kendra = boto3.client("kendra")

print("Create a query suggestions block list.")

# Provide a name for the block list
block_list_name = "block-list-name"
# Provide an optional description for the block list
block_list_description = "block-list-description"
# Provide the IAM role ARN required for query suggestions block lists
block_list_role_arn = "role-arn"

# Provide the index ID
index_id = "index-id"

s3_bucket_name = "bucket-name"
s3_key = "query-suggestions/block_list.txt"
source_s3_path = <span>{</span>
    'Bucket': s3_bucket_name,
    'Key': s3_key
}

try:
    block_list_response = kendra.create_query_suggestions_block_list(
        Description = block_list_description,
        Name = block_list_name,
        RoleArn = block_list_role_arn,
        IndexId = index_id,
        SourceS3Path = source_s3_path
    )

    print(block_list_response)

    block_list_id = block_list_response["Id"]

    print("Wait for Amazon Kendra to create the block list.")

    while True:
        # Get block list description
        block_list_description = kendra.describe_query_suggestions_block_list(
            Id = block_list_id,
            IndexId = index_id
        )
        # If status is not CREATING, then quit
        status = block_list_description["Status"]
        print("Creating block list. Status: " + status)
        if status != "CREATING":
            break
        time.sleep(60)
        
except ClientError as e:
        print("%s" % e)

print("Program ends.")</code></pre>
                        <p><b>To update a block list</b></p>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import boto3
from botocore.exceptions import ClientError
import pprint
import time
                        
kendra = boto3.client("kendra")
                        
print("Update a block list for query suggestions.")

# Provide the block list name you want to update
block_list_name = "new-block-list-name"
# Provide the block list description you want to update
block_list_description = "new-block-list-description"
# Provide the IAM role ARN required for query suggestions block lists
block_list_role_arn = "role-arn"

# Provide the block list ID
block_list_id = "block-list-id"
# Provide the index ID
index_id = "index-id"
                        
s3_bucket_name = "bucket-name"
s3_key = "query-suggestions/new_block_list.txt"
source_s3_path = <span>{</span>
'Bucket': s3_bucket_name,
'Key': s3_key
}
                        
try:
    kendra.update_query_suggestions_block_list(
        Id = block_list_id,
        IndexId = index_id,
        Description = block_list_description,
        Name = block_list_name,
        RoleArn = block_list_role_arn,
        SourceS3Path = source_s3_path
    )
                        
    print("Wait for Amazon Kendra to update the block list.")
                        
    while True:
        # Get block list description
        block_list_description = kendra.describe_query_suggestions_block_list(
            Id = block_list_id,
            IndexId = index_id
        )
        # If status is not UPDATING, then the update has finished 
        status = block_list_description["Status"]
        print("Updating block list. Status: " + status)
        if status != "UPDATING":
            break
        time.sleep(60)
                        
except ClientError as e:
print("%s" % e)
                        
print("Program ends.")</code></pre>
                        <p><b>To delete a block list</b></p>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import boto3
from botocore.exceptions import ClientError

kendra = boto3.client("kendra")

print("Delete a block list for query suggestions.")

# provide the block list ID
query_suggestions_block_list_id = "query-suggestions-block-list-id"
# Provide the index ID
index_id = "index-id"

try:
    kendra.delete_query_suggestions_block_list(
        Id = query_suggestions_block_list_id,
        IndexId = index_id
    )

except ClientError as e:
        print("%s" % e)

print("Program ends.")</code></pre>
                    </dd>
            </dl></awsdocs-tabs>
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./searching-tables.html">Tabular search for HTML</div><div id="next" class="next-link" accesskey="n" href="./query-spell-check.html">Query spell checker</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=https://docs.aws.amazon.com/en_us/kendra/latest/dg/query-suggestions.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=https://docs.aws.amazon.com/en_us/kendra/latest/dg/query-suggestions.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>