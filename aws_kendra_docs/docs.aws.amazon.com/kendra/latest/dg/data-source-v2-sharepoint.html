<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>SharePoint connector V2.0 - Amazon Kendra</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="data-source-v2-sharepoint" /><meta name="default_state" content="data-source-v2-sharepoint" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/kendra/latest/dg/data-source-v2-sharepoint.html" /><meta name="description" content="SharePoint is a collaborative website building service that you can use to customize web content and create pages, sites, document libraries, and lists. You can use Amazon Kendra to index your SharePoint data source." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Kendra" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Provides a conceptual overview of Amazon Kendra. Learn about Amazon Kendra features and get started indexing your documents using the console, CLI, and API." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/kendra/latest/dg/data-source-v2-sharepoint.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/data-source-v2-sharepoint.html" hreflang="x-default" /><meta name="feedback-item" content="Kendra" /><meta name="this_doc_product" content="Amazon Kendra" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'kendra'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="SharePoint connector V2.0" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>SharePoint connector V2.0 - Amazon Kendra</title><meta name="pdf" content="/pdfs/kendra/latest/dg/kendra-dg.pdf#data-source-v2-sharepoint" /><meta name="github" content="https://github.com/awsdocs/amazon-kendra-developer-guide/tree/master/doc_source/data-source-v2-sharepoint.md" /><meta name="rss" content="amazon-kendra-release-notes.rss" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=http://docs.aws.amazon.com/en_us/kendra/latest/dg/data-source-v2-sharepoint.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/kendra/latest/dg/data-source-v2-sharepoint.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/kendra/latest/dg/data-source-v2-sharepoint.html" /><meta name="keywords" content="Kendra,Amazon Kendra,search,intelligent search,natural language,index,question,keyword,data source,connector,FAQ,frequently asked question,SharePoint" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Kendra",
        "item" : "https://docs.aws.amazon.com/kendra/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Creating a data source connector",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg/data-source.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Data source connectors",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg/data-sources.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Microsoft SharePoint",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg/data-source-sharepoint.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "SharePoint connector V2.0",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg/data-source-sharepoint.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/kendra/latest/dg/kendra-dg.pdf#data-source-v2-sharepoint" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/amazon-kendra-developer-guide/tree/master/doc_source/data-source-v2-sharepoint.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/kendra/index.html">Amazon Kendra</a><a href="what-is-kendra.html">Developer Guide</a></div><div id="page-toc-src"><a href="#supported-features-v2-sharepoint">Supported features</a><a href="#prerequisites-v2-sharepoint">Prerequisites</a><a href="#data-source-procedure-v2-sharepoint">Connection
                    instructions</a><a href="#sharepoint-notes">Notes</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="data-source-v2-sharepoint">SharePoint connector
                V2.0</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>SharePoint is a collaborative website building service that you can use to
            customize web content and create pages, sites, document libraries, and lists. You can
            use Amazon Kendra to index your SharePoint data source.</p><p>Amazon Kendra currently supports SharePoint Cloud and SharePoint
            Server (2013, 2016, 2019, and Subscription Edition).</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Support for SharePoint connector V1.0 / SharePointConfiguration API is
   scheduled to end in 2023. We recommend migrating to or using SharePoint connector V2.0 /
   TemplateConfiguration API.</p></div></div><p>For troubleshooting your Amazon Kendra SharePoint data source connector, see <a href="./troubleshooting-data-sources.html">Troubleshooting data sources</a>.</p><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#supported-features-v2-sharepoint">Supported features</a></li><li><a href="#prerequisites-v2-sharepoint">Prerequisites</a></li><li><a href="#data-source-procedure-v2-sharepoint">Connection
                    instructions</a></li><li><a href="#sharepoint-notes">Notes</a></li></ul></div>
            <h2 id="supported-features-v2-sharepoint">Supported features</h2>
            <p>Amazon Kendra SharePoint data source connector supports the following
                features:</p>
            <div class="itemizedlist">
                 
                 
                 
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>Field mappings</p>
                </li><li class="listitem">
                    <p>Identity crawling</p>
                </li><li class="listitem">
                    <p>User context filtering</p>
                </li><li class="listitem">
                    <p>Virtual private cloud (VPC)</p>
                </li><li class="listitem">
                    <p>Inclusion/exclusion patterns</p>
                </li><li class="listitem">
                    <p>Full sync/New or modified content sync/New, modified, or deleted content
                        sync</p>
                </li></ul></div>
         
            <h2 id="prerequisites-v2-sharepoint">Prerequisites</h2>
            <p>Before you can use Amazon Kendra to index your SharePoint data
                source, make these changes in your SharePoint and AWS
                accounts.</p>


            <p><b>In SharePoint Online, make sure you
                have:</b></p>
            <div class="itemizedlist">
                 
                 
                 
                 
                 
                 
                 
                 

            <ul class="itemizedlist"><li class="listitem">
                    <p>Copied your SharePoint instance URLs. The format for the host URL
                        you enter is
                            <code class="replaceable">https://yourcompany.sharepoint.com/sites/mysite</code>.
                        Your URL must start with <code class="code">https</code>.</p>
                </li><li class="listitem">
                    <p>Copied the domain name of your SharePoint instance URL.</p>
                </li><li class="listitem">
                    <p>Noted your basic authentication credentials containing the user name and
                        password you use to connect to SharePoint Online.</p>
                </li><li class="listitem">
                    <p><b>If using authentication type other than basic
                            authentication:</b> Copied the tenant ID of your
                        SharePoint instance. For details on how to find your tenant ID, see
                            <a href="https://learn.microsoft.com/en-us/sharepoint/find-your-office-365-tenant-id" rel="noopener noreferrer" target="_blank"><span>Find your Microsoft 365 tenant ID</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
                </li><li class="listitem">
                    <p><b>For OAuth 2.0 authentication:</b> Noted your
                        basic authentication credentials containing the user name and password you
                        use to connect to SharePoint Online and the Azure AD client ID and
                        Azure AD client secret generated after registering SharePoint with
                        Azure AD.</p>
                </li><li class="listitem">
                    <p><b>For Azure AD App-Only:</b> Noted the X.509
                        certificate, private key, and the Azure AD client ID you generated after
                        registering SharePoint with Azure AD.</p>
                </li><li class="listitem">
                    <p><b>For SharePoint App-Only:</b> Noted
                        your SharePoint client ID and client secret generated while granting
                        permission to SharePoint App Only, and your Azure AD client ID and
                        Azure AD client secret generated when you registered SharePoint with
                        Azure AD.</p>
                </li><li class="listitem">
                    <p>Activated admin consent from a tenant and then added the following API
                        permissions in your Azure Portal for SharePoint Online:</p>

                    <div class="table-container"><div class="table-contents disable-scroll"><table id="w213aac23c19d135c33c19b7c15b3"><thead>
                                <tr>
                                    <th align="center" style="text-align: center;"><b>Microsoft
                                            Graph</b></th>
                                    <th align="center" style="text-align: center;"><b>SharePoint</b></th>
                                </tr>
                            </thead>
                                <tr>
                                    <td>
                                        <div class="itemizedlist">

                                             
                                             
                                             
                                             
                                             
                                             
                                             
                                        <ul class="itemizedlist"><li class="listitem">
                                                <p>Group.Read.All (Read all groups)</p>
                                            </li><li class="listitem">
                                                <p>GroupMember.Read.All (Read all group
                                                  memberships)</p>
                                            </li><li class="listitem">
                                                <p>Notes.Read.All (Read all OneNote
                                                  notebooks)</p>
                                            </li><li class="listitem">
                                                <p>Sites.FullControl.All (Have full control of
                                                  all site collections)</p>
                                            </li><li class="listitem">
                                                <p>Sites.Read.All (Read items in all site
                                                  collections)</p>
                                            </li><li class="listitem">
                                                <p>User.Read (Sign in and read user
                                                  profile)</p>
                                            </li><li class="listitem">
                                                <p>User.Read.All (Read all users' full
                                                  profiles)</p>
                                            </li></ul></div></td>
                                    <td><div class="itemizedlist">
                                             
                                        <ul class="itemizedlist"><li class="listitem">
                                                <p>Sites.FullControl.All (Have full control of
                                                  all site collections)</p>
                                            </li></ul></div></td>
                                </tr>
                            </table></div></div>
                    <p>For more information on adding API permissions in the Azure portal, see
                            <a href="https://learn.microsoft.com/en-us/azure/active-directory/develop/quickstart-configure-app-access-web-apis" rel="noopener noreferrer" target="_blank"><span>Quickstart: Configure a client application to access a web
                        API</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
                    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Sites.FullControl.All permission is required for Amazon Kendra to
                            crawl entities and user permissions (ACL) for SharePoint Online.
                            If Sites.FullControl.All is not provided for OAuth 2.0
                            authentication:</p><div class="itemizedlist">
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p>comments, attachments, and OneNote documents will be crawled
                                    without ACL details.</p>
                            </li><li class="listitem">
                                <p>documents, pages, events, and links will not be crawled from
                                    either main sites or subsites.</p>
                            </li></ul></div></div></div>
                </li></ul></div>


            <p><b>In SharePoint Server, make sure you
                have:</b></p>
            <div class="itemizedlist">
                 
                 

                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>Copied your SharePoint instance URLs and the domain name of your
                        SharePoint URLs. The format for the host URL you enter is
                            <code class="replaceable">https://yourcompany.sharepoint.com/sites/mysite</code>.
                        Your URL must start with <code class="code">https</code>.</p>
                    
 <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>(On-premise/server) Amazon Kendra checks if the endpoint information included in  
 AWS Secrets Manager is the same the endpoint information specified in your data source 
 configuration details. This helps protect against the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/confused-deputy.html">confused deputy problem</a>, which is a 
 security issue where a user doesn’t have permission to perform an action but uses 
 Amazon Kendra as a proxy to access the configured secret and perform the action. If you 
 later change your endpoint information, you must update or create a new secret to sync this 
 information.</p></div></div>

                </li><li class="listitem">
                    <p>If using <b>Email ID with Domain from IDP</b> for access
                        control:</p>
                    <div class="itemizedlist">
                         
                         
                    <ul class="itemizedlist"><li class="listitem">
                            <p>Copied your SharePoint Server LDAP.</p>
                        </li><li class="listitem">
                            <p>Noted your custom email domain value—for example:
                                    <code class="replaceable">"amazon.com"</code>.</p>
                        </li></ul></div>
                </li><li class="listitem">
                    <p>If using <b>Email ID with Domain from IDP</b> authorization,
                        copied your:</p>
                    <div class="itemizedlist">
                         
                         
                         
                    <ul class="itemizedlist"><li class="listitem">
                            <p>LDAP Server Endpoint (endpoint of LDAP server including protocol
                                and port number). For example:
                                    <code class="replaceable">ldap://example.com:389</code>.</p>
                        </li><li class="listitem">
                            <p>LDAP Search Base (search base of the LDAP user). For example:
                                    <code class="replaceable">CN=Users,DC=sharepoint,DC=com</code>.</p>
                        </li><li class="listitem">
                            <p>LDAP user name and LDAP password.</p>
                        </li></ul></div>
                </li><li class="listitem">
                    <p>Either configured NTLM authentication credentials <b>or</b> configured Kerberos authentication credentials containing
                        a user name (SharePoint account user name) and password
                        (SharePoint account password).</p>

                </li></ul></div>
            

 <p><b>In your AWS account, make sure you
                have:</b></p>
        <div class="itemizedlist">
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><a href="https://docs.aws.amazon.com/kendra/latest/dg/create-index.html">Created
                        an Amazon Kendra index</a> and, if using the API, noted the index
                    ID.</p>
            </li><li class="listitem">
                <p><a href="https://docs.aws.amazon.com/kendra/latest/dg/iam-roles.html#iam-roles-ds">Created an IAM role</a> for your data source and, if
                    using the API, noted the ARN of the IAM role.</p>
                    

 <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>If you change your authentication type and credentials, you must 
 update your IAM role to access the correct AWS Secrets Manager secret ID.</p></div></div>


            </li><li class="listitem">
                <p>Stored your SharePoint authentication credentials in an AWS
                    Secrets Manager secret and, if using the API, noted the ARN of the
                    secret.</p>
                

 <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>It’s recommended that you regularly refresh or rotate your credentials 
  and secret. Provide only the necessary access level for your own security. 
  It’s <b>not</b> recommended to re-use
  credentials and secrets across data sources, and connector versions 1.0 and
  2.0 (where applicable).</p></div></div>


            </li></ul></div>
        <p>If you don’t have an existing IAM role or secret, you can use the
            console to create a new IAM role and Secrets Manager secret when you
            connect your SharePoint data source to Amazon Kendra. If you are using the
            API, you must provide the ARN of an existing IAM role and Secrets Manager secret, and an index ID.</p>


         
            <h2 id="data-source-procedure-v2-sharepoint">Connection
                    instructions</h2>

            <p>To connect Amazon Kendra to your SharePoint data source, you must
                provide details of your SharePoint credentials so that Amazon Kendra
                can access your data. If you have not yet configured SharePoint for Amazon Kendra see <a href="#prerequisites-v2-sharepoint">Prerequisites</a>.</p>




            

             
                <awsdocs-tabs><dl style="display: none">
                    <dt>Console: SharePoint Online</dt><dd tab-id="console:-sharepoint-online">
                            <p><b>To connect Amazon Kendra to
                                    SharePoint Online</b>
                            </p>
                            <div class="procedure"><ol><li>
                                    <p>Sign in to the AWS Management Console and
                                        open the <a href="https://console.aws.amazon.com/kendra/" rel="noopener noreferrer" target="_blank"><span>Amazon Kendra console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
                                </li><li>
                                    <p>From the left navigation pane, choose
                                            <b>Indexes</b> and then choose the index
                                        you want to use from the list of indexes.</p>
                                    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You can choose to configure or edit your
                                                <b>User access control</b> settings
                                            under <b>Index settings</b>. </p></div></div>
                                </li><li>
                                    <p>On the <b>Getting started</b> page, choose
                                            <b>Add data source</b>.</p>
                                </li><li>
                                    <p>On the <b>Add data source</b> page, choose
                                            <b>SharePoint connector V2.0</b>,
                                        and then choose <b>Add data source</b>.</p>
                                </li><li> 
    <p>On the <b>Specify data source details</b> page, enter the following information:</p>
        <ol><li>
            <p>In <b>Name and description</b>, for <b>Data source name</b>—Enter a name for your data source. You can include hyphens but not spaces.</p>
            </li><li>
            <p>(Optional)<b> Description</b>—Enter an optional description for your data source.</p>
            </li><li>
            <p>In <b>Language</b>, for <b>Default language</b>—A language to filter your documents for the index. Unless you specify otherwise,
            the language defaults to English. Language specified in the document metadata overrides the selected language.</p>
            </li><li>
            <p>In <b>Tags</b>, for <b>Add new tag</b>—Tags to search and filter your resources or track your AWS costs.</p>
            </li><li>
            <p>Choose <b>Next</b>.</p>
            </li></ol>
      </li><li>
                                    <p>On the <b>Define access and security</b>
                                        page, enter the following information:</p>
                                    <ol><li>
                                            <p>In <b>Source</b>, for
                                                  <b>Hosting Method</b>—Choose
                                                  <b>SharePoint
                                                Online</b>.</p>
                                        </li><li>
                                            <p><b>Site URLs specific to your
                                                  SharePoint
                                                repository</b>—Enter the
                                                SharePoint host URLs. The format for the
                                                host URLs you enter is
                                                  <code class="replaceable">https://yourcompany.sharepoint.com/sites/mysite</code>.
                                                The URL must start with <code class="code">https</code> protocol.
                                                Separate URLs with a new line. You can add up to 100
                                                URLs.</p>
                                        </li><li>
                                            <p><b>Domain</b>—Enter the
                                                SharePoint domain.</p>
                                        </li><li>
                                            <p>For <b>Authentication</b>, choose
                                                between <b>Basic</b>, <b>Oauth
                                                  2.0</b>, <b>Azure AD App-Only
                                                  authentication</b>, and
                                                  <b>SharePoint App-Only
                                                  authentication</b> based on your use
                                                case.</p>
                                            <ol><li>
                                                  <p> If using <b>Basic
                                                  Authentication</b>, enter the following
                                                  information:</p>
                                                  <div class="itemizedlist">
                                                   
                                                  <ul class="itemizedlist"><li class="listitem">
                                                  <p>For <b>AWS
                                                  Secrets Manager secret</b>—Choose
                                                  an existing secret or create a new Secrets Manager secret to store your SharePoint
                                                  authentication credentials. If you choose to
                                                  create a new secret an AWS
                                                  Secrets Manager secret window opens. Enter the
                                                  following information in the window:</p>
                                                  <div class="itemizedlist">
                                                   
                                                   
                                                   
                                                  <ul class="itemizedlist"><li class="listitem">
                                                  <p><b>Secret name</b>—A
                                                  name for your secret. The prefix
                                                  ‘AmazonKendra-SharePoint-’ is
                                                  automatically added to your secret name.</p>
                                                  </li><li class="listitem">
                                                  <p>
                                                  <b>Username</b>—User name for
                                                  your SharePoint account.</p>
                                                  </li><li class="listitem">
                                                  <p><b>Password</b>—Password
                                                  for your SharePoint account.</p>
                                                  </li></ul></div>
                                                  </li></ul></div>
                                                </li><li>
                                                  <p> If using <b>OAuth 2.0
                                                  authentication</b>, enter the following
                                                  information:</p>
                                                  <div class="itemizedlist">
                                                   
                                                   
                                                  <ul class="itemizedlist"><li class="listitem">
                                                  <p><b>Tenant ID</b>—Tenant
                                                  ID of your SharePoint account.</p>
                                                  </li><li class="listitem">
                                                  <p>For <b>AWS
                                                  Secrets Manager secret</b>—Choose
                                                  an existing secret or create a new Secrets Manager secret to store your SharePoint
                                                  authentication credentials. If you choose to
                                                  create a new secret an AWS
                                                  Secrets Manager secret window opens. Enter the
                                                  following information in the window:</p>
                                                  <div class="itemizedlist">
                                                   
                                                   
                                                   
                                                   
                                                   
                                                  <ul class="itemizedlist"><li class="listitem">
                                                  <p><b>Secret name</b>—A
                                                  name for your secret. The prefix
                                                  ‘AmazonKendra-SharePoint-’ is
                                                  automatically added to your secret name.</p>
                                                  </li><li class="listitem">
                                                  <p><b>Username</b>—User
                                                  name for your SharePoint account.</p>
                                                  </li><li class="listitem">
                                                  <p><b>Password</b>—Password
                                                  for your SharePoint account.</p>
                                                  </li><li class="listitem">
                                                  <p><b>Client ID</b>—The
                                                  Azure AD client ID generated when you register
                                                  SharePoint in Azure AD. </p>
                                                  </li><li class="listitem">
                                                  <p><b>Client
                                                  secret</b>—The Azure AD client
                                                  secret generated when you register
                                                  SharePoint in Azure AD.</p>
                                                  </li></ul></div>
                                                  </li></ul></div>
                                                </li><li>
                                                  <p> If using <b>Azure AD App-Only
                                                  authentication</b>, enter the following
                                                  information:</p>
                                                  <div class="itemizedlist">
                                                   
                                                   
                                                   
                                                  <ul class="itemizedlist"><li class="listitem">
                                                  <p><b>Tenant ID</b>—Tenant
                                                  ID of your SharePoint account.</p>
                                                  </li><li class="listitem">
                                                  <p><b>Azure AD self-signed X.509
                                                  certificate</b>—Certificate to
                                                  authenticate the connector for Azure AD.</p>
                                                  </li><li class="listitem">
                                                  <p>For <b>AWS
                                                  Secrets Manager secret</b>—Choose
                                                  an existing secret or create a new Secrets Manager secret to store your SharePoint
                                                  authentication credentials. If you choose to
                                                  create a new secret an AWS
                                                  Secrets Manager secret window opens. Enter the
                                                  following information in the window:</p>
                                                  <div class="itemizedlist">
                                                   
                                                   
                                                   
                                                  <ul class="itemizedlist"><li class="listitem">
                                                  <p><b>Secret name</b>—A
                                                  name for your secret. The prefix
                                                  ‘AmazonKendra-SharePoint-’ is
                                                  automatically added to your secret name.</p>
                                                  </li><li class="listitem">
                                                  <p><b>Client ID</b>—The
                                                  Azure AD client ID generated when you register
                                                  SharePoint in Azure AD. </p>
                                                  </li><li class="listitem">
                                                  <p><b>Private key</b>—A
                                                  private key to authenticate the connector for
                                                  Azure AD.</p>
                                                  </li></ul></div>
                                                  </li></ul></div>
                                                </li><li>
                                                  <p> If using <b>SharePoint
                                                  App-Only authentication</b>, enter the
                                                  following information:</p>
                                                  <div class="itemizedlist">
                                                   
                                                   
                                                  <ul class="itemizedlist"><li class="listitem">
                                                  <p><b>Tenant ID</b>—Tenant
                                                  ID of your SharePoint account.</p>
                                                  </li><li class="listitem">
                                                  <p>For <b>AWS
                                                  Secrets Manager secret</b>—Choose
                                                  an existing secret or create a new Secrets Manager secret to store your SharePoint
                                                  authentication credentials. If you choose to
                                                  create a new secret an AWS
                                                  Secrets Manager secret window opens. Enter the
                                                  following information in the window:</p>
                                                  <div class="itemizedlist">
                                                   
                                                   
                                                   
                                                   
                                                   
                                                  <ul class="itemizedlist"><li class="listitem">
                                                  <p><b>Secret name</b>—A
                                                  name for your secret. The prefix
                                                  ‘AmazonKendra-SharePoint-’ is
                                                  automatically added to your secret name.</p>
                                                  </li><li class="listitem">
                                                  <p><b>SharePoint client
                                                  ID</b>—The SharePoint client
                                                  ID generated when you register App Only at Tenant
                                                  Level.</p>
                                                  </li><li class="listitem">
                                                  <p><b>SharePoint client
                                                  secret</b>—The SharePoint
                                                  client secret generated when your resgiter for App
                                                  Only at Tenant Level.</p>
                                                  </li><li class="listitem">
                                                  <p><b>Azure AD client
                                                  ID</b>—The Azure AD client ID
                                                  generated when you register SharePoint in
                                                  Azure AD.</p>
                                                  </li><li class="listitem">
                                                  <p><b>Azure AD client
                                                  secret</b>—The Azure AD client
                                                  secret generated when you resgiter
                                                  SharePoint to Azure AD.</p>
                                                  </li></ul></div>
                                                  </li></ul></div>
                                                </li></ol>
                                        </li><li>
                                            <p>
                                                <b>Identity crawler</b>—Choose
                                                to activate Amazon Kendra identity crawler to
                                                sync identity information. If you choose to turn
                                                identity crawler off, you must upload the principal
                                                information using the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_PutPrincipalMapping.html">PutPrincipalMapping</a>API.</p>
                                            <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Crawl AD Group mapping is available to OAuth
                                                  2.0 and SharePoint App Only authentication
                                                  users only.</p></div></div>
                                            <p>You can also choose to:</p>
                                            <ol><li>
                                                  <p><b>Crawl Local Group
                                                  Mapping</b>—Activate to crawl local
                                                  group mapping.</p>
                                                </li><li>
                                                  <p><b>Crawl AD Group
                                                  Mapping</b>—Activate to crawl Azure
                                                  Active Directory group mapping.</p>
                                                </li></ol>
                                        </li><li>
                                            <p>(Optional) <b>Configure VPC and security
                                                  group</b>—Select a VPC to use with
                                                your SharePoint instance. If so, you must
                                                add <b>Subnets</b> and <b>VPC
                                                  security groups</b>.</p>
                                        </li><li> 
    <p><b>IAM role</b>—Choose an existing IAM 
    role or create a new IAM role to access your repository credentials and index content.</p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>IAM roles used for indexes cannot be used for data sources. If you are unsure 
       if an existing role is used for an index or FAQ, choose <b>Create a new role</b> to avoid 
       errors.</p></div></div>
    </li><li>
                                            <p>Choose <b>Next</b>.</p>
                                        </li></ol>
                                </li><li>
                                    <p>On the <b>Configure sync settings</b> page,
                                        enter the following information:</p>
                                    <ol><li>
                                            <p>In <b>Sync scope</b>, choose from
                                                the following options :</p>
                                            <ol><li>
                                                  <p><b>Select
                                                  entities</b>—Choose the entities you
                                                  want to crawl. You can select to crawl
                                                  <b>All</b> entities or any
                                                  combination of <b>Files</b>,
                                                  <b>Attachments</b>,
                                                  <b>Links</b>
                                                  <b>Pages</b>,
                                                  <b>Events</b>,
                                                  <b>Comments</b>, and <b>List
                                                  Data</b>.</p>
                                                </li><li>
                                                  <p>In <b>Additional
                                                  configuration</b>, for <b>Entity
                                                  regex patterns</b>—Add regular
                                                  expression patterns for
                                                  <b>Links</b>,
                                                  <b>Pages</b>, and
                                                  <b>Events</b> to include specific
                                                  entities instead of syncing all your
                                                  documents.</p>
                                                </li><li>
                                                  <p><b>Regex
                                                  patterns</b>—Add regular expression
                                                  patterns to include or exclude files by
                                                  <b>File path</b>
                                                  <b>File name</b>
                                                  <b>File type</b>, <b>OneNote
                                                  section name</b>, and <b>OneNote
                                                  page name</b> instead of syncing all your
                                                  documents. You can add up to 100.</p>
                                                </li></ol>
                                        </li><li>
                                            <p>For <b>Sync mode</b> choose how you
                                                want to update your index when your data source
                                                content changes. When you sync your data source with
                                                  Amazon Kendra for the first time, all content
                                                is synced by default.</p>
                                            <div class="itemizedlist">
                                                 
                                                 
                                                 
                                            <ul class="itemizedlist"><li class="listitem">
                                                  <p><b>Full sync</b>—Sync
                                                  all content regardless of the previous sync
                                                  status.</p>
                                                </li><li class="listitem">
                                                  <p><b>New or modified documents
                                                  sync</b>—Sync only new or modified
                                                  documents.</p>
                                                </li><li class="listitem">
                                                  <p><b>New, modified, or deleted
                                                  documents sync</b>—Sync only new,
                                                  modified, and deleted documents.</p>
                                                </li></ul></div>
                                        </li><li>
                                            <p>In <b>Sync run schedule</b>, for
                                                  <b>Frequency</b>—How often
                                                  Amazon Kendra will sync with your data
                                                source.</p>
                                        </li><li>
                                            <p>Choose <b>Next</b>.</p>
                                        </li></ol>

                                </li><li>
                                    <p>On the <b>Set field mappings</b> page, enter
                                        the following information:</p>
                                    <ol><li>
                                            <p>For <b>Events</b>
                                                <b>Pages</b>,
                                                  <b>Files</b>,
                                                  <b>Links</b>,
                                                  <b>Attachments</b>, and
                                                  <b>Comments</b>—Select from
                                                the Amazon Kendra generated default data source
                                                fields that you want to map to your index. </p>
                                        </li><li>
                                            <p>
                                                <b>Add field</b>—To add custom
                                                data source fields to create an index field name to
                                                map to and the field data type.</p>
                                        </li><li>
                                            <p>Choose <b>Next</b>.</p>
                                        </li></ol>
                                </li><li> 
   <p>On the <b>Review and create</b> page, check that
   the information you have entered is correct and then select
   <b>Add data source</b>. You can also choose to edit your information from this page. 
   Your data source will appear on the <b>Data sources</b> page after it’s added successfully.</p>
   
    </li></ol></div>

                        </dd>

                    


                    

                    <dt>Console: SharePoint Server</dt><dd tab-id="console:-sharepoint-server">

                            <p><b>To connect Amazon Kendra to
                                    SharePoint</b>
                            </p>
                            <div class="procedure"><ol><li>
                                    <p>Sign in to the AWS Management Console and
                                        open the <a href="https://console.aws.amazon.com/kendra/" rel="noopener noreferrer" target="_blank"><span>Amazon Kendra console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
                                </li><li>
                                    <p>From the left navigation pane, choose
                                            <b>Indexes</b> and then choose the index
                                        you want to use from the list of indexes.</p>
                                    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You can choose to configure or edit your
                                                <b>User access control</b> settings
                                            under <b>Index settings</b>. </p></div></div>
                                </li><li>
                                    <p>On the <b>Getting started</b> page, choose
                                            <b>Add data source</b>.</p>
                                </li><li>
                                    <p>On the <b>Add data source</b> page, choose
                                            <b>SharePoint connector V2.0</b>,
                                        and then choose <b>Add data source</b>.</p>
                                </li><li> 
    <p>On the <b>Specify data source details</b> page, enter the following information:</p>
        <ol><li>
            <p>In <b>Name and description</b>, for <b>Data source name</b>—Enter a name for your data source. You can include hyphens but not spaces.</p>
            </li><li>
            <p>(Optional)<b> Description</b>—Enter an optional description for your data source.</p>
            </li><li>
            <p>In <b>Language</b>, for <b>Default language</b>—A language to filter your documents for the index. Unless you specify otherwise,
            the language defaults to English. Language specified in the document metadata overrides the selected language.</p>
            </li><li>
            <p>In <b>Tags</b>, for <b>Add new tag</b>—Tags to search and filter your resources or track your AWS costs.</p>
            </li><li>
            <p>Choose <b>Next</b>.</p>
            </li></ol>
      </li><li>
                                    <p>On the <b>Define access and security</b>
                                        page, enter the following information:</p>
                                    <ol><li>
                                            <p>In <b>Source</b>, for
                                                  <b>Hosting Method</b>—Choose
                                                  <b>SharePoint
                                                Server</b>.</p>
                                        </li><li>
                                            <p><b>Choose SharePoint
                                                  Version</b>—Choose between
                                                  <b>SharePoint 2013</b>,
                                                  <b>SharePoint 2016</b>,
                                                  <b>SharePoint 2019</b>, and
                                                  <b>SharePoint (Subscription
                                                  Edition)</b>.</p>
                                        </li><li>
                                            <p><b>Site URLs specific to your
                                                  SharePoint
                                                repository</b>—Enter the
                                                SharePoint host URLs. The format for the
                                                host URLs you enter is
                                                  <code class="replaceable">https://yourcompany.sharepoint.com/sites/mysite</code>.
                                                The URL must start with <code class="code">https</code> protocol.
                                                Separate URLs with a new line. You can add up to 100
                                                URLs.</p>
                                        </li><li>
                                            <p><b>Domain</b>—Enter the
                                                SharePoint domain.</p>
                                        </li><li>
                                            <p><b>SSL certificate
                                                location</b>—Enter the Amazon S3 path to your SSL certificate file.</p>
                                        </li><li>
                                            <p>(Optional) For <b>Web
                                                proxy</b>—Enter the host name (without
                                                the <code class="code">http://</code> or <code class="code">https://</code>
                                                protocol), and the port number used by the host URL
                                                transport protocol. The numeric value of the port
                                                number must be between 0 and 65535.</p>
                                        </li><li>
                                            <p>For
                                                <b>Authorization</b>—Choose
                                                from the following access control/context filtering
                                                options:</p>
                                            <ol><li>
                                                  <p><b>Email ID with Domain from
                                                  IDP</b>—Access control will be based
                                                  on email ids extracted from email domains fetched
                                                  from the underlying identity provider (IDP). You
                                                  provide the IDP connection details in your Secrets Manager secret during
                                                  <b>Authentication</b>.</p>
                                                </li><li>
                                                  <p><b>Email ID with Custom
                                                  Domain</b>—Access control will be
                                                  based on email IDs. You want to provide the email
                                                  domain value. For example,
                                                  <code class="replaceable">"amazon.com"</code>. The email
                                                  domain will be used to construct the email ID for
                                                  access control. You must enter your email domain
                                                  using <b>Add Email
                                                  Domain</b>.</p>
                                                </li><li>
                                                  <p><b>Domain/User with
                                                  Domain</b>—Access control will be
                                                  structured using a Domain/User ID format. You need
                                                  to provide a valid Domain name. For example:
                                                  <code class="replaceable">"sharepoint2019"</code> to
                                                  construct access control.</p>
                                                </li></ol>
                                        </li><li>
                                            <p>For <b>Authentication</b>, choose
                                                between <b>NTLM authentication</b> and
                                                  <b>Kerberos authentication</b> based
                                                on your use case. Enter the following information
                                                for your chosen authentication option (for both
                                                  <b>NTLM authentication</b> or
                                                  <b>Kerberos
                                                authentication</b>):</p>
                                            <ol><li>
                                                  <p>For <b>AWS
                                                  Secrets Manager secret</b>—Choose
                                                  an existing secret or create a new Secrets Manager secret to store your SharePoint
                                                  authentication credentials. If you choose to
                                                  create a new secret, an AWS
                                                  Secrets Manager secret window opens. Enter the
                                                  following information in the window:</p>
                                                  <div class="itemizedlist">
                                                   
                                                   
                                                   
                                                   
                                                  <ul class="itemizedlist"><li class="listitem">
                                                  <p><b>Secret name</b>—A
                                                  name for your secret. The prefix
                                                  ‘AmazonKendra-SharePoint-’ is
                                                  automatically added to your secret name.</p>
                                                  </li><li class="listitem">
                                                  <p>
                                                  <b>Username</b>—User name for
                                                  your SharePoint account.</p>
                                                  </li><li class="listitem">
                                                  <p><b>Password</b>—Password
                                                  for your SharePoint account.</p>
                                                  </li><li class="listitem">
                                                  <p>If using <b>Email ID with Domain from
                                                  IDP</b>, also enter your:</p>
                                                  <div class="itemizedlist">
                                                   
                                                   
                                                   
                                                   
                                                  <ul class="itemizedlist"><li class="listitem">
                                                  <p>
                                                  <b>LDAP Server
                                                  Endpoint</b>—Endpoint of LDAP
                                                  server, including protocol and port number. For
                                                  example:
                                                  <code class="replaceable">ldap://example.com:389</code>.</p>
                                                  </li><li class="listitem">
                                                  <p><b>LDAP Search
                                                  Base</b>—Search base of LDAP user.
                                                  For example:
                                                  <code class="replaceable">CN=Users,DC=sharepoint,DC=com</code>.</p>
                                                  </li><li class="listitem">
                                                  <p><b>LDAP
                                                  username</b>—Your LDAP user
                                                  name.</p>
                                                  </li><li class="listitem">
                                                  <p><b>LDAP
                                                  Password</b>—Your LDAP
                                                  password.</p>
                                                  </li></ul></div>
                                                  </li></ul></div>
                                                </li></ol>
                                        </li><li>
                                            <p><b>Identity
                                                crawler</b>—Choose to enable Amazon Kendra identity crawler to sync identity
                                                information. If you choose to turn identity crawler
                                                off, you must upload the principal information using
                                                the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_PutPrincipalMapping.html">PutPrincipalMapping </a>API. You can also
                                                choose to:</p>
                                            <ol><li>
                                                  <p><b>Crawl Local Group
                                                  Mapping</b>—Activate to crawl local
                                                  group mapping.</p>
                                                </li><li>
                                                  <p>(For <b>Email ID with Domain from
                                                  IDP</b> only)<b>Crawl AD Group
                                                  Mapping</b>—Activate to crawl Active
                                                  Directory mapping.</p>
                                                </li></ol>
                                        </li><li>
                                            <p>(Optional) <b>Configure VPC and security
                                                  group</b>—Select a VPC to use with
                                                your SharePoint instance. If so, you must
                                                add <b>Subnets</b> and <b>VPC
                                                  security groups</b>.</p>
                                        </li><li> 
    <p><b>IAM role</b>—Choose an existing IAM 
    role or create a new IAM role to access your repository credentials and index content.</p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>IAM roles used for indexes cannot be used for data sources. If you are unsure 
       if an existing role is used for an index or FAQ, choose <b>Create a new role</b> to avoid 
       errors.</p></div></div>
    </li><li>
                                            <p>Choose <b>Next</b>.</p>
                                        </li></ol>
                                </li><li>
                                    <p>On the <b>Configure sync settings</b> page,
                                        enter the following information:</p>
                                    <ol><li>
                                            <p>In <b>Sync scope</b>, choose from
                                                the following options :</p>
                                            <ol><li>
                                                  <p><b>Select
                                                  entities</b>—Choose the entities you
                                                  want to crawl. You can select to crawl
                                                  <b>All</b> entities or any
                                                  combination of <b>Files</b>,
                                                  <b>Attachments</b>,
                                                  <b>Links</b>
                                                  <b>Pages</b>,
                                                  <b>Events</b>,
                                                  <b>Comments</b>, and <b>List
                                                  Data</b>.</p>
                                                </li><li>
                                                  <p>In <b>Additional
                                                  configuration</b>, for <b>Entity
                                                  regex patterns</b>—Add regular
                                                  expression patterns for
                                                  <b>Links</b>,
                                                  <b>Pages</b>, and
                                                  <b>Events</b> to include specific
                                                  entities instead of syncing all your
                                                  documents.</p>
                                                </li><li>
                                                  <p><b>Regex
                                                  patterns</b>—Add regular expression
                                                  patterns to include or exclude files by
                                                  <b>File path</b>
                                                  <b>File name</b>
                                                  <b>File type</b>, <b>OneNote
                                                  section name</b>, and <b>OneNote
                                                  page name</b> instead of syncing all your
                                                  documents. You can add up to 100.</p>
                                                </li></ol>
                                        </li><li>
                                            <p>For <b>Sync mode</b> choose how you
                                                want to update your index when your data source
                                                content changes. When you sync your data source with
                                                  Amazon Kendra for the first time, all content
                                                is synced by default.</p>
                                            <div class="itemizedlist">
                                                 
                                                 
                                                 
                                            <ul class="itemizedlist"><li class="listitem">
                                                  <p><b>Full sync</b>—Sync
                                                  all content regardless of the previous sync
                                                  status.</p>
                                                </li><li class="listitem">
                                                  <p><b>New or modified documents
                                                  sync</b>—Sync only new and modified
                                                  documents.</p>
                                                </li><li class="listitem">
                                                  <p><b>New, modified, or deleted
                                                  documents sync</b>—Sync only new,
                                                  modified, and deleted documents.</p>
                                                </li></ul></div>
                                        </li><li>
                                            <p>In <b>Sync run schedule</b>, for
                                                  <b>Frequency</b>—How often
                                                  Amazon Kendra will sync with your data
                                                source.</p>
                                        </li><li>
                                            <p>Choose <b>Next</b>.</p>
                                        </li></ol>

                                </li><li>
                                    <p>On the <b>Set field mappings</b> page, enter
                                        the following information:</p>
                                    <ol><li>
                                            <p>For <b>Events</b>
                                                <b>Pages</b>,
                                                  <b>Files</b>,
                                                  <b>Links</b>,
                                                  <b>Attachments</b>, and
                                                  <b>Comments</b>—Select from
                                                the Amazon Kendra generated default data source
                                                fields that you want to map to your index. </p>
                                        </li><li>
                                            <p>
                                                <b>Add field</b>—To add custom
                                                data source fields to create an index field name to
                                                map to and the field data type.</p>
                                        </li><li>
                                            <p>Choose <b>Next</b>.</p>
                                        </li></ol>
                                </li><li> 
   <p>On the <b>Review and create</b> page, check that
   the information you have entered is correct and then select
   <b>Add data source</b>. You can also choose to edit your information from this page. 
   Your data source will appear on the <b>Data sources</b> page after it’s added successfully.</p>
   
    </li></ol></div>

                        </dd>




                    


                    

                    <dt>API</dt><dd tab-id="api">
                            <p><b>To connect Amazon Kendra to
                                    SharePoint</b></p>

                            

                            <p>You must specify a JSON of the <a href="https://docs.aws.amazon.com/kendra/latest/dg/ds-schemas.html">data source
                                    schema</a> using the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_TemplateConfiguration.html">TemplateConfiguration</a> API. You must provide the
                                following information:</p>

                            <div class="itemizedlist">
                                 
                                 
                                 
                                 
                                 

                                 
                                 
                                
                                 
                            <ul class="itemizedlist"><li class="listitem">
                                    <p><b>Repository Endpoint
                                            Metadata</b>—Specify the
                                            <code class="code">tenantID</code>
                                        <code class="code">domain</code> and <code class="code">siteUrls</code> of your
                                        SharePoint instance.</p>
                                </li><li class="listitem">
                                    <p><b>Repository Additional
                                            Properties</b>—Specify the:</p>
                                    <div class="itemizedlist">
                                         
                                         
                                         
                                    <ul class="itemizedlist"><li class="listitem">
                                            <p>(For SharePoint Server only)
                                                  <code class="code">S3bucketName</code> and
                                                  <code class="code">s3certificateName</code> you used to store
                                                your SSL certificate.</p>
                                        </li><li class="listitem">
                                            <p>Authentication type (<code class="code">auth_Type</code>) you
                                                are using, whether <code class="code">OAuth2</code>,
                                                  <code class="code">OAuth2App</code>,
                                                  <code class="code">OAuth2Certificate</code>,
                                                <code class="code">Basic</code>, <code class="code">NTLM</code>, or
                                                  <code class="code">Kerberos</code>.</p>
                                        </li><li class="listitem">
                                            <p>Version (<code class="code">version</code>) you are using,
                                                whether <code class="code">Server</code> or <code class="code">Online</code>.
                                                If you use <code class="code">Server</code> you can futher
                                                specify the <code class="code">onPremVersion</code> as
                                                  <code class="code">2013</code>, <code class="code">2016</code>,
                                                  <code class="code">2019</code>, or <code class="code">Subsc</code>.</p>
                                        </li></ul></div>
                                </li><li class="listitem">
    <p><b>Type</b>—Specify
    <code class="code">TEMPLATE</code> as the Type when you call <code class="code">CreateDataSource</code>.</p>
    
   </li><li class="listitem">
                                    <p><b>Data
                                        source</b>—Specify the data source as
                                            <code class="code">SHAREPOINTV2</code>. </p>
                                </li><li class="listitem">
                                    <p><b>Secret Amazon Resource Name
                                            (ARN)</b>—Provide the Amazon Resource Name
                                        (ARN) of a Secrets Manager secret that contains the
                                        authentication credentials you created in your
                                        SharePoint account.</p>

                                    <p>If you use SharePoint Online, you can choose
                                        between Basic, OAuth 2.0, Azure AD App-only and
                                        SharePoint App Only authentication. The following
                                        are the minimum JSON structure that must be in your secret
                                        for each authentication option:</p>
                                    <div class="itemizedlist">
                                         
                                         
                                         
                                         
                                    <ul class="itemizedlist"><li class="listitem">
                                            <p><b>Basic
                                                  authentication</b></p>
                                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "username": "<code class="replaceable">SharePoint account user name</code>",
    "password": "<code class="replaceable">SharePoint account password</code>"
}</code></pre>
                                        </li><li class="listitem">
                                            <p><b>OAuth 2.0
                                                  authentication</b></p>
                                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "clientId": "<code class="replaceable">client id generated when registering SharePoint with Azure AD</code>",
    "clientSecret": "<code class="replaceable">client secret generated when registering SharePoint with Azure AD</code>",
    "userName": "<code class="replaceable">SharePoint account user name</code>",
    "password": "<code class="replaceable">SharePoint account password</code>"
}</code></pre>
                                        </li><li class="listitem">
                                            <p><b>Azure AD App-Only
                                                  authentication</b></p>
                                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "clientId": "<code class="replaceable">client id generated when registering SharePoint with Azure AD</code>",
    "privateKey": "<code class="replaceable">private key to authorize connection with Azure AD</code>"
}</code></pre>
                                        </li><li class="listitem">
                                            <p><b>SharePoint App-Only
                                                  authentication</b></p>
                                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "clientId": "<code class="replaceable">client id generated when registering SharePoint for App Only at Tenant Level</code>",
    "clientSecret": "<code class="replaceable">client secret generated when registering SharePoint for App Only at Tenant Level</code>",
    "adClientId": "<code class="replaceable">client id generated while registering SharePoint with Azure AD</code>",
    "adClientSecret": "<code class="replaceable">client secret generated while registering SharePoint with Azure AD</code>"
}</code></pre>
                                        </li></ul></div>

                                    <p>If you use SharePoint Server, you can choose
                                        between NTLM and Kerberos authentication. The following are
                                        the minimum JSON structure that must be in your secret for
                                        each authentication option:</p>
                                    <div class="itemizedlist">
                                         
                                         
                                    <ul class="itemizedlist"><li class="listitem">
                                            <p><b>NTLM or Kerberos authentication
                                                </b></p>

                                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "siteUrlsHash": "<code class="replaceable">Hash representation of all SharePoint site URLs</code>",
    "username": "<code class="replaceable">SharePoint account user name</code>",
    "password": "<code class="replaceable">SharePoint account password"</code>"
}</code></pre>
                                        </li><li class="listitem">
                                            <p><b>NTLM or Kerberos authentication 
                                                with user/email ID and the domain from IDP authorization</b></p>

                                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "siteUrlsHash": "<code class="replaceable">Hash representation of all SharePoint site URLs</code>",
    "userName": "<code class="replaceable">SharePoint account user name</code>",
    "password": "<code class="replaceable">SharePoint account password</code>",
    "ldapUrl": "<code class="replaceable">ldap://example.com:389</code>",
    "baseDn": "<code class="replaceable">CN=Users,DC=sharepoint,DC=com</code>",
    "ldapUser": "<code class="replaceable">LDAP account user name</code>",
    "ldapPassword": "<code class="replaceable">LDAP account password</code>"
}</code></pre>
                                        </li></ul></div>
                                    
                                    

 <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>It’s recommended that you regularly refresh or rotate your credentials 
  and secret. Provide only the necessary access level for your own security. 
  It’s <b>not</b> recommended to re-use
  credentials and secrets across data sources, and connector versions 1.0 and
  2.0 (where applicable).</p></div></div>


                                </li><li class="listitem"> 
    <p><b>Sync mode</b>—Specify
                                        whether Amazon Kendra should update your index by
                                        syncing all documents or only new, modified, and deleted
                                        documents. You can choose between:</p>
                                    <div class="itemizedlist">
                                         
                                         
                                         
                                    <ul class="itemizedlist"><li class="listitem">
                                            <p><code class="code">FORCED_FULL_CRAWL</code> to freshly re-crawl
                                                all content and replace existing content each time
                                                your data source syncs with your index</p>
                                        </li><li class="listitem">
                                            <p><code class="code">FULL_CRAWL</code> to incrementally crawl
                                                only new, modified, and deleted content each time
                                                your data source syncs with your index</p>
                                        </li><li class="listitem">
                                            <p><code class="code">CHANGE_LOG</code> to incrementally crawl
                                                only new and modified content each time your data
                                                source syncs with your index</p>
                                        </li></ul></div>
   
    </li><li class="listitem"> 
     
      <p><b>Enable identity
      crawler</b>—Specify whether to activate
      identity crawler. If identity crawler is deactivated, you
      must upload the principal information using the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_PutPrincipalMapping.html">PutPrincipalMapping</a> API. Crawling identity
      information on users and groups with access to certain
      documents is useful for user context filtering. Search
      results are filtered based on the user or their group access
      to documents. For more information, see <a href="https://docs.aws.amazon.com/kendra/latest/dg/user-context-filter.html#context-filter-user-incl-datasources">Filtering on user context</a>.</p>
      </li><li class="listitem">
    <p><b>IAM role</b>—Specify <code class="code">RoleArn</code>
     when you call <code class="code">CreateDataSource</code> to provide an IAM role with permissions to access
    your Secrets Manager secret and to call the required public
    APIs for the SharePoint connector and Amazon Kendra. 
    For more information, see <a href="https://docs.aws.amazon.com/kendra/latest/dg/iam-roles.html#iam-roles-ds">IAM roles for SharePoint 
    data sources</a>.</p>
    
   </li></ul></div>

                            

                            <p>You can also add the following optional features:</p>
                            <div class="itemizedlist">
                                 
                                 
                                
                                 
                                 
                                 
                            <ul class="itemizedlist"><li class="listitem">
                                    <p>
                                        <b>Specific documents to
                                        index</b>—You can use a SharePoint
                                        query to specify the documents you want from one or more
                                        knowledge bases, including private knowledge bases. Access
                                        to the knowledge bases is determined by the user that you
                                        use to connect to the SharePoint instance. For more
                                        information, see <a href="https://docs.aws.amazon.com/kendra/latest/dg/servicenow-query.html">Specifying
                                            documents to index with a query</a>.</p>
                                </li><li class="listitem">
                                    <p>
                                        <b>Inclusion and exclusion
                                            filters</b>—You can specify whether to
                                        include or exclude knowledge articles, service catalogs, 
                                        incidents and their attachments.</p>
                                    
                                    
     <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Most data sources use regular expression patterns, 
     which are inclusion or exclusion patterns referred to as filters. 
     If you specify an inclusion filter, only content that
     matches the inclusion filter is indexed. Any document that
     doesn’t match the inclusion filter isn’t indexed. If you
     specify an inclusion and exclusion filter, documents that
     match the exclusion filter are not indexed, even if they
     match the inclusion filter.</p></div></div>
    
   
                                </li><li class="listitem">
   <p>
   <b>Field mappings</b>—Choose to map your SharePoint 
   data source fields to your
   Amazon Kendra index fields. For more information, see
   <a href="https://docs.aws.amazon.com/kendra/latest/dg/field-mapping.html">Mapping data
   source fields</a>.</p>
    
   </li><li class="listitem">
    <p>
    <b>Virtual Private Cloud
    (VPC)</b>—Specify
    <code class="code">VpcConfiguration</code> when you call <code class="code">CreateDataSource</code>. 
    For more information, see <a href="./vpc-configuration.html">Configuring Amazon Kendra to use an Amazon VPC</a>.</p>
    
   </li><li class="listitem"> 
    <p>
    <b>User context filtering</b>—Amazon Kendra 
    crawls the access control list (ACL) for your data source by default. The ACL 
    information is used to filter search results based on the user or their
    group access to documents. For more information, see <a href="https://docs.aws.amazon.com/kendra/latest/dg/user-context-filter.html#datasource-context-filter">User context
    filtering for SharePoint data sources</a>.</p>
    
   </li></ul></div>

                            <p>For a list of other important JSON keys to configure, see <a href="./ds-schemas.html#ds-schema-sharepoint">Microsoft SharePoint template schema</a>.</p>
                        </dd>
                </dl></awsdocs-tabs>
             
         
            <h2 id="sharepoint-notes">Notes</h2>
            <div class="itemizedlist">
                 
                 
                 
                 
                 
                 
                 
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>The connector supports custom field mappings only for the
                            <b>Files</b> entity.</p>
                </li><li class="listitem">
                    <p>For all SharePoint Server versions, the ACL token must be in lower
                        case. For <b>Email with Domain from IDP</b> and
                            <b>Email ID with Custom Domain</b> ACL, for example:
                            <code class="replaceable">user@sharepoint2019.com</code>. For
                            <b>Domain/User with Domain</b> ACL, for example:
                            <code class="replaceable">sharepoint2013\user</code>.</p>
                </li><li class="listitem">
                    <p>The connector does not support change log mode/<b>New or modified
                            content sync</b> for SharePoint 2013.</p>
                </li><li class="listitem">
                    <p>If an entity name has a <code class="code">%</code> character in its name, the
                        connector will skip these files due to API limitations.</p>
                </li><li class="listitem">
                    <p>OneNote can only be crawled by the connector using a Tenant ID and with
                        OAuth 2.0 or SharePoint App Only authentication activated for
                        SharePoint Online.</p>
                </li><li class="listitem">
                    <p>The connector crawls the first section of a OneNote document using its
                        default name only, even if the document is renamed.</p>
                </li><li class="listitem">
                    <p>The connector crawls links in SharePoint 2019, SharePoint
                        Online, and Subscription Edition, only if <b>Pages</b> and
                            <b>Files</b> are selected as entities to be crawled in
                        addition to <b>Links</b>.</p>
                </li><li class="listitem">
                    <p>The connector crawls links in SharePoint 2013 and
                        SharePoint 2016 if <b>Links</b> is selected as an
                        entity to be crawled.</p>
                </li><li class="listitem">
                    <p>The connector crawls list attachments and comments only when
                            <b>List Data</b> is also selected as an entity to be
                        crawled.</p>
                </li><li class="listitem">
                    <p>The connector crawls event attachments only when
                            <b>Events</b> is also selected as an entity to be
                        crawled.</p>
                </li></ul></div>
        <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./data-source-v1-sharepoint.html">SharePoint connector
                V1.0</div><div id="next" class="next-link" accesskey="n" href="./data-source-teams.html">Microsoft Teams</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=https://docs.aws.amazon.com/en_us/kendra/latest/dg/data-source-v2-sharepoint.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=https://docs.aws.amazon.com/en_us/kendra/latest/dg/data-source-v2-sharepoint.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>