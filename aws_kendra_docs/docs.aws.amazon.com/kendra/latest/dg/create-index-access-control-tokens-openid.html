<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Using OpenID - Amazon Kendra</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="create-index-access-control-tokens-openid" /><meta name="default_state" content="create-index-access-control-tokens-openid" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/kendra/latest/dg/create-index-access-control-tokens-openid.html" /><meta name="description" content="Howow to use OpenID with access control for Amazon Kendra." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Kendra" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Provides a conceptual overview of Amazon Kendra. Learn about Amazon Kendra features and get started indexing your documents using the console, CLI, and API." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/kendra/latest/dg/create-index-access-control-tokens-openid.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/create-index-access-control-tokens-openid.html" hreflang="x-default" /><meta name="feedback-item" content="Kendra" /><meta name="this_doc_product" content="Amazon Kendra" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'kendra'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Using OpenID" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Using OpenID - Amazon Kendra</title><meta name="pdf" content="/pdfs/kendra/latest/dg/kendra-dg.pdf#create-index-access-control-tokens-openid" /><meta name="github" content="https://github.com/awsdocs/amazon-kendra-developer-guide/tree/master/doc_source/create-index-access-control-tokens-openid.md" /><meta name="rss" content="amazon-kendra-release-notes.rss" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=http://docs.aws.amazon.com/en_us/kendra/latest/dg/create-index-access-control-tokens-openid.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/kendra/latest/dg/create-index-access-control-tokens-openid.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/kendra/latest/dg/create-index-access-control-tokens-openid.html" /><meta name="keywords" content="Kendra,Amazon Kendra,search,intelligent search,natural language,index,question,keyword,data source,connector,FAQ,frequently asked question" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Kendra",
        "item" : "https://docs.aws.amazon.com/kendra/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Creating an index",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg/create-index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Controlling access to documents in an index",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg/create-index-access-control.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Using OpenID",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg/create-index-access-control.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/kendra/latest/dg/kendra-dg.pdf#create-index-access-control-tokens-openid" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/amazon-kendra-developer-guide/tree/master/doc_source/create-index-access-control-tokens-openid.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/kendra/index.html">Amazon Kendra</a><a href="what-is-kendra.html">Developer Guide</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="create-index-access-control-tokens-openid">Using OpenID</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>To configure an Amazon Kendra index to use an OpenID token for access control, you need
  the JWKS (JSON Web Key Set) URL from the OpenID provider. In most cases the JWKS URL is in the
  following format (if they're following openId discovery)
   <code class="code">https://domain-name/.well_known/jwks.json</code>. </p><p>The following examples show how to use an OpenID token for user access control when you
  create an index. </p><awsdocs-tabs><dl style="display: none">
  <dt>Console</dt><dd tab-id="console">
    <div class="procedure"><ol><li>
      <p>Choose <b>Create index</b> to start creating a new index.</p>
     </li><li>
      <p>On the <b>Specify index details</b> page, give your index a name and a
       description. </p>
     </li><li>
      <p>For <b>IAM role</b>, select a role or select
        <b>Create a new role</b> to and specify a role name to create a new role. The
       IAM role will have the prefix "AmazonKendra-". </p>
     </li><li>
      <p>Leave all of the other fields at their defaults. Choose
       <b>Next</b>.</p>
     </li><li>
      <p>In the <b>Configure user access control</b> page, under <b>Access
        control settings</b>, choose <b>Yes</b> to use tokens for access
       control. </p>
     </li><li>
      <p>Under <b>Token configuration</b>, select <b>OpenID</b> as
       the <b>Token type</b>. </p>
     </li><li>
      <p>Specify a <b>Signing key URL</b>. The URL should point to a set of JSON
       web keys. </p>
     </li><li>
      
      <p><em>Optional</em> Under <b>Advanced
        configuration</b>: </p>
      <ol><li>
        <p>Specify a <b>Username</b> to use in the ACL check. </p>
       </li><li>
        <p>Specify one or more <b>Groups</b> to use in the ACL check. </p>
       </li><li>
        <p>Specify the <b>Issuer</b> that will validate the token issuer. </p>
       </li><li>
        <p>Specify the <b>Client Id(s)</b>. You must specify a regular expression
         that match the audience in the JWT.</p>
       </li></ol>
     </li><li>
      <p>In the <b>Provisioning details</b> page, choose <b>Developer
        edition</b>.</p>
     </li><li>
      <p>Choose <b>Create</b> to create your index.</p>
     </li><li>
      <p>Wait for your index to be created. Amazon Kendra provisions the hardware for your
       index. This operation can take some time.</p>
     </li></ol></div>
   </dd>
  <dt>CLI</dt><dd tab-id="cli">
    <p>To create an index with the AWS CLI using a JSON input file, first create a
     JSON file with your desired parameters:</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Name": "<code class="replaceable">user-context</code>",
    "Edition": "<code class="replaceable">ENTERPRISE_EDITION</code>",
    "RoleArn": "arn:aws:iam::<code class="replaceable">account-id</code>:role:/<code class="replaceable">my-role</code>",
    "UserTokenConfigurations": [
        <span>{</span>
            "JwtTokenTypeConfiguration": <span>{</span>
                "KeyLocation": "URL",
                "Issuer": "<code class="replaceable">optional: specify the issuer url</code>",
                "ClaimRegex": "<code class="replaceable">optional: regex to validate claims in the token</code>",
                "UserNameAttributeField": "<code class="replaceable">optional: user</code>",
                "GroupAttributeField": "<code class="replaceable">optional: group</code>",
                "URL": "https://example.com/.well-known/jwks.json"
            }
        }
    ],
    "UserContextPolicy": "USER_TOKEN"
}</code></pre>
    <p>You can override the default user and group field names. The default value for
      <code class="code">UserNameAttributeField</code> is "user". The default value for
      <code class="code">GroupAttributeField</code> is "groups". </p>

    <p>Next, call <code class="code">create-index</code> using the input file. For example, if the name of
     your JSON file is <code>create-index-openid.json</code>, you can use the following: </p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws kendra create-index --cli-input-json file://create-index-openid.json</code></pre>
   </dd>
  <dt>Python</dt><dd tab-id="python">
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="Python ">response = kendra.create_index(
    Name='<code class="replaceable">user-context</code>',
    Edition='<code class="replaceable">ENTERPRISE_EDITION</code>',
    RoleArn='arn:aws:iam::<code class="replaceable">account-id</code>:role:/<code class="replaceable">my-role</code>',
    UserTokenConfigurations=[
        <span>{</span>
            "JwtTokenTypeConfiguration": <span>{</span>
                "KeyLocation": "URL",
                "Issuer": "<code class="replaceable">optional: specify the issuer url</code>",
                "ClaimRegex": "<code class="replaceable">optional: regex to validate claims in the token</code>",
                "UserNameAttributeField": "<code class="replaceable">optional: user</code>",
                "GroupAttributeField": "<code class="replaceable">optional: group</code>",
                "URL": "https://example.com/.well-known/jwks.json"
            }
        }
    ],
    UserContextPolicy='USER_TOKEN'
)</code></pre>
   </dd>
 </dl></awsdocs-tabs><awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./create-index-access-control.html">Controlling access to documents in an
            index</div><div id="next" class="next-link" accesskey="n" href="./create-index-access-control-tokens-jwtshared.html">Using a JSON Web Token (JWT) with
      a shared secret</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=https://docs.aws.amazon.com/en_us/kendra/latest/dg/create-index-access-control-tokens-openid.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=https://docs.aws.amazon.com/en_us/kendra/latest/dg/create-index-access-control-tokens-openid.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>