<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Custom data source connector - Amazon Kendra</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="data-source-custom" /><meta name="default_state" content="data-source-custom" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/kendra/latest/dg/data-source-custom.html" /><meta name="description" content="How to use your own custom data source connector in Amazon Kendra to index your documents." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Kendra" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Provides a conceptual overview of Amazon Kendra. Learn about Amazon Kendra features and get started indexing your documents using the console, CLI, and API." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/kendra/latest/dg/data-source-custom.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/data-source-custom.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/data-source-custom.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kendra/latest/dg/data-source-custom.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kendra/latest/dg/data-source-custom.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/data-source-custom.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/data-source-custom.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kendra/latest/dg/data-source-custom.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kendra/latest/dg/data-source-custom.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/data-source-custom.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/data-source-custom.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kendra/latest/dg/data-source-custom.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kendra/latest/dg/data-source-custom.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/data-source-custom.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/data-source-custom.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kendra/latest/dg/data-source-custom.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kendra/latest/dg/data-source-custom.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kendra/latest/dg/data-source-custom.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kendra/latest/dg/data-source-custom.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/kendra/latest/dg/data-source-custom.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/kendra/latest/dg/data-source-custom.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/data-source-custom.html" hreflang="x-default" /><meta name="feedback-item" content="Kendra" /><meta name="this_doc_product" content="Amazon Kendra" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'kendra'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Custom data source connector" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Custom data source connector - Amazon Kendra</title><meta name="pdf" content="/pdfs/kendra/latest/dg/kendra-dg.pdf#data-source-custom" /><meta name="github" content="https://github.com/awsdocs/amazon-kendra-developer-guide/tree/master/doc_source/data-source-custom.md" /><meta name="rss" content="amazon-kendra-release-notes.rss" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=http://docs.aws.amazon.com/en_us/kendra/latest/dg/data-source-custom.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/kendra/latest/dg/data-source-custom.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/kendra/latest/dg/data-source-custom.html" /><meta name="keywords" content="Kendra,Amazon Kendra,search,intelligent search,natural language,index,question,keyword,data source,connector,FAQ,frequently asked question,custom connector" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Kendra",
        "item" : "https://docs.aws.amazon.com/kendra/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Creating a data source connector",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg/data-source.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Data source connectors",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg/data-sources.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Custom data source connector",
        "item" : "https://docs.aws.amazon.com/kendra/latest/dg/data-sources.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/kendra/latest/dg/kendra-dg.pdf#data-source-custom" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/amazon-kendra-developer-guide/tree/master/doc_source/data-source-custom.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/kendra/index.html">Amazon Kendra</a><a href="what-is-kendra.html">Developer Guide</a></div><div id="page-toc-src"><a href="#custom-required-attributes">Required attributes</a><a href="#custom-metrics">Viewing metrics</a><a href="#custom-learn-more">Learn more</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="data-source-custom">Custom data source connector</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Use a custom data source when you have a repository that Amazon Kendra doesn’t yet
        provide a data source connector for. You can use it to see the same run history metrics that
            Amazon Kendra data sources provide even when you can't use Amazon Kendra's
        data sources to sync your repositories. Use this to create a consistent sync monitoring
        experience between Amazon Kendra data sources and custom ones. Specifically, use a
        custom data source to see sync metrics for a data source connector that you created using
        the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_BatchPutDocument.html">BatchPutDocument</a> and <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_BatchDeleteDocument.html">BatchDeleteDocument</a>
        APIs.</p><p>For troubleshooting your Amazon Kendra custom data source connector, see <a href="./troubleshooting-data-sources.html">Troubleshooting data sources</a>.</p><p>When you create a custom data source, you have complete control over how the documents to
        index are selected. Amazon Kendra only provides metric information that you can use to
        monitor your data source sync jobs. You must create and run the crawler that determines the
        documents your data source indexes.</p><p>You must specify the main title of your documents using the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_Document.html">Document</a> object, and <code class="code">_source_uri</code> 
        in <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_DocumentAttribute.html">DocumentAttribute</a> in order to 
        have <code class="code">DocumentTitle</code> and <code class="code">DocumentURI</code> included in the response of 
        the <code class="code">Query</code> result.</p><p>You create an identifier for your custom data source using the console or by using the
            <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_CreateDataSource.html">CreateDataSource</a> API. To use the console, give your data source a name, and
        optionally a description and resource tags. After the data source is created, a data source
        ID is shown. Copy this ID to use when you synchronize the data source with the index.</p><div class="mediaobject">
         
            <img src="/images/kendra/latest/dg/images/CustomDataSource.png" class="aws-docs-img-whiteBg aws-docs-img-padding" />
         
    </div><p>You can also create a custom data source using the <code class="code">CreateDataSource</code> API. The
        API returns an ID to use when you synchronize the data source. When you use the
            <code class="code">CreateDataSource</code> API to create a custom data source, you can't set the
            <code class="code">Configuration</code>, <code class="code">RoleArn</code> or <code class="code">Schedule</code> parameters. If
        you set these parameters, Amazon Kendra returns a <code class="code">ValidationException</code>
        exception.</p><p>To use a custom data source, create an application that is responsible for updating the
            Amazon Kendra index. The application depends on a crawler that you create. The
        crawler reads the documents in your repository and determines which should be sent to
            Amazon Kendra. Your application should perform the following steps: </p><div class="orderedlist">
         
         
         
         
         
    <ol><li>
            <p>Crawl your repository and make a list of the documents in your repository that are
                added, updated, or deleted.</p>
        </li><li>
            <p>Call the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_StartDataSourceSyncJob.html">StartDataSourceSyncJob</a> API to signal that a sync job is starting. You
                provide a data source ID to identify the data source that is synchronizing. Amazon Kendra returns a execution ID to identify a particular sync job.</p>
        </li><li>
            <p>Call the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_BatchDeleteDocument.html">BatchDeleteDocument</a>
                API to remove documents from the index. You provide the data source ID and execution
                ID to identify the data source that is synchronizing and the job that this update is
                associated with.</p>
        </li><li>
            <p>Call the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_StopDataSourceSyncJob.html">StopDataSourceSyncJob</a> API to signal the end of the sync job. After you
                call the <code class="code">StopDataSourceSyncJob</code> API, the associated execution ID is no
                longer valid.</p>
        </li><li>
            <p>Call the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_ListDataSourceSyncJobs.html">ListDataSourceSyncJobs</a> API with the index and data source identifiers
                to list the sync jobs for the data source and to see metrics for the sync
                jobs.</p>
        </li></ol></div><p>After you end a sync job, you can start a new synchronization job. There can be a period
        of time before all of the submitted documents are added to the index. Use the
            <code class="code">ListDataSourceSyncJobs</code> API to see the status of the sync job. If the
            <code class="code">Status</code> returned for the sync job is <code class="code">SYNCING_INDEXING</code>, some
        documents are still being indexed. You can start a new sync job when the status of the
        previous job is <code class="code">FAILED</code>, <code class="code">SUCCEEDED</code>, or
        <code class="code">SYNCING_INDEX</code>.</p><p>After you call the <code class="code">StopDataSourceSyncJob</code> API, you can't use a sync job
        identifier in a call to the <code class="code">BatchPutDocument</code> or
            <code class="code">BatchDeleteDocument</code> APIs. If you do, all of the documents submitted are
        returned in the <code class="code">FailedDocuments</code> response message from the API.</p>
        <h2 id="custom-required-attributes">Required attributes</h2>
        <p>When you submit a document to Amazon Kendra using the
                <code class="code">BatchPutDocument</code> API, each document requires two attributes to identify
            the data source and synchronization run that it belongs to. You must provide the
            following two attributes:</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><code class="code">_data_source_id</code>—The identifier of the data source. This is
                    returned when you create the data source with the console or the
                        <code class="code">CreateDataSource</code> API.</p>
            </li><li class="listitem">
                <p><code class="code">_data_source_sync_job_execution_id</code>—The identifier of the
                    sync run. This is returned when you start the index synchronization with the
                        <code class="code">StartDataSourceSyncJob</code> API.</p>
            </li></ul></div>
        <p>The following is the JSON required to index a document using a custom data
            source.</p>
        <pre class="programlisting"><div class="code-btn-container"></div><code class="json "><span>{</span>
    "Documents": [
        <span>{</span>
            "Attributes": [
                <span>{</span>
                    "Key": "_data_source_id",
                    "Value": <span>{</span>
                        "StringValue": "<code class="replaceable">data source identifier</code>"
                    }
                },
                <span>{</span>
                    "Key": "_data_source_sync_job_execution_id",
                    "Value": <span>{</span>
                        "StringValue": "<code class="replaceable">sync job identifier</code>"
                    }
                }
            ],
            "Blob": "<code class="replaceable">document content</code>",
            "ContentType": "<code class="replaceable">content type</code>",
            "Id": "<code class="replaceable">document identifier</code>",
            "Title": "<code class="replaceable">document title</code>"
        }
    ],
    "IndexId": "<code class="replaceable">index identifier</code>",
    "RoleArn": "<code class="replaceable">IAM role ARN</code>"
}</code></pre>
        <p>When you remove a document from the index using the <code class="code">BatchDeleteDocument</code>
            API, you need to specify the following two fields in the
                <code class="code">DataSourceSyncJobMetricTarget</code> parameter:</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><code class="code">DataSourceId</code>—The identifier of the data source. This is
                    returned when you create the data source with the console or the
                        <code class="code">CreateDataSource</code> API.</p>
            </li><li class="listitem">
                <p><code class="code">DataSourceSyncJobId</code>—The identifier of the sync run. This
                    is returned when you start the index synchronization with the
                        <code class="code">StartDataSourceSyncJob</code> API.</p>
            </li></ul></div>
        <p>The following is the JSON required to delete a document from the index using the
                <code class="code">BatchDeleteDocument</code> API.</p>
        <pre class="programlisting"><div class="code-btn-container"></div><code class="json "><span>{</span>
    "DataSourceSyncJobMetricTarget": <span>{</span>
        "DataSourceId": "<code class="replaceable">data source identifier</code>",
        "DataSourceSyncJobId": "<code class="replaceable">sync job identifier</code>"
    },
    "DocumentIdList": [
        "<code class="replaceable">document identifier</code>"
    ],
    "IndexId": "<code class="replaceable">index identifier</code>"
}</code></pre>
     
        <h2 id="custom-metrics">Viewing metrics</h2>
        <p>After a sync job is finished, you can use the <a href="https://docs.aws.amazon.com/kendra/latest/APIReference/API_DataSourceSyncJobMetrics.html">DataSourceSyncJobMetrics</a> API to get the metrics associated with the sync
            job. Use this to monitor your custom data source syncs.</p>
        <p>If you submit the same document multiple times, either as part of the
                <code class="code">BatchPutDocument</code> API, the <code class="code">BatchDeleteDocument</code> API, or if
            the document is submitted for both addition and deletion, the document is only counted
            once in the metrics.</p>
        <div class="itemizedlist">
             
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><code class="code">DocumentsAdded</code>—The number of documents submitted using the
                        <code class="code">BatchPutDocument</code> API associated with this sync job added to the
                    index for the first time. If a document is submitted for addition more than once
                    in a sync, the document is only counted once in the metrics.</p>
            </li><li class="listitem">
                <p><code class="code">DocumentsDeleted</code>—The number of documents submitted using
                    the <code class="code">BatchDeleteDocument</code> API associated with this sync job deleted
                    from the index. If a document is submitted for deletion more than once in a
                    sync, the document is only counted once in the metrics.</p>
            </li><li class="listitem">
                <p><code class="code">DocumentsFailed</code>—The number of documents associated with
                    this sync job that failed indexing. These are documents that were accepted by
                        Amazon Kendra for indexing but could not be indexed or deleted. If a
                    document isn't accepted by Amazon Kendra, the identifier for the document
                    is returned in the <code class="code">FailedDocuments</code> response property of the
                        <code class="code">BatchPutDocument</code> and <code class="code">BatchDeleteDocument</code>
                    APIs.</p>
            </li><li class="listitem">
                <p><code class="code">DocumentsModified</code>—The number of modified documents
                    submitted using the <code class="code">BatchPutDocument</code> API associated with this sync
                    job that were modified in the Amazon Kendra index.</p>
            </li></ul></div>
        <p>Amazon Kendra also emits Amazon CloudWatch metrics while indexing documents.
            For more information, see <a href="https://docs.aws.amazon.com/kendra/latest/dg/cloudwatch-metrics.html">Monitoring Amazon Kendra with
                    Amazon CloudWatch</a>.</p>
        <p>Amazon Kendra doesn't return the <code class="code">DocumentsScanned</code> metric for custom
            data sources. It also emits the CloudWatch metrics listed in the document <a href="https://docs.aws.amazon.com/kendra/latest/dg/cloudwatch-metrics.html#cloudwatch-metrics-data-source">Metrics for Amazon Kendra data sources</a>.</p>
     
        <h2 id="custom-learn-more">Learn more</h2>
        <p>To learn more about integrating Amazon Kendra with your custom data source,
            see:</p>

        <div class="itemizedlist">
             
        <ul class="itemizedlist"><li class="listitem">
                <p><a href="https://aws.amazon.com/blogs/machine-learning/adding-custom-data-sources-to-amazon-kendra/" rel="noopener noreferrer" target="_blank"><span>Adding custom data sources to Amazon Kendra</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
            </li></ul></div>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./data-source-v2-confluence.html">Confluence connector V2.0</div><div id="next" class="next-link" accesskey="n" href="./custom-java-sample.html">Custom data source (Java)</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=https://docs.aws.amazon.com/en_us/kendra/latest/dg/data-source-custom.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=https://docs.aws.amazon.com/en_us/kendra/latest/dg/data-source-custom.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>