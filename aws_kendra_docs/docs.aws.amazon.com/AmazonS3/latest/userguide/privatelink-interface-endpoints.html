<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS PrivateLink for Amazon S3 - Amazon Simple Storage Service</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="privatelink-interface-endpoints" /><meta name="default_state" content="privatelink-interface-endpoints" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" /><meta name="description" content="Connect to Amazon S3 by using AWS PrivateLink interface VPC endpoints in your virtual private cloud (VPC)." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Simple Storage Service" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Learn how to use Amazon Simple Storage Service (Amazon S3) to store and retrieve any amount of data from anywhere. This guide explains Amazon S3 concepts, such as buckets, objects, and related configurations, and includes code examples for common operations." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" hreflang="x-default" /><meta name="feedback-item" content="S3" /><meta name="this_doc_product" content="Amazon Simple Storage Service" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'s3'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="AWS PrivateLink for Amazon S3" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS PrivateLink for Amazon S3 - Amazon Simple Storage Service</title><meta name="pdf" content="/pdfs/AmazonS3/latest/userguide/s3-userguide.pdf#privatelink-interface-endpoints" /><meta name="github" content="https://github.com/awsdocs/amazon-s3-userguide/tree/main/doc_source/privatelink-interface-endpoints.md" /><meta name="rss" content="s3-userguide-rss-updates.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=24" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=S3&amp;topic_url=http://docs.aws.amazon.com/en_us/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/AmazonS3/latest/userguide/privatelink-interface-endpoints.html" /><meta name="keywords" content="S3,Amazon S3,S3 User Guide,Amazon S3 User Guide,Amazon User Guide,s3 bucket,s3 object,cloud storage,data storage" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Simple Storage Service (S3)",
        "item" : "https://docs.aws.amazon.com/s3/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AmazonS3/latest/userguide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Amazon S3 security",
        "item" : "https://docs.aws.amazon.com/AmazonS3/latest/userguide/security.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "AWS PrivateLink for Amazon S3",
        "item" : "https://docs.aws.amazon.com/AmazonS3/latest/userguide/security.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/AmazonS3/latest/userguide/s3-userguide.pdf#privatelink-interface-endpoints" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/amazon-s3-userguide/tree/main/doc_source/privatelink-interface-endpoints.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/s3/index.html">Amazon Simple Storage Service (S3)</a><a href="Welcome.html">User Guide</a></div><div id="page-toc-src"><a href="#types-of-vpc-endpoints-for-s3">Types of VPC endpoints</a><a href="#privatelink-limitations">Restrictions and limitations of AWS PrivateLink for Amazon S3</a><a href="#s3-creating-vpc">Creating a VPC endpoint</a><a href="#accessing-s3-interface-endpoints">Accessing Amazon S3 interface
        endpoints</a><a href="#private-dns">Private DNS</a><a href="#accessing-bucket-and-aps-from-interface-endpoints">Accessing buckets, access points,
        and Amazon S3 Control API operations from S3 interface endpoints</a><a href="#updating-on-premises-dns-config">Updating an on-premises DNS
        configuration</a><a href="#creating-vpc-endpoint-policy">Creating a VPC endpoint policy</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="privatelink-interface-endpoints">AWS PrivateLink for Amazon S3</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>With AWS PrivateLink for Amazon S3, you can provision <em>interface VPC endpoints</em>
    (interface endpoints) in your virtual private cloud (VPC). These endpoints are directly accessible from applications that are on premises
    over VPN and AWS Direct Connect, or in a different AWS Region over VPC peering.</p><p>Interface endpoints are represented by one or more elastic network interfaces (ENIs) that
    are assigned private IP addresses from subnets in your VPC. Requests to Amazon S3 over interface
    endpoints stay on the Amazon network. You can also access interface endpoints in your VPC from
    on-premises applications through AWS Direct Connect or AWS Virtual Private Network (AWS VPN). For more information about
    how to connect your VPC with your on-premises network, see the <a href="https://docs.aws.amazon.com/directconnect/latest/UserGuide/Welcome.html">AWS Direct Connect User Guide</a> and the <a href="https://docs.aws.amazon.com/vpn/latest/s2svpn/VPC_VPN.html">AWS Site-to-Site VPN User Guide</a>.</p><p>For general information about interface endpoints, see <a href="https://docs.aws.amazon.com/vpc/latest/privatelink/vpce-interface.html">Interface VPC endpoints
      (AWS PrivateLink)</a> in the <em>AWS PrivateLink Guide</em>.</p><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#types-of-vpc-endpoints-for-s3">Types of VPC endpoints for Amazon S3</a></li><li><a href="#privatelink-limitations">Restrictions and limitations of AWS PrivateLink for Amazon S3</a></li><li><a href="#s3-creating-vpc">Creating a VPC endpoint</a></li><li><a href="#accessing-s3-interface-endpoints">Accessing Amazon S3 interface
        endpoints</a></li><li><a href="#private-dns">Private DNS</a></li><li><a href="#accessing-bucket-and-aps-from-interface-endpoints">Accessing buckets, access points,
        and Amazon S3 Control API operations from S3 interface endpoints</a></li><li><a href="#updating-on-premises-dns-config">Updating an on-premises DNS
        configuration</a></li><li><a href="#creating-vpc-endpoint-policy">Creating a VPC endpoint policy for
        Amazon S3</a></li></ul></div>
    <h2 id="types-of-vpc-endpoints-for-s3">Types of VPC endpoints for Amazon S3</h2>
    <p>You can use two types of VPC endpoints to access Amazon S3: <em>gateway
        endpoints</em> and <em>interface endpoints</em> (by using AWS PrivateLink).
      A <em>gateway endpoint</em> is a gateway that you specify in your
      route table to access Amazon S3 from your VPC over the AWS network. <em>Interface endpoints</em> extend the functionality of gateway endpoints by using
      private IP addresses to route requests to Amazon S3 from within your VPC, on premises, or from a
      VPC in another AWS Region by using VPC peering or AWS Transit Gateway. For
      more information, see <a href="https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html">What is VPC peering?</a> and <a href="https://docs.aws.amazon.com/whitepapers/latest/building-scalable-secure-multi-vpc-network-infrastructure/transit-gateway-vs-vpc-peering.html">Transit Gateway vs VPC peering</a>.</p>
    <p>Interface endpoints are compatible with gateway endpoints. If you have an existing gateway
      endpoint in the VPC, you can use both types of endpoints in the same VPC.</p>
    <div class="table-container"><div class="table-contents"><table id="w1877aac20c25c11b7"><thead>
          <tr>
            <th>
              <p>Gateway endpoints for Amazon S3</p>
            </th>
            <th>
              <p>Interface endpoints for Amazon S3</p>
            </th>
          </tr>
        </thead>
          <tr>
            <td colspan="2">
              
              <p>In both cases, your network traffic remains on the AWS network.</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Use Amazon S3 public IP addresses</p>
            </td>
            <td>
              <p>Use private IP addresses from your VPC to access Amazon S3</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Use the same Amazon S3 DNS names</p>
            </td>
            <td>
              <p><a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/privatelink-interface-endpoints.html#accessing-s3-interface-endpoints">Require endpoint-specific Amazon S3 DNS names</a></p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Do not allow access from on premises</p>
            </td>
            <td>
              <p>Allow access from on premises</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Do not allow access from another AWS Region</p>
            </td>
            <td>
              <p>Allow access from a VPC in another AWS Region by using VPC peering or
                AWS Transit Gateway</p>
            </td>
          </tr>
          <tr>
            <td>
              <p>Not billed</p>
            </td>
            <td>
              <p>Billed</p>
            </td>
          </tr>
        </table></div></div>
    <p>For more information about gateway endpoints, see <a href="https://docs.aws.amazon.com/vpc/latest/privatelink/vpce-gateway.html">Gateway VPC endpoints</a> in the
        <em>AWS PrivateLink Guide</em>.</p>
     
      <h2 id="privatelink-limitations">Restrictions and limitations of AWS PrivateLink for Amazon S3</h2>
      <p>VPC limitations apply to AWS PrivateLink for Amazon S3. For more information, see <a href="https://docs.aws.amazon.com/vpc/latest/privatelink/vpce-interface.html#vpce-interface-limitations">Interface
        endpoint considerations</a> and <a href="https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-limits-endpoints.html">AWS PrivateLink quotas</a> in the
        <em>AWS PrivateLink Guide</em>. In addition, the following restrictions
      apply.</p>
    <p>AWS PrivateLink for Amazon S3 does not support the following:</p>
    <div class="itemizedlist">
       
       
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p><a href="http://aws.amazon.com/compliance/fips/" rel="noopener noreferrer" target="_blank"><span>Federal Information Processing Standard
            (FIPS) endpoints</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
      </li><li class="listitem">
        <p><a href="./WebsiteEndpoints.html">Website endpoints</a></p>
      </li><li class="listitem">
        <p><a href="./VirtualHosting.html#deprecated-global-endpoint">Legacy global endpoints</a></p>
      </li><li class="listitem">
        <p>Using <a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_CopyObject.html">CopyObject</a> or <a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_UploadPartCopy.html">UploadPartCopy</a>
          between buckets in different AWS Regions</p></li><li class="listitem">
        <p>Transport Layer Security (TLS) 1.1</p>
      </li></ul></div>
     
    <h2 id="s3-creating-vpc">Creating a VPC endpoint</h2>
    <p>To create a VPC interface endpoint, see <a href="https://docs.aws.amazon.com/vpc/latest/privatelink/create-interface-endpoint.html#create-interface-endpoint-aws">
        Create a VPC endpoint</a> in the <em>AWS PrivateLink
      Guide</em>.</p>
   
      <h2 id="accessing-s3-interface-endpoints">Accessing Amazon S3 interface
        endpoints</h2>
      
      <p>When you create an interface endpoint, Amazon S3 generates two types of endpoint-specific, S3
      DNS names: <em>Regional</em> and <em>zonal</em>. </p>
      <div class="itemizedlist">
         
         
      <ul class="itemizedlist"><li class="listitem">
          <p>A <em>Regional</em> DNS name includes a unique VPC endpoint ID, a
          service identifier, the AWS Region, and <code class="code">vpce.amazonaws.com</code> in its name. For
          example, for VPC endpoint ID <code class="code"><code class="replaceable">vpce-1a2b3c4d</code></code>, the
          DNS name generated might be similar to
            <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f</code>.s3.us-east-1.vpce.amazonaws.com</code>.</p>
        </li><li class="listitem">
          <p>A <em>Zonal</em> DNS name includes the Availability Zone—for
          example, <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f</code>-<b>us-east-1a.</b>s3.us-east-1.vpce.amazonaws.com</code>. You might use this
          option if your architecture isolates Availability Zones. For example, you could use it for
          fault containment or to reduce Regional data transfer costs.</p>
        </li></ul></div>
      <p>Endpoint-specific S3 DNS names can be resolved from the S3 public DNS domain.</p>
      
     
    <h2 id="private-dns">Private DNS</h2>
    <p>Private DNS options for VPC interface endpoints simplify routing S3 traffic over VPC
      endpoints and help you take advantage of the lowest-cost network path available to your
      application. You can use private DNS options to route Regional S3 traffic without updating
      your S3 clients to use the endpoint-specific DNS names of your interface endpoints, or
      managing DNS infrastructure. With private DNS names enabled, Regional S3 DNS queries resolve
      to the private IP addresses of AWS PrivateLink for the following endpoints:</p>
    <div class="itemizedlist">
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>Regional bucket endpoints (for example,
          <code class="code">s3.us-east-1.amazonaws.com</code>)</p>
      </li><li class="listitem">
        <p>Control endpoints (for example,
          <code class="code">s3-control.us-east-1.amazonaws.com</code>)</p>
      </li><li class="listitem">
        <p>Access point endpoints (for example,
            <code class="code">s3-accesspoint.us-east-1.amazonaws.com</code>)</p>
      </li></ul></div>
    <p>If you have a gateway endpoint in your VPC, you can automatically route in-VPC
      requests over your existing S3 gateway endpoint and on-premises requests over your interface
      endpoint. This approach allows you to optimize your networking costs by using gateway
      endpoints, which are not billed, for your in-VPC traffic. Your on-premises applications can
      use AWS PrivateLink with the help of the inbound Resolver endpoint. Amazon provides a DNS
      server, called the Route 53 Resolver, for your VPC. An inbound Resolver endpoint forwards DNS
      queries from the on-premises network to Route 53 Resolver.</p>
    <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>To
        take
        advantage of the lowest cost network path when using <b>Enable private DNS only for
          inbound endpoints</b>, a gateway endpoint must be present in your VPC. The
        presence of a gateway endpoint helps ensure that in-VPC traffic always routes over the
        AWS private network when the <b>Enable private DNS only for inbound
          endpoints</b> option is selected. You must maintain this gateway endpoint while you
        have the <b>Enable private DNS only for inbound endpoints</b> option selected.
        If you want to delete your gateway endpoint you must first clear <b>Enable private
          DNS only for inbound endpoints</b>. </p><p>If you want to update an existing interface endpoint to <b>Enable private DNS
          only for inbound endpoints</b>, first confirm that your VPC has an S3 gateway
        endpoint. For more information about gateway endpoints and managing private DNS names, see
          <a href="https://docs.aws.amazon.com/vpc/latest/privatelink/vpce-gateway.html">Gateway VPC
          endpoints</a> and <a href="https://docs.aws.amazon.com/vpc/latest/privatelink/manage-dns-names.html">Manage DNS names</a> respectively
        in the <em>AWS PrivateLink Guide</em>.</p></div></div>
    <p>The <b>Enable private DNS only for inbound endpoints</b> option is available
      only for services that support gateway endpoints.</p>
    <p>For more information about creating a VPC endpoint that uses <b>Enable private
        DNS only for inbound endpoints</b>, see <a href="https://docs.aws.amazon.com/vpc/latest/privatelink/create-interface-endpoint.html">Create an interface
        endpoint</a> in the <em>AWS PrivateLink Guide</em>.</p>
    <p><b>Using
        the VPC console</b></p>
    <p>In the console you have two options: <b>Enable DNS name</b> and
        <b>Enable private DNS only for inbound endpoints</b>. <b>Enable DNS
        name</b> is an option supported by AWS PrivateLink. By using the <b>Enable DNS
        name</b> option, you can use Amazon’s private connectivity to Amazon S3, while making
      requests to the default public endpoint DNS names. When this option is enabled, customers can
      take advantage of the lowest cost network path available to their application.</p>
    <p>When you enable private DNS names on an existing or new VPC interface endpoint for Amazon S3,
      the <b>Enable private DNS only for inbound endpoints</b> option is selected by
      default. If this option is selected, your applications use only interface endpoints for your
      on-premises traffic. This in-VPC traffic automatically uses the lower-cost gateway endpoints.
      Alternatively, you can clear <b>Enable private DNS only for inbound
        endpoints</b> to route all S3 requests over your interface endpoint.</p>
    <p><b>Using the AWS CLI</b></p>
    <p>If
      you don't specify a value for <code class="code">PrivateDnsOnlyForInboundResolverEndpoint</code>, it will
      default to <code class="code">true</code>. However, before your VPC applies your settings, it performs a
      check to make sure that you have a gateway endpoint present in the VPC. If a gateway
      endpoint is present in the VPC, the call succeeds. If not, you will see the following error
      message: </p>
    <p><strong class="errortext"><code>To set PrivateDnsOnlyForInboundResolverEndpoint to true, the VPC
          <code class="replaceable">vpce_id</code> must have a gateway endpoint for the
        service.</code></strong></p>
    <p><b>For a new VPC Interface endpoint</b></p>
    <p>Use the <code class="code">private-dns-enabled</code> and <code class="code">dns-options</code> attributes to enable
      private DNS through the command line. The
        <code class="code">PrivateDnsOnlyForInboundResolverEndpoint</code> option in the <code class="code">dns-options</code>
      attribute must be set to <code class="code">true</code>. Replace the <code class="code"><code class="replaceable">user input placeholders</code></code> with
      your own information.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">
aws ec2 create-vpc-endpoint \
--region <code class="replaceable">us-east-1</code> \
--service-name <code class="replaceable">s3-service-name</code> \
--vpc-id <code class="replaceable">client-vpc-id</code> \
--subnet-ids <code class="replaceable">client-subnet-id</code> \ 
--vpc-endpoint-type Interface  \
--private-dns-enabled  \
--ip-address-type <code class="replaceable">ip-address-type</code> \ 
--dns-options PrivateDnsOnlyForInboundResolverEndpoint=true \
--security-group-ids <code class="replaceable">client-sg-id</code> 
    </code></pre>
    <p><b>For an existing VPC endpoint</b></p>
    <p>If you want to use private DNS for an existing VPC endpoint, use the following example
      command and replace the <code class="code"><code class="replaceable">user input placeholders</code></code> with
      your own information.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">
aws ec2 modify-vpc-endpoint \
--region <code class="replaceable">us-east-1</code> \
--vpc-endpoint-id <code class="replaceable">client-vpc-id</code> \
--private-dns-enabled \
--dns-options PrivateDnsOnlyForInboundResolverEndpoint=false
    </code></pre>
    <p>If you want to update an existing VPC endpoint to enable private DNS only for the
      Inbound Resolver, use the following example and replace the sample values with your
      own.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">
aws ec2 modify-vpc-endpoint \
--region <code class="replaceable">us-east-1</code> \
--vpc-endpoint-id <code class="replaceable">client-vpc-id</code> \
--private-dns-enabled \
--dns-options PrivateDnsOnlyForInboundResolverEndpoint=true
    </code></pre>
   
    <h2 id="accessing-bucket-and-aps-from-interface-endpoints">Accessing buckets, access points,
        and Amazon S3 Control API operations from S3 interface endpoints</h2>
    <p>You can use the AWS CLI or AWS SDKs to access buckets, S3 access points, and Amazon S3 Control API
      operations through S3 interface endpoints. </p>
    <p>The following image shows the VPC console <b>Details</b> tab, where you
      can find the DNS name of a VPC endpoint. In this example, the <em>VPC endpoint ID
        (vpce-id)</em> is <code class="code">vpce-0e25b8cdd720f900e</code> and the <em>DNS
        name</em> is
        <code class="code">*.vpce-0e25b8cdd720f900e-argc85vg.s3.us-east-1.vpce.amazonaws.com</code>. </p>
    <p></p>
    <p></p>
    <p></p>
    <div class="mediaobject">
       
       
        <img src="/images/AmazonS3/latest/userguide/images/vpc-console-details-tab.png" class="aws-docs-img-whiteBg aws-docs-img-padding aws-docs-img-filter" alt="&#xA;        The Details tab in the VPC console.&#xA;      " style="max-width:100%" />
       
    </div>
    <p>When using the DNS name to access a resource, replace <code class="replaceable">*</code> with
      the appropriate value. The appropriate values to use in place of <code class="code">*</code> are as
      follows: </p>
    <div class="itemizedlist">
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p><code class="code">bucket</code></p>
      </li><li class="listitem">
        <p><code class="code">accesspoint</code></p>
      </li><li class="listitem">
        <p><code class="code">control</code></p>
      </li></ul></div>
    <p>For example, to access a bucket, use a <em>DNS name</em> like this:</p>
    <p>
      <code class="code">bucket.vpce-0e25b8cdd720f900e-argc85vg.s3.us-east-1.vpce.amazonaws.com</code></p>
    <p>For examples of how to use DNS names to access buckets, access points, and Amazon S3 Control
      API operations, see the following sections of <a href="#privatelink-aws-cli-examples">AWS CLI examples</a> and <a href="#privatelink-aws-sdk-examples">AWS SDK examples</a>.</p>
    <p>For
      more information about how to view your endpoint-specific DNS names, see <a href="https://docs.aws.amazon.com/vpc/latest/privatelink/view-vpc-endpoint-service-dns-name.html">Viewing endpoint service private DNS name configuration</a> in the <em>VPC User
        Guide</em>.</p>
     
      <h3 id="privatelink-aws-cli-examples">AWS CLI examples</h3>
      <p>To access S3 buckets, S3 access points, or Amazon S3 Control API operations through S3 interface
        endpoints in AWS CLI commands, use the <code class="code">--region</code> and <code class="code">--endpoint-url</code>
        parameters. </p>
       
        <h6>Example: Use an endpoint URL to list objects in your bucket</h6>
        <p>In the following example, replace the bucket name <code class="code"><code class="replaceable">my-bucket</code></code>, Region
              <code class="code"><code class="replaceable">us-east-1</code></code>, and the DNS name of the VPC endpoint
          ID
            <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code> with your own
          information.</p>
       
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws s3 ls s3://<code class="replaceable">my-bucket</code>/ --region <code class="replaceable">us-east-1</code> --endpoint-url https://<b>bucket.</b><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code></pre>
      <p><b>Example: Use an endpoint URL to list objects from an access point</b></p>
      <div class="itemizedlist">
                 
         
         
      <ul class="itemizedlist"><li class="listitem">
          <p><b>Method 1</b> – Using the Amazon Resource Name
            (ARN) of the access point with the access point endpoint</p>
          
          <p>Replace the ARN
                <code class="code"><code class="replaceable">us-east-1:123456789012:accesspoint/accesspointexamplename</code></code>,
            the Region <code class="code"><code class="replaceable">us-east-1</code></code>, and the VPC endpoint ID
                <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code>
            with your own information.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws s3api list-objects-v2 --bucket arn:aws:s3:<code class="replaceable">us-east-1:123456789012:accesspoint/accesspointexamplename</code> --region <code class="replaceable">us-east-1</code> --endpoint-url https://<b>accesspoint.</b><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code></pre>
          <p>If you can't run the command successfully, update your AWS CLI to the latest version and try again. For more information on the update instructions, see 
            <a href="https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html#getting-started-install-instructions">
              Installing or updating the latest version of the AWS CLI</a> in the
            <em>AWS Command Line Interface User Guide</em>.</p>
        </li><li class="listitem">
          <p><b>Method 2</b> – Using the alias of the access point with
            the regional bucket endpoint</p>
          <p>In the following example, replace the access point alias 
            <code class="code"><code class="replaceable">accesspointexamplename-8tyekmigicmhun8n9kwpfur39dnw4use1a-s3alias</code></code>, the
            Region <code class="code"><code class="replaceable">us-east-1</code></code>, and the VPC endpoint ID
            <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code>
            with your own information.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws s3api list-objects-v2 --bucket <code class="replaceable">accesspointexamplename-8tyekmigicmhun8n9kwpfur39dnw4use1a-s3alias</code> --region <code class="replaceable">us-east-1</code> --endpoint-url https://<b>bucket.</b><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code></pre>
        </li><li class="listitem">
          <p><b>Method 3</b> – Using the alias of the access point with
            the access point endpoint</p>
          <p>First, to construct an S3 endpoint with the bucket included as part of the hostname, set the addressing style to <code class="code">virtual</code> for <code class="code">aws s3api</code> to use.
            For more information about <code class="code">AWS configure</code>, see <a href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-files.html">Configuration and credential file settings</a> in the
            <em>AWS Command Line Interface User Guide</em>.
          </p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws configure set default.s3.addressing_style virtual</code></pre>
          <p>Then, in the following example, replace the access point alias 
            <code class="code"><code class="replaceable">accesspointexamplename-8tyekmigicmhun8n9kwpfur39dnw4use1a-s3alias</code></code>, the
            Region <code class="code"><code class="replaceable">us-east-1</code></code>, and the VPC endpoint ID
            <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code>
            with your own information. For more information about access point alias, see <a href="./access-points-alias.html">Using a bucket-style alias for your S3 bucket
            access point</a></p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws s3api list-objects-v2 --bucket <code class="replaceable">accesspointexamplename-8tyekmigicmhun8n9kwpfur39dnw4use1a-s3alias</code> --region <code class="replaceable">us-east-1</code> --endpoint-url https://<b>accesspoint.</b><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code></pre>
        </li></ul></div>     
       
        <h6>Example: Use an endpoint URL to list jobs with an S3 control API operation</h6>
        <p>In the following example, replace the Region
              <code class="code"><code class="replaceable">us-east-1</code></code>, the VPC endpoint ID
              <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code>,
          and the account ID <code class="code"><code class="replaceable">12345678</code></code> with your own
          information.</p>
       
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws s3control --region <code class="replaceable">us-east-1</code> --endpoint-url https://<b>control.</b><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code> list-jobs --account-id <code class="replaceable">12345678</code></code></pre>
     
     
      <h3 id="privatelink-aws-sdk-examples">AWS SDK examples</h3>
      <p>To access S3 buckets, S3 access points, or Amazon S3 Control API operations through S3 interface
        endpoints when using the AWS SDKs, update your SDKs to the latest version. Then configure
        your clients to use an endpoint URL for accessing a bucket, access point, or Amazon S3 Control API
        operations through S3 interface endpoints. </p>
      <awsdocs-tabs><dl style="display: none">
        <dt>SDK for Python (Boto3)</dt><dd tab-id="sdk-for-python-(boto3)">
             
              <h6>Example: Use an endpoint URL to access an S3 bucket</h6>
              <p>In the following example, replace the Region
                    <code class="code"><code class="replaceable">us-east-1</code></code> and VPC endpoint ID
                    <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code>
                with your own information. </p>
             
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">s3_client = session.client(
service_name='s3',
region_name='<code class="replaceable">us-east-1</code>',
endpoint_url='https://<b>bucket.</b><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code>'
)</code></pre>
             
              <h6>Example: Use an endpoint URL to access an S3 access point</h6>
              <p>In the following example, replace the Region
                    <code class="code"><code class="replaceable">us-east-1</code></code> and VPC endpoint ID
                    <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code>
                with your own information. </p>
             
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">ap_client = session.client(
service_name='s3',
region_name='<code class="replaceable">us-east-1</code>',
endpoint_url='https://<b>accesspoint.</b><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code>'
)</code></pre>
             
              <h6>Example: Use an endpoint URL to access the Amazon S3 Control API</h6>
              <p>In the following example, replace the Region
                    <code class="code"><code class="replaceable">us-east-1</code></code> and VPC endpoint ID
                    <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code>
                with your own information. </p>
             
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">control_client = session.client(
service_name='s3control',
region_name='<code class="replaceable">us-east-1</code>',
endpoint_url='https://<b>control.</b><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code>'
)</code></pre>
          </dd>
        <dt>SDK for Java 1.x</dt><dd tab-id="sdk-for-java-1.x">
             
              <h6>Example: Use an endpoint URL to access an S3 bucket</h6>
              <p>In the following example, replace the VPC endpoint ID
                    <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code>
                with your own information. </p>
             
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="java ">// bucket client
final AmazonS3 s3 = AmazonS3ClientBuilder.standard().withEndpointConfiguration(
        new AwsClientBuilder.EndpointConfiguration(
                "https://<b>bucket.</b><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code>",
                Regions.DEFAULT_REGION.getName()
        )
).build();
List&lt;Bucket&gt; buckets = s3.listBuckets();</code></pre>
             
              <h6>Example: Use an endpoint URL to access an S3 access point</h6>
              <p>In the following example, replace the VPC endpoint ID
                    <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code>
                and ARN
                  <code class="code"><code class="replaceable">us-east-1:123456789012:accesspoint/prod</code></code>
                with your own information. </p>
             
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="java ">// accesspoint client
final AmazonS3 s3accesspoint = AmazonS3ClientBuilder.standard().withEndpointConfiguration(
        new AwsClientBuilder.EndpointConfiguration(
                "https://<b>accesspoint.</b><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code>",
                Regions.DEFAULT_REGION.getName()
        )
).build();
ObjectListing objects = s3accesspoint.listObjects("arn:aws:s3:<code class="replaceable">us-east-1:123456789012:accesspoint/prod</code>");</code></pre>
             
              <h6>Example: Use an endpoint URL to access an Amazon S3 Control API operation</h6>
              <p>In the following example, replace the VPC endpoint ID
                    <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code>
                with your own information. </p>
             
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="java ">// control client
final AWSS3Control s3control = AWSS3ControlClient.builder().withEndpointConfiguration(
        new AwsClientBuilder.EndpointConfiguration(
                "https://<b>control.</b><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code>",
                Regions.DEFAULT_REGION.getName()
        )
).build();
final ListJobsResult jobs = s3control.listJobs(new ListJobsRequest());</code></pre>
          </dd>
        <dt>SDK for Java 2.x</dt><dd tab-id="sdk-for-java-2.x">
             
              <h6>Example: Use an endpoint URL to access an S3 bucket</h6>
              <p>In the following example, replace the VPC endpoint ID
                    <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code>
                and the Region <code class="code"><code class="replaceable">Region.US_EAST_1</code></code> with your
                own information.</p>
             
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="java ">// bucket client
Region region = <code class="replaceable">Region.US_EAST_1</code>;
s3Client = S3Client.builder().region(region)
                   .endpointOverride(URI.create("https://<b>bucket.</b><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code>"))
                   .build()</code></pre>
             
              <h6>Example: Use an endpoint URL to access an S3 access point</h6>
              <p>In the following example, replace the VPC endpoint ID
                    <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code>
                and the Region <code class="code"><code class="replaceable">Region.US_EAST_1</code></code> with your
                own information.</p>
             
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="java ">// accesspoint client
Region region = <code class="replaceable">Region.US_EAST_1</code>;
s3Client = S3Client.builder().region(region)
                   .endpointOverride(URI.create("https://<b>accesspoint.</b><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code>"))
                   .build()</code></pre>
             
              <h6>Example: Use an endpoint URL to access the Amazon S3 Control API</h6>
              <p>In the following example, replace the VPC endpoint ID
                    <code class="code"><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code></code>
                and the Region <code class="code"><code class="replaceable">Region.US_EAST_1</code></code> with your
                own information.</p>
             
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="java ">// control client
Region region = <code class="replaceable">Region.US_EAST_1</code>;
s3ControlClient = S3ControlClient.builder().region(region)
                                 .endpointOverride(URI.create("https://<b>control.</b><code class="replaceable">vpce-1a2b3c4d-5e6f.s3.us-east-1.vpce.amazonaws.com</code>"))
                                 .build()</code></pre>
          </dd>
      </dl></awsdocs-tabs>
     
   
    <h2 id="updating-on-premises-dns-config">Updating an on-premises DNS
        configuration</h2>
      <p>When using endpoint-specific DNS names to access the interface endpoints for Amazon S3, you
      don’t have to update your on-premises DNS resolver. You can resolve the endpoint-specific DNS
      name with the private IP address of the interface endpoint from the public Amazon S3 DNS domain. </p>

       
      <h3 id="using-interface-endpoints">Using interface endpoints to access Amazon S3 without
          a gateway endpoint or an internet gateway in the VPC</h3>
      <p>Interface endpoints in your VPC can route both in-VPC applications and on-premises
        applications to Amazon S3 over the Amazon network, as illustrated in the following
        diagram.</p>
      <div class="mediaobject">
         
         
          <img src="/images/AmazonS3/latest/userguide/images/interface-endpoints.png" class="aws-docs-img-whiteBg aws-docs-img-padding aws-docs-img-filter" alt="&#xA;          Data flow diagram showing access from on-premises and in-VPC apps to Amazon S3 by&#xA;            using an interface endpoint and AWS PrivateLink.&#xA;        " style="max-width:100%" />
         
      </div>
      <p>The
        diagram illustrates the following: </p>
      <div class="itemizedlist">
         
         
         
         
      <ul class="itemizedlist"><li class="listitem">
          <p>Your on-premises network uses AWS Direct Connect or AWS VPN to connect to VPC A.</p>
        </li><li class="listitem">
          <p>Your applications on-premises and in VPC A use endpoint-specific DNS names to access
            Amazon S3 through the S3 interface endpoint.</p>
        </li><li class="listitem">
          <p>On-premises applications send data to the interface endpoint in the VPC through
            AWS Direct Connect (or AWS VPN). AWS PrivateLink moves the data from the interface endpoint to Amazon S3
            over the AWS network.</p>
        </li><li class="listitem">
          <p>In-VPC applications also send traffic to the interface endpoint. AWS PrivateLink moves
            the data from the interface endpoint to Amazon S3 over the AWS network.</p>
        </li></ul></div>
     
       
        <h3 id="using-gateway-and-interface-endpoints">Using gateway endpoints and
          interface endpoints together in the same VPC to access Amazon S3</h3>
        <p>You can create interface endpoints and retain the existing gateway endpoint in the
        same VPC, as the following diagram shows. By taking this approach, you allow in-VPC
        applications to continue accessing Amazon S3 through the gateway endpoint, which is not billed.
        Then, only your on-premises applications would use interface endpoints to access Amazon S3. To
        access Amazon S3 this way, you must update your on-premises applications to use endpoint-specific
        DNS names for Amazon S3.</p>
        <div class="mediaobject">
         
         
          <img src="/images/AmazonS3/latest/userguide/images/interface-and-gateway-endpoints.png" class="aws-docs-img-whiteBg aws-docs-img-padding aws-docs-img-filter" alt="&#xA;          Data-flow diagram showing access to Amazon S3 by using gateway endpoints and interface&#xA;            endpoints together.&#xA;        " style="max-width:100%" />
         
      </div>
        <p>The diagram illustrates the following: </p>
        <div class="itemizedlist">
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p>On-premises applications use endpoint-specific DNS names to send data to the
            interface endpoint within the VPC through AWS Direct Connect (or AWS VPN). AWS PrivateLink moves the
            data from the interface endpoint to Amazon S3 over the AWS network.</p>
          </li><li class="listitem">
            <p>Using default Regional Amazon S3 names, in-VPC applications send data to the gateway
            endpoint that connects to Amazon S3 over the AWS network.</p>
          </li></ul></div>
        <p>For more information about gateway endpoints, see <a href="https://docs.aws.amazon.com/vpc/latest/privatelink/vpce-gateway.html">Gateway VPC endpoints</a> in the
            <em>VPC User Guide</em>. </p>
     
   
    <h2 id="creating-vpc-endpoint-policy">Creating a VPC endpoint policy for
        Amazon S3</h2>
    <p>You can attach an endpoint policy to your VPC endpoint that controls access to Amazon S3. The
      policy specifies the following information: </p>
    <div class="itemizedlist">
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>The AWS Identity and Access Management (IAM) principal that can perform actions </p>
      </li><li class="listitem">
        <p>The actions that can be performed </p>
      </li><li class="listitem">
        <p>The resources on which actions can be performed </p>
      </li></ul></div>
    <p>You can also use Amazon S3 bucket policies to restrict access to specific buckets from a
      specific VPC endpoint by using the <code class="code">aws:sourceVpce</code> condition in your bucket
      policy. The following examples show policies that restrict access to a bucket or to an
      endpoint.</p>
    <div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#privatelink-example-restrict-access-to-bucket">Example: Restricting access
          to a specific bucket from a VPC endpoint</a></li><li><a href="#privatelink-example-access-bucket-in-specific-account-only">Example:
          Restricting access to buckets in a specific account from a VPC endpoint</a></li><li><a href="#privatelink-example-restrict-access-to-vpc-endpoint">Example: Restricting
          access to a specific VPC endpoint in the S3 bucket policy</a></li></ul></div>
     
      <h3 id="privatelink-example-restrict-access-to-bucket">Example: Restricting access
          to a specific bucket from a VPC endpoint</h3>
      <p>You can create an endpoint policy that restricts access to only specific Amazon S3 buckets.
        This type of policy is useful if you have other AWS services in your VPC that use
        buckets. The following bucket policy restricts access to only the
            <code class="code"><code class="replaceable"><code class="replaceable">DOC-EXAMPLE-BUCKET1</code></code></code>. To use this endpoint
        policy, replace <code class="code"><code class="replaceable"><code class="replaceable">DOC-EXAMPLE-BUCKET1</code></code></code> with the name
        of your bucket.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Id": "Policy1415115909151",
  "Statement": [
    <span>{</span> "Sid": "Access-to-specific-bucket-only",
      "Principal": "*",
      "Action": [
        "s3:GetObject",
        "s3:PutObject"
      ],
      "Effect": "Allow",
      "Resource": ["arn:aws:s3:::<code class="replaceable"><code class="replaceable">DOC-EXAMPLE-BUCKET1</code></code>",
                   "arn:aws:s3:::<code class="replaceable"><code class="replaceable">DOC-EXAMPLE-BUCKET1</code></code>/*"]
    }
  ]
}</code></pre>
     
     
      <h3 id="privatelink-example-access-bucket-in-specific-account-only">Example:
          Restricting access to buckets in a specific account from a VPC endpoint</h3>
      <p>You can create an endpoint policy that restricts access to only the S3 buckets in a
        specific AWS account. To prevent clients within your VPC from accessing buckets that you
        don't own, use the following statement in your endpoint policy. The following example
        statement creates a policy that restricts access to resources owned by a single
        AWS account ID, <code class="replaceable"><code class="code">111122223333</code></code>.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Statement": [
    <span>{</span>
      "Sid": "Access-to-bucket-in-specific-account-only",
      "Principal": "*",
      "Action": [
        "s3:GetObject",
        "s3:PutObject"
      ],
      "Effect": "Deny",
      "Resource": "arn:aws:s3:::*",
      "Condition": <span>{</span>
        "StringNotEquals": <span>{</span>
          "aws:ResourceAccount": "<code class="replaceable">111122223333</code>"
        }
      }
    }
  ]
}</code></pre>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>To specify the AWS account ID of the resource being accessed, you can use either the
            <code class="code">aws:ResourceAccount</code> or the <code class="code">s3:ResourceAccount</code> key in your
          IAM policy. However, be aware that some AWS services rely on access to AWS managed
          buckets. Therefore, using the <code class="code">aws:ResourceAccount</code> or
            <code class="code">s3:ResourceAccount</code> key in your IAM policy might also affect access to
          these resources.</p></div></div>
     
     
      <h3 id="privatelink-example-restrict-access-to-vpc-endpoint">Example: Restricting
          access to a specific VPC endpoint in the S3 bucket policy</h3>
      <p><a id="example-restrict-access-to-vpc-endpoint"></a><b>Example: Restricting access to a specific VPC endpoint in the S3
          bucket policy</b></p>
      <p>The following Amazon S3 bucket policy allows access to a specific bucket,
            <code class="code"><code class="replaceable"><code class="replaceable">DOC-EXAMPLE-BUCKET2</code></code></code>, from only the VPC endpoint
            <code class="code"><code class="replaceable">vpce-1a2b3c4d</code></code>. The policy denies all access to
        the bucket if the specified endpoint is not being used. The <code class="code">aws:sourceVpce</code>
        condition specifies the endpoint and doesn't require an Amazon Resource Name (ARN) for the
        VPC endpoint resource, only the endpoint ID. To use this bucket policy, replace
            <code class="code"><code class="replaceable"><code class="replaceable">DOC-EXAMPLE-BUCKET2</code></code></code> and
            <code class="code"><code class="replaceable">vpce-1a2b3c4d</code></code> with your bucket name and
        endpoint. </p>
      <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><div class="itemizedlist">
           
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p>When applying the following Amazon S3 bucket policy to restrict access to only certain
              VPC endpoints, you might block your access to the bucket without intending to do so.
              Bucket policies that are intended to specifically limit bucket access to connections
              originating from your VPC endpoint can block all connections to the bucket. For
              information about how to fix this issue, see <a href="https://aws.amazon.com/premiumsupport/knowledge-center/s3-regain-access/" rel="noopener noreferrer" target="_blank"><span>My bucket
                policy has the wrong VPC or VPC endpoint ID. How can I fix the policy so that I
                can access the bucket?</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> in the <em>AWS Support Knowledge
              Center</em>.</p>
          </li><li class="listitem">
            <p>Before using the following example policy, replace the VPC endpoint ID with an
              appropriate value for your use case. Otherwise, you won't be able to access your
              bucket. </p>
          </li><li class="listitem">
            <p>This policy disables <em>console</em> access to the specified bucket,
              because console requests don't originate from the specified VPC endpoint. </p>
          </li></ul></div></div></div>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Id": "Policy1415115909152",
  "Statement": [
    <span>{</span> "Sid": "Access-to-specific-VPCE-only",
      "Principal": "*",
      "Action": "s3:*",
      "Effect": "Deny",
      "Resource": ["arn:aws:s3:::<code class="replaceable"><code class="replaceable">DOC-EXAMPLE-BUCKET2</code></code>",
                   "arn:aws:s3:::<code class="replaceable"><code class="replaceable">DOC-EXAMPLE-BUCKET2</code>/*</code>"],
      "Condition": <span>{</span>"StringNotEquals": <span>{</span>"aws:sourceVpce": "<code class="replaceable">vpce-1a2b3c4d</code>"}}
    }
  ]
}</code></pre>
     
    <p>For more policy examples, see <a href="https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints-s3.html#vpc-endpoints-policies-s3">Endpoints for
        Amazon S3</a> in the <em>VPC User Guide</em>.</p>
  <p>For more information about VPC connectivity, see <a href="https://docs.aws.amazon.com/whitepapers/latest/aws-vpc-connectivity-options/network-to-amazon-vpc-connectivity-options.html">Network-to-VPC connectivity options</a> in the AWS whitepaper <a href="https://docs.aws.amazon.com/whitepapers/latest/aws-vpc-connectivity-options/welcome.html">Amazon
      Virtual Private Cloud Connectivity Options</a>.</p><awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./inter-network-traffic-privacy.html">Internetwork privacy</div><div id="next" class="next-link" accesskey="n" href="./s3-access-control.html">Identity and access management</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=S3&amp;topic_url=https://docs.aws.amazon.com/en_us/AmazonS3/latest/userguide/privatelink-interface-endpoints.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=S3&amp;topic_url=https://docs.aws.amazon.com/en_us/AmazonS3/latest/userguide/privatelink-interface-endpoints.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>