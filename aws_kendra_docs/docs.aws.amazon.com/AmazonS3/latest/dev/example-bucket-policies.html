<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Bucket policy examples - Amazon Simple Storage Service</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="example-bucket-policies" /><meta name="default_state" content="example-bucket-policies" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/example-bucket-policies.html" /><meta name="description" content="See examples of typical use cases for Amazon S3 bucket policies." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Simple Storage Service" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Learn how to use Amazon Simple Storage Service (Amazon S3) to store and retrieve any amount of data from anywhere. This guide explains Amazon S3 concepts, such as buckets, objects, and related configurations, and includes code examples for common operations." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/example-bucket-policies.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/example-bucket-policies.html" hreflang="x-default" /><meta name="feedback-item" content="S3" /><meta name="this_doc_product" content="Amazon Simple Storage Service" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'s3'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="Bucket policy examples" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Bucket policy examples - Amazon Simple Storage Service</title><meta name="pdf" content="/pdfs/AmazonS3/latest/userguide/s3-userguide.pdf#example-bucket-policies" /><meta name="github" content="https://github.com/awsdocs/amazon-s3-userguide/tree/main/doc_source/example-bucket-policies.md" /><meta name="rss" content="s3-userguide-rss-updates.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=24" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=S3&amp;topic_url=http://docs.aws.amazon.com/en_us/AmazonS3/latest/userguide/example-bucket-policies.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/AmazonS3/latest/userguide/example-bucket-policies.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/AmazonS3/latest/userguide/example-bucket-policies.html" /><meta name="keywords" content="S3,Amazon S3,S3 User Guide,Amazon S3 User Guide,Amazon User Guide,s3 bucket,s3 object,cloud storage,data storage" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Simple Storage Service (S3)",
        "item" : "https://docs.aws.amazon.com/s3/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/AmazonS3/latest/userguide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Amazon S3 security",
        "item" : "https://docs.aws.amazon.com/AmazonS3/latest/userguide/security.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Identity and access management in Amazon S3",
        "item" : "https://docs.aws.amazon.com/AmazonS3/latest/userguide/s3-access-control.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Bucket policies and user policies",
        "item" : "https://docs.aws.amazon.com/AmazonS3/latest/userguide/using-iam-policies.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "Using bucket policies",
        "item" : "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-policies.html"
      },
      {
        "@type" : "ListItem",
        "position" : 8,
        "name" : "Bucket policy examples",
        "item" : "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-policies.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/AmazonS3/latest/userguide/s3-userguide.pdf#example-bucket-policies" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/amazon-s3-userguide/tree/main/doc_source/example-bucket-policies.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/s3/index.html">Amazon Simple Storage Service (S3)</a><a href="Welcome.html">User Guide</a></div><div id="page-toc-src"><a href="#example-bucket-policies-encryption">Requiring encryption</a><a href="#example-bucket-policies-public-access">Managing buckets using canned ACLs</a><a href="#example-bucket-policies-object-tags">Managing object access with object tagging</a><a href="#example-bucket-policies-global-condition-keys">Managing object access by using global
        condition keys</a><a href="#example-bucket-policies-IP">Managing access based on specific IP
        addresses</a><a href="#example-bucket-policies-HTTP-HTTPS">Managing access based on HTTP or HTTPS
        requests</a><a href="#example-bucket-policies-folders">Managing user access to specific
        folders</a><a href="#example-bucket-policies-access-logs">Managing access for access logs</a><a href="#example-bucket-policies-cloudfront">Managing access to an Amazon CloudFront
        OAI</a><a href="#example-bucket-policies-lens">Managing access for Amazon S3 Storage Lens</a><a href="#example-bucket-policies-s3-inventory">Managing permissions for S3 Inventory,
        S3 analytics, and S3 Inventory reports</a><a href="#example-bucket-policies-MFA">Requiring MFA</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="example-bucket-policies">Bucket policy examples</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>With Amazon S3 bucket policies, you can secure access to objects in your buckets, so that only
    users with the appropriate permissions can access them. You can even prevent authenticated users
    without the appropriate permissions from accessing your Amazon S3 resources.</p><p>This section presents examples of typical use cases for bucket policies. These sample
    policies use <code class="code"><code class="replaceable">DOC-EXAMPLE-BUCKET</code></code> as the resource value. To test these policies,
    replace the <code class="code"><code class="replaceable">user input placeholders</code></code> with your own
    information (such as your bucket name). </p><p>To grant or deny permissions to a set of objects, you can use wildcard characters
      (<code class="code">*</code>) in Amazon Resource Names (ARNs) and other values. For example, you can
    control access to groups of objects that begin with a common <a href="https://docs.aws.amazon.com/general/latest/gr/glos-chap.html#keyprefix">prefix</a> or end with a given extension,
    such as <code class="code">.html</code>. </p><p>For information about bucket policies, see <a href="./bucket-policies.html">Using bucket policies</a>. For more information about AWS Identity and Access Management (IAM) policy
    language, see <a href="./access-policy-language-overview.html">Policies and Permissions in
				Amazon S3</a>.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>When testing permissions by using the Amazon S3 console, you must grant additional permissions
      that the console requires—<code class="code">s3:ListAllMyBuckets</code>,
        <code class="code">s3:GetBucketLocation</code>, and <code class="code">s3:ListBucket</code>. For an example
      walkthrough that grants permissions to users and tests those permissions by using the console,
      see <a href="./walkthrough1.html">Controlling access to a bucket with user policies</a>.</p></div></div><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#example-bucket-policies-encryption">Requiring encryption</a></li><li><a href="#example-bucket-policies-public-access">Managing buckets using canned ACLs</a></li><li><a href="#example-bucket-policies-object-tags">Managing object access with object tagging</a></li><li><a href="#example-bucket-policies-global-condition-keys">Managing object access by using global
        condition keys</a></li><li><a href="#example-bucket-policies-IP">Managing access based on specific IP
        addresses</a></li><li><a href="#example-bucket-policies-HTTP-HTTPS">Managing access based on HTTP or HTTPS
        requests</a></li><li><a href="#example-bucket-policies-folders">Managing user access to specific
        folders</a></li><li><a href="#example-bucket-policies-access-logs">Managing access for access logs</a></li><li><a href="#example-bucket-policies-cloudfront">Managing access to an Amazon CloudFront
        OAI</a></li><li><a href="#example-bucket-policies-lens">Managing access for Amazon S3 Storage Lens</a></li><li><a href="#example-bucket-policies-s3-inventory">Managing permissions for S3 Inventory,
        S3 analytics, and S3 Inventory reports</a></li><li><a href="#example-bucket-policies-MFA">Requiring MFA</a></li></ul></div>
    <h2 id="example-bucket-policies-encryption">Requiring encryption</h2>
     
      <h3 id="example-bucket-policies-encryption-1">Require SSE-KMS for all objects
          written to a bucket</h3>
      <p>The following example policy requires every object that is written to the bucket to be
        encrypted with server-side encryption using AWS Key Management Service (AWS KMS) keys (SSE-KMS). If the object
        isn't encrypted with SSE-KMS, the request will be denied.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
"Version": "2012-10-17",
"Id": "PutObjPolicy",
"Statement": [<span>{</span>
  "Sid": "<code class="replaceable">DenyObjectsThatAreNotSSEKMS</code>",
  "Principal": "*",
  "Effect": "Deny",
  "Action": "s3:PutObject",
  "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*",
  "Condition": <span>{</span>
    "Null": <span>{</span>
      "s3:x-amz-server-side-encryption-aws-kms-key-id": "true"
    }
  }
}]
}</code></pre>
     
     
      <h3 id="example-bucket-policies-encryption-2">Require SSE-KMS with a specific
          AWS KMS key for all objects written to a bucket</h3>
      <p>The following example policy denies any objects from being written to the bucket if they
        aren’t encrypted with SSE-KMS by using a specific KMS key ID. Even if the objects are
        encrypted with SSE-KMS by using a per-request header or bucket default encryption, the
        objects cannot be written to the bucket if they haven't been encrypted with the specified
        KMS key. Make sure to replace the KMS key ARN that's used in this example with your own
        KMS key ARN.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
"Version": "2012-10-17",
"Id": "PutObjPolicy",
"Statement": [<span>{</span>
  "Sid": "<code class="replaceable">DenyObjectsThatAreNotSSEKMSWithSpecificKey</code>",
  "Principal": "*",
  "Effect": "Deny",
  "Action": "s3:PutObject",
  "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*",
  "Condition": <span>{</span>
    "ArnNotEqualsIfExists": <span>{</span>
      "s3:x-amz-server-side-encryption-aws-kms-key-id": "arn:aws:kms:<code class="replaceable">us-east-2</code>:<code class="replaceable">111122223333</code>:key/<code class="replaceable">01234567-89ab-cdef-0123-456789abcdef</code>"
    }
  }
}]
}</code></pre>
     
   
    <h2 id="example-bucket-policies-public-access">Managing buckets using canned ACLs</h2>
     
      <h3 id="example-bucket-policies-acl-1">Granting permissions to multiple accounts to
          upload objects or set object ACLs for public access</h3>
      <p>The following example policy grants the <code class="code">s3:PutObject</code> and
        <code class="code">s3:PutObjectAcl</code> permissions to multiple AWS accounts and requires that any
        requests for these operations must include the <code class="code">public-read</code> canned access
        control list (ACL). For more information, see <a href="./using-with-s3-actions.html">Amazon S3 actions</a> and <a href="./amazon-s3-policy-keys.html">Amazon S3 condition key examples</a>.</p>
      <div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Warning</h6></div><div class="awsdocs-note-text"><p>The <code class="code">public-read</code> canned ACL allows anyone in the world to view the objects
          in your bucket. Use caution when granting anonymous access to your Amazon S3 bucket or
          disabling block public access settings. When you grant anonymous access, anyone in the
          world can access your bucket. We recommend that you never grant anonymous access to your
          Amazon S3 bucket unless you specifically need to, such as with <a href="./WebsiteHosting.html">static website hosting</a>. If you want to enable block public access settings for
          static website hosting, see <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/HostingWebsiteOnS3Setup.html">Tutorial: Configuring a
            static website on Amazon S3</a>.</p></div></div>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "AddPublicReadCannedAcl",
            "Effect": "Allow",
            "Principal": <span>{</span>
                "AWS": [
                    "arn:aws:iam::<code class="replaceable">111122223333</code>:root",
                    "arn:aws:iam::<code class="replaceable">444455556666</code>:root"
                ]
            },
            "Action": [
                "s3:PutObject",
                "s3:PutObjectAcl"
            ],
            "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "s3:x-amz-acl": [
                        "public-read"
                    ]
                }
            }
        }
    ]
}</code></pre>
     
     
      <h3 id="example-bucket-policies-acl-2">Grant cross-account permissions to upload
          objects while ensuring that the bucket owner has full control</h3>
      <p>The following example shows how to allow another AWS account to upload objects to your
        bucket while ensuring that you have full control of the uploaded objects. This policy grants
        a specific AWS account (<code class="replaceable"><code class="code">111122223333</code></code>)
        the ability to upload objects only if that account includes the
        <code class="code">bucket-owner-full-control</code> canned ACL on upload. The <code class="code">StringEquals</code>
        condition in the policy specifies the <code class="code">s3:x-amz-acl</code> condition key to express the
        canned ACL requirement. For more information, see <a href="./amazon-s3-policy-keys.html">Amazon S3 condition key examples</a>. </p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
     <span>{</span>
       "Sid":"PolicyForAllowUploadWithACL",
       "Effect":"Allow",
       "Principal":<span>{</span>"AWS":"<code class="replaceable">111122223333</code>"},
       "Action":"s3:PutObject",
       "Resource":"arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*",
       "Condition": <span>{</span>
         "StringEquals": <span>{</span>"s3:x-amz-acl":"bucket-owner-full-control"}
       }
     }
   ]
}</code></pre>
     
   
    <h2 id="example-bucket-policies-object-tags">Managing object access with object tagging</h2>
     
      <h3 id="example-bucket-policies-tagging-1">Allow a user to read only objects that
          have a specific tag key and value</h3>
      <p>The following permissions policy limits a user to only reading objects that have the
        <code class="code">environment: production</code> tag key and value. This policy uses the
        <code class="code">s3:ExistingObjectTag</code> condition key to specify the tag key and value.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Principal":<span>{</span>
            "AWS":"arn:aws:iam::111122223333:role/JohnDoe"
         },
         "Effect":"Allow",
         "Action":[
            "s3:GetObject",
            "s3:GetObjectVersion"
         ],
         "Resource":"arn:aws:s3:::DOC-EXAMPLE-BUCKET/*",
         "Condition":<span>{</span>
            "StringEquals":<span>{</span>
               "s3:ExistingObjectTag/environment":"production"
            }
         }
      }
   ]
}</code></pre>
     
     
      <h3 id="example-bucket-policies-tagging-2">Restrict which object tag keys that
          users can add</h3>
      <p>The following example policy grants a user permission to perform the
        <code class="code">s3:PutObjectTagging</code> action, which allows a user to add tags to an existing
        object. The condition uses the <code class="code">s3:RequestObjectTagKeys</code> condition key to specify
        the allowed tag keys, such as <code class="code">Owner</code> or <code class="code">CreationDate</code>. For more
        information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_multi-value-conditions.html">Creating a
          condition that tests multiple key values</a> in the <em>IAM User Guide</em>.</p>
      <p>The policy ensures that every tag key specified in the request is an authorized tag key.
        The <code class="code">ForAnyValue</code> qualifier in the condition ensures that at least one of the
        specified keys must be present in the request.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version": "2012-10-17",
  "Statement": [
    <span>{</span>"Principal":<span>{</span>"AWS":[
            "arn:aws:iam::<code class="replaceable">111122223333</code>:role/<code class="replaceable">JohnDoe</code>"
         ]
       },
 "Effect": "Allow",
      "Action": [
        "s3:PutObjectTagging"
      ],
      "Resource": [
        "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*"
      ],
      "Condition": <span>{</span>"ForAnyValue:StringEquals": <span>{</span>"s3:RequestObjectTagKeys": [
            "Owner",
            "CreationDate"
          ]
        }
      }
    }
  ]
}</code></pre>
     
     
      <h3 id="example-bucket-policies-tagging-3">Require a specific tag key and value
          when allowing users to add object tags</h3>
      <p>The following example policy grants a user permission to perform the
        <code class="code">s3:PutObjectTagging</code> action, which allows a user to add tags to an existing
        object. The condition requires the user to include a specific tag key (such as
        <code class="code"><code class="replaceable">Project</code></code>) with the value set to
        <code class="code"><code class="replaceable">X</code></code>.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version": "2012-10-17",
  "Statement": [
    <span>{</span>"Principal":<span>{</span>"AWS":[
       "arn:aws:iam::<code class="replaceable">111122223333</code>:user/<code class="replaceable">JohnDoe</code>"
         ]
       },
      "Effect": "Allow",
      "Action": [
        "s3:PutObjectTagging"
      ],
      "Resource": [
        "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*"
      ],
      "Condition": <span>{</span>"StringEquals": <span>{</span>"s3:RequestObjectTag/<code class="replaceable">Project</code>": "<code class="replaceable">X</code>"
        }
      }
    }
  ]
}</code></pre>
     
     
      <h3 id="example-bucket-policies-tagging-4">Allow a user to only add objects with a
          specific object tag key and value</h3>
      <p>The following example policy grants a user permission to perform the
        <code class="code">s3:PutObject</code> action so that they can add objects to a bucket. However, the
        <code class="code">Condition</code> statement restricts the tag keys and values that are allowed on the
        uploaded objects. In this example, the user can only add objects that have the specific tag
        key (<code class="code"><code class="replaceable">Department</code></code>) with the value set to
        <code class="code"><code class="replaceable">Finance</code></code> to the bucket.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [<span>{</span>
        "Principal":<span>{</span>
            "AWS":[
                 "arn:aws:iam::<code class="replaceable">111122223333</code>:user/<code class="replaceable">JohnDoe</code>"
         ]
        },
        "Effect": "Allow",
        "Action": [
            "s3:PutObject"
        ],
        "Resource": [
            "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*"
        ],
        "Condition": <span>{</span>
            "StringEquals": <span>{</span>
                "s3:RequestObjectTag/<code class="replaceable">Department</code>": "<code class="replaceable">Finance</code>"
            }
        }
    }]
}</code></pre>
     
   
    <h2 id="example-bucket-policies-global-condition-keys">Managing object access by using global
        condition keys</h2>
    <p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html">Global condition
        keys</a> are condition context keys with an <code class="code">aws</code> prefix. AWS services can
      support global condition keys or service-specific keys that include the service prefix. You
      can use the <code class="code">Condition</code> element of a JSON policy to compare the keys in a request
      with the key values that you specify in your policy.</p>
     
      <h3 id="example-bucket-policies-global-condition-keys-1">Restrict access to only Amazon S3 server
          access log deliveries</h3>
      <p>In the following example bucket policy, the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#condition-keys-sourcearn">aws:SourceArn</a> global condition key is used to compare the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_identifiers.html#identifiers-arns">Amazon Resource
          Name (ARN)</a> of the resource, making a service-to-service request with the ARN that
        is specified in the policy. The <code class="code">aws:SourceArn</code> global condition key is used to
        prevent the Amazon S3 service from being used as a <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/confused-deputy.html">confused deputy</a> during
        transactions between services. Only the Amazon S3 service is allowed to add objects to the Amazon S3
        bucket.</p>
      <p>This example bucket policy grants <code class="code">s3:PutObject</code> permissions to only the
        logging service principal (<code class="code">logging.s3.amazonaws.com</code>). </p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "<code class="replaceable">AllowPutObjectS3ServerAccessLogsPolicy</code>",
            "Principal": <span>{</span>
                "Service": "logging.s3.amazonaws.com"
            },
            "Effect": "Allow",
            "Action": "s3:PutObject",
            "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET-logs</code>/*",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "aws:SourceAccount": "<code class="replaceable">111111111111</code>"
                },
                "ArnLike": <span>{</span>
                    "aws:SourceArn": "arn:aws:s3:::<code class="replaceable">EXAMPLE-SOURCE-BUCKET</code>"
                }
            }
        },
        <span>{</span>
            "Sid": "<code class="replaceable">RestrictToS3ServerAccessLogs</code>",
            "Effect": "Deny",
            "Principal": "*",
            "Action": "s3:PutObject",
            "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET-logs</code>/*",
            "Condition": <span>{</span>
                "ForAllValues:StringNotEquals": <span>{</span>
                    "aws:PrincipalServiceNamesList": "logging.s3.amazonaws.com"
                }
            }
        }
    ]
}</code></pre>
     
     
      <h3 id="example-bucket-policies-global-condition-keys-2">Allow access to only your
          organization</h3>
      <p>If you want to require all <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/intro-structure.html#intro-structure-principal">IAM
          principals</a> accessing a resource to be from an AWS account in your organization
        (including the AWS Organizations management account), you can use the <code class="code">aws:PrincipalOrgID</code>
        global condition key.</p>
      <p>To grant or restrict this type of access, define the <code class="code">aws:PrincipalOrgID</code>
        condition and set the value to your <a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_org_details.html">organization ID</a>
        in the bucket policy. The organization ID is used to control  access to the bucket. When you
        use the <code class="code">aws:PrincipalOrgID</code> condition, the permissions from the bucket policy
        are also applied to all new accounts that are added to the organization.</p>
      <p>Here’s an example of a resource-based bucket policy that you can use to grant specific
        IAM principals in your organization direct access to your bucket. By adding the
          <code class="code">aws:PrincipalOrgID</code> global condition key to your bucket policy, the principal
        account is now required to be in your organization to obtain access to the resource. Even if
        you accidentally specify an incorrect account when granting access, the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#condition-keys-principalorgid">aws:PrincipalOrgID global condition key</a> acts as an additional
        safeguard. When this global key is used in a policy, it prevents all principals from outside
        of the specified organization from accessing the S3 bucket. Only principals from accounts in
        the listed organization are able to obtain access to the resource.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [<span>{</span>
        "Sid": "AllowGetObject",
        "Principal": <span>{</span>
            "AWS": "*"
        },
        "Effect": "Allow",
        "Action": "s3:GetObject",
        "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*",
        "Condition": <span>{</span>
            "StringEquals": <span>{</span>
                "aws:PrincipalOrgID": ["<code class="replaceable">o-aa111bb222</code>"]
            }
        }
    }]
}</code></pre>
     
   
    <h2 id="example-bucket-policies-IP">Managing access based on specific IP
        addresses</h2>
     
      <h3 id="example-bucket-policies-IP-1">Restrict access to specific IP
          addresses</h3>
      <p>The following example denies all users from performing any Amazon S3 operations on objects in
        the specified buckets unless the request originates from the specified range of IP
        addresses. </p>
      <p>This policy's <code class="code">Condition</code> statement identifies
            <code class="replaceable"><code class="code">192.0.2.0/24</code></code> as the range of allowed Internet
        Protocol version 4 (IPv4) IP addresses. </p>
      <p>The <code class="code">Condition</code> block uses the <code class="code">NotIpAddress</code> condition and the
          <code class="code">aws:SourceIp</code> condition key, which is an AWS wide condition key. The
          <code class="code">aws:SourceIp</code> condition key can only be used for public IP address ranges. For
        more information about these condition keys, see <a href="./amazon-s3-policy-keys.html">Amazon S3 condition key examples</a>. The <code class="code">aws:SourceIp</code> IPv4 values use
        standard CIDR notation. For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements.html#Conditions_IPAddress">IAM JSON Policy
          Elements Reference</a> in the <em>IAM User Guide</em>.
        </p>
      <div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Warning</h6></div><div class="awsdocs-note-text"><p>Before using this policy, replace the
            <code class="replaceable"><code class="code">192.0.2.0/24</code></code> IP address range in this example
          with an appropriate value for your use case. Otherwise, you will lose the ability to
          access your bucket.</p></div></div>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Id": "S3PolicyId1",
    "Statement": [
        <span>{</span>
            "Sid": "IPAllow",
            "Effect": "Deny",
            "Principal": "*",
            "Action": "s3:*",
            "Resource": [
                "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>",
                "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*"
            ],
            "Condition": <span>{</span>
                "NotIpAddress": <span>{</span>
                    "aws:SourceIp": "<code class="replaceable">192.0.2.0/24</code>"
                }
            }
        }
    ]
}</code></pre>
     
     
      <h3 id="example-bucket-policies-IP-2">Allow both IPv4 and IPv6
          addresses</h3>
      <p>When you start using IPv6 addresses, we recommend that you update all of your
        organization's policies with your IPv6 address ranges in addition to your existing IPv4
        ranges. Doing this will help ensure that the policies continue to work as you make the
        transition to IPv6.</p>
      <p>The following example bucket policy shows how to mix IPv4 and IPv6 address ranges
        to cover all of your organization's valid IP addresses. The example policy allows access to
        the example IP addresses <code class="replaceable"><code class="code">192.0.2.1</code></code> and
            <code class="replaceable"><code class="code">2001:DB8:1234:5678::1</code></code> and denies access to the
        addresses <code class="replaceable"><code class="code">203.0.113.1</code></code> and
            <code class="replaceable"><code class="code">2001:DB8:1234:5678:ABCD::1</code></code>.</p>
      <p>The <code class="code">aws:SourceIp</code> condition key can only be used for public IP address
        ranges. The IPv6 values for <code class="code">aws:SourceIp</code> must be in standard CIDR format.
        For IPv6, we support using <code class="code">::</code> to represent a range of 0s (for example,
          <code class="code">2001:DB8:1234:5678::/64</code>). For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_condition_operators.html#Conditions_IPAddress"> IP Address Condition Operators</a> in the
        <em>IAM User Guide</em>.</p>
      <div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Warning</h6></div><div class="awsdocs-note-text"><p>Replace the IP address ranges in this example with appropriate values for your use
          case before using this policy. Otherwise, you might lose the ability to access your
          bucket.</p></div></div>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Id": "PolicyId2",
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "AllowIPmix",
            "Effect": "Allow",
            "Principal": "*",
            "Action": "s3:*",
            "Resource": [
                "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>",
                "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*"
            ],
            "Condition": <span>{</span>
                "IpAddress": <span>{</span>
                    "aws:SourceIp": [
                        "<code class="replaceable">192.0.2.0/24</code>",
                        "<code class="replaceable">2001:DB8:1234:5678::/64</code>"
                    ]
                },
                "NotIpAddress": <span>{</span>
                    "aws:SourceIp": [
                        "<code class="replaceable">203.0.113.0/24</code>",
                        "<code class="replaceable">2001:DB8:1234:5678:ABCD::/80</code>"
                    ]
                }
            }
        }
    ]
}</code></pre>
     
   
    <h2 id="example-bucket-policies-HTTP-HTTPS">Managing access based on HTTP or HTTPS
        requests</h2>
     
      <h3 id="example-bucket-policies-use-case-HTTP-HTTPS-1">Restrict access to only
          HTTPS requests</h3>
      <p>If you want to prevent potential attackers from manipulating network traffic, you can
        use HTTPS (TLS) to only allow encrypted connections while restricting HTTP requests from
        accessing your bucket. To determine whether the request is HTTP or HTTPS, use the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#condition-keys-securetransport">aws:SecureTransport</a> global condition key in your S3 bucket
        policy. The <code class="code">aws:SecureTransport</code> condition key checks whether a request was sent
        by using HTTP.</p>
      <p>If a request returns <code class="code">true</code>, then the request was sent through HTTPS. If the
        request returns <code class="code">false</code>, then the request was sent through HTTP. You can then
        allow or deny access to your bucket based on the desired request scheme.</p>
      <p>In the following example, the bucket policy explicitly denies HTTP requests. </p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [<span>{</span>
        "Sid": "RestrictToTLSRequestsOnly",
        "Action": "s3:*",
        "Effect": "Deny",
        "Resource": [
            "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>",
            "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*"
        ],
        "Condition": <span>{</span>
            "Bool": <span>{</span>
                "aws:SecureTransport": "false"
            }
        },
        "Principal": "*"
    }]
}</code></pre>
     
     
      <h3 id="example-bucket-policies-HTTP-HTTPS-2">Restrict access to a specific HTTP
          referer</h3>
      <p>Suppose that you have a website with the domain name
            <code class="replaceable"><code class="code">www.example.com</code></code> or
            <code class="replaceable"><code class="code">example.com</code></code> with links to photos and videos
        stored in your bucket named <code class="code"><code class="replaceable">DOC-EXAMPLE-BUCKET</code></code>. By default, all Amazon S3 resources
        are private, so only the AWS account that created the resources can access them. </p>
      <p>To allow read access to these objects from your website, you can add a bucket policy
        that allows the <code class="code">s3:GetObject</code> permission with a condition that the
          <code class="code">GET</code> request must originate from specific webpages. The following policy
        restricts requests by using the <code class="code">StringLike</code> condition with the
          <code class="code">aws:Referer</code> condition key.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version":"2012-10-17",
  "Id":"HTTP referer policy example",
  "Statement":[
    <span>{</span>
      "Sid":"Allow only GET requests originating from www.example.com and example.com.",
      "Effect":"Allow",
      "Principal":"*",
      "Action":["s3:GetObject","s3:GetObjectVersion"],
      "Resource":"arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*",
      "Condition":<span>{</span>
        "StringLike":<span>{</span>"aws:Referer":["<code class="replaceable">http://www.example.com/*</code>","<code class="replaceable">http://example.com/*</code>"]}
      }
    }
  ]
}</code></pre>
      <p>Make sure that the browsers that you use include the HTTP <code class="code">referer</code> header in
        the request.</p>
      <div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Warning</h6></div><div class="awsdocs-note-text"><p>We recommend that you use caution when using the <code class="code">aws:Referer</code> condition
          key. It is dangerous to include a publicly known HTTP referer header value. Unauthorized
          parties can use modified or custom browsers to provide any <code class="code">aws:Referer</code> value
          that they choose. Therefore, do not use <code class="code">aws:Referer</code> to prevent unauthorized
          parties from making direct AWS requests. </p><p>The <code class="code">aws:Referer</code> condition key is offered only to allow customers to
          protect their digital content, such as content stored in Amazon S3, from being referenced on
          unauthorized third-party sites. For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#condition-keys-referer">aws:Referer</a> in the
          <em>IAM User Guide</em>.</p></div></div>
     
   
    <h2 id="example-bucket-policies-folders">Managing user access to specific
        folders</h2>
     
      <h3 id="example-bucket-policies-folders-1">Grant users access to specific folders</h3>
      <p>Suppose that you're trying to grant users access to a specific folder. If the IAM user
        and the S3 bucket belong to the same AWS account, then you can use an IAM policy to
        grant the user access to a specific bucket folder. With this approach, you don't need to
        update your bucket policy to grant access. You can add the IAM policy to an IAM role that multiple users can switch to. </p>
      <p>If the IAM identity and the S3 bucket belong to different AWS accounts, then you
        must grant cross-account access in both the IAM policy and the bucket policy. For more
        information about granting cross-account access, see <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/example-walkthroughs-managing-access-example2.html">Bucket
          owner granting cross-account bucket permissions</a>.</p>
      <p>The following example bucket policy grants
          <code class="code"><code class="replaceable">JohnDoe</code></code> full console access to only his folder
            (<code class="code">home/<code class="replaceable">JohnDoe</code>/</code>). By creating a <code class="code">home</code>
        folder and granting the appropriate permissions to your users, you can have multiple users
        share a single bucket. This policy consists of three <code class="code">Allow</code> statements:</p>
      <div class="itemizedlist">
         
         
         
      <ul class="itemizedlist"><li class="listitem">
          <p><code class="code"><code class="replaceable">AllowRootAndHomeListingOfCompanyBucket</code></code>:
            Allows the user (<code class="code"><code class="replaceable">JohnDoe</code></code>) to list objects at the
            root level of the <code class="code"><code class="replaceable">DOC-EXAMPLE-BUCKET</code></code> bucket and
            in the <code class="code">home</code> folder. This statement also allows the user to search on the
            prefix <code class="code">home/</code> by using the console.</p>
        </li><li class="listitem">
          <p><code class="code"><code class="replaceable">AllowListingOfUserFolder</code></code>: Allows the user
                (<code class="code"><code class="replaceable">JohnDoe</code></code>) to list all objects in the
                <code class="code">home/<code class="replaceable">JohnDoe</code>/</code> folder and any
            subfolders.</p>
        </li><li class="listitem">
          <p><code class="code"><code class="replaceable">AllowAllS3ActionsInUserFolder</code></code>: Allows the
            user to perform all Amazon S3 actions by granting <code class="code">Read</code>, <code class="code">Write</code>, and
              <code class="code">Delete</code> permissions. Permissions are limited to the bucket owner's home
            folder.</p>
        </li></ul></div>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "<code class="replaceable">AllowRootAndHomeListingOfCompanyBucket</code>",
            "Principal": <span>{</span>
                "AWS": [
                    "arn:aws:iam::<code class="replaceable">111122223333</code>:user/<code class="replaceable">JohnDoe</code>"
                ]
            },
            "Effect": "Allow",
            "Action": ["s3:ListBucket"],
            "Resource": ["arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>"],
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "s3:prefix": ["", "home/", "home/<code class="replaceable">JohnDoe</code>"],
                    "s3:delimiter": ["/"]
                }
            }
        },
        <span>{</span>
            "Sid": "<code class="replaceable">AllowListingOfUserFolder</code>",
            "Principal": <span>{</span>
                "AWS": [
                    "arn:aws:iam::<code class="replaceable">111122223333</code>:user/<code class="replaceable">JohnDoe</code>"
                ]
            },
            "Action": ["s3:ListBucket"],
            "Effect": "Allow",
            "Resource": ["arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>"],
            "Condition": <span>{</span>
                "StringLike": <span>{</span>
                    "s3:prefix": ["home/<code class="replaceable">JohnDoe</code>/*"]
                }
            }
        },
        <span>{</span>
            "Sid": "<code class="replaceable">AllowAllS3ActionsInUserFolder</code>",
            "Effect": "Allow",
            "Principal": <span>{</span>
                "AWS": [
                    "arn:aws:iam::<code class="replaceable">111122223333</code>:user/<code class="replaceable">JohnDoe</code>"
                ]
            },
            "Action": ["s3:*"],
            "Resource": ["arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/home/<code class="replaceable">JohnDoe</code>/*"]
        }
    ]
}</code></pre>
     
   
    <h2 id="example-bucket-policies-access-logs">Managing access for access logs</h2>
     
      <h3 id="example-bucket-policies-access-logs-1">Grant access to Application Load Balancer for enabling
          access logs</h3>
      <p>When you enable access logs for Application Load Balancer, you must specify the name of the S3 bucket where
        the load balancer will <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/enable-access-logging.html#access-log-create-bucket">store the logs</a>. The bucket must have an <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/enable-access-logging.html#attach-bucket-policy">attached policy</a> that grants Elastic Load Balancing permission to write to the bucket.</p>
      <p>In the following example, the bucket policy grants Elastic Load Balancing (ELB) permission to write the
        access logs to the bucket:</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Principal": <span>{</span>
        "AWS": "arn:aws:iam::<code class="replaceable">elb-account-id</code>:root"
      },
      "Effect": "Allow",
      "Action": "s3:PutObject",
      "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/<code class="replaceable">prefix</code>/AWSLogs/<code class="replaceable">111122223333</code>/*"
    }
  ]
}</code></pre>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Make sure to replace <code class="code"><code class="replaceable">elb-account-id</code></code> with the
          AWS account ID for Elastic Load Balancing for your AWS Region. For the list of Elastic Load Balancing Regions, see
            <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/enable-access-logs.html#attach-bucket-policy">Attach a policy to your Amazon S3 bucket</a> in the <em>Elastic Load Balancing User
            Guide</em>.</p></div></div>
      <p>If your AWS Region does not appear in the supported Elastic Load Balancing Regions list, use the
        following policy, which grants permissions to the specified log delivery service.</p>
       <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
       "Principal": <span>{</span>
         "Service": "logdelivery.elasticloadbalancing.amazonaws.com"
          },
      "Effect": "Allow",
      "Action": "s3:PutObject",
      "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/<code class="replaceable">prefix</code>/AWSLogs/<code class="replaceable">111122223333</code>/*"
    }
  ]
}</code></pre>
      <p>Then, make sure to configure your <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/enable-access-logging.html#enable-access-logs">Elastic Load Balancing access logs</a> by enabling them. You can <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/enable-access-logging.html#verify-bucket-permissions">verify your bucket permissions</a> by creating a test file.</p>
     
   
    <h2 id="example-bucket-policies-cloudfront">Managing access to an Amazon CloudFront
        OAI</h2>
     
      <h3 id="example-bucket-policies-cloudfront-1">Grant permission to an Amazon CloudFront
          OAI</h3>
      <p>The following example bucket policy grants a CloudFront origin access identity (OAI)
        permission to get (read) all objects in your S3 bucket. You can use a CloudFront OAI to allow
        users to access objects in your bucket through CloudFront but not directly through Amazon S3. For more
        information, see <a href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html">Restricting access to Amazon S3 content by using an Origin Access
          Identity</a> in the <em>Amazon CloudFront Developer Guide</em>.</p>
      <p>The following policy uses the OAI's ID as the policy's <code class="code">Principal</code>. For more
        information about using S3 bucket policies to grant access to a CloudFront OAI, see <a href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html#migrate-from-oai-to-oac">Migrating from origin access identity (OAI) to origin access control (OAC)</a> in the
          <em>Amazon CloudFront Developer Guide</em>.</p>
      <p>To use this example:</p>
      <div class="itemizedlist">
         
         
      <ul class="itemizedlist"><li class="listitem">
          <p>Replace <code class="code"><code class="replaceable">EH1HDMB1FH2TC</code></code> with the OAI's ID. To
            find the OAI's ID, see the <a href="https://console.aws.amazon.com/cloudfront/home?region=us-east-1#oai:" rel="noopener noreferrer" target="_blank"><span>Origin Access Identity page</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> on the
            CloudFront console, or use <a href="https://docs.aws.amazon.com/cloudfront/latest/APIReference/API_ListCloudFrontOriginAccessIdentities.html">ListCloudFrontOriginAccessIdentities</a> in the CloudFront API.</p>
        </li><li class="listitem">
          <p>Replace <code class="code"><code class="replaceable">DOC-EXAMPLE-BUCKET</code></code> with the name of your bucket.</p>
        </li></ul></div>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Id": "PolicyForCloudFrontPrivateContent",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Principal": <span>{</span>
                "AWS": "arn:aws:iam::cloudfront:user/CloudFront Origin Access Identity <code class="replaceable">EH1HDMB1FH2TC</code>"
            },
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*"
        }
    ]
}</code></pre>
     
   
    <h2 id="example-bucket-policies-lens">Managing access for Amazon S3 Storage Lens</h2>
     
      <h3 id="example-bucket-policies-lens-1">Grant permissions for Amazon S3 Storage Lens</h3>
      <p>S3 Storage Lens aggregates your metrics and displays the information in
      the <b>Account snapshot</b> section on the Amazon S3 console <b>Buckets</b> page. S3 Storage Lens also provides an interactive dashboard 
      that you can use to visualize insights and trends, flag outliers, and receive recommendations for optimizing storage costs and 
      applying data-protection best practices. Your dashboard has drill-down options to generate insights at the organization, account, 
      bucket, object, or prefix level. You can also send a once-daily metrics export in CSV or Parquet format to an S3 bucket.</p>
      <p>S3 Storage Lens can export your aggregated storage usage metrics to an Amazon S3 bucket for further
        analysis. The bucket where S3 Storage Lens places its metrics exports is known as the
          <em>destination bucket</em>. When setting up your S3 Storage Lens metrics export, you
        must have a bucket policy for the destination bucket. For more information, see <a href="./storage_lens.html">Assessing your storage activity and usage with
      Amazon S3 Storage Lens</a>.</p>
      <p>The following example bucket policy grants Amazon S3 permission to write objects
          (<code class="code">PUT</code> requests) to a destination bucket. You use a bucket policy like this on
        the destination bucket when setting up an S3 Storage Lens metrics export.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "S3StorageLensExamplePolicy",
            "Effect": "Allow",
            "Principal": <span>{</span>
                "Service": "storage-lens.s3.amazonaws.com"
            },
            "Action": "s3:PutObject",
            "Resource": [
                "arn:aws:s3:::<code class="replaceable">destination-bucket</code>/<code class="replaceable">destination-prefix</code>/StorageLens/<code class="replaceable">111122223333</code>/*"
            ],
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "s3:x-amz-acl": "bucket-owner-full-control",
                    "aws:SourceAccount": "<code class="replaceable">111122223333</code>",
                    "aws:SourceArn": "arn:aws:s3:<code class="replaceable">region-code</code>:<code class="replaceable">111122223333</code>:storage-lens/<code class="replaceable">storage-lens-dashboard-configuration-id</code>"
                }
            }
        }
    ]
}</code></pre>
      <p>When you're setting up an S3 Storage Lens organization-level metrics export, use the following
        modification to the previous bucket policy's <code class="code">Resource</code> statement.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">
"Resource": "arn:aws:s3:::<code class="replaceable">destination-bucket</code>/<code class="replaceable">destination-prefix</code>/StorageLens/<code class="replaceable">your-organization-id</code>/*",
    </code></pre>
     
   
    <h2 id="example-bucket-policies-s3-inventory">Managing permissions for S3 Inventory,
        S3 analytics, and S3 Inventory reports</h2>
     
      <h3 id="example-bucket-policies-s3-inventory-1">Grant permissions for S3 Inventory
          and S3 analytics</h3>
      <p>S3 Inventory creates lists of the objects in a bucket, and S3 analytics Storage Class
        Analysis export creates output files of the data used in the analysis. The bucket that the
        inventory lists the objects for is called the <em>source bucket</em>. The bucket
        where the inventory file or the analytics export file is written to is called a
          <em>destination bucket</em>. When setting up an inventory or an analytics
        export, you must create a bucket policy for the destination bucket. For more information,
        see <a href="./storage-inventory.html">Amazon S3 Inventory</a> and <a href="./analytics-storage-class.html">Amazon S3 analytics – Storage Class Analysis</a>.</p>
      <p>The following example bucket policy grants Amazon S3 permission to write objects
          (<code class="code">PUT</code> requests) from the account for the source bucket to the destination
        bucket. You use a bucket policy like this on the destination bucket when setting up S3
        Inventory and S3 analytics export.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>  
      "Version": "2012-10-17",
      "Statement": [
        <span>{</span>
            "Sid": "InventoryAndAnalyticsExamplePolicy",
            "Effect": "Allow",
            "Principal": <span>{</span>
                "Service": "s3.amazonaws.com"
            },
            "Action": "s3:PutObject",
            "Resource": [
                "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-DESTINATION-BUCKET</code>/*"
            ],
            "Condition": <span>{</span>
                "ArnLike": <span>{</span>
                    "aws:SourceArn": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-SOURCE-BUCKET</code>"
                },
                "StringEquals": <span>{</span>
                    "aws:SourceAccount": "<code class="replaceable">111122223333</code>",
                    "s3:x-amz-acl": "bucket-owner-full-control"
                }
            }
        }
    ]
}</code></pre>
     
     
      <h3 id="example-bucket-policies-s3-inventory-2">Restrict access to an S3 Inventory
          report</h3>
      <p><a href="./storage-inventory.html">Amazon S3 Inventory</a> creates lists of
        the objects in an S3 bucket and the metadata for each object. The
          <code class="code">s3:PutInventoryConfiguration</code> permission allows a user to create an inventory
        report that includes all object metadata fields that are available and to specify the
        destination bucket to store the inventory. A user with read access to objects in the
        destination bucket can access all object metadata fields that are available in the inventory
        report. For more information about the metadata fields that are available in S3 Inventory,
        see <a href="./storage-inventory.html#storage-inventory-contents">Amazon S3 Inventory list</a>.</p>
      <p>To restrict a user from configuring an S3 Inventory report of all object metadata
        available, remove the <code class="code">s3:PutInventoryConfiguration</code> permission from the
        user.</p>
      <p>To restrict a user from accessing your S3 Inventory report in a destination bucket, add
        a bucket policy like the following example to the destination bucket. This example bucket
        policy denies all the principals except the user <code class="code"><code class="replaceable">Ana</code></code>
        from accessing the inventory report
            <code class="code"><code class="replaceable">DOC-EXAMPLE-DESTINATION-BUCKET-INVENTORY</code></code> in the
        destination bucket
        <code class="code"><code class="replaceable">DOC-EXAMPLE-DESTINATION-BUCKET</code></code>.</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
	"Id": "GetObjectPolicy",
	"Version": "2012-10-17",
	"Statement": [<span>{</span>
			"Sid": "AllowListBucket",
			"Action": [
				"s3:ListBucket"
			],
			"Effect": "Allow",
			"Resource": [
				"arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-DESTINATION-BUCKET</code>",
				"arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-DESTINATION-BUCKET</code>/*"
			],
			"Principal": <span>{</span>
				"AWS": [
					"arn:aws:iam::<code class="replaceable">111122223333</code>:user/<code class="replaceable">Ana</code>"
				]
			}
		},
		<span>{</span>
			"Sid": "AllowACertainUserToReadObject",
			"Action": [
				"s3:GetObject"
			],
			"Effect": "Allow",
			"Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-DESTINATION-BUCKET/DOC-EXAMPLE-DESTINATION-BUCKET-INVENTORY</code>/*",
			"Principal": <span>{</span>
				"AWS": [
					"arn:aws:iam::<code class="replaceable">111122223333</code>:user/<code class="replaceable">Ana</code>"
				]
			}
		},
		<span>{</span>
			"Sid": "DenyAllTheOtherUsersToReadObject",
			"Action": [
				"s3:GetObject"
			],
			"Effect": "Deny",
			"Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-DESTINATION-BUCKET/DOC-EXAMPLE-DESTINATION-BUCKET-INVENTORY</code>/*",
			"Principal": <span>{</span>
				"AWS": "*"
			},
			"Condition": <span>{</span>
				"ArnNotEquals": <span>{</span>
					"aws:PrincipalArn": "arn:aws:iam::<code class="replaceable">111122223333</code>:user/<code class="replaceable">Ana</code>"
				}
			}
		}
	]
}</code></pre>
     
   
    <h2 id="example-bucket-policies-MFA">Requiring MFA</h2>
    <p>Amazon S3 supports MFA-protected API access, a feature that can enforce multi-factor
      authentication (MFA) for access to your Amazon S3 resources. Multi-factor authentication provides
      an extra level of security that you can apply to your AWS environment. MFA is a security
      feature that requires users to prove physical possession of an MFA device by providing a valid
      MFA code. For more information, see <a href="https://aws.amazon.com/mfa/" rel="noopener noreferrer" target="_blank"><span>AWS Multi-Factor
        Authentication</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. You can require MFA for any requests to access your Amazon S3 resources. </p>
    <p>To enforce the MFA requirement, use the <code class="code">aws:MultiFactorAuthAge</code> condition key
      in a bucket policy. IAM users can access Amazon S3 resources by using temporary credentials
      issued by the AWS Security Token Service (AWS STS). You provide the MFA code at the time of the AWS STS
      request. </p>
    <p>When Amazon S3 receives a request with multi-factor authentication, the
        <code class="code">aws:MultiFactorAuthAge</code> condition key provides a numeric value that indicates
      how long ago (in seconds) the temporary credential was created. If the temporary credential
      provided in the request was not created by using an MFA device, this key value is null
      (absent). In a bucket policy, you can add a condition to check this value, as shown in the
      following example. </p>
    <p>This example policy denies any Amazon S3 operation on the
          <code class="replaceable"><code class="code">/taxdocuments</code></code> folder in the
        <code class="code"><code class="replaceable">DOC-EXAMPLE-BUCKET</code></code> bucket if the request is not authenticated by using MFA. To
      learn more about MFA, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa.html">Using
        Multi-Factor Authentication (MFA) in AWS</a> in the
        <em>IAM User Guide</em>.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Id": "123",
    "Statement": [
      <span>{</span>
        "Sid": "",
        "Effect": "Deny",
        "Principal": "*",
        "Action": "s3:*",
        "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code><code class="replaceable">/taxdocuments</code>/*",
        "Condition": <span>{</span> "Null": <span>{</span> "aws:MultiFactorAuthAge": true }}
      }
    ]
 }</code></pre>
    <p>The <code class="code">Null</code> condition in the <code class="code">Condition</code> block evaluates to
        <code class="code">true</code> if the <code class="code">aws:MultiFactorAuthAge</code> condition key value is null,
      indicating that the temporary security credentials in the request were created without an MFA
      device. </p>
    <p>The following bucket policy is an extension of the preceding bucket policy. It includes
      two policy statements. One statement allows the <code class="code">s3:GetObject</code> permission on a
      bucket (<code class="code"><code class="replaceable">DOC-EXAMPLE-BUCKET</code></code>) to everyone. Another statement further restricts
      access to the <code class="code"><code class="replaceable"><code class="replaceable">DOC-EXAMPLE-BUCKET</code>/taxdocuments</code></code> folder
      in the bucket by requiring MFA. </p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Id": "123",
    "Statement": [
      <span>{</span>
        "Sid": "",
        "Effect": "Deny",
        "Principal": "*",
        "Action": "s3:*",
        "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code><code class="replaceable">/taxdocuments</code>/*",
        "Condition": <span>{</span> "Null": <span>{</span> "aws:MultiFactorAuthAge": true } }
      },
      <span>{</span>
        "Sid": "",
        "Effect": "Allow",
        "Principal": "*",
        "Action": ["s3:GetObject"],
        "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*"
      }
    ]
 }</code></pre>
    <p>You can optionally use a numeric condition to limit the duration for which the
        <code class="code">aws:MultiFactorAuthAge</code> key is valid. The duration that you specify with the
        <code class="code">aws:MultiFactorAuthAge</code> key is independent of the lifetime of the temporary
      security credential that's used in authenticating the request. </p>
    <p>For example, the following bucket policy, in addition to requiring MFA authentication,
      also checks how long ago the temporary session was created. The policy denies any operation if
      the <code class="code">aws:MultiFactorAuthAge</code> key value indicates that the temporary session was
      created more than an hour ago (3,600 seconds). </p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Id": "123",
    "Statement": [
      <span>{</span>
        "Sid": "",
        "Effect": "Deny",
        "Principal": "*",
        "Action": "s3:*",
        "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code><code class="replaceable">/taxdocuments</code>/*",
        "Condition": <span>{</span>"Null": <span>{</span>"aws:MultiFactorAuthAge": true }}
      },
      <span>{</span>
        "Sid": "",
        "Effect": "Deny",
        "Principal": "*",
        "Action": "s3:*",
        "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code><code class="replaceable">/taxdocuments</code>/*",
        "Condition": <span>{</span>"NumericGreaterThan": <span>{</span>"aws:MultiFactorAuthAge": 3600 }}
       },
       <span>{</span>
         "Sid": "",
         "Effect": "Allow",
         "Principal": "*",
         "Action": ["s3:GetObject"],
         "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*"
       }
    ]
 }</code></pre>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./example-bucket-policies-vpc-endpoint.html">Controlling VPC access</div><div id="next" class="next-link" accesskey="n" href="./user-policies.html">IAM user and role policies</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=S3&amp;topic_url=https://docs.aws.amazon.com/en_us/AmazonS3/latest/userguide/example-bucket-policies.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=S3&amp;topic_url=https://docs.aws.amazon.com/en_us/AmazonS3/latest/userguide/example-bucket-policies.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>