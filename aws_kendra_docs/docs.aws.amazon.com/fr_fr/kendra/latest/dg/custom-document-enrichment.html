<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Enrichir vos documents lors de l'ingestion - Amazon Kendra</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="custom-document-enrichment" /><meta name="default_state" content="custom-document-enrichment" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/custom-document-enrichment.html" /><meta name="description" content="Comment créer, modifier ou supprimer les attributs et le contenu des documents pendant le processus d'intégration de documents dansAmazon Kendra." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Kendra" /><meta name="guide" content="Guide du développeur" /><meta name="abstract" content="Propose une présentation conceptuelle de Amazon Kendra. Découvrez lesAmazon Kendra fonctionnalités et commencez à indexer vos documents à l'aide de la console, de l'interface de ligne de commande et de l'API." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/custom-document-enrichment.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/custom-document-enrichment.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/custom-document-enrichment.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kendra/latest/dg/custom-document-enrichment.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kendra/latest/dg/custom-document-enrichment.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/custom-document-enrichment.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/custom-document-enrichment.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kendra/latest/dg/custom-document-enrichment.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kendra/latest/dg/custom-document-enrichment.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/custom-document-enrichment.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/custom-document-enrichment.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kendra/latest/dg/custom-document-enrichment.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kendra/latest/dg/custom-document-enrichment.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/custom-document-enrichment.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/custom-document-enrichment.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kendra/latest/dg/custom-document-enrichment.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kendra/latest/dg/custom-document-enrichment.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kendra/latest/dg/custom-document-enrichment.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kendra/latest/dg/custom-document-enrichment.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/kendra/latest/dg/custom-document-enrichment.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/kendra/latest/dg/custom-document-enrichment.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/custom-document-enrichment.html" hreflang="x-default" /><meta name="feedback-item" content="Kendra" /><meta name="this_doc_product" content="Amazon Kendra" /><meta name="this_doc_guide" content="Guide du développeur" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'kendra'}"></script><meta id="panorama-serviceSubSection" value="Guide du développeur" /><meta id="panorama-serviceConsolePage" value="Enrichir vos documents lors de l'ingestion" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Enrichir vos documents lors de l'ingestion - Amazon Kendra</title><meta name="pdf" content="kendra-dg.pdf#custom-document-enrichment" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=http://docs.aws.amazon.com/fr_fr/kendra/latest/dg/custom-document-enrichment.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/fr_fr/kendra/latest/dg/custom-document-enrichment.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/fr_fr/kendra/latest/dg/custom-document-enrichment.html" /><meta name="keywords" content="Kendra,Amazon Kendra,search,recherche intelligente,langage naturel,index,question,mot-clé,source de données,connector,FAQ,question fréquemment posée" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Kendra",
        "item" : "https://docs.aws.amazon.com/kendra/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide du développeur",
        "item" : "https://docs.aws.amazon.com/fr_fr/kendra/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Enrichir vos documents lors de l'ingestion",
        "item" : "https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/custom-document-enrichment.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="kendra-dg.pdf#custom-document-enrichment" target="_blank" rel="noopener noreferrer" title="Ouvrir le PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/kendra/index.html">Amazon Kendra</a><a href="what-is-kendra.html">Guide du développeur</a></div><div id="page-toc-src"><a href="#how-custom-document-enrichment-works">Comment fonctionne l'enrichissement personnalisé des documents</a><a href="#basic-data-maniplation">Opérations de base pour modifier les métadonnées</a><a href="#advanced-data-manipulation">Fonctions Lambda : extraction et modification de métadonnées ou de contenu</a><a href="#cde-data-contracts-lambda">Contrats de données pour les fonctions Lambda</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="custom-document-enrichment">Enrichir vos documents lors de l'ingestion</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Vous pouvez modifier les champs ou attributs des métadonnées de contenu et de document pendant le processus d'intégration de documents. Grâce àAmazon Kendra la fonction <em>d'enrichissement personnalisé des documents</em>, vous pouvez créer, modifier ou supprimer des attributs et du contenu de documents lorsque vous y intégrez vos documentsAmazon Kendra. Cela signifie que vous pouvez manipuler et ingérer vos données selon vos besoins.</p><p>Cette fonctionnalité vous permet de contrôler la façon dont vos documents sont traités et intégrésAmazon Kendra. Par exemple, vous pouvez effacer les informations personnelles identifiables contenues dans les métadonnées du document lors de l'importation de vos documentsAmazon Kendra.</p><p>Vous pouvez également utiliser cette fonctionnalité en invoquant une fonction LambdaAWS Lambda pour exécuter la reconnaissance optique de caractères (OCR) sur des images, la traduction du texte et d'autres tâches de préparation des données à des fins de recherche ou d'analyse. Par exemple, vous pouvez appeler une fonction pour exécuter l'OCR sur des images. La fonction peut interpréter le texte à partir d'images et traiter chaque image comme un document textuel. Une entreprise qui reçoit des enquêtes clients envoyées par la poste et qui stocke ces enquêtes sous forme d'images pourrait intégrer ces images sous forme de documents textuelsAmazon Kendra. L'entreprise peut ensuite rechercher des informations précieuses sur les enquêtes auprès des clients dansAmazon Kendra.</p><p>Vous pouvez utiliser des opérations de base pour effectuer une première analyse de vos données, puis utiliser une fonction Lambda pour appliquer des opérations plus complexes à vos données. Par exemple, vous pouvez utiliser une opération de base pour simplement supprimer toutes les valeurs du champ de métadonnées du document « Customer_ID », puis appliquer une fonction Lambda pour extraire du texte à partir d'images du texte contenu dans les documents.</p>
        <h2 id="how-custom-document-enrichment-works">Comment fonctionne l'enrichissement personnalisé des documents</h2>
        <p>Le processus global d'enrichissement personnalisé des documents est le suivant :</p>
        <div class="orderedlist">
             
             
             
             
        <ol><li>
                <p>Vous configurez l'enrichissement personnalisé des documents lorsque vous créez ou mettez à jour votre source de données, ou lorsque vous y indexez vos documents directementAmazon Kendra.</p>
            </li><li>
                <p>Amazon Kendraapplique des configurations en ligne ou une logique de base pour modifier vos données. Pour plus d'informations, veuillez consulter <a href="#basic-data-maniplation">Opérations de base pour modifier les métadonnées</a>.</p>
            </li><li>
                <p>Si vous choisissez de configurer la manipulation avancée des données, vousAmazon Kendra pouvez l'appliquer à vos documents bruts d'origine ou aux documents structurés et analysés. Pour plus d'informations, veuillez consulter <a href="#advanced-data-manipulation">Fonctions Lambda : extraction et modification de métadonnées ou de contenu</a>.</p>
            </li><li>
                <p>Vos documents modifiés sont ingérésAmazon Kendra.</p>
            </li></ol></div>
        <p>À tout moment de ce processus, si votre configuration n'est pas valide, uneAmazon Kendra erreur est générée.</p>
        <p>Lorsque vous appelez des <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_BatchPutDocument.html">BatchPutDocument</a>API <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_CreateDataSource.html">CreateDataSource<a href="https://docs.aws.amazon.com/kendra/latest/dg/API_UpdateDataSource.html">UpdateDataSource</a></a>, vous fournissez votre configuration personnalisée d'enrichissement de documents. Si vous appelez<code class="code">BatchPutDocument</code>, vous devez configurer l'enrichissement personnalisé des documents à chaque demande. Si vous utilisez la console, vous sélectionnez votre index, puis vous sélectionnez <b>Enrichissements de documents pour configurer l'enrichissement personnalisé des</b> documents.</p>
        <p>Si vous utilisez <b>les enrichissements de documents</b> dans la console, vous pouvez choisir de configurer uniquement les opérations de base ou uniquement les fonctions Lambda, ou les deux, comme vous pouvez le faire avec l'API. Vous pouvez sélectionner <b>Suivant</b> dans les étapes de la console pour choisir de ne pas configurer les opérations de base et uniquement les fonctions Lambda, notamment si vous souhaitez les appliquer aux données d'origine (pré-extraction) ou structurées (post-extraction). Vous ne pouvez enregistrer vos configurations qu'en suivant toutes les étapes de la console. Les configurations de vos documents ne sont pas enregistrées si vous n'effectuez pas toutes les étapes.</p>
     
        <h2 id="basic-data-maniplation">Opérations de base pour modifier les métadonnées</h2>
        <p>Vous pouvez manipuler les champs et le contenu de votre document à l'aide d'une logique de base. Cela inclut la suppression de valeurs dans un champ, la modification des valeurs d'un champ à l'aide d'une condition ou la création d'un champ. Pour des manipulations avancées qui vont au-delà de ce que vous pouvez manipuler à l'aide de la logique de base, appelez une fonction Lambda. Pour plus d'informations, veuillez consulter <a href="#advanced-data-manipulation">Fonctions Lambda : extraction et modification de métadonnées ou de contenu</a>.</p>
        <p>Pour appliquer la logique de base, vous devez spécifier le champ cible que vous souhaitez manipuler à l'aide de l'<a href="https://docs.aws.amazon.com/kendra/latest/dg/API_DocumentAttributeTarget.html">DocumentAttributeTarget</a>objet. Vous fournissez la clé d'attribut. Par exemple, la clé « Department » est un champ ou un attribut qui contient tous les noms des départements associés aux documents. Vous pouvez également spécifier une valeur à utiliser dans le champ cible si une certaine condition est remplie. Vous définissez la condition à l'aide de l'<a href="https://docs.aws.amazon.com/kendra/latest/dg/API_DocumentAttributeCondition.html">DocumentAttributeCondition</a>objet. Par exemple, si le champ « Source_URI » contient « financier » dans sa valeur URI, le champ cible « Department » doit être prérempli avec la valeur cible « Finance » pour le document. Vous pouvez également supprimer les valeurs de l'attribut du document cible.</p>
        <p>Pour appliquer la logique de base à l'aide de la console, sélectionnez votre index, puis sélectionnez <b>Enrichissements de documents</b> dans le menu de navigation. Accédez à <b>Configurer les opérations de base</b> pour appliquer des manipulations de base aux champs et au contenu de votre document.</p>
        <p>Voici un exemple d'utilisation de la logique de base pour supprimer tous les numéros d'identification des clients dans le champ du document appelé « Customer_ID ».</p>
        <p><b>Exemple 1 : Supprimer les numéros d'identification client associés aux documents</b></p>
        <p>Données avant l'application de la manipulation de base.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c13c15"><thead>
                    <tr>
                        <th><b>ID du document</b></th>
                        <th><b>Body_Text</b></th>
                        <th><b>ID du client</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>Lorem Ipsum.</td>
                        <td>CID1234</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Lorem Ipsum.</td>
                        <td>CID1235</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Lorem Ipsum.</td>
                        <td>CID1236</td>
                    </tr>
                </table></div></div>
        <p>Données après application d'une manipulation de base.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c13c19"><thead>
                    <tr>
                        <th><b>ID du document</b></th>
                        <th><b>Body_Text</b></th>
                        <th><b>ID du client</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>Lorem Ipsum.</td>
                        <td> </td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Lorem Ipsum.</td>
                        <td> </td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Lorem Ipsum.</td>
                        <td> </td>
                    </tr>
                </table></div></div>
        <p>Voici un exemple d'utilisation de la logique de base pour créer un champ appelé « Département » et pré-remplir ce champ avec les noms des départements en fonction des informations du champ « Source_URI ». Cela utilise la condition suivante : si le champ « Source_URI » contient « financier » dans sa valeur URI, le champ cible « Department » doit être prérempli avec la valeur cible « Finance » pour le document.</p>
        <p><b>Exemple 2 : Création du champ « Département » et préremplissage du champ avec les noms des départements associés aux documents à l'aide d'une condition.</b></p>
        <p>Données avant l'application de la manipulation de base.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c13c27"><thead>
                    <tr>
                        <th><b>ID du document</b></th>
                        <th><b>Body_Text</b></th>
                        <th><b>URI source</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>Lorem Ipsum.</td>
                        <td>financier 1</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Lorem Ipsum.</td>
                        <td>financier ou 2</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Lorem Ipsum.</td>
                        <td>financier ou 3</td>
                    </tr>
                </table></div></div>
        <p>Données après application d'une manipulation de base.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c13c31"><thead>
                    <tr>
                        <th><b>ID du document</b></th>
                        <th><b>Body_Text</b></th>
                        <th><b>URI source</b></th>
                        <th><b>Département</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>Lorem Ipsum.</td>
                        <td>financier 1</td>
                        <td>Finance</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Lorem Ipsum.</td>
                        <td>financier ou 2</td>
                        <td>Finance</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Lorem Ipsum.</td>
                        <td>financier ou 3</td>
                        <td>Finance</td>
                    </tr>
                </table></div></div>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Amazon Kendrane peut pas créer de champ de document cible s'il n'est pas déjà créé en tant que champ d'index. Après avoir créé votre champ d'index, vous pouvez créer un champ de document à l'aide de<code class="code">DocumentAttributeTarget</code>. Amazon Kendrapuis mappe le champ de métadonnées du document que vous venez de créer avec votre champ d'index.</p></div></div>
        <p>Le code suivant est un exemple de configuration de la manipulation de données de base pour supprimer les numéros d'identification client associés aux documents.</p>
        <awsdocs-tabs><dl style="display: none">
            <dt>Console</dt><dd tab-id="console">
                    
                    <div class="procedure"><h6>Pour configurer la manipulation de base des données afin de supprimer les numéros d'identification des clients</h6><ol><li>
                            <p>Dans le volet de navigation de gauche, sous <b>Index</b>, sélectionnez <b>Enrichissements de documents</b>, puis sélectionnez <b>Ajouter un enrichissement de documents</b>.</p>
                        </li><li>
                            <p>Sur la page <b>Configurer les opérations de base</b>, choisissez dans la liste déroulante la source de données dont vous souhaitez modifier les champs et le contenu du document. Choisissez ensuite dans la liste déroulante le nom du champ du document « Customer_ID », sélectionnez dans la liste déroulante le nom du champ d'index « Customer_ID » et sélectionnez dans la liste déroulante l'action cible <b>Supprimer</b>. Sélectionnez ensuite <b>Ajouter une opération de base</b>.</p>
                        </li></ol></div>
                </dd>
            <dt>CLI</dt><dd tab-id="cli">
                    <p><b>Pour configurer la manipulation de base des données afin de supprimer les numéros d'identification des clients</b></p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws kendra create-data-source \
 --name <code class="replaceable">data-source-name</code> \
 --index-id <code class="replaceable">index-id</code> \
 --role-arn <code class="replaceable">arn:aws:iam::account-id:role/role-name</code> \
 --type S3 \
 --configuration '<span>{</span>"S3Configuration":<span>{</span>"BucketName":"<code class="replaceable">S3-bucket-name</code>"}}' \
 --custom-document-enrichment-configuration '<span>{</span>"InlineConfigurations":[<span>{</span>"Target":<span>{</span>"TargetDocumentAttributeKey":"Customer_ID", "TargetDocumentAttributeValueDeletion": true}}]}' 
</code></pre>
                </dd>
            <dt>Python</dt><dd tab-id="python">
                    <p><b>Pour configurer la manipulation de base des données afin de supprimer les numéros d'identification des clients</b></p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import boto3&#xD;
from botocore.exceptions import ClientError&#xD;
import pprint&#xD;
import time&#xD;
&#xD;
kendra = boto3.client("kendra")&#xD;
&#xD;
print("Create a data source with customizations")&#xD;
&#xD;
# Provide the name of the data source&#xD;
name = "data-source-name"&#xD;
# Provide the index ID for the data source&#xD;
index_id = "index-id"&#xD;
# Provide the IAM role ARN required for data sources&#xD;
role_arn = "arn:aws:iam::$<span>{</span>account-id}:role/$<span>{</span>role-name}"&#xD;
# Provide the data source connection information&#xD;
data_source_type = "S3"&#xD;
S3_bucket_name = "S3-bucket-name"&#xD;
# Configure the data source with Custom Document Enrichment&#xD;
configuration = <span>{</span>"S3Configuration":&#xD;
        <span>{</span>&#xD;
            "BucketName": S3_bucket_name&#xD;
        }&#xD;
    }&#xD;
custom_document_enrichment_configuration = <span>{</span>"InlineConfigurations":[&#xD;
        <span>{</span>&#xD;
            "Target":<span>{</span>"TargetDocumentAttributeKey":"Customer_ID",&#xD;
                       "TargetDocumentAttributeValueDeletion": True}&#xD;
        }]&#xD;
    }&#xD;
&#xD;
try:&#xD;
    data_source_response = kendra.create_data_source(&#xD;
        Name = name,&#xD;
        IndexId = index_id,&#xD;
        RoleArn = role_arn,&#xD;
        Type = data_source_type&#xD;
        Configuration = configuration&#xD;
        CustomDocumentEnrichmentConfiguration = custom_document_enrichment_configuration&#xD;
    )&#xD;
&#xD;
    pprint.pprint(data_source_response)&#xD;
&#xD;
    data_source_id = data_source_response["Id"]&#xD;
&#xD;
    print("Wait for Amazon Kendra to create the data source with your customizations.")&#xD;
&#xD;
    while True:&#xD;
        # Get the details of the data source, such as the status&#xD;
        data_source_description = kendra.describe_data_source(&#xD;
            Id = data_source_id,&#xD;
            IndexId = index_id&#xD;
        )&#xD;
        status = data_source_description["Status"]&#xD;
        print(" Creating data source. Status: "+status)&#xD;
        time.sleep(60)&#xD;
        if status != "CREATING":&#xD;
            break&#xD;
&#xD;
    print("Synchronize the data source.")&#xD;
&#xD;
    sync_response = kendra.start_data_source_sync_job(&#xD;
        Id = data_source_id,&#xD;
        IndexId = index_id&#xD;
    )&#xD;
&#xD;
    pprint.pprint(sync_response)&#xD;
&#xD;
    print("Wait for the data source to sync with the index.")&#xD;
&#xD;
    while True:&#xD;
&#xD;
        jobs = kendra.list_data_source_sync_jobs(&#xD;
            Id= data_source_id,&#xD;
            IndexId= index_id&#xD;
        )&#xD;
&#xD;
        # For this example, there should be one job&#xD;
        status = jobs["History"][0]["Status"]&#xD;
&#xD;
        print(" Syncing data source. Status: "+status)&#xD;
        time.sleep(60)&#xD;
        if status != "SYNCING":&#xD;
            break&#xD;
&#xD;
except  ClientError as e:&#xD;
        print("%s" % e)&#xD;
&#xD;
print("Program ends.")</code></pre>
                </dd>
            <dt>Java</dt><dd tab-id="java">
                    <p><b>Pour configurer la manipulation de base des données afin de supprimer les numéros d'identification des clients</b></p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="java ">package com.amazonaws.kendra;

import java.util.concurrent.TimeUnit;
import software.amazon.awssdk.services.kendra.KendraClient;
import software.amazon.awssdk.services.kendra.model.CreateDataSourceRequest;
import software.amazon.awssdk.services.kendra.model.CreateDataSourceResponse;
import software.amazon.awssdk.services.kendra.model.CreateIndexRequest;
import software.amazon.awssdk.services.kendra.model.CreateIndexResponse;
import software.amazon.awssdk.services.kendra.model.DataSourceConfiguration;
import software.amazon.awssdk.services.kendra.model.DataSourceStatus;
import software.amazon.awssdk.services.kendra.model.DataSourceSyncJob;
import software.amazon.awssdk.services.kendra.model.DataSourceSyncJobStatus;
import software.amazon.awssdk.services.kendra.model.DataSourceType;
import software.amazon.awssdk.services.kendra.model.DescribeDataSourceRequest;
import software.amazon.awssdk.services.kendra.model.DescribeDataSourceResponse;
import software.amazon.awssdk.services.kendra.model.DescribeIndexRequest;
import software.amazon.awssdk.services.kendra.model.DescribeIndexResponse;
import software.amazon.awssdk.services.kendra.model.IndexStatus;
import software.amazon.awssdk.services.kendra.model.ListDataSourceSyncJobsRequest;
import software.amazon.awssdk.services.kendra.model.ListDataSourceSyncJobsResponse;
import software.amazon.awssdk.services.kendra.model.S3DataSourceConfiguration;
import software.amazon.awssdk.services.kendra.model.StartDataSourceSyncJobRequest;
import software.amazon.awssdk.services.kendra.model.StartDataSourceSyncJobResponse;

public class CreateDataSourceWithCustomizationsExample <span>{</span>

    public static void main(String[] args) throws InterruptedException <span>{</span>
        System.out.println("Create a data source with customizations");
        
        String dataSourceName = "data-source-name";
        String indexId = "index-id";
        String dataSourceRoleArn = "arn:aws:iam::account-id:role/role-name";
        String s3BucketName = "S3-bucket-name"

        KendraClient kendra = KendraClient.builder().build();
        
        CreateDataSourceRequest createDataSourceRequest = CreateDataSourceRequest
            .builder()
            .name(dataSourceName)
            .description(experienceDescription)
            .roleArn(experienceRoleArn)
            .type(DataSourceType.S3)
            .configuration(
                DataSourceConfiguration
                    .builder()
                    .s3Configuration(
                        S3DataSourceConfiguration
                            .builder()
                            .bucketName(s3BucketName)
                            .build()
                    ).build()
            )
            .customDocumentEnrichmentConfiguration(
                CustomDocumentEnrichmentConfiguration
                    .builder()
                    .inlineConfigurations(Arrays.asList(
                        InlineCustomDocumentEnrichmentConfiguration
                            .builder()
                            .target(
                                DocumentAttributeTarget
                                    .builder()
                                    .targetDocumentAttributeKey("Customer_ID")
                                    .targetDocumentAttributeValueDeletion(true)
                                    .build())
                            .build()
                    )).build();
        
        CreateDataSourceResponse createDataSourceResponse = kendra.createDataSource(createDataSourceRequest);
        System.out.println(String.format("Response of creating data source: %s", createDataSourceResponse));

        String dataSourceId = createDataSourceResponse.id();
        System.out.println(String.format("Waiting for Kendra to create the data source %s", dataSourceId));
        DescribeDataSourceRequest describeDataSourceRequest = DescribeDataSourceRequest
            .builder()
            .indexId(indexId)
            .id(dataSourceId)
            .build();

        while (true) <span>{</span>
            DescribeDataSourceResponse describeDataSourceResponse = kendra.describeDataSource(describeDataSourceRequest);

            DataSourceStatus status = describeDataSourceResponse.status();
            System.out.println(String.format("Creating data source. Status: %s", status));
            TimeUnit.SECONDS.sleep(60);
            if (status != DataSourceStatus.CREATING) <span>{</span>
                break;
            }
        }

        System.out.println(String.format("Synchronize the data source %s", dataSourceId));
        StartDataSourceSyncJobRequest startDataSourceSyncJobRequest = StartDataSourceSyncJobRequest
            .builder()
            .indexId(indexId)
            .id(dataSourceId)
            .build();
        StartDataSourceSyncJobResponse startDataSourceSyncJobResponse = kendra.startDataSourceSyncJob(startDataSourceSyncJobRequest);
        System.out.println(String.format("Waiting for the data source to sync with the index %s for execution ID %s", indexId, startDataSourceSyncJobResponse.executionId()));

        // For this example, there should be one job
        ListDataSourceSyncJobsRequest listDataSourceSyncJobsRequest = ListDataSourceSyncJobsRequest
            .builder()
            .indexId(indexId)
            .id(dataSourceId)
            .build();

        while (true) <span>{</span>
            ListDataSourceSyncJobsResponse listDataSourceSyncJobsResponse = kendra.listDataSourceSyncJobs(listDataSourceSyncJobsRequest);
            DataSourceSyncJob job = listDataSourceSyncJobsResponse.history().get(0);
            System.out.println(String.format("Syncing data source. Status: %s", job.status()));

            TimeUnit.SECONDS.sleep(60);
            if (job.status() != DataSourceSyncJobStatus.SYNCING) <span>{</span>
                break;
            }

        }

        System.out.println("Data source creation with customizations is complete");
    }
}</code></pre>
                </dd>
        </dl></awsdocs-tabs>
     
        <h2 id="advanced-data-manipulation">Fonctions Lambda : extraction et modification de métadonnées ou de contenu</h2>
        <p>Vous pouvez manipuler les champs et le contenu de votre document à l'aide des fonctions Lambda. Cela est utile si vous souhaitez aller au-delà de la logique de base et appliquer des manipulations de données avancées. Par exemple, utiliser la reconnaissance optique de caractères (OCR), qui interprète le texte des images et traite chaque image comme un document textuel. Vous pouvez également récupérer la date-heure actuelle dans un certain fuseau horaire et insérer la date-heure là où il y a une valeur vide pour un champ de date.</p>
        <p>Vous pouvez d'abord appliquer une logique de base, puis utiliser une fonction Lambda pour continuer à manipuler vos données, ou vice versa. Vous pouvez également choisir de n'appliquer qu'une fonction Lambda.</p>
        <p>Amazon Kendrapeut invoquer une fonction Lambda pour appliquer des manipulations de données avancées lors du processus d'ingestion dans le cadre de votre <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_CustomDocumentEnrichmentConfiguration.html">CustomDocumentEnrichmentConfiguration</a>. Vous spécifiez un rôle qui inclut l'autorisation d'exécuter la fonction Lambda et d'accéder à votreAmazon S3 compartiment pour stocker le résultat de vos manipulations de données (voir <a href="https://docs.aws.amazon.com/kendra/latest/dg/iam-roles.html">rôlesIAM d'accès</a>).</p>
        <p>Amazon Kendrapeut appliquer une fonction Lambda sur vos documents bruts originaux ou sur les documents structurés analysés. Vous pouvez configurer une fonction Lambda qui prend vos données d'origine ou brutes et applique vos manipulations de données à l'aide de <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_CustomDocumentEnrichmentConfiguration.html">PreExtractionHookConfiguration</a>. Vous pouvez également configurer une fonction Lambda qui prend vos documents structurés et applique vos manipulations de données à l'aide de <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_CustomDocumentEnrichmentConfiguration.html">PostExtractionHookConfiguration</a>. Amazon Kendraextrait les métadonnées et le texte du document pour structurer vos documents. Vos fonctions Lambda doivent respecter les structures de demande et de réponse obligatoires. Pour plus d'informations, veuillez consulter <a href="#cde-data-contracts-lambda">Contrats de données pour les fonctions Lambda</a>.</p>
        <p>Pour configurer une fonction Lambda dans la console, sélectionnez votre index, puis sélectionnez <b>Enrichissements de documents</b> dans le menu de navigation. Accédez à <b>Configurer les fonctions Lambda</b> pour configurer une fonction Lambda.</p>
        <p>Vous ne pouvez configurer qu'une seule fonction Lambda pour<code class="code">PreExtractionHookConfiguration</code> et une seule fonction Lambda pour<code class="code">PostExtractionHookConfiguration</code>. Cependant, votre fonction Lambda peut appeler d'autres fonctions dont elle a besoin. Vous pouvez configurer les deux et/ou<code class="code">PreExtractionHookConfiguration</code> l'un<code class="code">PostExtractionHookConfiguration</code> ou l'autre. La durée d'exécution de votre fonction Lambda ne<code class="code">PreExtractionHookConfiguration</code> doit pas dépasser 5 minutes et celle de votre fonction Lambda ne<code class="code">PostExtractionHookConfiguration</code> doit pas dépasser 1 minute. La configuration de l'enrichissement personnalisé des documents prend naturellement plus de temps pour intégrer vos documentsAmazon Kendra que si vous ne le configuriez pas.</p>
        <p>Vous pouvez configurerAmazon Kendra pour appeler une fonction Lambda uniquement si une condition est remplie. Par exemple, vous pouvez spécifier une condition selon laquelle, s'il existe des valeurs de date et d'heureAmazon Kendra vides, une fonction qui insère la date et l'heure actuelles.</p>
        <p>Voici un exemple d'utilisation d'une fonction Lambda pour exécuter l'OCR afin d'interpréter du texte à partir d'images et de stocker ce texte dans un champ appelé « Document_Image_Text ».</p>
        <p><b>Exemple 1 : Extraction de texte à partir d'images pour créer des documents textuels</b></p>
        <p>Données avant l'application d'une manipulation avancée.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c15c23"><thead>
                    <tr>
                        <th><b>ID du document</b></th>
                        <th><b>Document_Image</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>image_1.png</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>image_2.png</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>image_3.png</td>
                    </tr>
                </table></div></div>
        <p>Données après manipulation avancée appliquées.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c15c27"><thead>
                    <tr>
                        <th><b>ID du document</b></th>
                        <th><b>Document_Image</b></th>
                        <th><b>Document_Image_Text</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>image_1.png</td>
                        <td>Réponse à l'enquête envoyée par courrier</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>image_2.png</td>
                        <td>Réponse à l'enquête envoyée par courrier</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>image_3.png</td>
                        <td>Réponse à l'enquête envoyée par courrier</td>
                    </tr>
                </table></div></div>
        <p>Voici un exemple d'utilisation d'une fonction Lambda pour insérer la date-heure actuelle pour des valeurs de date vides. Cela utilise la condition selon laquelle si la valeur d'un champ de date est « nulle », remplacez-la par la date-heure actuelle.</p>
        <p><b>Exemple 2 : Remplacement des valeurs vides dans le champ Last_Updated par la date-heure actuelle.</b></p>
        <p>Données avant l'application d'une manipulation avancée.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c15c35"><thead>
                    <tr>
                        <th><b>ID du document</b></th>
                        <th><b>Body_Text</b></th>
                        <th><b>Dernière mise à jour</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>Lorem Ipsum.</td>
                        <td>1er janvier 2020</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Lorem Ipsum.</td>
                        <td> </td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Lorem Ipsum.</td>
                        <td>1er juillet 2020</td>
                    </tr>
                </table></div></div>
        <p>Les données ont été appliquées après manipulation avancée.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c15c39"><thead>
                    <tr>
                        <th><b>ID du document</b></th>
                        <th><b>Body_Text</b></th>
                        <th><b>Dernière mise à jour</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>Lorem Ipsum.</td>
                        <td>1er janvier 2020</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Lorem Ipsum.</td>
                        <td>1er décembre 2021</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Lorem Ipsum.</td>
                        <td>1er juillet 2020</td>
                    </tr>
                </table></div></div>
        <p>Le code suivant est un exemple de configuration d'une fonction Lambda pour une manipulation avancée des données sur les données brutes d'origine.</p>
        <awsdocs-tabs><dl style="display: none">
            <dt>Console</dt><dd tab-id="console">
                    
                    <div class="procedure"><h6>Pour configurer une fonction Lambda pour une manipulation avancée des données sur les données brutes d'origine</h6><ol><li>
                            <p>Dans le volet de navigation de gauche, sous <b>Index</b>, sélectionnez <b>Enrichissements de documents</b>, puis sélectionnez <b>Ajouter un enrichissement de documents</b>.</p>
                        </li><li>
                            <p>Sur la page <b>Configurer les fonctions Lambda</b>, dans la section <b>Lambda pour la pré-extraction</b>, sélectionnez dans les listes déroulantes votre ARN de fonction Lambda et votreAmazon S3 bucket. Ajoutez votre rôleIAM d'accès en sélectionnant l'option permettant de créer un nouveau rôle dans la liste déroulante. Cela crée lesAmazon Kendra autorisations requises pour créer l'enrichissement du document.</p>
                        </li></ol></div>
                </dd>
            <dt>CLI</dt><dd tab-id="cli">
                    <p><b>Pour configurer une fonction Lambda pour une manipulation avancée des données sur les données brutes d'origine</b></p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws kendra create-data-source \
 --name <code class="replaceable">data-source-name</code> \
 --index-id <code class="replaceable">index-id</code> \
 --role-arn <code class="replaceable">arn:aws:iam::account-id:role/role-name</code> \
 --type S3 \
 --configuration '<span>{</span>"S3Configuration":<span>{</span>"BucketName":"<code class="replaceable">S3-bucket-name</code>"}}' \
 --custom-document-enrichment-configuration '<span>{</span>"PreExtractionHookConfiguration":<span>{</span>"LambdaArn":"<code class="replaceable">arn:aws:iam::account-id:function/function-name</code>", "S3Bucket":"<code class="replaceable">S3-bucket-name</code>"}, "RoleArn": "<code class="replaceable">arn:aws:iam:account-id:role/cde-role-name</code>"}'
</code></pre>
                </dd>
            <dt>Python</dt><dd tab-id="python">
                    <p><b>Pour configurer une fonction Lambda pour une manipulation avancée des données sur les données brutes d'origine</b></p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import boto3&#xD;
from botocore.exceptions import ClientError&#xD;
import pprint&#xD;
import time&#xD;
&#xD;
kendra = boto3.client("kendra")&#xD;
&#xD;
print("Create a data source with customizations.")&#xD;
&#xD;
# Provide the name of the data source&#xD;
name = "data-source-name"&#xD;
# Provide the index ID for the data source&#xD;
index_id = "index-id"&#xD;
# Provide the IAM role ARN required for data sources&#xD;
role_arn = "arn:aws:iam::$<span>{</span>account-id}:role/$<span>{</span>role-name}"&#xD;
# Provide the data source connection information&#xD;
data_source_type = "S3"&#xD;
S3_bucket_name = "S3-bucket-name"&#xD;
# Configure the data source with Custom Document Enrichment&#xD;
configuration = <span>{</span>"S3Configuration":&#xD;
        <span>{</span>&#xD;
            "BucketName": S3_bucket_name&#xD;
        }&#xD;
    }&#xD;
custom_document_enrichment_configuration = <span>{</span>"PreExtractionHookConfiguration":&#xD;
        <span>{</span>&#xD;
            "LambdaArn":"arn:aws:iam::account-id:function/function-name",&#xD;
            "S3Bucket":"S3-bucket-name"&#xD;
        }&#xD;
    "RoleArn":"arn:aws:iam::account-id:role/cde-role-name"&#xD;
    }&#xD;
&#xD;
try:&#xD;
    data_source_response = kendra.create_data_source(&#xD;
        Name = name,&#xD;
        IndexId = index_id,&#xD;
        RoleArn = role_arn,&#xD;
        Type = data_source_type&#xD;
        Configuration = configuration&#xD;
        CustomDocumentEnrichmentConfiguration = custom_document_enrichment_configuration&#xD;
    )&#xD;
&#xD;
    pprint.pprint(data_source_response)&#xD;
&#xD;
    data_source_id = data_source_response["Id"]&#xD;
&#xD;
    print("Wait for Amazon Kendra to create the data source with your customizations.")&#xD;
&#xD;
    while True:&#xD;
        # Get the details of the data source, such as the status&#xD;
        data_source_description = kendra.describe_data_source(&#xD;
            Id = data_source_id,&#xD;
            IndexId = index_id&#xD;
        )&#xD;
        status = data_source_description["Status"]&#xD;
        print(" Creating data source. Status: "+status)&#xD;
        time.sleep(60)&#xD;
        if status != "CREATING":&#xD;
            break&#xD;
&#xD;
    print("Synchronize the data source.")&#xD;
&#xD;
    sync_response = kendra.start_data_source_sync_job(&#xD;
        Id = data_source_id,&#xD;
        IndexId = index_id&#xD;
    )&#xD;
&#xD;
    pprint.pprint(sync_response)&#xD;
&#xD;
    print("Wait for the data source to sync with the index.")&#xD;
&#xD;
    while True:&#xD;
&#xD;
        jobs = kendra.list_data_source_sync_jobs(&#xD;
            Id = data_source_id,&#xD;
            IndexId = index_id&#xD;
        )&#xD;
&#xD;
        # For this example, there should be one job&#xD;
        status = jobs["History"][0]["Status"]&#xD;
&#xD;
        print(" Syncing data source. Status: "+status)&#xD;
        time.sleep(60)&#xD;
        if status != "SYNCING":&#xD;
            break&#xD;
&#xD;
except  ClientError as e:&#xD;
        print("%s" % e)&#xD;
&#xD;
print("Program ends.")&#xD;
</code></pre>
                </dd>
            <dt>Java</dt><dd tab-id="java">
                    <p><b>Pour configurer une fonction Lambda pour une manipulation avancée des données sur les données brutes d'origine</b></p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="java ">package com.amazonaws.kendra;

import java.util.concurrent.TimeUnit;
import software.amazon.awssdk.services.kendra.KendraClient;
import software.amazon.awssdk.services.kendra.model.CreateDataSourceRequest;
import software.amazon.awssdk.services.kendra.model.CreateDataSourceResponse;
import software.amazon.awssdk.services.kendra.model.CreateIndexRequest;
import software.amazon.awssdk.services.kendra.model.CreateIndexResponse;
import software.amazon.awssdk.services.kendra.model.DataSourceConfiguration;
import software.amazon.awssdk.services.kendra.model.DataSourceStatus;
import software.amazon.awssdk.services.kendra.model.DataSourceSyncJob;
import software.amazon.awssdk.services.kendra.model.DataSourceSyncJobStatus;
import software.amazon.awssdk.services.kendra.model.DataSourceType;
import software.amazon.awssdk.services.kendra.model.DescribeDataSourceRequest;
import software.amazon.awssdk.services.kendra.model.DescribeDataSourceResponse;
import software.amazon.awssdk.services.kendra.model.DescribeIndexRequest;
import software.amazon.awssdk.services.kendra.model.DescribeIndexResponse;
import software.amazon.awssdk.services.kendra.model.IndexStatus;
import software.amazon.awssdk.services.kendra.model.ListDataSourceSyncJobsRequest;
import software.amazon.awssdk.services.kendra.model.ListDataSourceSyncJobsResponse;
import software.amazon.awssdk.services.kendra.model.S3DataSourceConfiguration;
import software.amazon.awssdk.services.kendra.model.StartDataSourceSyncJobRequest;
import software.amazon.awssdk.services.kendra.model.StartDataSourceSyncJobResponse;


public class CreateDataSourceWithCustomizationsExample <span>{</span>

    public static void main(String[] args) throws InterruptedException <span>{</span>
        System.out.println("Create a data source with customizations");
        
        String dataSourceName = "data-source-name";
        String indexId = "index-id";
        String dataSourceRoleArn = "arn:aws:iam::account-id:role/role-name";
        String s3BucketName = "S3-bucket-name"

        KendraClient kendra = KendraClient.builder().build();
        
        CreateDataSourceRequest createDataSourceRequest = CreateDataSourceRequest
            .builder()
            .name(dataSourceName)
            .description(experienceDescription)
            .roleArn(experienceRoleArn)
            .type(DataSourceType.S3)
            .configuration(
                DataSourceConfiguration
                    .builder()
                    .s3Configuration(
                        S3DataSourceConfiguration
                            .builder()
                            .bucketName(s3BucketName)
                            .build()
                    ).build()
            )
            .customDocumentEnrichmentConfiguration(
                CustomDocumentEnrichmentConfiguration
                    .builder()
                    .preExtractionHookConfiguration(
                        HookConfiguration
                            .builder()
                            .lambdaArn("arn:aws:iam::account-id:function/function-name")
                            .s3Bucket("S3-bucket-name")
                            .build())
                    .roleArn("arn:aws:iam::account-id:role/cde-role-name")
                    .build();
        
        CreateDataSourceResponse createDataSourceResponse = kendra.createDataSource(createDataSourceRequest);
        System.out.println(String.format("Response of creating data source: %s", createDataSourceResponse));

        String dataSourceId = createDataSourceResponse.id();
        System.out.println(String.format("Waiting for Kendra to create the data source %s", dataSourceId));
        DescribeDataSourceRequest describeDataSourceRequest = DescribeDataSourceRequest
            .builder()
            .indexId(indexId)
            .id(dataSourceId)
            .build();

        while (true) <span>{</span>
            DescribeDataSourceResponse describeDataSourceResponse = kendra.describeDataSource(describeDataSourceRequest);

            DataSourceStatus status = describeDataSourceResponse.status();
            System.out.println(String.format("Creating data source. Status: %s", status));
            TimeUnit.SECONDS.sleep(60);
            if (status != DataSourceStatus.CREATING) <span>{</span>
                break;
            }
        }

        System.out.println(String.format("Synchronize the data source %s", dataSourceId));
        StartDataSourceSyncJobRequest startDataSourceSyncJobRequest = StartDataSourceSyncJobRequest
            .builder()
            .indexId(indexId)
            .id(dataSourceId)
            .build();
        StartDataSourceSyncJobResponse startDataSourceSyncJobResponse = kendra.startDataSourceSyncJob(startDataSourceSyncJobRequest);
        System.out.println(String.format("Waiting for the data source to sync with the index %s for execution ID %s", indexId, startDataSourceSyncJobResponse.executionId()));

        // For this example, there should be one job
        ListDataSourceSyncJobsRequest listDataSourceSyncJobsRequest = ListDataSourceSyncJobsRequest
            .builder()
            .indexId(indexId)
            .id(dataSourceId)
            .build();

        while (true) <span>{</span>
            ListDataSourceSyncJobsResponse listDataSourceSyncJobsResponse = kendra.listDataSourceSyncJobs(listDataSourceSyncJobsRequest);
            DataSourceSyncJob job = listDataSourceSyncJobsResponse.history().get(0);
            System.out.println(String.format("Syncing data source. Status: %s", job.status()));

            TimeUnit.SECONDS.sleep(60);
            if (job.status() != DataSourceSyncJobStatus.SYNCING) <span>{</span>
                break;
            }

        }

        System.out.println("Data source creation with customizations is complete");
    }
}</code></pre>
                </dd>
        </dl></awsdocs-tabs>
     
        <h2 id="cde-data-contracts-lambda">Contrats de données pour les fonctions Lambda</h2>
        <p>Vos fonctions Lambda destinées à la manipulation avancée des données interagissent avecAmazon Kendra les contrats de données. Les contrats sont les structures de demande et de réponse obligatoires de vos fonctions Lambda. Si vos fonctions Lambda ne suivent pas ces structures, celaAmazon Kendra génère une erreur.</p>
        <p>Votre fonction Lambda pour<code class="code">PreExtractionHookConfiguration</code> doit s'attendre à la structure de requête suivante :</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "version": &lt;str&gt;,
    "dataBlobStringEncodedInBase64": &lt;str&gt;, //In the case of a data blob
    "s3Bucket": &lt;str&gt;, //In the case of an S3 bucket
    "s3ObjectKey": &lt;str&gt;, //In the case of an S3 bucket
    "metadata": &lt;Metadata&gt;
}</code></pre>
        <p>La<code class="code">metadata</code> structure, qui inclut la<code class="code">CustomerDocumentAttribute</code> structure, est la suivante :</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "attributes": [&lt;CustomerDocumentAttribute&lt;]
}

CustomerDocumentAttribute
<span>{</span>
    "name": &lt;str&gt;,
    "value": &lt;CustomerDocumentAttributeValue&gt;
}

CustomerDocumentAttributeValue
<span>{</span>
    "stringValue": &lt;str&gt;,
    "integerValue": &lt;int&gt;,
    "longValue": &lt;long&gt;,
    "stringListValue": list&lt;str&gt;,
    "dateValue": &lt;str&gt;
}</code></pre>
        <p>Votre fonction Lambda pour<code class="code">PreExtractionHookConfiguration</code> doit respecter la structure de réponse suivante :</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "version": &lt;str&gt;,
    "dataBlobStringEncodedInBase64": &lt;str&gt;, //In the case of a data blob
    "s3ObjectKey": &lt;str&gt;, //In the case of an S3 bucket
    "metadataUpdates": [&lt;CustomDocumentAttribute&gt;]
}</code></pre>
        <p>Votre fonction Lambda pour<code class="code">PostExtractionHookConfiguration</code> doit s'attendre à la structure de requête suivante :</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "version": &lt;str&gt;,
    "s3Bucket": &lt;str&gt;,
    "s3ObjectKey": &lt;str&gt;,
    "metadata": &lt;Metadata&gt;
}</code></pre>
        <p>Votre fonction Lambda pour<code class="code">PostExtractionHookConfiguration</code> doit respecter la structure de réponse suivante :</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">PostExtractionHookConfiguration Lambda Response
<span>{</span>
    "version": &lt;str&gt;,
    "s3ObjectKey": &lt;str&gt;,
    "metadataUpdates": [&lt;CustomDocumentAttribute&gt;]
}</code></pre>
        <p>Le document modifié est chargé dans votreAmazon S3 compartiment. Le document modifié doit respecter le format indiqué dans<a href="#structured-document-format">Format de document structuré</a>.</p>
         
            <h3 id="structured-document-format">Format de document structuré</h3>
            <p>Amazon Kendratélécharge votre document structuré dans leAmazon S3 compartiment indiqué. Le document structuré suit le format suivant :</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">Kendra document

<span>{</span>
   "textContent": &lt;TextContent&gt;
}

TextContent
<span>{</span>
  "documentBodyText": &lt;str&gt;
}</code></pre>
         
         
            <h3 id="example-lambda-function-advanced-manipulation">Exemple de fonction Lambda qui adhère à des contrats de données</h3>
            <p>Le code Python suivant est un exemple de fonction Lambda qui applique une manipulation avancée des champs<code class="code">_authors</code> de métadonnées et du corps du contenu des documents bruts ou originaux.<code class="code">_document_title</code></p>
            <p><b>Dans le cas où le contenu du corps réside dans unAmazon S3 seau</b></p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import json&#xD;
import boto3&#xD;
     &#xD;
s3 = boto3.client("s3")&#xD;
&#xD;
# Lambda function for advanced data manipulation    &#xD;
def lambda_handler(event, context):&#xD;
    # Get the value of "S3Bucket" key name or item from the given event input&#xD;
    s3_bucket = event.get("s3Bucket")&#xD;
    # Get the value of "S3ObjectKey" key name or item from the given event input&#xD;
    s3_object_key = event.get("s3ObjectKey")&#xD;
    &#xD;
    content_object_before_CDE = s3.get_object(Bucket = s3_bucket, Key = s3_object_key)&#xD;
    content_before_CDE = content_object_before_CDE["Body"].read().decode("utf-8");&#xD;
    content_after_CDE = "CDEInvolved " + content_before_CDE&#xD;
    &#xD;
    # Get the value of "metadata" key name or item from the given event input&#xD;
    metadata = event.get("metadata")&#xD;
    # Get the document "attributes" from the metadata &#xD;
    document_attributes = metadata.get("attributes")&#xD;
    &#xD;
    s3.put_object(Bucket = s3_bucket, Key = "dummy_updated_kendra_document", Body=json.dumps(content_after_CDE))&#xD;
    return <span>{</span>&#xD;
        "version": "v0",&#xD;
        "s3ObjectKey": "dummy_updated_kendra_document",&#xD;
        "metadataUpdates": [&#xD;
            <span>{</span>"name":"_document_title", "value":<span>{</span>"stringValue":"title_from_pre_extraction_lambda"}},&#xD;
            <span>{</span>"name":"_authors", "value":<span>{</span>"stringListValue":["author1", "author2"]}}&#xD;
        ]&#xD;
    }</code></pre>
            <p><b>Dans le cas du corps du contenu résidant dans un blob de données</b></p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import json&#xD;
import boto3&#xD;
import base64&#xD;
&#xD;
# Lambda function for advanced data manipulation&#xD;
def lambda_handler(event, context):&#xD;
    &#xD;
    # Get the value of "dataBlobStringEncodedInBase64" key name or item from the given event input &#xD;
    data_blob_string_encoded_in_base64 = event.get("dataBlobStringEncodedInBase64")&#xD;
    # Decode the data blob string in UTF-8&#xD;
    data_blob_string = base64.b64decode(data_blob_string_encoded_in_base64).decode("utf-8")&#xD;
    # Get the value of "metadata" key name or item from the given event input    &#xD;
    metadata = event.get("metadata")&#xD;
    # Get the document "attributes" from the metadata&#xD;
    document_attributes = metadata.get("attributes")&#xD;
    &#xD;
    new_data_blob = "This should be the modified data in the document by pre processing lambda ".encode("utf-8")&#xD;
    return <span>{</span>&#xD;
        "version": "v0",&#xD;
        "dataBlobStringEncodedInBase64": base64.b64encode(new_data_blob).decode("utf-8"),&#xD;
        "metadataUpdates": [&#xD;
            <span>{</span>"name":"_document_title", "value":<span>{</span>"stringValue":"title_from_pre_extraction_lambda"}},&#xD;
            <span>{</span>"name":"_authors", "value":<span>{</span>"stringListValue":["author1", "author2"]}}&#xD;
        ]&#xD;
    }</code></pre>
            <p>Le code Python suivant est un exemple de fonction Lambda qui applique une manipulation avancée des champs<code class="code">_authors</code> de métadonnées et du corps du contenu des documents structurés ou analysés.<code class="code">_document_title</code></p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import json&#xD;
import boto3&#xD;
import time&#xD;
&#xD;
s3 = boto3.client("s3")&#xD;
&#xD;
# Lambda function for advanced data manipulation&#xD;
def lambda_handler(event, context):&#xD;
    &#xD;
    # Get the value of "S3Bucket" key name or item from the given event input&#xD;
    s3_bucket = event.get("s3Bucket")&#xD;
    # Get the value of "S3ObjectKey" key name or item from the given event input&#xD;
    s3_key = event.get("s3ObjectKey")&#xD;
    # Get the value of "metadata" key name or item from the given event input&#xD;
    metadata = event.get("metadata")&#xD;
    # Get the document "attributes" from the metadata &#xD;
    document_attributes = metadata.get("attributes")&#xD;
    &#xD;
    kendra_document_object = s3.get_object(Bucket = s3_bucket, Key = s3_key)&#xD;
    kendra_document_string = kendra_document_object['Body'].read().decode('utf-8')&#xD;
    kendra_document = json.loads(kendra_document_string)&#xD;
    kendra_document["textContent"]["documentBodyText"] = "Changing document body to a short sentence."&#xD;
    &#xD;
    s3.put_object(Bucket = s3_bucket, Key = "dummy_updated_kendra_document", Body=json.dumps(kendra_document))&#xD;
&#xD;
    return <span>{</span>&#xD;
        "version" : "v0",&#xD;
        "s3ObjectKey": "dummy_updated_kendra_document",&#xD;
        "metadataUpdates": [&#xD;
            <span>{</span>"name": "_document_title", "value":<span>{</span>"stringValue": "title_from_post_extraction_lambda"}},&#xD;
            <span>{</span>"name": "_authors", "value":<span>{</span>"stringListValue":["author1", "author2"]}}&#xD;
        ]&#xD;
    }</code></pre>
         
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./delete-data-source.html">Suppression de sources de données</div><div id="next" class="next-link" accesskey="n" href="./searching.html">Recherche dans les index</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/custom-document-enrichment.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/custom-document-enrichment.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>