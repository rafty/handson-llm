<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="fr-FR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AMAZON. KendraSearchIntent - Amazon Lex</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="built-in-intent-kendra-search" /><meta name="default_state" content="built-in-intent-kendra-search" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/built-in-intent-kendra-search.html" /><meta name="description" content="Pour rechercher des documents que vous avez indexés avec Amazon Kendra, utilisez l' AMAZON.KendraSearchIntent intention. Lorsqu'Amazon Lex V2 ne parvient pas à déterminer l'action suivante dans une conversation avec l'utilisateur, cela déclenche l'intention de recherche." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Lex" /><meta name="guide" content="Guide du développeur V2" /><meta name="abstract" content="Fournit une présentation conceptuelle d'Amazon Lex V2. Inclut des instructions détaillées pour l'utilisation de diverses fonctionnalités, telles que le streaming de conversations, et fournit une référence complète pour les API V2." /><meta name="guide-locale" content="fr_fr" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/built-in-intent-kendra-search.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="x-default" /><meta name="feedback-item" content="Lex" /><meta name="this_doc_product" content="Amazon Lex" /><meta name="this_doc_guide" content="Guide du développeur V2" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'lex'}"></script><meta id="panorama-serviceSubSection" value="Guide du développeur V2" /><meta id="panorama-serviceConsolePage" value="AMAZON. KendraSearchIntent" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AMAZON. KendraSearchIntent - Amazon Lex</title><meta name="pdf" content="lex2.0.pdf#built-in-intent-kendra-search" /><meta name="rss" content="amazon-lex-v2-document-history.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=251" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lex&amp;topic_url=http://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/built-in-intent-kendra-search.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/built-in-intent-kendra-search.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/built-in-intent-kendra-search.html" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Lex",
        "item" : "https://docs.aws.amazon.com/lex/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guide du développeur V2",
        "item" : "https://docs.aws.amazon.com/fr_fr/lexv2/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Construire des robots",
        "item" : "https://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/building-bots.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Intentions et types d'emplacements intégrés",
        "item" : "https://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/built-in.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Intentions prédéfinies",
        "item" : "https://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/howitworks-builtins-intents.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "AMAZON. KendraSearchIntent",
        "item" : "https://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/howitworks-builtins-intents.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="lex2.0.pdf#built-in-intent-kendra-search" target="_blank" rel="noopener noreferrer" title="Ouvrir le PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/lex/index.html">Amazon Lex</a><a href="what-is.html">Guide du développeur V2</a></div><div id="page-toc-src"><a href="#kendra-search-iam">Stratégie IAM</a><a href="#kendra-search-filter">Utilisation des attributs de demande et de session en tant que filtres</a><a href="#kendra-search-response">Utilisation de la réponse de recherche</a><a href="#kendra-search-lambda">Utilisation d'une fonction Lambda pour gérer la demande et la réponse</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Les traductions sont fournies par des outils de traduction automatique. En cas de conflit entre le contenu d'une traduction et celui de la version originale en anglais, la version anglaise prévaudra.</p></awsui-alert><h1 class="topictitle" id="built-in-intent-kendra-search">AMAZON. KendraSearchIntent</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Pour rechercher des documents que vous avez indexés avec Amazon Kendra, utilisez l'<code class="code">AMAZON.KendraSearchIntent</code>intention. Lorsqu'Amazon Lex V2 ne parvient pas à déterminer l'action suivante dans une conversation avec l'utilisateur, cela déclenche l'intention de recherche.</p><p><code class="code">AMAZON.KendraSearchIntent</code>Il est disponible uniquement dans les régions anglais (USA) et UE (Irlande).</p><p>Amazon Kendra est un service machine-learning-based  de recherche qui indexe des documents en langage naturel tels que des documents PDF ou des fichiers Microsoft Word. Il peut effectuer des recherches sur des documents indexés et renvoyer les types de réponse suivants à une question :</p><div class="itemizedlist">
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>Une réponse </p>
                </li><li class="listitem">
                    <p>Une entrée de FAQ qui pourrait répondre à la question</p>
                </li><li class="listitem">
                    <p>Un document lié à la question</p>
                </li></ul></div><p>Pour obtenir un exemple d'utilisation de <code class="code">AMAZON.KendraSearchIntent</code>, veuillez consulter <a href="./faq-bot-kendra-search.html">Exemple : création d'un bot FAQ pour un index Amazon Kendra</a>.</p><p>Si vous configurez une<code class="code">AMAZON.KendraSearchIntent</code> intention pour votre robot, Amazon Lex V2 appelle l'intention chaque fois qu'il ne parvient pas à déterminer l'énoncé d'une intention par l'utilisateur. S'il n'y a pas de réponse d'Amazon Kendra, la conversation se poursuit comme configuré dans le bot.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p> Amazon Lex V2 ne prend actuellement pas en charge l'activation des créneaux<code class="code">AMAZON.KendraSearchIntent</code> horaires. Si Amazon Lex V2 ne parvient pas à déterminer l'énoncé de l'utilisateur pour un emplacement, il appelle le<code class="code">AMAZON.FallbackIntent</code>. </p></div></div><p>Lorsque vous utilisez le<code class="code">AMAZON.KendraSearchIntent</code> avec le<code class="code">AMAZON.FallbackIntent</code> dans le même bot, Amazon Lex V2 utilise les intentions suivantes :</p><div class="orderedlist">
                 
                 
                 
                 
            <ol><li>
                    <p>Amazon Lex V2 appelle<code class="code">AMAZON.KendraSearchIntent</code>. L'intention appelle l'<code class="code">Query</code>opération Amazon Kendra.</p>
                </li><li>
                    <p>Si Amazon Kendra renvoie une réponse, Amazon Lex V2 affiche le résultat à l'utilisateur.</p>
                </li><li>
                    <p>En l'absence de réponse d'Amazon Kendra, Amazon Lex V2 invite à nouveau l'utilisateur. L'action suivante dépend de la réponse de l'utilisateur.</p>
                    <div class="itemizedlist">
                         
                         
                    <ul class="itemizedlist"><li class="listitem">
                            <p>Si la réponse de l'utilisateur contient un énoncé reconnu par Amazon Lex V2, tel que le remplissage d'une valeur d'intervalle ou la confirmation d'une intention, la conversation avec l'utilisateur se poursuit comme configuré pour le bot.</p>
                        </li><li class="listitem">
                            <p>Si la réponse de l'utilisateur ne contient aucun énoncé reconnu par Amazon Lex V2, Amazon Lex V2 lance un nouvel appel à l'<code class="code">Query</code>opération.</p>
                        </li></ul></div>
                </li><li>
                    <p>S'il n'y a pas de réponse après le nombre de tentatives configuré, Amazon Lex V2 appelle<code class="code">AMAZON.FallbackIntent</code> et met fin à la conversation avec l'utilisateur.</p>
                </li></ol></div><p>Vous pouvez utiliser le pour envoyer une demande<code class="code">AMAZON.KendraSearchIntent</code> à Amazon Kendra de trois manières :</p><div class="itemizedlist">
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>Laissez l'intention de recherche faire la demande pour vous. Amazon Lex V2 appelle Amazon Kendra en utilisant l'énoncé de l'utilisateur comme chaîne de recherche. Lorsque vous créez l'intention, vous pouvez définir une chaîne de filtre de requête qui limite le nombre de réponses renvoyées par Amazon Kendra. Amazon Lex V2 utilise le filtre dans la demande de requête.</p>
                </li><li class="listitem">
                    <p>Ajoutez des paramètres de requête supplémentaires à la demande pour affiner les résultats de recherche à l'aide de votre fonction Lambda. Vous ajoutez un<code class="code">kendraQueryFilterString</code> champ contenant les paramètres de requête Amazon Kendra à l'action<code class="code">delegate</code> de dialogue. Lorsque vous ajoutez des paramètres de requête à la demande à l'aide de la fonction Lambda, ils ont priorité sur le filtre de requête que vous avez défini lors de la création de l'intention.</p>
                </li><li class="listitem">
                    <p>Créez une requête à aide de fonction Lambda. Vous pouvez créer une demande de requête Amazon Kendra complète qu'Amazon Lex V2 envoie. Vous spécifiez la requête dans le champ <code class="code">kendraQueryRequestPayload</code> de l’action de dialogue <code class="code">delegate</code>. Le champ <code class="code">kendraQueryRequestPayload</code> a priorité sur le champ <code class="code">kendraQueryFilterString</code>.</p>
                </li></ul></div><p>Pour spécifier le<code class="code">queryFilterString</code> paramètre lorsque vous créez un robot, ou pour spécifier le<code class="code">kendraQueryFilterString</code> champ lorsque vous appelez l'<code class="code">delegate</code>action dans une fonction Lambda de dialogue, vous spécifiez une chaîne qui est utilisée comme filtre d'attribut pour la requête Amazon Kendra. Si la chaîne n'est pas un filtre d'attribut valide, vous obtiendrez une exception <code class="code">InvalidBotConfigException</code> lors de l'exécution. Pour plus d'informations sur les filtres d'attributs, consultez la section <a href="https://docs.aws.amazon.com/kendra/latest/dg/filtering.html#search-filtering">Utilisation des attributs de document pour filtrer les requêtes</a> dans le <em>Guide du développeur Amazon Kendra</em>.</p><p>Pour contrôler la requête envoyée par Amazon Lex V2 à Amazon Kendra, vous pouvez spécifier une requête dans le<code class="code">kendraQueryRequestPayload</code> champ de votre fonction Lambda. Si la requête n'est pas valide, Amazon Lex V2 renvoie une<code class="code">InvalidLambdaResponseException</code> exception. Pour plus d'informations, consultez le <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_Query.html">fonctionnement des requêtes</a> dans le <em>Guide du développeur Amazon Kendra</em>.</p><p>Pour obtenir un exemple de la façon d'utiliser l’intention <code class="code">AMAZON.KendraSearchIntent</code>, veuillez consulter <a href="./faq-bot-kendra-search.html">Exemple : création d'un bot FAQ pour un index Amazon Kendra</a>.</p>
                <h2 id="kendra-search-iam">Politique IAM pour Amazon Kendra</h2>
                <p>Pour utiliser l'<code class="code">AMAZON.KendraSearchIntent</code>intention, vous devez utiliser un rôle fournissant des politiquesAWS Identity and Access Management (IAM) permettant à Amazon Lex V2 d'assumer un rôle d'exécution autorisé à appeler l'<code class="code">Query</code>intention Amazon Kendra. Les paramètres IAM que vous utilisez varient selon que vous les créez à l'<code class="code">AMAZON.KendraSearchIntent</code>aide de la console Amazon Lex V2, d'un SDK AWS ou duAWS Command Line Interface (AWS CLI). Lorsque vous utilisez la console, vous pouvez choisir d'ajouter l'autorisation d'appeler Amazon Kendra au rôle lié au service Amazon Lex V2 ou d'utiliser un rôle spécifique pour appeler l'<code class="code">Query</code>opération Amazon Kendra. Lorsque vous utilisez l’AWS CLI ou un kit SDK pour créer l'intention, vous devez utiliser un rôle spécifique pour appeler l'opération <code class="code">Query</code>.</p>
                 
                    <h3 id="kendra-iam-attach">Attachement d’autorisations </h3>
                    <p>Vous pouvez utiliser la console pour associer des autorisations d'accès à l'<code class="code">Query</code>opération Amazon Kendra au rôle par défaut lié au service Amazon Lex V2. Lorsque vous associez des autorisations au rôle lié à un service, vous n'avez pas besoin de créer et de gérer un rôle d'exécution spécifique pour vous connecter à l'index Amazon Kendra.</p>
                    <p>L'utilisateur, le rôle ou le groupe que vous utilisez pour accéder à la console Amazon Lex V2 doit disposer des autorisations nécessaires pour gérer les politiques relatives aux rôles. Attachez la politique IAM suivante au rôle d'accès à console. Lorsque vous accordez ces autorisations, le rôle dispose des autorisations permettant de modifier la stratégie de rôle liée à un service existante. </p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "iam:AttachRolePolicy",
                "iam:PutRolePolicy",
                "iam:GetRolePolicy"
            ],
            "Resource": "arn:aws:iam::*:role/aws-service-role/lexv2.amazonaws.com/AWSServiceRoleForLexBots*"
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": "iam:ListRoles",
            "Resource": "*"
        }
    ]
}</code></pre>
                 
                 
                    <h3 id="kendra-iam-role">Spécification d'un rôle </h3>
                    <p>Vous pouvez utiliser la consoleAWS CLI, l'API ou l'API pour spécifier un rôle d'exécution à utiliser lors de l'appel de l'<code class="code">Query</code>opération Amazon Kendra. </p>
                    <p>L'utilisateur, le rôle ou le groupe que vous utilisez pour spécifier le rôle d'exécution doit disposer de cette<code class="code">iam:PassRole</code> autorisation. La stratégie suivante définit l'autorisation. Vous pouvez utiliser les clés de contexte de condition <code class="code">iam:AssociatedResourceArn</code> et <code class="code">iam:PassedToService</code> pour limiter davantage la portée des autorisations. Pour plus d'informations, consultez les <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html">sections IAM etAWS STS Context Keys</a> du <em>guide deAWS Identity and Access Management l'utilisateur</em>.</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": "iam:PassRole",
            "Resource": "arn:aws:iam::<code class="replaceable">account</code>:role/<code class="replaceable">role</code>"
        }
    ]
}</code></pre>
                    <p>Le rôle d'exécution qu'Amazon Lex V2 doit utiliser pour appeler Amazon Kendra doit disposer des<code class="code">kendra:Query</code> autorisations nécessaires. Lorsque vous utilisez un rôle IAM existant pour obtenir l'autorisation d'appeler l'<code class="code">Query</code>opération Amazon Kendra, le rôle doit être associé à la politique suivante.</p>
                    <p>Vous pouvez utiliser la console IAM, l'API IAM ouAWS CLI pour créer une politique et l'associer à un rôle. Ces instructions utilisent l’AWS CLI pour créer le rôle et les stratégies.</p>
                    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>Le code suivant est formaté pour Linux et macOS. Sous Windows, remplacez le caractère de continuité de ligne Linux (\) par le caret (^).</p></div></div>
                    <div class="procedure"><h6>Pour ajouter une autorisation d'opération Query à un rôle</h6><ol><li>
                            <p>Créez un document appelé <code class="userinput">KendraQueryPolicy.json</code> dans le répertoire courant, ajoutez-y le code suivant et enregistrez-le.</p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kendra:Query"
            ],
            "Resource": [
                "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account</code>:index/<code class="replaceable">index ID</code>"
            ]
        }
    ]
}</code></pre>
                        </li><li>
                            <p>Dans leAWS CLI, exécutez la commande suivante pour créer la politique IAM pour exécuter l'<code class="code">Query</code>opération Amazon Kendra.</p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iam create-policy \
    --policy-name <code class="replaceable">query-policy-name</code> \
    --policy-document file://KendraQueryPolicy.json</code></pre>
                        </li><li>
                            <p>Attachez la politique au rôle IAM que vous utilisez pour appeler l'<code class="code">Query</code>opération.</p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iam attach-role-policy \
    --policy-arn arn:aws:iam::<code class="replaceable">account-id</code>:policy/<code class="replaceable">query-policy-name</code>
    --role-name <code class="replaceable">role-name</code></code></pre>
                        </li></ol></div>
                    <p>Vous pouvez choisir de mettre à jour le rôle lié au service Amazon Lex V2 ou d'utiliser un rôle que vous avez créé lors de la création du rôle<code class="code">AMAZON.KendraSearchIntent</code> pour votre bot. La procédure suivante indique comment choisir le rôle IAM à utiliser.</p>
                    <div class="procedure"><h6>Pour spécifier le rôle d'exécution pour AMAZON. KendraSearchIntent</h6><ol><li>
                            <p>Connectez-vousAWS Management Console à Amazon Lex <a href="https://console.aws.amazon.com/lex/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/lex/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
                        </li><li>
                            <p>Choisissez le bot auquel vous souhaitez ajouter l’intention <code class="code">AMAZON.KendraSearchIntent</code>.</p>
                        </li><li>
                            <p>Choisissez le signe plus (+) en regarde de <b>Intents (Intentions)</b>.</p>
                        </li><li>
                            <p>Dans <b>Add intent (Ajouter une intention)</b>, choisissez <b>Search existing intents (Rechercher des intentions existantes)</b>.</p>
                        </li><li>
                            <p>Dans <b>Search intents (Rechercher des intentions)</b>, entrez, <code class="userinput">AMAZON.KendraSearchIntent</code> puis choisissez <b>Add (Ajouter)</b>.</p>
                        </li><li>
                            <p>Dans <b>Copy built-in intent (Copier une intention intégrée)</b>, entrez un nom pour l'intention, par exemple <code class="userinput">KendraSearchIntent</code>, puis choisissez <b>Add (Ajouter)</b>.</p>
                        </li><li>
                            <p>Ouvrez la section <b>Amazon Kendra query (Requête Amazon Kendra)</b>.</p>
                        </li><li>
                            <p>Pour <b>IAM role (Rôle IAM)</b> choisissez une des options suivantes :</p>
                            <div class="itemizedlist">
                                 
                                 
                            <ul class="itemizedlist"><li class="listitem">
                                    <p>Pour mettre à jour le rôle lié au service Amazon Lex V2 afin de permettre à votre robot d'interroger les index Amazon Kendra, choisissez <b>Ajouter des autorisations Amazon Kendra</b>.</p>
                                </li><li class="listitem">
                                    <p>Pour utiliser un rôle autorisé à appeler l'<code class="code">Query</code>opération Amazon Kendra, choisissez <b>Utiliser un rôle existant</b>.</p>
                                </li></ul></div>
                        </li></ol></div>
                 
             
                <h2 id="kendra-search-filter">Utilisation des attributs de demande et de session en tant que filtres</h2>
                <p>Pour filtrer la réponse d'Amazon Kendra aux éléments liés à la conversation en cours, utilisez les attributs de session et de demande comme filtres en ajoutant le<code class="code">queryFilterString</code> paramètre lorsque vous créez votre bot. Vous spécifiez un espace réservé pour l'attribut lorsque vous créez l'intention, puis Amazon Lex V2 y substitue une valeur avant d'appeler Amazon Kendra. Pour de plus amples informations sur les attributs de demande, veuillez consulter <a href="./context-mgmt-request-attribs.html">Définition des attributs de la demande</a>. Pour en savoir plus sur les attributs de session, consultez <a href="./context-mgmt-session-attribs.html">Définition des attributs de la session</a>.</p>
                <p>Voici un exemple de<code class="code">queryFilterString</code> paramètre qui utilise une chaîne pour filtrer la requête Amazon Kendra.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"<span>{</span>"equalsTo": <span>{</span>"key": "City", "value": <span>{</span>"stringValue": "Seattle"}}}"</code></pre>
                <p>Voici un exemple de<code class="code">queryFilterString</code> paramètre qui utilise un attribut de session appelé<code class="code">"SourceURI"</code> pour filtrer la requête Amazon Kendra.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"<span>{</span>"equalsTo": <span>{</span>"key": "SourceURI","value": <span>{</span>"stringValue": "[FileURL]"}}}"</code></pre>
                <p>Voici un exemple de<code class="code">queryFilterString</code> paramètre qui utilise un attribut de demande appelé<code class="code">"DepartmentName"</code> pour filtrer la requête Amazon Kendra.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"<span>{</span>"equalsTo": <span>{</span>"key": "Department","value": <span>{</span>"stringValue": "((DepartmentName))"}}}"</code></pre>
                <p>Les<code class="code">AMAZON.KendraSearchInteng</code> filtres utilisent le même format que les filtres de recherche Amazon Kendra. Pour plus d'informations, consultez la section <a href="https://docs.aws.amazon.com/kendra/latest/dg/filtering.html#search-filtering">Utilisation des attributs de document pour filtrer les résultats de recherche</a> dans le <em>guide du développeur Amazon Kendra</em>.</p>
                <p>La chaîne de filtre de requête utilisée avec<code class="code">AMAZON.KendraSearchIntent</code> doit utiliser des lettres minuscules pour la première lettre de chaque filtre. Par exemple, ce qui suit est un filtre de requête valide pour<code class="code">AMAZON.KendraSearchIntent</code>.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Texte"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "andAllFilters": [
        <span>{</span>
            "equalsTo": <span>{</span>
                "key": "City",
                "value": <span>{</span>
                    "stringValue": "Seattle"
                }
            }
        },
        <span>{</span>
            "equalsTo": <span>{</span>
                "key": "State",
                "value": <span>{</span>
                    "stringValue": "Washington"
                }
            }
        }
    ]
}</code></pre>
             
                <h2 id="kendra-search-response">Utilisation de la réponse de recherche</h2>
                <p>Amazon Kendra renvoie la réponse à une recherche sous la forme d'une réponse à partir de la<code class="code">IntentClosingSetting</code> déclaration d'intention. L'intention doit comporter une<code class="code">closingResponse</code> instruction à moins qu'une fonction Lambda ne produise un message de réponse de clôture.</p>
                <p>Amazon Kendra propose cinq types de réponses. </p>
                <div class="itemizedlist">
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>Les deux réponses suivantes nécessitent la création d'une FAQ pour votre index Amazon Kendra. Pour plus de détails, voir <a href="https://docs.aws.amazon.com/kendra/latest/dg/in-creating-faq.html">Ajouter des questions et des réponses directement à un index</a>.</p>
                        <div class="itemizedlist">
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p> <code class="code">x-amz-lex:kendra-search-response-question_answer-question-&lt;N&gt;</code>— La question d'une FAQ qui correspond à la recherche. </p>
                            </li><li class="listitem">
                                <p> <code class="code">x-amz-lex:kendra-search-response-question_answer-answer-&lt;N&gt;</code>— La réponse d'une FAQ qui correspond à la recherche. </p>
                            </li></ul></div>                        
                    </li><li class="listitem">
                        <p>Les trois réponses suivantes nécessitent la configuration d'une source de données pour votre index Amazon Kendra. Pour plus de détails, consultez la section <a href="https://docs.aws.amazon.com/kendra/latest/dg/data-source.html">Création d'une source de données</a>. </p>
                        <div class="itemizedlist">
                             
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p><code class="code">x-amz-lex:kendra-search-response-document-&lt;N&gt;</code>— Extrait d'un document de l'index lié au texte de l'énoncé.</p>
                            </li><li class="listitem">
                                <p><code class="code">x-amz-lex:kendra-search-response-document-link-&lt;N&gt;</code>— URL d'un document de l'index associé au texte de l'énoncé.</p>
                            </li><li class="listitem">
                                <p><code class="code">x-amz-lex:kendra-search-response-answer-&lt;N&gt;</code>— Un extrait d'un document de l'index qui répond à la question.</p>
                            </li></ul></div>
                    </li></ul></div>
                <p>Les réponses sont renvoyées dans les attributs <code class="code">request</code>. Il peut y avoir jusqu'à cinq réponses pour chaque attribut, numérotées de 1 à 5. Pour plus d'informations sur les réponses, consultez <a href="https://docs.aws.amazon.com/kendra/latest/dg/response-types.html">les types de réponses</a> dans le <em>Guide du développeur Amazon Kendra</em>. </p>
                <p>L'instruction <code class="code">closingResponse</code> doit comporter un ou plusieurs groupes de messages. Chaque groupe de messages contient un ou plusieurs messages. Chaque message peut contenir une ou plusieurs variables d'espace réservé qui sont remplacées par des attributs de demande dans la réponse d'Amazon Kendra. Il doit y avoir au moins un message du groupe de messages dans lequel toutes les variables du message sont remplacées par des valeurs d'attribut de demande dans la réponse d'exécution, ou il doit y avoir un message du groupe de messages sans aucune variable d'espace réservé. Les attributs de demande sont définis avec des parenthèses doubles ("((" "))"). Les messages du groupe de messages suivants correspondent à toutes les réponses d'Amazon Kendra :</p>
                <div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>« J'ai trouvé une question FAQ pour vous : ((x-amz-lex:kendra-search-response-question _answer-question-1)), et la réponse est ((x-amz-lex:kendra-search-response-question _answer-answer-1)) »</p>
                    </li><li class="listitem">
                        <p>« J'ai trouvé un extrait d'un document utile : ((x-amz-lex:kendra-search-response-document -1)) »</p>
                    </li><li class="listitem">
                        <p>« Je pense que la réponse à vos questions est ((x-amz-lex:kendra-search-response-answer -1)) »</p>
                    </li></ul></div>
             
                <h2 id="kendra-search-lambda">Utilisation d'une fonction Lambda pour gérer la demande et la réponse</h2>
                <p>L'<code class="code">AMAZON.KendraSearchIntent</code>intention peut utiliser votre crochet de code de boîte de dialogue et votre crochet de code d'expédition pour gérer la demande adressée à Amazon Kendra et la réponse. Utilisez la fonction Lambda de crochet de code de boîte de dialogue lorsque vous souhaitez modifier la requête que vous envoyez à Amazon Kendra, et la fonction Lambda de crochet de code d'expédition lorsque vous souhaitez modifier la réponse.</p>
                 
                    <h3 id="kendra-search-lambda-dialog">Création d'une requête avec le hook de code de dialogue</h3>
                    <p>Vous pouvez utiliser le crochet de code de la boîte de dialogue pour créer une requête à envoyer à Amazon Kendra. L'utilisation du hook de code de dialogue est facultative. Si vous ne spécifiez pas de crochet de dialogue, Amazon Lex V2 crée une requête à partir de l'énoncé utilisateur et utilise<code class="code">queryFilterString</code> celui que vous avez fourni lors de la configuration de l'intention, si vous en avez fourni un.</p>
                    <p>Vous pouvez utiliser deux champs dans la réponse du crochet de dialogue pour modifier la demande adressée à Amazon Kendra :</p>
                    <div class="itemizedlist">
                         
                         
                    <ul class="itemizedlist"><li class="listitem">
                            <p><code class="code">kendraQueryFilterString</code>— Utilisez cette chaîne pour spécifier les filtres d'attributs pour la demande Amazon Kendra. Vous pouvez filtrer la requête à l'aide de l'un des champs d'index définis dans votre index. Pour connaître la structure de la chaîne de filtre, consultez la section <a href="https://docs.aws.amazon.com/kendra/latest/dg/filtering.html#search-filtering">Utilisation des attributs de document pour filtrer les requêtes</a> dans le <em>Guide du développeur Amazon Kendra</em>. Si la chaîne de filtre spécifiée n'est pas valide, vous obtiendrez une exception <code class="code">InvalidLambdaResponseException</code>. La chaîne <code class="code">kendraQueryFilterString</code> remplace toute chaîne de requête spécifiée dans <code class="code">queryFilterString</code> configuré pour l'intention.</p>
                        </li><li class="listitem">
                            <p><code class="code">kendraQueryRequestPayload</code>— Utilisez cette chaîne pour spécifier une requête Amazon Kendra. Votre requête peut utiliser toutes les fonctionnalités d'Amazon Kendra. Si vous ne spécifiez pas de requête valide, vous obtenez une exception <code class="code">InvalidLambdaResponseException</code>. Pour plus d'informations, consultez <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_Query.html">Query</a> dans le <em>guide du développeur Amazon Kendra</em>.</p>
                        </li></ul></div>
                    <p>Après avoir créé le filtre ou la chaîne de requête, vous envoyez la réponse à Amazon Lex V2 avec le<code class="code">dialogAction</code> champ de réponse défini sur<code class="code">delegate</code>. Amazon Lex V2 envoie la requête à Amazon Kendra, puis renvoie la réponse à la requête au crochet de code d'expédition.</p>
                 
                 
                    <h3 id="kendra-search-lambda-fulfillment">Utilisation du hook de code d'exécution pour la réponse</h3>
                    <p>Une fois qu'Amazon Lex V2 a envoyé une requête à Amazon Kendra, la réponse à la requête est renvoyée à la<code class="code">AMAZON.KendraSearchIntent</code> fonction Lambda de traitement. L'événement d'entrée dans le crochet de code contient la réponse complète d'Amazon Kendra. Les données de requête ont la même structure que celles renvoyées par l'<code class="code">Query</code>opération Amazon Kendra. Pour plus d'informations, consultez la section <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_Query.html#API_Query_ResponseSyntax">Syntaxe des réponses aux requêtes</a> dans le <em>Guide du développeur Amazon Kendra</em>.</p>
                    <p>Le hook de code d'exécution est facultatif. S'il n'en existe pas, ou si le crochet de code ne renvoie aucun message dans la réponse, Amazon Lex V2 utilise l'<code class="code">closingResponse</code>instruction pour les réponses.</p>
                 
            <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Avertissement" /> <strong>JavaScript est désactivé ou n'est pas disponible dans votre navigateur.</strong></p><p>Pour que vous puissiez utiliser la documentation AWS, Javascript doit être activé. Vous trouverez des instructions sur les pages d'aide de votre navigateur.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Conventions de rédaction</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./built-in-intent-help.html">AMAZON. HelpIntent</div><div id="next" class="next-link" accesskey="n" href="./faq-bot-kendra-search.html">Exemple : création d'un bot FAQ pour un index Amazon Kendra</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Oui</div><div class="content"><p>Merci de nous avoir fait part de votre satisfaction.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer ce qui vous a plu afin que nous puissions nous améliorer davantage.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lex&amp;topic_url=https://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/built-in-intent-kendra-search.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Cette page vous a-t-elle été utile ? - Non</div><div class="content"><p>Merci de nous avoir avertis que cette page avait besoin d'être retravaillée. Nous sommes désolés de ne pas avoir répondu à vos attentes.</p><p>Si vous avez quelques minutes à nous consacrer, merci de nous indiquer comment nous pourrions améliorer cette documentation.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Commentaire" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lex&amp;topic_url=https://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/built-in-intent-kendra-search.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>