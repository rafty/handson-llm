<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Using service-linked roles for Network Firewall - AWS Network Firewall</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="using-service-linked-roles" /><meta name="default_state" content="using-service-linked-roles" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/network-firewall/latest/developerguide/using-service-linked-roles.html" /><meta name="description" content="Use service-linked roles to give Network Firewall access to resources in your AWS account." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Network Firewall" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Describes how to use AWS Network Firewall, the Amazon Virtual Private Cloud firewall service." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/network-firewall/latest/developerguide/using-service-linked-roles.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/network-firewall/latest/developerguide/using-service-linked-roles.html" hreflang="x-default" /><meta name="feedback-item" content="Network Firewall" /><meta name="this_doc_product" content="AWS Network Firewall" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'network-firewall'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="Using service-linked roles for Network Firewall" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Using service-linked roles for Network Firewall - AWS Network Firewall</title><meta name="pdf" content="/pdfs/network-firewall/latest/developerguide/network-firewall-developer-guide.pdf#using-service-linked-roles" /><meta name="rss" content="network-firewall-developer-guide.rss" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Network%20Firewall&amp;topic_url=http://docs.aws.amazon.com/en_us/network-firewall/latest/developerguide/using-service-linked-roles.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/network-firewall/latest/developerguide/using-service-linked-roles.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/network-firewall/latest/developerguide/using-service-linked-roles.html" /><meta name="keywords" content="VPC,AWS Network Firewall,Network Firewall,Amazon Virtual Private Cloud,Amazon VPC,virtual private cloud firewall,firewall,firewall policy,rule group,ACL,access control list" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Network Firewall",
        "item" : "https://docs.aws.amazon.com/network-firewall/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/network-firewall/latest/developerguide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Security in AWS Network Firewall",
        "item" : "https://docs.aws.amazon.com/network-firewall/latest/developerguide/security.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Identity and Access Management for AWS Network Firewall",
        "item" : "https://docs.aws.amazon.com/network-firewall/latest/developerguide/security-iam.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Using service-linked roles for Network Firewall",
        "item" : "https://docs.aws.amazon.com/network-firewall/latest/developerguide/security-iam.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/network-firewall/latest/developerguide/network-firewall-developer-guide.pdf#using-service-linked-roles" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/network-firewall/index.html">AWS Network Firewall</a><a href="what-is-aws-network-firewall.html">Developer Guide</a></div><div id="page-toc-src"><a href="#slr-permissions">Service-linked role permissions</a><a href="#create-slr">Creating a service-linked role</a><a href="#edit-slr">Editing a service-linked role</a><a href="#delete-slr">Deleting a service-linked role</a><a href="#slr-regions">Supported Regions for service-linked roles</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="using-service-linked-roles">Using service-linked roles for Network Firewall</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>AWS Network Firewall uses AWS Identity and Access Management (IAM) <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-linked-role">
		service-linked roles</a>. A service-linked role is a unique type of IAM role that is
		linked directly to Network Firewall. Service-linked roles are predefined by Network Firewall and
		include all the permissions that the service requires to call other AWS services on your
		behalf. </p><p>A service-linked role makes setting up Network Firewall easier because you don’t have to
		manually add the necessary permissions. Network Firewall defines the permissions of its
		service-linked roles, and unless defined otherwise, only Network Firewall can assume its roles.
		The defined permissions include the trust policy and the permissions policy. That
		permissions policy can't be attached to any other IAM entity.</p><p>You can delete a service-linked role only after first deleting its related resources.
		This protects your Network Firewall resources because you can't inadvertently remove permission
		to access the resources.</p><p>For information about other services that support service-linked roles, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_aws-services-that-work-with-iam.html">AWS services that
			work with IAM</a> and look for the services that have <b>Yes</b> in the <b>Service-Linked Role</b> column. Choose a
			<b>Yes</b> with a link to view the service-linked role
		documentation for that service.</p>
		<h2 id="slr-permissions">Service-linked role permissions for
				Network Firewall</h2>
		<p>Network Firewall uses the service-linked role named <b><code class="code">AWSServiceRoleForNetworkFirewall</code></b> –
			An access policy that allows AWS Network Firewall to manage Network Firewall related resources on behalf of your AWS account. Network Firewall uses its service-linked-role to create, describe, and delete VPC endpoints in support of your firewall management activities. Network Firewall is the only service that uses this service-linked role,
			and Network Firewall doesn't use any other service's service-linked role. This
			service-linked role is used in the Network Firewall managed policy
				<code class="code">AWSNetworkFirewallServiceRolePolicy</code>. For more information, see <a href="./security-iam-awsmanpol.html">AWS managed policies for AWS Network Firewall</a>.</p>
		<p>The <code class="code">AWSServiceRoleForNetworkFirewall</code> service-linked role trusts the <code class="code">network-firewall.amazonaws.com</code> service
			principal to assume the role. The following is the JSON trust policy: </p>
		<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Effect": "Allow",
      "Principal": <span>{</span>
        "Service": [          
          "network-firewall.amazonaws.com"
        ]
      },
      "Action": "sts:AssumeRole"
    }
  ]
}</code></pre>
		<p>The role permissions policy allows Network Firewall to perform the following actions: </p>
		<div class="itemizedlist">
			 
			 
			 
			 
			 
		<ul class="itemizedlist"><li class="listitem"><p>Describe and create Amazon EC2 VPC resources for firewall management.</p></li><li class="listitem"><p>Describe ACM certificates for use with TLS inspection configurations.</p></li><li class="listitem"><p>Create and manage resource groups.</p></li><li class="listitem"><p>Periodically check the VPC CIDR blocks and management of firewall endpoints in the VPC.</p></li><li class="listitem"><p>Describe Amazon EC2 instances and Amazon EC2 network interfaces for use in resource groups.</p></li></ul></div>
		<p>The following is the JSON role permissions
			policy:</p>
		<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Action": [
                "ec2:DescribeSubnets",
                "ec2:DescribeVpcs",
                "ec2:CreateVpcEndpoint",
                "ec2:DescribeVpcEndpoints",
                "ec2:DescribeInstances",
                "ec2:DescribeNetworkInterfaces"
            ],
            "Effect": "Allow",
            "Resource": "*"
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": "acm:DescribeCertificate",
            "Resource": "*"
         },
         <span>{</span>
            "Effect": "Allow",
            "Action": "resource-groups:ListGroupResources",
            "Resource": "*"
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": "tag:GetResources",
            "Resource": "*",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "aws:CalledViaLast": "resource-groups.amazonaws.com"
                }
            }
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "ec2:CreateTags"
            ],
            "Resource": "arn:aws:ec2:*:*:vpc-endpoint/*",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "ec2:CreateAction": "CreateVpcEndpoint",
                    "aws:RequestTag/AWSNetworkFirewallManaged": "true"
                }
            }
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "ec2:DeleteVpcEndpoints"
            ],
            "Resource": "*",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "aws:ResourceTag/AWSNetworkFirewallManaged": "true"
                }
            }
        }
    ]
}</code></pre>
		<p>When you enable logging for a firewall, Network Firewall uses a log delivery service,
			which might create a service-linked role in your account named
				<code class="code">AWSServiceRoleForLogDelivery</code> to deliver logs.</p>
		<p>You must configure permissions to allow an IAM entity (such as a user, group, or role)
			to create, edit, or delete a service-linked role. For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/using-service-linked-roles.html#service-linked-role-permissions">Service-Linked Role Permissions</a> in the <em>IAM User Guide</em>.</p>
	 
		<h2 id="create-slr">Creating a service-linked role for
				Network Firewall</h2>
		
		<p>You don't need to manually create a service-linked role for AWS Network Firewall. When you
			create a AWS Network Firewall firewall in the AWS Management Console, the AWS CLI, or the AWS API, if your account
			doesn't have the Network Firewall service-linked role yet, Network Firewall creates the role
			for you. If you manage your firewall resources through AWS Firewall Manager, Firewall Manager creates the
			service-linked role for accounts that are within scope of the Firewall Manager policy. If you want
			to, you can create the role through the IAM console. If you delete the service-linked
			role, the next time you create an Network Firewall resource, Network Firewall creates one for
			you again.</p>
	 
		<h2 id="edit-slr">Editing a service-linked role for
				Network Firewall</h2>
		<p>Network Firewall doesn't allow you to edit the <code class="code">AWSServiceRoleForNetworkFirewall</code> service-linked role. After you create
			a service-linked role, you can't change the name of the role because various entities
			might reference it. However, you can edit the description of the role using IAM. For
			more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/using-service-linked-roles.html#edit-service-linked-role">Editing a Service-Linked Role</a> in the
			<em>IAM User Guide</em>.</p>
	 
		<h2 id="delete-slr">Deleting a service-linked role for
				Network Firewall</h2>
		<p>If you no longer need to use a feature or service that requires a service-linked role, we
			recommend that you delete that role. That way you don’t have an unused entity that is
			not actively monitored or maintained. You must clean up the resources that require your
			service-linked role before you can manually delete it. You can delete the service-linked
			role used by Network Firewall if you no longer want to use the service. To delete the role,
			you must delete all firewalls, firewall policies, stateful rule groups, and stateless
			rule groups, in all Regions where you have them defined.</p>    
		<div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>If the Network Firewall service is using the role when you try to delete the resources,
				then the deletion might fail. If that happens, wait for a few minutes and try the
				operation again.</p></div></div>
		<div class="procedure"><h6>To delete all Network Firewall resources </h6><ol><li>
				<p>On the Amazon VPC console, update all route tables that send traffic through your firewall
					endpoints, to remove the endpoints from the traffic flow. For information about managing route tables for your VPC, see
                        <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_Route_Tables.html">Route
						tables</a> in the <em>Amazon Virtual Private Cloud User
							Guide</em>.</p>
			</li><li>
				<p>On the Network Firewall console, remove your firewalls, firewall policies,
					stateful rules groups, and stateless rule groups. For information, see <a href="./firewall-deleting.html">Deleting a firewall</a>, <a href="./firewall-policy-deleting.html">Deleting a firewall policy</a>, and <a href="./rule-group-deleting.html">Deleting a stateless rule group</a>.</p>
			</li></ol></div>
		<p>This removes all resources that Network Firewall used the service-linked role for. </p>
		<p><b>To manually delete the service-linked role using
			IAM</b></p>
		<p>Use the IAM console, the IAM CLI, or the IAM API to delete the <code class="code">AWSServiceRoleForNetworkFirewall</code>
			service-linked role. For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/using-service-linked-roles.html#delete-service-linked-role">Deleting a
				Service-Linked Role</a> in the <em>IAM User Guide</em>.</p>
	 
		<h2 id="slr-regions">Supported Regions for
				Network Firewall service-linked roles</h2>
		<p>Network Firewall supports using service-linked roles in all of the Regions where the service is
			available. For a Region list, see <a href="https://docs.aws.amazon.com/general/latest/gr/rande.html">AWS Regions and Endpoints</a>.</p>
	<awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./security_iam_troubleshoot.html">Troubleshooting</div><div id="next" class="next-link" accesskey="n" href="./incident-response.html">AWS logging and monitoring tools</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Network Firewall&amp;topic_url=https://docs.aws.amazon.com/en_us/network-firewall/latest/developerguide/using-service-linked-roles.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Network Firewall&amp;topic_url=https://docs.aws.amazon.com/en_us/network-firewall/latest/developerguide/using-service-linked-roles.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>