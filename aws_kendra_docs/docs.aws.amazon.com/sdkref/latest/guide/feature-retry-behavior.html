<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Retry behavior - AWS SDKs and Tools</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="feature-retry-behavior" /><meta name="default_state" content="feature-retry-behavior" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><meta name="description" content="Retry behavior includes settings regarding how the SDKs attempt to recover from failures resulting from requests made to AWS services. Configure this functionality by using the following settings." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS SDKs and Tools" /><meta name="guide" content="Reference Guide" /><meta name="abstract" content="A guide to common features and functionality of the AWS SDKs and developer tools. Includes maintenance and support policies, as well as a complete reference for configuring your AWS credentials and other parameters." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/sdkref/latest/guide/feature-retry-behavior.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sdkref/latest/guide/feature-retry-behavior.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sdkref/latest/guide/feature-retry-behavior.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sdkref/latest/guide/feature-retry-behavior.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sdkref/latest/guide/feature-retry-behavior.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/sdkref/latest/guide/feature-retry-behavior.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/sdkref/latest/guide/feature-retry-behavior.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sdkref/latest/guide/feature-retry-behavior.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sdkref/latest/guide/feature-retry-behavior.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sdkref/latest/guide/feature-retry-behavior.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sdkref/latest/guide/feature-retry-behavior.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sdkref/latest/guide/feature-retry-behavior.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sdkref/latest/guide/feature-retry-behavior.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sdkref/latest/guide/feature-retry-behavior.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sdkref/latest/guide/feature-retry-behavior.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sdkref/latest/guide/feature-retry-behavior.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sdkref/latest/guide/feature-retry-behavior.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sdkref/latest/guide/feature-retry-behavior.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sdkref/latest/guide/feature-retry-behavior.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sdkref/latest/guide/feature-retry-behavior.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sdkref/latest/guide/feature-retry-behavior.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/sdkref/latest/guide/feature-retry-behavior.html" hreflang="x-default" /><meta name="feedback-item" content="AWS Docs SDK Reference" /><meta name="this_doc_product" content="AWS SDKs and Tools" /><meta name="this_doc_guide" content="Reference Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sdkref'}"></script><meta id="panorama-serviceSubSection" value="Reference Guide" /><meta id="panorama-serviceConsolePage" value="Retry behavior" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Retry behavior - AWS SDKs and Tools</title><meta name="pdf" content="/pdfs/sdkref/latest/guide/aws-sdk-ref.pdf#feature-retry-behavior" /><meta name="rss" content="aws-sdk-ref.rss" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWS%20Docs%20SDK%20Reference&amp;topic_url=http://docs.aws.amazon.com/en_us/sdkref/latest/guide/feature-retry-behavior.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sdkref/latest/guide/feature-retry-behavior.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sdkref/latest/guide/feature-retry-behavior.html" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "none",
        "item" : "https://docs.aws.amazon.com/sdkref/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Reference Guide",
        "item" : "https://docs.aws.amazon.com/sdkref/latest/guide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Configuration and authentication settings reference",
        "item" : "https://docs.aws.amazon.com/sdkref/latest/guide/settings-reference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Standardized features",
        "item" : "https://docs.aws.amazon.com/sdkref/latest/guide/standardized-features.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Retry behavior",
        "item" : "https://docs.aws.amazon.com/sdkref/latest/guide/standardized-features.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/sdkref/latest/guide/aws-sdk-ref.pdf#feature-retry-behavior" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="overview.html">Reference Guide</a></div><div id="page-toc-src"><a href="#feature-retry-behavior-sdk-compat">Compatibility with AWS SDKS</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="feature-retry-behavior">Retry behavior</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Retry behavior includes settings regarding how the SDKs attempt to recover from failures
        resulting from requests made to AWS services. </p><div class="variablelist"><p>Configure this functionality by using the following:</p>
         
         


    <dl>
            <dt><b><span class="term"><code class="code">max_attempts</code> - shared AWS <code>config</code> file setting</span></b></dt>
            <dt><b><span class="term"><code class="code">AWS_MAX_ATTEMPTS</code> - environment variable</span></b></dt>
            <dd>
                <p>Specifies the maximum number attempts to make on a request.</p>

                <p><b>Default value:</b> If this value is not
                    specified, its default depends on the value of the <code class="code">retry_mode</code>
                    setting: </p>
                <div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>If <code class="code">retry_mode</code> is <code class="code">legacy</code> – Uses a default
                            value specific to your SDK (check your specific SDK guide or your SDK's
                            code base for <code class="code">max_attempts</code> default). </p>
                    </li><li class="listitem">
                        <p>If <code class="code">retry_mode</code> is <code class="code">standard</code> – Makes three
                            attempts.</p>
                    </li><li class="listitem">
                        <p>If <code class="code">retry_mode</code> is <code class="code">adaptive</code> – Makes three
                            attempts.</p>
                    </li></ul></div>
                <p><b>Valid values:</b> Number greater than 0. </p>
            </dd>
        
            <dt><b><span class="term"><code class="code">retry_mode</code> - shared AWS <code>config</code> file setting</span></b></dt>
            <dt><b><span class="term"><code class="code">AWS_RETRY_MODE</code> - environment variable</span></b></dt>
            <dd>
                <p>Specifies how the SDK or developer tool attempts retries.</p>

                <p><b>Default value:</b>
                    <code class="code">legacy</code> is the default retry strategy. </p>
                <p><b>Valid values:</b>
                </p>
                <div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p><code class="code">legacy</code> – Specific to your SDK (check your specific
                            SDK guide or your SDK's code base).</p>
                    </li><li class="listitem">
                        <p><code class="code">standard</code> – The standard set of retry rules across
                            AWS SDKs. This mode includes a standard set of errors that are
                            retried, and support for retry quotas. The default maximum number of
                            attempts with this mode is three, unless <code class="code">max_attempts</code> is
                            explicitly configured.</p>
                    </li><li class="listitem">
                        <p><code class="code">adaptive</code> – An experimental retry mode that
                            includes the functionality of standard mode but includes automatic
                            client-side throttling. Because this mode is experimental, it might
                            change behavior in the future.</p>
                    </li></ul></div>
            </dd>
        </dl></div><p>Following is the high-level pseudocode for both the <code class="code">standard</code> and
            <code class="code">adaptive</code> retry modes:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">MakeSDKRequest() <span>{</span>
  attempts = 0
  loop <span>{</span>
    GetSendToken()
    response = SendHTTPRequest()
    RequestBookkeeping(response)
    if not Retryable(response)
      return response
    attempts += 1
    if attempts &gt;= MAX_ATTEMPTS:
      return response
    if not HasRetryQuota(response)
      return response
    delay = ExponentialBackoff(attempts)
    sleep(delay)
  }
}</code></pre><p>Following are more details about the components used in the pseudocode:</p><p><b><code class="code">GetSendToken</code>:</b></p><p> Token buckets are only used in <code class="code">adaptive</code> retry mode. Token buckets enforce a
        maximum request rate by requiring a token to be available in order to initiate a request.
        The SDK client is configurable to either fast fail the request or block until a token
        becomes available.</p><p><em>Client Side Rate Limiting</em> is an algorithm that initially lets
        requests be made at any rate up to the token allowance. However, after a throttled response
        is detected, the client rate-of-request is then limited accordingly. The token allowance is
        also increased accordingly if successful responses are received. </p><p>With adaptive rate limiting, SDKs can slow down the rate at which requests are sent in
        order to better accommodate the capacity of AWS services. </p><p><b><code class="code">SendHTTPRequest</code>:</b></p><p>Most AWS SDKs use an HTTP library that uses connection pools so that you can reuse an
        existing connection when making an HTTP request. Generally, connections are reused when
        retrying requests due to throttling errors. Requests are not reused when retrying due to
        transient errors. </p><p><b><code class="code">RequestBookkeeping</code>:</b></p><p> The retry quota should be updated if the request is successful. For <code class="code">adaptive</code>
        retry mode only, the state variable <code class="code">maxsendrate</code> is updated based on the type of
        response received. </p><p><b><code class="code">Retryable</code>:</b></p><p> This step determines whether a response can be retried based on the following: </p><div class="itemizedlist">
         
         
         
    <ul class="itemizedlist"><li class="listitem">
            <p>The HTTP status code. </p>
        </li><li class="listitem">
            <p>The error code returned from the service.</p>
        </li><li class="listitem">
            <p>Connection errors, defined as any error received by the SDK in which an HTTP
                response from the service is not received. </p>
        </li></ul></div><p>Transient errors (HTTP status codes 400, 408, 500, 502, 503, and 504) and throttling
        errors (HTTP status codes 400, 403, 429, 502, 503, and 509) can all potentially be retried.
        SDK retry behavior is determined in combination with error codes or other data from the
        service.</p><p><b><code class="code">MAX_ATTEMPTS</code>:</b></p><p> Specified by the <code class="code">config</code> file setting or the environment variable. </p><p><b><code class="code">HasRetryQuota</code></b></p><p>This step throttles retry requests by requiring a token to be available in the retry quota
        bucket. Retry quota buckets are a mechanism to prevent retries that are unlikely to succeed.
        These quotas are SDK-dependent, are often client-dependent, and are sometimes even dependent
        on service endpoints. The available retry quota tokens are removed when requests fail for
        various reasons, and replenished when they succeed. When no tokens remain, the retry loop is
        exited. </p><p><b><code class="code">ExponentialBackoff</code></b></p><p> For an error that can be retried, the retry delay is calculated using truncated
        exponential backoff. The SDKs use truncated binary exponential backoff with jitter. The
        following algorithm shows how the amount of time to sleep, in seconds, is defined for a
        response for request <code class="code">i</code>: </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">seconds_to_sleep_i = min(b*r^i, MAX_BACKOFF)</code></pre><p>In the preceding algorithm, the following values apply:</p><p><code class="code">b = random number within the range of: 0 &lt;= b &lt;= 1</code></p><p><code class="code">r = 2</code></p><p><code class="code">MAX_BACKOFF = 20 seconds</code> for most SDKs. See your specific SDK guide or source
        code for confirmation.</p>
        <h2 id="feature-retry-behavior-sdk-compat">Compatibility with AWS SDKS</h2>
        <p>The following SDKs support the features and settings described on this page, any partial exceptions are noted:</p>
        <div class="table-container"><div class="table-contents"><table id="w184aac11c21c27c59b5"><thead>
                    <tr>
                        <th>SDK</th>
                        <th>Supported</th>
                        <th>Notes or more information</th>
                    </tr>
                </thead>
                    <tr>
                        <td><a href="https://docs.aws.amazon.com/cli/latest/userguide/">AWS CLI v2</a></td>
                        <td align="center" style="text-align: center;">Yes</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><a href="https://docs.aws.amazon.com/sdk-for-cpp/latest/developer-guide/">SDK for C++</a></td>
                        <td align="center" style="text-align: center;">Yes</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><a href="https://aws.github.io/aws-sdk-go-v2/docs" rel="noopener noreferrer" target="_blank"><span>SDK for Go V2 (1.x)</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></td>
                        <td align="center" style="text-align: center;">Yes</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><a href="https://docs.aws.amazon.com/sdk-for-go/latest/developer-guide/">SDK for Go 1.x (V1)</a></td>
                        <td align="center" style="text-align: center;">No</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><a href="https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/">SDK for Java 2.x</a></td>
                        <td align="center" style="text-align: center;">Yes</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><a href="https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/">SDK for Java 1.x</a></td>
                        <td align="center" style="text-align: center;">Yes</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><a href="https://docs.aws.amazon.com/sdk-for-javascript/latest/developer-guide/">SDK for JavaScript 3.x</a></td>
                        <td align="center" style="text-align: center;">Yes</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><a href="https://docs.aws.amazon.com/sdk-for-javascript/v2/developer-guide/">SDK for JavaScript 2.x</a></td>
                        <td align="center" style="text-align: center;">No</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><a href="https://docs.aws.amazon.com/sdk-for-net/latest/developer-guide/">SDK for .NET 3.x</a></td>
                        <td align="center" style="text-align: center;">Yes</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><a href="https://docs.aws.amazon.com/sdk-for-php/latest/developer-guide/">SDK for PHP 3.x</a></td>
                        <td align="center" style="text-align: center;">Yes</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><a href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/quickstart.html" rel="noopener noreferrer" target="_blank"><span>SDK for Python (Boto3)</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></td>
                        <td align="center" style="text-align: center;">Yes</td>
                        <td></td>
                    </tr>
                    <tr>
                        <td><a href="https://docs.aws.amazon.com/sdk-for-ruby/latest/developer-guide/">SDK for Ruby 3.x</a></td>
                        <td align="center" style="text-align: center;">Yes</td>
                        <td></td>
                    </tr>

                </table></div></div>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./feature-imds-client.html">IMDS client</div><div id="next" class="next-link" accesskey="n" href="./feature-smart-config-defaults.html">Smart configuration defaults</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWS Docs SDK Reference&amp;topic_url=https://docs.aws.amazon.com/en_us/sdkref/latest/guide/feature-retry-behavior.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWS Docs SDK Reference&amp;topic_url=https://docs.aws.amazon.com/en_us/sdkref/latest/guide/feature-retry-behavior.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>