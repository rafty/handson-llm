<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS KMS concepts - AWS Key Management Service</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="concepts" /><meta name="default_state" content="concepts" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html" /><meta name="description" content="Learn the basic terms and concepts used in AWS KMS." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Key Management Service" /><meta name="guide" content="Developer Guide" /><meta name="abstract" content="Learn how to use AWS Key Management Service (AWS KMS) to securely store and manage encryption keys and perform encryption and decryption of user data." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kms/latest/developerguide/concepts.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kms/latest/developerguide/concepts.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kms/latest/developerguide/concepts.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kms/latest/developerguide/concepts.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kms/latest/developerguide/concepts.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kms/latest/developerguide/concepts.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kms/latest/developerguide/concepts.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kms/latest/developerguide/concepts.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kms/latest/developerguide/concepts.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kms/latest/developerguide/concepts.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kms/latest/developerguide/concepts.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kms/latest/developerguide/concepts.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kms/latest/developerguide/concepts.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kms/latest/developerguide/concepts.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kms/latest/developerguide/concepts.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kms/latest/developerguide/concepts.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/kms/latest/developerguide/concepts.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/kms/latest/developerguide/concepts.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/kms/latest/developerguide/concepts.html" hreflang="x-default" /><meta name="feedback-item" content="Key Management Service (KMS)" /><meta name="this_doc_product" content="AWS Key Management Service" /><meta name="this_doc_guide" content="Developer Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'kms'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide" /><meta id="panorama-serviceConsolePage" value="AWS KMS concepts" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS KMS concepts - AWS Key Management Service</title><meta name="pdf" content="/pdfs/kms/latest/developerguide/kms-dg.pdf#concepts" /><meta name="github" content="https://github.com/awsdocs/aws-kms-developer-guide/tree/master/doc_source/concepts.md" /><meta name="rss" content="aws-kms-document-history.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=182" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Key%20Management%20Service%20%28KMS%29&amp;topic_url=http://docs.aws.amazon.com/en_us/kms/latest/developerguide/concepts.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/kms/latest/developerguide/concepts.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/kms/latest/developerguide/concepts.html" /><meta name="keywords" content="KMS,key management service,encryption key management,encryption key,,envelope encryption" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS KMS",
        "item" : "https://docs.aws.amazon.com/kms/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide",
        "item" : "https://docs.aws.amazon.com/kms/latest/developerguide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "AWS Key Management Service",
        "item" : "https://docs.aws.amazon.com/kms/latest/developerguide/overview.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "AWS KMS concepts",
        "item" : "https://docs.aws.amazon.com/kms/latest/developerguide/overview.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/kms/latest/developerguide/kms-dg.pdf#concepts" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/aws-kms-developer-guide/tree/master/doc_source/concepts.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/kms/index.html">AWS KMS</a><a href="overview.html">Developer Guide</a></div><div id="page-toc-src"><a href="#kms_keys">AWS KMS keys</a><a href="#key-mgmt">Customer keys and AWS keys</a><a href="#symmetric-cmks">Symmetric encryption KMS keys</a><a href="#asymmetric-keys-concept">Asymmetric KMS keys</a><a href="#hmac-key-concept">HMAC KMS keys</a><a href="#data-keys">Data keys</a><a href="#data-key-pairs">Data key pairs</a><a href="#alias-concept">Aliases</a><a href="#keystore-concept">Custom key stores</a><a href="#cryptographic-operations">Cryptographic operations</a><a href="#key-id">Key identifiers (KeyId)</a><a href="#key-material">Key material</a><a href="#key-origin">Key material origin</a><a href="#key-spec">Key spec</a><a href="#key-usage">Key usage</a><a href="#enveloping">Envelope encryption</a><a href="#encrypt_context">Encryption context</a><a href="#key_permissions">Key policy</a><a href="#grant">Grant</a><a href="#auditing_key_use">Auditing KMS key usage</a><a href="#key_management">Key management infrastructure</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="concepts">AWS KMS concepts</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Learn the basic terms and concepts used in AWS Key Management Service (AWS KMS) and how they work together to
    help protect your data.</p><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#kms_keys">AWS KMS keys</a></li><li><a href="#key-mgmt">Customer keys and AWS keys</a></li><li><a href="#symmetric-cmks">Symmetric encryption KMS keys</a></li><li><a href="#asymmetric-keys-concept">Asymmetric KMS keys</a></li><li><a href="#hmac-key-concept">HMAC KMS keys</a></li><li><a href="#data-keys">Data keys</a></li><li><a href="#data-key-pairs">Data key pairs</a></li><li><a href="#alias-concept">Aliases</a></li><li><a href="#keystore-concept">Custom key stores</a></li><li><a href="#cryptographic-operations">Cryptographic operations</a></li><li><a href="#key-id">Key identifiers (KeyId)</a></li><li><a href="#key-material">Key material</a></li><li><a href="#key-origin">Key material origin</a></li><li><a href="#key-spec">Key spec</a></li><li><a href="#key-usage">Key usage</a></li><li><a href="#enveloping">Envelope encryption</a></li><li><a href="#encrypt_context">Encryption context</a></li><li><a href="#key_permissions">Key policy</a></li><li><a href="#grant">Grant</a></li><li><a href="#auditing_key_use">Auditing KMS key usage</a></li><li><a href="#key_management">Key management infrastructure</a></li></ul></div>
    <h2 id="kms_keys">AWS KMS keys</h2>

    <p>AWS KMS keys (KMS keys) are the primary resource in AWS KMS. You can use a KMS key to
      encrypt, decrypt, and re-encrypt data. It can also generate data keys that you can use outside
      of AWS KMS. Typically, you'll use <a href="#symmetric-cmks">symmetric encryption
        KMS keys</a>, but you can create and use <a href="#asymmetric-keys-concept">asymmetric KMS keys</a> for encryption or signing, and create and use <a href="#hmac-key-concept">HMAC</a> KMS keys to generate and verify HMAC tags.</p>    
    
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>AWS KMS is replacing the term <em>customer master key (CMK)</em> with <em>AWS KMS key</em> and <em>KMS key</em>. The concept has not changed. To prevent breaking changes, AWS KMS is keeping some variations of this term.</p></div></div>
    <p>An <em>AWS KMS key</em> is a logical representation of a cryptographic key.
      A KMS key contains metadata, such as the key ID, <a href="#key-spec">key spec</a>,
        <a href="#key-usage">key usage</a>, creation date, description, and <a href="./key-state.html">key state</a>. Most importantly, it contains a reference to the <a href="#key-material">key material</a> that is used when you perform cryptographic
      operations with the KMS key.</p>

    <p>You can create a KMS key with cryptographic key material generated in AWS KMS <a href="https://csrc.nist.gov/projects/cryptographic-module-validation-program/certificate/4177" rel="noopener noreferrer" target="_blank"><span>FIPS validated hardware security modules</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>. The key material for
      symmetric KMS keys and the private keys of asymmetric KMS key never leaves AWS KMS
      unencrypted.
      
      To use or manage your KMS keys, you must use AWS KMS. For information about creating and
      managing KMS keys, see <a href="./getting-started.html">Managing keys</a>. For information about using
      KMS keys, see the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/">AWS Key Management Service API Reference</a>.</p>
    <p>By default, AWS KMS creates the key material for a KMS key. You cannot extract, export,
      view, or manage this key material. The only exception is the public key of an asymmetric key pair,
      which you can export for use outside of AWS. Also, you cannot delete this key material; you must <a href="./deleting-keys.html">delete the KMS key</a>. However, you can <a href="./importing-keys.html">import your own key material</a> into a KMS key, or use a
        <a href="#keystore-concept">custom key store</a> to create KMS keys that use key
      material in your AWS CloudHSM cluster, or key material in an external key manager that you own and manage
      outside of AWS.</p>

    <p>AWS KMS also supports <a href="./multi-region-keys-overview.html">multi-Region keys</a>,
      which let you encrypt data in one AWS Region and decrypt it in a different AWS Region. </p>

    <p>For information about creating and managing KMS keys, see <a href="./getting-started.html">Managing keys</a>. For information about using KMS keys, see the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/">AWS Key Management Service API Reference</a>.</p>
   
    <h2 id="key-mgmt">Customer keys and AWS keys</h2>
    <p>The KMS keys that you create are <a href="#customer-cmk">customer managed keys</a>.
      AWS services that use KMS keys to encrypt your service resources often create keys for
      you. KMS keys that AWS services create in your AWS account are <a href="#aws-managed-cmk">AWS managed keys</a>. KMS keys that AWS services create
      in a service account are <a href="#aws-owned-cmk">AWS owned keys</a>. </p>


    <div class="table-container"><div class="table-contents"><table id="w261aab5c39b9b5"><thead>
          <tr>
            <th>Type of KMS key</th>
            <th>Can view KMS key metadata</th>
            <th>Can manage KMS key</th>
            <th>Used only for my AWS account</th>
            <th><a href="./rotate-keys.html">Automatic rotation</a></th>
            <th><a href="https://aws.amazon.com/kms/pricing/" rel="noopener noreferrer" target="_blank"><span>Pricing</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></th>
          </tr>
        </thead>
          <tr>
            <td><a href="#customer-cmk">Customer managed key</a></td>
            <td>Yes</td>
            <td>Yes</td>
            <td>Yes</td>
            <td>Optional. Every year (approximately 365 days)</td>
            <td><p>Monthly fee (pro-rated hourly)</p><p>Per-use fee</p></td>
          </tr>
          <tr>
            <td><a href="#aws-managed-cmk">AWS managed key</a></td>
            <td>Yes</td>
            <td>No</td>
            <td>Yes</td>
            <td>Required. Every year (approximately 365 days)</td>
            <td><p>No monthly fee</p><p>Per-use fee (some AWS services pay this fee for you)</p></td>
          </tr>
          <tr>
            <td><a href="#aws-owned-cmk">AWS owned key</a></td>
            <td>No</td>
            <td>No</td>
            <td>No</td>
            <td>Varies</td>
            <td>No fees</td>
          </tr>
        </table></div></div>
    <p><a href="./service-integration.html">AWS services that integrate with AWS KMS</a> differ
      in their support for KMS keys. Some AWS services encrypt your data by default with an
      AWS owned key or an AWS managed key. Some AWS services support customer managed keys. Other AWS
      services support all types of KMS keys to allow you the ease of an AWS owned key, the
      visibility of an AWS managed key, or the control of a customer managed key. For detailed information
      about the encryption options that an AWS service offers, see the <em>Encryption at Rest</em> topic in the user guide or the developer guide for the
      service.</p>

     
      <h3 id="customer-cmk">Customer managed keys</h3>
      <p>The KMS keys that you create are <em>customer managed
          keys</em>. Customer managed keys are KMS keys in your AWS account that you create,
        own, and manage. You have full control over these KMS keys, including establishing and
        maintaining their <a href="./control-access.html">key policies, IAM policies, and
          grants</a>, <a href="./enabling-keys.html">enabling and disabling</a> them, <a href="./rotate-keys.html">rotating their cryptographic material</a>, <a href="./tagging-keys.html">adding tags</a>, <a href="./programming-aliases.html">creating
          aliases</a> that refer to the KMS keys, and <a href="./deleting-keys.html">scheduling
          the KMS keys for deletion</a>. </p>
      <p>Customer managed keys appear on the <b>Customer managed keys</b> page of the AWS Management Console
        for AWS KMS. To definitively identify a customer managed key, use the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_DescribeKey.html">DescribeKey</a> operation. For customer managed keys,
        the value of the <code class="code">KeyManager</code> field of the <code class="code">DescribeKey</code> response is
          <code class="code">CUSTOMER</code>.</p>
      <p>You can use your customer managed key in cryptographic operations and audit usage in AWS CloudTrail
        logs. In addition, many <a href="./service-integration.html">AWS services that integrate
          with AWS KMS</a> let you specify a customer managed key to protect the data stored and managed for
        you. </p>
      <p>Customer managed keys incur a monthly fee and a fee for use in excess of the free tier. They
        are counted against the AWS KMS <a href="./limits.html">quotas</a> for your account. For
        details, see <a href="https://aws.amazon.com/kms/pricing/" rel="noopener noreferrer" target="_blank"><span>AWS Key Management Service Pricing</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> and <a href="./limits.html">Quotas</a>.</p>
     

     
      <h3 id="aws-managed-cmk">AWS managed keys</h3>
      <p><em>AWS managed keys</em> are KMS keys in your account
        that are created, managed, and used on your behalf by an <a href="https://aws.amazon.com/kms/features/#AWS_Service_Integration" rel="noopener noreferrer" target="_blank"><span>AWS service integrated with AWS KMS</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
      <p>Some AWS services let you choose an AWS managed key or a customer managed key to protect your
        resources in that service. In general, unless you are required to control the encryption key
        that protects your resources, an AWS managed key is a good choice. You don't have to
        create or maintain the key or its key policy, and there's never a monthly fee for an
        AWS managed key.</p>     
      <p>You have permission to <a href="./viewing-keys.html">view the AWS managed keys</a>
        in your account, <a href="./key-policy-viewing.html">view their key policies</a>, and
          <a href="./logging-using-cloudtrail.html">audit their use</a> in AWS CloudTrail logs. However,
        you cannot change any properties of AWS managed keys, rotate them, change their key
        policies, or schedule them for deletion. And, you cannot use AWS managed keys in
        cryptographic operations directly; the service that creates them uses them on your behalf. </p>
      <p>AWS managed keys appear on the <b>AWS managed keys</b> page of the
        AWS Management Console for AWS KMS. You can also identify AWS managed keys by their aliases, which have
        the format <code class="code">aws/<code class="replaceable">service-name</code></code>, such as
          <code class="code">aws/redshift</code>. To definitively identify an AWS managed keys, use the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_DescribeKey.html">DescribeKey</a> operation. For
        AWS managed keys, the value of the <code class="code">KeyManager</code> field of the
          <code class="code">DescribeKey</code> response is <code class="code">AWS</code>.</p>
      <p>All AWS managed keys are automatically rotated every year. You cannot change this
        rotation schedule.</p>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>In May 2022, AWS KMS changed the rotation schedule for
 AWS managed keys from every three years (approximately 1,095 days) to
 every year (approximately 365 days).</p><p>New AWS managed keys are automatically rotated one year after they
are created, and approximately every year thereafter. </p><p>Existing AWS managed keys are automatically rotated one year after
their most recent rotation, and every year thereafter.</p></div></div>
      <p>There is no monthly fee for AWS managed keys. They can be subject to fees for use in
        excess of the free tier, but some AWS services cover these costs for you. For details, see
        the <em>Encryption at Rest</em> topic in the user guide or
        developer guide for the service. For details, see <a href="https://aws.amazon.com/kms/pricing/" rel="noopener noreferrer" target="_blank"><span>AWS Key Management Service
          Pricing</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
      <p>AWS managed keys do not count against resource quotas on the number of KMS keys in
        each Region of your account. But when used on behalf of a principal in your account, the
        KMS keys count against request quotas. For details, see <a href="./limits.html">Quotas</a>.</p>
     

     
      <h3 id="aws-owned-cmk">AWS owned keys</h3>
      <p><em>AWS owned keys</em> are a collection of KMS keys that
        an AWS service owns and manages for use in multiple AWS accounts. Although
        AWS owned keys are not in your AWS account, an AWS service can use an AWS owned key to protect the resources in your account.</p>
      <p>Some AWS services let you choose an AWS owned key or a customer managed key. In general,
        unless you are required to audit or control the encryption key that protects your resources,
        an AWS owned key is a good choice. AWS owned keys are completely free of charge (no
        monthly fees or usage fees), they do not count against the <a href="./limits.html">AWS KMS
          quotas</a> for your account, and they're easy to use. You don't need to create or
        maintain the key or its key policy.</p>
      <p>The rotation of AWS owned keys varies across services. For information about the
        rotation of a particular AWS owned key, see the <em>Encryption at
          Rest</em> topic in the user guide or developer guide for the service.</p>
     
   
    <h2 id="symmetric-cmks">Symmetric encryption KMS keys</h2>
    <p>When you create an AWS KMS key, by default, you get a KMS key for symmetric
      encryption. This is the basic and most commonly used type of KMS key. </p>
    <p>In AWS KMS, a <em>symmetric encryption KMS key</em> represents a 256-bit AES-GCM
      encryption key, except in China Regions, where it represents a 128-bit SM4 encryption key. Symmetric 
      key material never leaves AWS KMS unencrypted. To use a symmetric encryption KMS key, you must
      call AWS KMS. Symmetric encryption keys are used in symmetric encryption, where the same key is used
      for encryption and decryption. Unless your task explicitly requires asymmetric encryption,
      symmetric encryption KMS keys, which never leave AWS KMS unencrypted, are a good choice.</p>
    <p><a href="https://aws.amazon.com/kms/features/#AWS_Service_Integration" rel="noopener noreferrer" target="_blank"><span>AWS services that
          are integrated with AWS KMS</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> use only symmetric encryption KMS keys to encrypt your data. These services do not support encryption with asymmetric KMS keys. For help determining whether a KMS key is symmetric or asymmetric, see <a href="./find-symm-asymm.html">Identifying asymmetric KMS keys</a>.</p>
    <p>Technically, the key spec for a symmetric key is SYMMETRIC_DEFAULT, the key usage is
      ENCRYPT_DECRYPT, and the encryption algorithm is SYMMETRIC_DEFAULT. For details, see <a href="./asymmetric-key-specs.html#key-spec-symmetric-default">SYMMETRIC_DEFAULT key spec</a>.</p>
    <p>You can use a symmetric encryption KMS key in AWS KMS to encrypt, decrypt, and re-encrypt
      data, and generate data keys and data key pairs. You can create <a href="./multi-region-keys-overview.html">multi-Region</a> symmetric encryption KMS keys,
        <a href="./importing-keys.html">import your own key material</a> into a symmetric
      encryption KMS key, and create symmetric encryption KMS keys in <a href="./custom-key-store-overview.html">custom key stores</a>. For a table comparing the
      operations that you can perform on KMS keys of different types, see <a href="./symm-asymm-compare.html">Key type reference</a>.</p>
   
    <h2 id="asymmetric-keys-concept">Asymmetric KMS keys</h2>
    <p>You can create asymmetric KMS keys in AWS KMS. An <em>asymmetric
        KMS key</em> represents a mathematically related public key and private key pair.
      The private key never leaves AWS KMS unencrypted. To use the private key, you must call AWS KMS.
      You can use the public key within AWS KMS by calling the AWS KMS API operations, or you can <a href="./download-public-key.html">download the public key</a> and use it outside of AWS KMS.
      You can also create <a href="./multi-region-keys-overview.html">multi-Region</a> asymmetric
      KMS keys.</p>
    <p>You can create asymmetric KMS keys that represent RSA key pairs or SM2 key pairs (China Regions only) for
      public key encryption or signing and verification, or elliptic curve key pairs for signing and
      verification. </p>
    <p>For more information about creating and using asymmetric KMS keys, see <a href="./symmetric-asymmetric.html">Asymmetric keys in AWS KMS</a>.</p>
   
    <h2 id="hmac-key-concept">HMAC KMS keys</h2>
    <p>An <em>HMAC KMS key</em> represents a symmetric key of varying
      length that is used to generate and verify hash-based message authentication codes (HMAC). The
      key material for an HMAC key never leaves AWS KMS unencrypted. To use an HMAC key, call the
        <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateMac.html"><code class="code">GenerateMac</code></a> or <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_VerifyMac.html"><code class="code">VerifyMac</code></a> API operations. </p>
    <p>You can also create <a href="./multi-region-keys-overview.html">multi-Region</a> HMAC
      KMS keys.</p>
    <p>For more information about creating and using HMAC KMS keys, see <a href="./hmac.html">HMAC keys in AWS KMS</a>.</p>
   
    <h2 id="data-keys">Data keys</h2>
    <p><em>Data keys</em> are symmetric keys you can use to encrypt
      data, including large amounts of data and other data encryption keys. Unlike symmetric <a href="#kms_keys">KMS keys</a>, which can't be downloaded, data keys are returned to
      you for use outside of AWS KMS. </p>
    <p>When AWS KMS generates data keys, it returns a plaintext data key for immediate use
      (optional) and an encrypted copy of the data key that you can safely store with the data. When
      you are ready to decrypt the data, you first ask AWS KMS to decrypt the encrypted data key. </p>
    <p>AWS KMS generates, encrypts, and decrypts data keys. However, AWS KMS does not store, manage,
      or track your data keys, or perform cryptographic operations with data keys. You must use and
      manage data keys outside of AWS KMS. For help using the data keys securely, see the <a href="https://docs.aws.amazon.com/encryption-sdk/latest/developer-guide/">AWS Encryption SDK</a>.</p>


     
      <h3 id="data-keys-create">Create a data key</h3>
      <p>To create a data key, call the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateDataKey.html">GenerateDataKey</a> operation. AWS KMS generates the data key. Then it encrypts a copy
        of the data key under a <a href="#symmetric-cmks">symmetric encryption KMS key</a>
        that you specify. The operation returns a plaintext copy of the data key and the copy of the
        data key encrypted under the KMS key. The following image shows this operation.</p>
      <div class="mediaobject">
         
          <img src="/images/kms/latest/developerguide/images/generate-data-key.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;          Generate a data key&#xA;        " />
         
         
      </div>
      <p>AWS KMS also supports the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateDataKeyWithoutPlaintext.html">GenerateDataKeyWithoutPlaintext</a> operation, which returns only an encrypted data
        key. When you need to use the data key, ask AWS KMS to <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_Decrypt.html">decrypt</a> it.</p>
     

     
      <h3 id="data-keys-encrypt">Encrypt data with a data key</h3>
      <p>AWS KMS cannot use a data key to encrypt data. But you can use the data key outside of
        AWS KMS, such as by using OpenSSL or a cryptographic library like the <a href="https://docs.aws.amazon.com/encryption-sdk/latest/developer-guide/">AWS Encryption SDK</a>.</p>
      <p>After using the plaintext data key to encrypt data, remove it from memory as soon as
        possible. You can safely store the encrypted data key with the encrypted data so it is
        available to decrypt the data.</p>
      <div class="mediaobject">
         
          <img src="/images/kms/latest/developerguide/images/encrypt-with-data-key.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;          Encrypt user data outside of AWS KMS&#xA;        " />
         
         
      </div>
     


     
      <h3 id="data-keys-decrypt">Decrypt data with a data key</h3>
      <p>To decrypt your data, pass the encrypted data key to the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_Decrypt.html">Decrypt</a> operation. AWS KMS uses your KMS key
        to decrypt the data key and then returns the plaintext data key. Use the plaintext data key
        to decrypt your data and then remove the plaintext data key from memory as soon as
        possible.</p>
      <p>The following diagram shows how to use the <code class="code">Decrypt</code> operation to decrypt an
        encrypted data key.</p>
      <div class="mediaobject">
         
          <img src="/images/kms/latest/developerguide/images/decrypt.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;          Decrypting a data key&#xA;        " />
         
         
      </div>
     
    
     
      <h3 id="unusable-kms-keys">How unusable KMS keys affect data keys</h3>
      <p>When a KMS key becomes unusable, the effect is almost immediate (subject to eventual
        consistency). The <a href="./key-state.html">key state</a> of the KMS key changes to
        reflect its new condition, and all requests to use the KMS key in <a href="#cryptographic-operations">cryptographic operations</a> fail.</p>
      <p>However, the effect on data keys encrypted by the KMS key, and on data encrypted by
        the data key, is delayed until the KMS key is used again, such as to decrypt the data
        key.</p>      
      <p>KMS keys can become unusable for a variety of reasons, including the following actions that you might perform.</p>
      <div class="itemizedlist">
         
         
         
         
         
      <ul class="itemizedlist"><li class="listitem"><p><a href="./enabling-keys.html">Disabling the KMS key</a></p></li><li class="listitem"><p><a href="./deleting-keys.html">Scheduling the KMS key for deletion</a></p></li><li class="listitem"><p><a href="./importing-keys-managing.html#importing-keys-delete-key-material">Deleting the key material</a> from a
            KMS key with imported key material, or allowing the imported key material to
            expire.</p></li><li class="listitem"><p><a href="./disconnect-keystore.html">Disconnecting the AWS CloudHSM key store</a> that hosts the
            KMS key, or <a href="./fix-keystore.html#fix-cmk-failed">deleting the key from the AWS CloudHSM
              cluster</a> that serves as key material for the KMS key.</p></li><li class="listitem">
          <p><a href="./xks-connect-disconnect.html#about-xks-disconnecting">Disconnecting the external key store</a>
            that hosts the KMS key, or any other action that interferes with encryption and
            decryption requests to the external key store proxy, including deleting the external key
            from its external key manager.</p>
        </li></ul></div>      
      <p>This effect is particularly important for the many AWS services that use data keys to
        protect the resources that the service manages. The following example uses Amazon Elastic Block Store (Amazon EBS)
        and Amazon Elastic Compute Cloud (Amazon EC2). Different AWS services use data keys in different ways. For
        details, see the Data protection section of the Security chapter for the
        AWS service.</p>
      <p>For example, consider this scenario:</p>
      <div class="orderedlist">
         
         
         
         
      <ol><li>
          <p>You <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-creating-volume.html">create an encrypted EBS
              volume</a> and specify a KMS key to protect it. Amazon EBS asks AWS KMS to use your
            KMS key to <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateDataKeyWithoutPlaintext.html">generate
              an encrypted data key</a> for the volume. Amazon EBS stores the encrypted data key with
            the volume.</p>
        </li><li>
          <p>When you attach the EBS volume to an EC2 instance, Amazon EC2 uses your KMS key to
            decrypt the EBS volume's encrypted data key. Amazon EC2 stores the plaintext data key in
            hypervisor memory and uses it to encrypt disk I/O to the EBS volume. The data key persists
            in memory as long as the EBS volume is attached to the EC2 instance.</p>
        </li><li>
          <p>You perform an action that makes the KMS key unusable. This has no
            immediate effect on the EC2 instance or the EBS volume. Amazon EC2 is using the plaintext data
            key—not the KMS key—to encrypt all disk I/O while the volume is attached
            to the instance.</p>
        </li><li>
          <p>However, when the encrypted EBS volume is detached from the EC2 instance, Amazon EBS
            removes the plaintext key from memory. The next time the encrypted EBS volume is
            attached to an EC2 instance, the attachment fails, because Amazon EBS cannot use the
            KMS key to decrypt the volume's encrypted data key. To use the EBS volume again, you
            must make the KMS key usable again.</p>
        </li></ol></div>
     
   
    <h2 id="data-key-pairs">Data key pairs</h2>
    <p><em>Data key pairs</em> are asymmetric data keys consisting of a
      mathematically-related public key and private key. They are designed for use in client-side
      encryption and decryption or signing and verification outside of AWS KMS. </p>
    <p>Unlike the data key pairs that tools like OpenSSL generate, AWS KMS protects the private key
      in each data key pair under a symmetric encryption KMS key in AWS KMS that you specify.
      However, AWS KMS does not store, manage, or track your data key pairs, or perform cryptographic
      operations with data key pairs. You must use and manage data key pairs outside of
      AWS KMS.</p>
    <p>AWS KMS supports the following types of data key pairs:</p>
    <div class="itemizedlist">
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>RSA key pairs: RSA_2048, RSA_3072, and RSA_4096</p>
      </li><li class="listitem">
        <p>Elliptic curve key pairs: ECC_NIST_P256, ECC_NIST_P384, ECC_NIST_P521, and
          ECC_SECG_P256K1</p>
      </li><li class="listitem">
        <p>SM key pairs (China Regions only): SM2</p>
      </li></ul></div>
    <p>The type of data key pair that you select usually depends on your use case or regulatory
      requirements. Most certificates require RSA keys. Elliptic curve keys are often used for
      digital signatures. ECC_SECG_P256K1 keys are commonly used for cryptocurrencies. AWS KMS recommends that you use
      ECC key pairs for signing, and use RSA key pairs for either encryption or signing, but not
      both. However, AWS KMS cannot enforce any restrictions on the use of data key pairs outside of
      AWS KMS.</p>

     
      <h3 id="data-keys-pairs-create">Create a data key pair</h3>
      <p>To create a data key pair, call the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateDataKeyPair.html">GenerateDataKeyPair</a> or <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateDataKeyPairWithoutPlaintext.html">GenerateDataKeyPairWithoutPlaintext</a> operations. Specify the <a href="#symmetric-cmks">symmetric encryption KMS key</a> you want to use to encrypt
        the private key.</p>
      <p><code class="code">GenerateDataKeyPair</code> returns a plaintext public key, a plaintext private
        key, and an encrypted private key. Use this operation when you need a plaintext private key
        immediately, such as to generate a digital signature.</p>
      <p><code class="code">GenerateDataKeyPairWithoutPlaintext</code> returns a plaintext public key and an
        encrypted private key, but not a plaintext private key. Use this operation when you don't
        need a plaintext private key immediately, such as when you're encrypting with a public key.
        Later, when you need a plaintext private key to decrypt the data, you can call the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_Decrypt.html">Decrypt</a> operation.</p>
      <p>The following image shows the <code class="code">GenerateDataKeyPair</code> operation. The
        <code class="code">GenerateDataKeyPairWithoutPlaintext</code> operation omits the plaintext private
        key.</p>
      <div class="mediaobject">
         
          <img src="/images/kms/latest/developerguide/images/generate-data-key-pair.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;          Generate a data key pair&#xA;        " />
         
         
      </div>
     

     
      <h3 id="data-key-pairs-encrypt">Encrypt data with a data key pair</h3>
      <p>When you encrypt with a data key pair, you use the public key of the pair to encrypt the
        data and the private key of the same pair to decrypt the data. Typically, you use data key
        pairs when many parties need to encrypt data that only the party with the private key can
        decrypt.</p>
      <p>The parties with the public key use that key to encrypt data, as shown in the following
        diagram.</p>
      <div class="mediaobject">
         
          <img src="/images/kms/latest/developerguide/images/encrypt-with-data-key-pair.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;          Encrypt user data with the public key of a data key pair outside of AWS KMS&#xA;        " />
         
         
      </div>
     


     
      <h3 id="data-key-pairs-decrypt">Decrypt data with a data key pair</h3>
      <p>To decrypt your data, use the private key in the data key pair. For the operation to
        succeed, the public and private keys must be from the same data key pair, and you must use
        the same encryption algorithm.</p>
      <p>To decrypt the encrypted private key, pass it to the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_Decrypt.html">Decrypt</a> operation. Use the plaintext private
        key to decrypt the data. Then remove the plaintext private key from memory as soon as
        possible.</p>
      <p>The following diagram shows how to use the private key in a data key pair to decrypt
        ciphertext.</p>
      <div class="mediaobject">
         
          <img src="/images/kms/latest/developerguide/images/decrypt-with-data-key-pair.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;          Decrypt the data with the private key in a data key pair outside of&#xA;            AWS KMS.&#xA;        " />
         
         
      </div>
     

     
      <h3 id="data-key-pairs-sign">Sign messages with a data key pair</h3>
      <p>To generate a cryptographic signature for a message, use the private key in the data key
        pair. Anyone with the public key can use it to verify that the message was signed with your
        private key and that it has not changed since it was signed.</p>
      <p>If you encrypt your private key, pass the encrypted private key to the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_Decrypt.html">Decrypt</a> operation. AWS KMS uses your KMS key
        to decrypt the data key and then it returns the plaintext private key. Use the plaintext
        private key to generate the signature. Then remove the plaintext private key from memory as
        soon as possible.</p>
      <p>To sign a message, create a message digest using a cryptographic hash function, such as
        the <a href="https://www.openssl.org/docs/man1.0.2/man1/openssl-dgst.html" rel="noopener noreferrer" target="_blank"><span><code class="code">dgst</code></span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> command in OpenSSL. Then, pass your plaintext private key to
        the signing algorithm. The result is a signature that represents the contents of the
        message. (You might be able to sign shorter messages without first creating a digest. The
        maximum message size varies with the signing tool you use.)</p>
      <p>The following diagram shows how to use the private key in a data key pair to sign a
        message.</p>
      <div class="mediaobject">
         
          <img src="/images/kms/latest/developerguide/images/sign-with-data-key-pair.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;          Generate a cryptographic signature with the private key in a data key pair outside&#xA;            of AWS KMS.&#xA;        " />
         
         
      </div>
     


     
      <h3 id="data-key-pairs-verify">Verify a signature with a data key pair</h3>
      <p>Anyone who has the public key in your data key pair can use it to verify the signature
        that you generated with your private key. Verification confirms that an authorized user
        signed the message with the specified private key and signing algorithm, and the message
        hasn't changed since it was signed. </p>
      <p>To be successful, the party verifying the signature must generate the same type of
        digest, use the same algorithm, and use the public key that corresponds to the private key
        used to sign the message.</p>
      <p>The following diagram shows how to use the public key in a data key pair to verify a
        message signature.</p>
      <div class="mediaobject">
         
          <img src="/images/kms/latest/developerguide/images/verify-with-data-key-pair.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;          Verify a cryptographic signature with the public key in a data key pair outside of&#xA;            AWS KMS.&#xA;        " />
         
         
      </div>
     
    
    
    
    
    
   
    <h2 id="alias-concept">Aliases</h2>
    <p>Use an <em>alias</em> as a friendly name for a KMS key. For
      example, you can refer to a KMS key as <em>test-key</em> instead
      of 1234abcd-12ab-34cd-56ef-1234567890ab.  </p>
    <p>Aliases make it easier to identify a KMS key in the AWS Management Console. You can use an alias to
      identify a KMS key in some AWS KMS operations, including <a href="#cryptographic-operations">cryptographic operations</a>. In applications, you can
      use a single alias to refer to different KMS keys in each AWS Region.</p>
    <p>You can also allow and deny access to KMS keys based on their aliases without editing
      policies or managing grants. This feature is part of AWS KMS support for attribute-based access
      control (ABAC). For details, see <a href="./abac.html">ABAC for AWS KMS</a>.</p>
    <p>In AWS KMS, aliases are independent resources, not properties of a KMS key. As such, you
      can add, change, and delete an alias without affecting the associated KMS key.</p>
    <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>Do not include confidential or sensitive information in an alias name. Aliases may
        appear in plaintext in CloudTrail logs and other output.</p></div></div>
    <p><b>Learn more:</b></p>
    <div class="itemizedlist">
       
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>For detailed information about aliases, see <a href="./kms-alias.html">Using aliases</a>. </p>
      </li><li class="listitem">
        <p>For information about the formats of key identifiers, including aliases, see <a href="#key-id">Key identifiers (KeyId)</a>.</p>
      </li><li class="listitem">
        <p>For help finding the aliases associated with a KMS key, see <a href="./find-cmk-alias.html">Finding the alias name and alias ARN</a></p>
      </li><li class="listitem">
        <p>For examples of creating and managing aliases in multiple programming languages, see
            <a href="./programming-aliases.html">Working with aliases</a>.</p>
      </li></ul></div>
   
    <h2 id="keystore-concept">Custom key stores</h2>
    <p>A <em>custom key store</em> is an AWS KMS resource backed by a key
      manager outside of AWS KMS that you own and manage. When you use a KMS key in a custom key
      store for a cryptographic operation, the cryptographic operation is actually performed in your
      key manager using its cryptographic keys. </p>
    <p>AWS KMS supports AWS CloudHSM key stores backed by an AWS CloudHSM cluster and external key stores that
      are backed by an external key manager outside of AWS.</p>
    <p>For more information, see <a href="./custom-key-store-overview.html">Custom key stores</a>.</p>
   
    <h2 id="cryptographic-operations">Cryptographic operations</h2>
    <p>In AWS KMS, <em>cryptographic operations</em> are API operations
      that use KMS keys to protect data. Because KMS keys remain within AWS KMS, you must call
      AWS KMS to use a KMS key in a cryptographic operation. </p>
    <p>To perform cryptographic operations with KMS keys, use the AWS SDKs, AWS Command Line Interface
      (AWS CLI), or the AWS Tools for PowerShell. You cannot perform cryptographic operations in the AWS KMS
      console. For examples of calling the cryptographic operations in several programming
      languages, see <a href="./programming-top.html">Programming the AWS KMS API</a>.</p>
    <p>The following table lists the AWS KMS cryptographic operations. It also shows the key type
      and <a href="#key-usage">key usage</a> requirements for KMS keys used in the
      operation.</p>

    <div class="table-container"><div class="table-contents"><table id="w261aab5c39c25b9"><thead>
          <tr>
            <th>Operation</th>
            <th>Key type</th>
            <th>Key usage</th>
          </tr>
        </thead>
          <tr>
            <td><a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_Decrypt.html">Decrypt</a></td>
            <td>Symmetric or asymmetric</td>
            <td><code class="code">ENCRYPT_DECRYPT</code></td>
          </tr>
          <tr>
            <td><a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_Encrypt.html">Encrypt</a></td>
            <td>Symmetric or asymmetric</td>
            <td><code class="code">ENCRYPT_DECRYPT</code></td>
          </tr>
          <tr>
            <td><a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateDataKey.html">GenerateDataKey</a></td>
            <td>Symmetric </td>
            <td><code class="code">ENCRYPT_DECRYPT</code></td>
          </tr>
          <tr>
            <td><a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateDataKeyPair.html">GenerateDataKeyPair</a></td>
            <td>Symmetric [1]<p>Not supported on KMS keys in custom key
              stores.</p></td>
            <td><code class="code">ENCRYPT_DECRYPT</code></td>
          </tr>
          <tr>
            <td><a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateDataKeyPairWithoutPlaintext.html">GenerateDataKeyPairWithoutPlaintext</a></td>
            <td>Symmetric [1]<p>Not supported on KMS keys in custom key
              stores.</p></td>
            <td><code class="code">ENCRYPT_DECRYPT</code></td>
          </tr>
          <tr>
            <td><a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateDataKeyWithoutPlaintext.html">GenerateDataKeyWithoutPlaintext</a></td>
            <td>Symmetric</td>
            <td><code class="code">ENCRYPT_DECRYPT</code></td>
          </tr>
          <tr>
            <td><a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateMac.html">GenerateMac</a></td>
            <td>HMAC</td>
            <td><code class="code">GENERATE_VERIFY_MAC</code></td>
          </tr>
          <tr>
            <td><a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateRandom.html">GenerateRandom</a></td>
            <td>N/A. This operation doesn't use a KMS key.</td>
            <td>N/A</td>
          </tr>
          <tr>
            <td><a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_ReEncrypt.html">ReEncrypt</a></td>
            <td>Symmetric or asymmetric</td>
            <td><code class="code">ENCRYPT_DECRYPT</code></td>
          </tr>
          <tr>
            <td><a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_Sign.html">Sign</a></td>
            <td>Asymmetric</td>
            <td><code class="code">SIGN_VERIFY</code></td>
          </tr>
          <tr>
            <td><a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_Verify.html">Verify</a></td>
            <td>Asymmetric</td>
            <td><code class="code">SIGN_VERIFY</code></td>
          </tr>
          <tr>
            <td><a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_VerifyMac.html">VerifyMac</a></td>
            <td>HMAC</td>
            <td><code class="code">GENERATE_VERIFY_MAC</code></td>
          </tr>
        </table></div></div>
    <p>[1] Generates an asymmetric data key pair that is protected by a symmetric encryption KMS key.</p>

    <p>For information about the permissions for cryptographic operations, see the <a href="./kms-api-permissions-reference.html">AWS KMS permissions</a>. </p>
    <p>To make AWS KMS responsive and highly functional for all users, AWS KMS establishes quotas on
      number of cryptographic operations called in each second. For details, see <a href="./requests-per-second.html#rps-shared-limit">Shared quotas for cryptographic operations</a>. </p>
   
    <h2 id="key-id">Key identifiers (KeyId)</h2>
    <p>Key identifiers act like names for your KMS keys. They help you to recognize your
      KMS keys in the console. You use them to indicate which KMS keys you want to use in AWS KMS
      API operations, key policies, IAM policies, and grants. The key identifier values are
      completely unrelated to the key material associated with the KMS key.</p>
    <p>AWS KMS defines several key identifiers. When you create a KMS key, AWS KMS generates a key ARN
      and key ID, which are properties of the KMS key. When you create an <a href="./kms-alias.html">alias</a>, AWS KMS generates an
      alias ARN based on the alias name that you define. You can view the key and alias identifiers
      in the AWS Management Console and in the AWS KMS API. </p>
    <p>In the AWS KMS console, you can view and filter KMS keys by their key ARN, key ID, or alias
      name, and sort by key ID and alias name. For help finding the key identifiers in the console,
      see <a href="./find-cmk-id-arn.html">Finding the key ID and key ARN</a>.</p>
    <p>In the AWS KMS API, the parameters you use to identify a KMS key are named
        <code class="code">KeyId</code> or a variation, such as <code class="code">TargetKeyId</code> or
        <code class="code">DestinationKeyId</code>. However, the values of those parameters are not limited to
      key IDs. Some can take any valid key identifier. For information about the values for each
      parameter, see the parameter description in the AWS Key Management Service API Reference.</p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>When using the AWS KMS API, be careful about the key identifier that you use. Different
        APIs require different key identifiers. In general, use the most complete and practical key
        identifier for your task.</p></div></div>
    <p>AWS KMS supports the following key identifiers.</p>
    <div class="variablelist">
       
    <dl>
        <dt><a id="key-id-key-ARN"></a><b><span class="term">Key ARN</span></b></dt>
        <dd>
          <p>The key ARN is the Amazon Resource Name (ARN) of a KMS key. It is a unique, fully
            qualified identifier for the KMS key. A key ARN includes the AWS account, Region,
            and the key ID. For help finding the key ARN of a KMS key, see <a href="./find-cmk-id-arn.html">Finding the key ID and key ARN</a>.</p>
          <p>The format of a key ARN is as follows:</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">arn:<code class="replaceable">&lt;partition&gt;</code>:kms:<code class="replaceable">&lt;region&gt;</code>:<code class="replaceable">&lt;account-id&gt;</code>:key/<code class="replaceable">&lt;key-id&gt;</code></code></pre>
          <p>The following is an example key ARN for a single-Region KMS key.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight ">arn:aws:kms:us-west-2:111122223333:key/1234abcd-12ab-34cd-56ef-1234567890ab</code></pre>
          <p>The <code class="replaceable">key-id</code> element of the key ARNs of <a href="./multi-region-keys-overview.html">multi-Region keys</a> begin with the
              <code class="code">mrk-</code> prefix. The following is an example key ARN for a multi-Region
            key.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight ">arn:aws:kms:us-west-2:111122223333:key/mrk-1234abcd12ab34cd56ef1234567890ab</code></pre>
        </dd>
      </dl></div>
    <div class="variablelist">
       
       
       
    <dl>
        <dt><a id="key-id-key-id"></a><b><span class="term">Key ID</span></b></dt>
        <dd>
          <p>The key ID uniquely identifies a KMS key within an account and Region. For help
            finding the key ID of a KMS key, see <a href="./find-cmk-id-arn.html">Finding the key ID and key ARN</a>.</p>
          <p>The following is an example key ID for a single-Region KMS key.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight ">1234abcd-12ab-34cd-56ef-1234567890ab</code></pre>
          <p>The key IDs of <a href="./multi-region-keys-overview.html">multi-Region keys</a>
            begin with the <code class="code">mrk-</code> prefix. The following is an example key ID for a
            multi-Region key.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight ">mrk-1234abcd12ab34cd56ef1234567890ab</code></pre>
        </dd>
      
        <dt><a id="key-id-alias-ARN"></a><b><span class="term">Alias ARN</span></b></dt>
        <dd>
          <p>The alias ARN is the Amazon Resource Name (ARN) of an AWS KMS alias. It is a unique,
            fully qualified identifier for the alias, and for the KMS key it represents. An alias
            ARN includes the AWS account, Region, and the alias name.</p>
          <p>At any given time, an alias ARN identifies one particular KMS key. However,
            because you can change the KMS key associated with the alias, the alias ARN can
            identify different KMS keys at different times. For help finding the alias ARN of a
            KMS key, see <a href="./find-cmk-alias.html">Finding the alias name and alias ARN</a>.</p>
          <p>The format of an alias ARN is as follows:</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">arn:<code class="replaceable">&lt;partition&gt;</code>:kms:<code class="replaceable">&lt;region&gt;</code>:<code class="replaceable">&lt;account-id&gt;</code>:alias/<code class="replaceable">&lt;alias-name&gt;</code></code></pre>
          <p>The following is the alias ARN for a fictitious <code class="code">ExampleAlias</code>.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight ">arn:aws:kms:us-west-2:111122223333:alias/ExampleAlias</code></pre>
        </dd>
      
        <dt><a id="key-id-alias-name"></a><b><span class="term">Alias name</span></b></dt>
        <dd>
          <p>The alias name is a string of up to 256 characters. It uniquely identifies an
            associated KMS key within an account and Region. In the AWS KMS API, alias names always
            begin with <code class="code">alias/</code>. For help finding the alias name of a KMS key, see
              <a href="./find-cmk-alias.html">Finding the alias name and alias ARN</a>.</p>
          <p>The format of an alias name is as follows:</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">alias/<code class="replaceable">&lt;alias-name&gt;</code></code></pre>
          <p>For example:</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight ">alias/ExampleAlias</code></pre>
          <p>The <code class="code">aws/</code> prefix for an alias name is reserved for <a href="#aws-managed-cmk">AWS managed keys</a>. You cannot create an alias with
            this prefix. For example, the alias name of the AWS managed key for Amazon Simple Storage Service (Amazon S3) is
            the following.</p>
          <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight ">alias/aws/s3</code></pre>
        </dd>
      </dl></div>
   
    <h2 id="key-material">Key material</h2>
    <p><em>Key material</em> is the string of bits used in a
      cryptographic algorithm. Secret key material must be kept secret to protect the cryptographic
      operations that use it. Public key material is designed to be shared.</p>
    <p>Each KMS key includes a reference to its key material in its metadata. The <a href="#key-origin">key material origin</a> of symmetric encryption KMS keys can vary.
      You can use key material that AWS KMS generates, key material that is generated in the AWS CloudHSM
      cluster of a <a href="./custom-key-store-overview.html">custom key store</a>, or <a href="./importing-keys.html">import your own key material</a>. If you use AWS KMS key material
      for your symmetric encryption KMS key, you can enable <a href="./rotate-keys.html">automatic
        rotation</a> of your key material.</p>
    <p>By default, each KMS key has unique key material. However, you can create a set of <a href="./multi-region-keys-overview.html">multi-Region keys</a> with the same key
      material.</p>
   
    <h2 id="key-origin">Key material origin</h2>
    <p><em>Key material origin</em> is a KMS key property that
      identifies the source of the key material in the KMS key. You choose the key material origin
      when you create the KMS key, and you cannot change it. The source of the key material
      affects the security, durability, availability, latency, and throughput characteristics of the
      KMS key. </p>
    <p>To find the key material origin of a KMS key, use the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_DescribeKey.html">DescribeKey</a> operation, or see the
        <b>Origin</b> value on the <b>Cryptographic configuration</b>
      tab of the detail page for a KMS key in the AWS KMS console. For help, see <a href="./viewing-keys.html">Viewing Keys</a>. </p>
    <p>The key origin for asymmetric KMS keys and HMAC KMS keys is always
        <code class="code">AWS_KMS</code>, which indicates that AWS KMS generated it.</p>
    <p>Symmetric encryption KMS keys can have one of the following key material origin
      values.</p>
    <div class="variablelist">
       
       
       
       
    <dl>
        <dt><b><span class="term"><code class="code">AWS_KMS</code></span></b></dt>
        <dd>
          <p>AWS KMS creates and manages the key material for the KMS key in its own key store.
            This is the default and the recommended value for most KMS keys.</p>
          <p>For help creating keys with key material from AWS KMS, see <a href="./create-keys.html">Creating keys</a>.</p>
        </dd>
      
        <dt><b><span class="term"><code class="code">EXTERNAL (Import key material)</code></span></b></dt>
        <dd>
          <p>The KMS key has <a href="./importing-keys.html">imported key material</a>. When
            you create a KMS key with an <code class="code">External</code> key material origin, the KMS key
            has no key material. Later, you can import key material into the KMS key. When you use
            imported key material, you need to secure and manage that key material outside of AWS KMS,
            including replacing the key material if it expires. For details, see <a href="./importing-keys-conceptual.html#importing-keys-considerations">About imported key material</a>.</p>
          <p>For help creating a KMS key for imported key material, see <a href="./importing-keys-create-cmk.html">Step 1: Create a KMS key with no key
      material</a>.</p>
        </dd>
      
        <dt><b><span class="term"><code class="code">AWS_CLOUDHSM</code></span></b></dt>
        <dd>
          <p>AWS KMS creates the key material in the AWS CloudHSM cluster for your <a href="./custom-key-store-overview.html">AWS CloudHSM key store</a>.</p>
          <p>For help creating a KMS key in an AWS CloudHSM key store, see <a href="./create-cmk-keystore.html">Creating KMS keys in an AWS CloudHSM key store</a>.</p>
        </dd>
      
        <dt><b><span class="term"><code class="code">EXTERNAL_KEY_STORE</code></span></b></dt>
        <dd>
          <p>The key material is a cryptographic key in an external key manager outside of AWS.
            This origin is supported only for KMS keys in an <a href="./keystore-external.html">external key store</a>.</p>
          <p>For help creating a KMS key in an external key store, see <a href="./create-xks-keys.html">Creating KMS keys in an external key store</a>.</p>
        </dd>
      </dl></div>
   
    <h2 id="key-spec">Key spec</h2>
    <p><em>Key spec</em> is a property that represents the
      cryptographic configuration of a key. The meaning of the key spec differs with the key
      type.</p>
    <div class="itemizedlist">
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p><a href="#kms_keys">AWS KMS keys</a> — The <em>key
            spec</em> determines whether the KMS key is symmetric or asymmetric. It also
          determines the type of its key material, and the algorithms it supports. You choose the
          key spec when you <a href="./create-keys.html">create the KMS key</a>, and you cannot
          change it. The default key spec, <a href="./asymmetric-key-specs.html#key-spec-symmetric-default">SYMMETRIC_DEFAULT</a>, represents a 256-bit symmetric encryption key. </p>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The <code class="code">KeySpec</code> for a KMS key was known as a <code class="code">CustomerMasterKeySpec</code>.
            The <code class="code">CustomerMasterKeySpec</code> parameter of the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_CreateKey.html">CreateKey</a> operation is deprecated.
            Instead, use the <code class="code">KeySpec</code> parameter, which works the same way. To prevent
            breaking changes, the response of the <code class="code">CreateKey</code> and <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_DescribeKey.html">DescribeKey</a> operations now includes
            both <code class="code">KeySpec</code> and <code class="code">CustomerMasterKeySpec</code> members with the same
            values.</p></div></div>
        <p>For a list of key specs and help with choosing a key spec, see <a href="./key-types.html#symm-asymm-choose-key-spec">Selecting the key spec</a>. To
          find the key spec of a KMS key, use the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_DescribeKey.html">DescribeKey</a> operation, or see the <b>Cryptographic
            configuration</b> tab on the detail page for a KMS key in the AWS KMS console.
          For help, see <a href="./viewing-keys.html">Viewing Keys</a>.</p>
        <p>To limit the key specs that principals can use when creating KMS keys, use the <a href="./conditions-kms.html#conditions-kms-key-spec">kms:KeySpec</a> condition key. You can also use the
            <code class="code">kms:KeySpec</code> condition key to allow principals to call AWS KMS operations only
          on KMS keys with a particular key spec. For example, you can deny permission to schedule
          deletion of any KMS key with an <code class="code">RSA_4096</code> key spec. </p>
      </li><li class="listitem">
        <p><a href="#data-keys">Data keys</a> (<a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateDataKey.html">GenerateDataKey</a>) — The
            <em>key spec</em> determines the length of an AES data key.
        </p>
      </li><li class="listitem">
        <p><a href="#data-key-pairs">Data keys pairs</a> (<a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateDataKeyPair.html">GenerateDataKeyPair</a>) —
          The <em>key pair spec</em> determines the type of key material
          in the data key pair.</p>
      </li></ul></div>
   
    <h2 id="key-usage">Key usage</h2>
    <p><em>Key usage</em> is a property that determines the
      cryptographic operations the key supports. KMS keys can have a key usage of
        <code class="code">ENCRYPT_DECRYPT</code>, <code class="code">SIGN_VERIFY</code>, or <code class="code">GENERATE_VERIFY_MAC</code>.
      Each KMS key can have only one key usage. Using a KMS key for more than one type of
      operation makes the product of both operations more vulnerable to attack.</p>
    <p>For help choosing the key usage for your KMS key, see <a href="./key-types.html#symm-asymm-choose-key-usage">Selecting the key usage</a>. To find
      the key usage of a KMS key, use the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_DescribeKey.html">DescribeKey</a> operation, or choose the <b>Cryptographic
        configuration</b> tab on the detail page for a KMS key in the AWS KMS console. For
      help, see <a href="./viewing-keys.html">Viewing Keys</a>. </p>
   
    <h2 id="enveloping">Envelope encryption</h2>
    <p>When you encrypt your data, your data is protected, but you have to protect your
      encryption key. One strategy is to encrypt it. <em>Envelope
        encryption</em> is the practice of encrypting plaintext data with a data key, and then
      encrypting the data key under another key.</p>
    <p>You can even encrypt the data encryption key under another encryption key, and encrypt
      that encryption key under another encryption key. But, eventually, one key must remain in
      plaintext so you can decrypt the keys and your data. This top-level plaintext key encryption
      key is known as the <em>root key</em>.</p>
    <div class="mediaobject">
       
        <img src="/images/kms/latest/developerguide/images/key-hierarchy-root.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;        Envelope encryption&#xA;      " />
       
       
    </div>
    <p>AWS KMS helps you to protect your encryption keys by storing and managing them securely.
      Root keys stored in AWS KMS, known as <a href="#kms_keys">AWS KMS keys</a>, never
      leave the AWS KMS <a href="https://csrc.nist.gov/projects/cryptographic-module-validation-program/certificate/4177" rel="noopener noreferrer" target="_blank"><span>FIPS validated hardware security modules</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> unencrypted. To use a KMS key, you must
      call AWS KMS.</p>
    <div class="mediaobject">
       
        <img src="/images/kms/latest/developerguide/images/key-hierarchy-kms-key.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;        Envelope encryption with multiple key encryption keys&#xA;      " />
       
       
    </div>



  <p>Envelope encryption offers several benefits:</p><div class="itemizedlist">
     
     
     
  <ul class="itemizedlist"><li class="listitem">
      <p><b>Protecting data keys</b></p>
      <p>When you encrypt a data key, you don't have to worry about storing the encrypted data
        key, because the data key is inherently protected by encryption. You can safely store the
        encrypted data key alongside the encrypted data.</p>
    </li><li class="listitem">
      <p><b>Encrypting the same data under multiple keys</b></p>
      <p>Encryption operations can be time consuming, particularly when the data being encrypted
        are large objects. Instead of re-encrypting raw data multiple times with different keys, you
        can re-encrypt only the data keys that protect the raw data.</p>
    </li><li class="listitem">
      <p><b>Combining the strengths of multiple algorithms</b></p>
      <p>In general, symmetric key algorithms are faster and produce smaller ciphertexts than
        public key algorithms. But public key algorithms provide inherent separation of roles and
        easier key management. Envelope encryption lets you combine the strengths of each
        strategy.</p>
    </li></ul></div>
    <h2 id="encrypt_context">Encryption context</h2>
    <p>All AWS KMS <a href="#cryptographic-operations">cryptographic operations</a> with
        <a href="#symmetric-cmks">symmetric encryption KMS keys</a> accept an <em>encryption context</em>, an optional set of non-secret key–value
      pairs that can contain additional contextual information about the data. AWS KMS uses the
      encryption context as <a href="https://docs.aws.amazon.com/crypto/latest/userguide/cryptography-concepts.html#term-aad">additional authenticated data</a> (AAD) to support <a href="https://docs.aws.amazon.com/crypto/latest/userguide/cryptography-concepts.html#define-authenticated-encryption">authenticated encryption</a>. </p>
    <p>When you include an encryption context in an encryption request, it is cryptographically
      bound to the ciphertext such that the same encryption context is required to decrypt (or
      decrypt and re-encrypt) the data. If the encryption context provided in the decryption request
      is not an exact, case-sensitive match, the decrypt request fails. Only the order of the
      key-value pairs in the encryption context can vary.</p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You cannot specify an encryption context in a cryptographic operation with an <a href="./symmetric-asymmetric.html#asymmetric-cmks">asymmetric KMS key</a> or an <a href="./hmac.html">HMAC KMS key</a>. Asymmetric algorithms and MAC algorithms do not support an encryption context.</p></div></div>
    <p>The encryption context is not secret and not encrypted. It appears in plaintext in <a href="./logging-using-cloudtrail.html">AWS CloudTrail Logs</a> so you can use it to identify and
      categorize your cryptographic operations. Your encryption context should not include sensitive
      information. We recommend that your encryption context describe the data being encrypted or
      decrypted. For example, when you encrypt a file, you might use part of the file path as
      encryption context.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight ">"encryptionContext": <span>{</span>
    "department": "10103.0"
}    </code></pre>
    <p>For example, when encrypting volumes and snapshots created with the <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AmazonEBS.html">Amazon Elastic Block Store</a> (Amazon EBS) <a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_CreateSnapshot.html">CreateSnapshot</a> operation, Amazon EBS uses the
      volume ID as encryption context value.</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">"encryptionContext": <span>{</span>
  "aws:ebs:id": "<code class="replaceable">vol-abcde12345abc1234</code>"
}</code></pre>
    <p>You can also use the encryption context to refine or limit access to AWS KMS keys in
      your account. You can use the encryption context <a href="./grants.html">as a constraint in
        grants</a> and as a <u><a href="./policy-conditions.html">condition in policy statements</a></u>. </p>
    <p>To learn how to use encryption context to protect the integrity of encrypted data, see the
      post <a href="https://aws.amazon.com/blogs/security/how-to-protect-the-integrity-of-your-encrypted-data-by-using-aws-key-management-service-and-encryptioncontext/" rel="noopener noreferrer" target="_blank"><span>How to Protect the Integrity of Your Encrypted Data by Using AWS Key Management Service and
        EncryptionContext</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> on the AWS Security Blog.</p>
    <p>More about encryption context.</p>
    <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="Encryption context rules" id="encryption-context-rules" expanded="false"><p>AWS KMS enforces the following rules for encryption context keys and values.</p><div class="itemizedlist">
           
           
        <ul class="itemizedlist"><li class="listitem">
            <p>The key and value in an encryption context pair must be simple literal strings. If
              you use a different type, such as an integer or float, AWS KMS interprets it as a
              string.</p>
          </li><li class="listitem">
            <p>The keys and values in an encryption context can include Unicode characters. If an
              encryption context includes characters that are not permitted in key policies or IAM
              policies, you won't be able to specify the encryption context in policy condition
              keys, such as <a href="./conditions-kms.html#conditions-kms-encryption-context">kms:EncryptionContext:context-key</a> and <a href="./conditions-kms.html#conditions-kms-encryption-context-keys">kms:EncryptionContextKeys</a>. For details about key policy document rules, see <a href="./key-policy-overview.html#key-policy-format">Key policy format</a>. For details about IAM
      policy document rules, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_iam-quotas.html#reference_iam-quotas-names">IAM name
        requirements</a> in the <em>IAM User Guide</em>.</p>
          </li></ul></div></awsui-expandable-section><awsui-expandable-section variant="container" header="Encryption context in policies" id="encryption-context-authorization" expanded="false"><p>The encryption context is used primarily to verify integrity and authenticity. But you
          can also use the encryption context to control access to symmetric encryption
          AWS KMS keys in key policies and IAM policies. </p><p>The <a href="./conditions-kms.html#conditions-kms-encryption-context">kms:EncryptionContext:</a>
          and <a href="./conditions-kms.html#conditions-kms-encryption-context">kms:EncryptionContextKeys</a>
          condition keys allow (or deny) a permission only when the request includes particular
          encryption context keys or key–value pairs. </p><p>For example, the following key policy statement allows the
            <code class="code">RoleForExampleApp</code> role to use the KMS key in <code class="code">Decrypt</code>
          operations. It uses the <code class="code">kms:EncryptionContext:<em>context-key</em></code> condition key to allow this
          permission only when the encryption context in the request includes an
            <code class="code">AppName:ExampleApp</code> encryption context pair.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Effect": "Allow",
  "Principal": <span>{</span>
    "AWS": "arn:aws:iam::111122223333:role/RoleForExampleApp"
  },
  "Action": "kms:Decrypt",
  "Resource": "*",
  "Condition": <span>{</span>
    "StringEquals": <span>{</span>
      "<b>kms:EncryptionContext:</b>AppName": "ExampleApp"
    }
  }
}</code></pre><p>For more information about these encryption context condition keys, see <a href="./policy-conditions.html">Condition keys for AWS KMS</a>.</p></awsui-expandable-section><awsui-expandable-section variant="container" header="Encryption context in grants" id="encryption-context-grants" expanded="false"><p>When you <a href="./grants.html">create a grant</a>, you can include <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GrantConstraints.html">grant constraints</a> that establish
          conditions for the grant permissions. AWS KMS supports two grant constraints,
            <code class="code">EncryptionContextEquals</code> and <code class="code">EncryptionContextSubset</code>, both of
          which involve the <a href="#encrypt_context">encryption context</a> in a request
          for a cryptographic operation. When you use these grant constraints, the permissions in
          the grant are effective only when the encryption context in the request for the
          cryptographic operation satisfies the requirements of the grant constraints. </p><p>For example, you can add an <code class="code">EncryptionContextEquals</code> grant constraint to a
          grant that allows the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GenerateDataKey.html">GenerateDataKey</a> operation. With this constraint, the grant allows the operation
          only when the encryption context in the request is a case-sensitive match for the
          encryption context in the grant constraint.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="prompt" copy="false">$ </code><code class="userinput">aws kms create-grant \
    --key-id 1234abcd-12ab-34cd-56ef-1234567890ab \
    --grantee-principal arn:aws:iam::111122223333:user/exampleUser \
    --retiring-principal arn:aws:iam::111122223333:role/adminRole \
    --operations GenerateDataKey \
<b>    --constraints EncryptionContextEquals=<span>{</span>Purpose=Test}</b>
</code></code></pre><p>A request like the following from the grantee principal would satisfy the
            <code class="code">EncryptionContextEquals</code> constraint.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="bash "><code class="userinput"><code class="prompt" copy="false">$ </code></code>aws kms generate-data-key \
    --key-id 1234abcd-12ab-34cd-56ef-1234567890ab \
    --key-spec AES_256 \
    --encryption-context Purpose=Test</code></pre><p>For details about the grant constraints, see <a href="./create-grant-overview.html#grant-constraints">Using grant constraints</a>. For detailed information about grants, see <a href="./grants.html">Grants in AWS KMS</a>.</p></awsui-expandable-section><awsui-expandable-section variant="container" header="Logging encryption context" id="encryption-context-auditing" expanded="false"><p>AWS KMS uses AWS CloudTrail to log the encryption context so you can determine which
          KMS keys and data have been accessed. The log entry shows exactly which KMS keys was
          used to encrypt or decrypt specific data referenced by the encryption context in the log
          entry.</p><div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>Because the encryption context is logged, it must not contain sensitive
            information.</p></div></div></awsui-expandable-section><awsui-expandable-section variant="container" header="Storing encryption context" id="encryption-context-storing" expanded="false"><p>To simplify use of any encryption context when you call the <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_Decrypt.html"><code class="code">Decrypt</code></a> or <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_ReEncrypt.html"><code class="code">ReEncrypt</code></a> operations, you can
          store the encryption context alongside the encrypted data. We recommend that you store
          only enough of the encryption context to help you create the full encryption context when
          you need it for encryption or decryption. </p><p>For example, if the encryption context is the fully qualified path to a file, store
          only part of that path with the encrypted file contents. Then, when you need the full
          encryption context, reconstruct it from the stored fragment. If someone tampers with the
          file, such as renaming it or moving it to a different location, the encryption context
          value changes and the decryption request fails.</p></awsui-expandable-section></div>
   
    <h2 id="key_permissions">Key policy</h2>

    <p>When you create a KMS key, you determine who can use and manage that KMS key. These
      permissions are contained in a document called the <em>key policy</em>. You can
      use the key policy to add, remove, or change permissions at any time for a customer managed keys. But
      you cannot edit the key policy for an AWS managed keys. For more information, see <a href="./key-policies.html">Key policies in AWS KMS</a>.</p>
   
    <h2 id="grant">Grant</h2>

    <p>A <em>grant</em> is a policy instrument that allows AWS principals to use
      AWS KMS keys in <a href="#cryptographic-operations">cryptographic
        operations</a>. It also can let them view a KMS key (<a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_DescribeKey.html">DescribeKey</a>) and create and manage grants.
      When authorizing access to a KMS key, grants are considered along with <a href="./key-policies.html">key policies</a> and <a href="./iam-policies.html">IAM
        policies</a>. Grants are often used for temporary permissions because you can create one,
      use its permissions, and delete it without changing your key policies or IAM policies.
      Because grants can be very specific, and are easy to create and revoke, they are often used to provide temporary permissions or more granular permissions. </p>
    <p>For detailed information about grants, including grant terminology, see <a href="./grants.html">Grants in AWS KMS</a>.</p>
   
    <h2 id="auditing_key_use">Auditing KMS key usage</h2>

    <p>You can use AWS CloudTrail to audit key usage. CloudTrail creates log files that contain a history of
      AWS API calls and related events for your account. These log files include all AWS KMS API
      requests made with the AWS Management Console, AWS SDKs, and command line tools. The log
      files also include requests to AWS KMS that AWS services make on your behalf. You can use
      these log files to find important information, including when the KMS keys was used, the
      operation that was requested, the identity of the requester, and the source IP address. For
      more information, see <a href="./logging-using-cloudtrail.html">Logging with AWS CloudTrail</a> and the <a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/">AWS CloudTrail User Guide</a>.</p>
   
    <h2 id="key_management">Key management infrastructure</h2>

    <p>A common practice in cryptography is to encrypt and decrypt with a publicly available and
      peer-reviewed algorithm such as AES (Advanced Encryption Standard) and a secret key. One of
      the main problems with cryptography is that it's very hard to keep a key secret. This is
      typically the job of a key management infrastructure (KMI). AWS KMS operates the key
      infrastructure for you. AWS KMS creates and securely stores your root keys, called <a href="#kms_keys">AWS KMS keys</a>. For more information about how AWS KMS operates,
      see <a href="https://docs.aws.amazon.com/kms/latest/cryptographic-details/">AWS Key Management Service Cryptographic Details</a>.</p>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./overview.html">AWS Key Management Service</div><div id="next" class="next-link" accesskey="n" href="./getting-started.html">Managing keys</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Key Management Service (KMS)&amp;topic_url=https://docs.aws.amazon.com/en_us/kms/latest/developerguide/concepts.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Key Management Service (KMS)&amp;topic_url=https://docs.aws.amazon.com/en_us/kms/latest/developerguide/concepts.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>