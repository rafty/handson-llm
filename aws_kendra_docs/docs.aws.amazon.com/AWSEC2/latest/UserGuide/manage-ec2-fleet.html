<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Work with EC2 Fleets - Amazon Elastic Compute Cloud</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="manage-ec2-fleet" /><meta name="default_state" content="manage-ec2-fleet" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" /><meta name="description" content="Create an EC2 Fleet that specifies the launch configuration for your On-Demand Instances and Spot Instances, including the price that you are willing to pay per unit hour." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Elastic Compute Cloud" /><meta name="guide" content="User Guide for Linux Instances" /><meta name="abstract" content="Use Amazon EC2 to configure, launch, and manage virtual servers in the AWS cloud." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" hreflang="x-default" /><meta name="feedback-item" content="EC2" /><meta name="this_doc_product" content="Amazon Elastic Compute Cloud" /><meta name="this_doc_guide" content="User Guide for Linux Instances" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'ec2'}"></script><meta id="panorama-serviceSubSection" value="User Guide for Linux Instances" /><meta id="panorama-serviceConsolePage" value="Work with EC2 Fleets" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Work with EC2 Fleets - Amazon Elastic Compute Cloud</title><meta name="pdf" content="/pdfs/AWSEC2/latest/UserGuide/ec2-ug.pdf#manage-ec2-fleet" /><meta name="github" content="https://github.com/awsdocs/amazon-ec2-user-guide/tree/master/doc_source/manage-ec2-fleet.md" /><meta name="rss" content="amazon-ec2-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=30" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=EC2&amp;topic_url=http://docs.aws.amazon.com/en_us/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/AWSEC2/latest/UserGuide/manage-ec2-fleet.html" /><meta name="keywords" content="EC2,Amazon EC2,EC2 instance,instance,VM,virtual machine" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon EC2",
        "item" : "https://docs.aws.amazon.com/ec2/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide for Linux Instances",
        "item" : "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "EC2 Fleet and Spot Fleet",
        "item" : "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Fleets.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "EC2 Fleet",
        "item" : "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-fleet.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Work with EC2 Fleets",
        "item" : "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-fleet.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/AWSEC2/latest/UserGuide/ec2-ug.pdf#manage-ec2-fleet" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/amazon-ec2-user-guide/tree/master/doc_source/manage-ec2-fleet.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/ec2/index.html">Amazon EC2</a><a href="concepts.html">User Guide for Linux Instances</a></div><div id="page-toc-src"><a href="#EC2-fleet-states">EC2 Fleet request states</a><a href="#ec2-fleet-prerequisites">EC2 Fleet prerequisites</a><a href="#ec2-fleet-health-checks">EC2 Fleet health checks</a><a href="#ec2-fleet-cli-skeleton">Generate an EC2 Fleet JSON configuration file</a><a href="#create-ec2-fleet">Create an EC2 Fleet</a><a href="#tag-ec2-fleet">Tag an EC2 Fleet</a><a href="#monitor-ec2-fleet">Describe your EC2 Fleet</a><a href="#modify-ec2-fleet">Modify an EC2 Fleet</a><a href="#delete-fleet">Delete an EC2 Fleet</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="manage-ec2-fleet">Work with EC2 Fleets</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>To start using an EC2 Fleet, you create a request that includes the total target capacity,
			On-Demand capacity, Spot capacity, one or more launch specifications for the instances,
			and the maximum price that you are willing to pay. The fleet request must include a
			launch template that defines the information that the fleet needs to launch an instance,
			such as an AMI, instance type, subnet or Availability Zone, and one or more security
			groups. You can specify launch specification overrides for the instance type, subnet,
			Availability Zone, and maximum price you're willing to pay, and you can assign weighted
			capacity to each launch specification override.</p><p>The EC2 Fleet launches On-Demand Instances when there is available capacity, and launches Spot Instances when
			your maximum price exceeds the Spot price and capacity is available.</p><p>If your fleet includes Spot Instances, Amazon EC2 can attempt to maintain your fleet target capacity
			as Spot prices change.</p><p>An EC2 Fleet request of type <code class="code">maintain</code> or <code class="code">request</code> remains active until
			it expires or you delete it. When you delete a fleet of type <code class="code">maintain</code> or
				<code class="code">request</code>, you can specify whether deletion terminates the instances in
			that fleet. Otherwise, the On-Demand Instances run until you terminate them, and the Spot Instances run until
			they are interrupted or you terminate them.</p><div class="highlights" id="inline-topiclist"><h6>Contents</h6><ul><li><a href="#EC2-fleet-states">EC2 Fleet request states</a></li><li><a href="#ec2-fleet-prerequisites">EC2 Fleet prerequisites</a></li><li><a href="#ec2-fleet-health-checks">EC2 Fleet health checks</a></li><li><a href="#ec2-fleet-cli-skeleton">Generate an EC2 Fleet JSON configuration file</a></li><li><a href="#create-ec2-fleet">Create an EC2 Fleet</a></li><li><a href="#tag-ec2-fleet">Tag an EC2 Fleet</a></li><li><a href="#monitor-ec2-fleet">Describe your EC2 Fleet</a></li><li><a href="#modify-ec2-fleet">Modify an EC2 Fleet</a></li><li><a href="#delete-fleet">Delete an EC2 Fleet</a></li></ul></div>
			<h2 id="EC2-fleet-states">EC2 Fleet request states</h2>
			<p>An EC2 Fleet request can be in one of the following states:</p>
			<div class="variablelist">
				 
					 
				 
					 
					 
					 
			<dl>
						<dt><span class="term"><code class="code">submitted</code></span></dt>
						<dd>
							<p>The EC2 Fleet request is being evaluated and Amazon EC2 is preparing to launch the target number
							of instances. The request can include On-Demand Instances, Spot Instances, or both.</p>
				</dd>
				 
						<dt><span class="term"><code class="code">active</code></span></dt>
						<dd>
					<p>The EC2 Fleet request has been validated and Amazon EC2
						is attempting to maintain the target number of running instances. The
						request remains in this state until it is modified or deleted.</p>
				</dd>
				 
					<dt><span class="term"><code class="code">modifying</code></span></dt>
					<dd>
					<p>The EC2 Fleet request is being modified. The request remains in this state until the
							modification is fully processed or the request is deleted. Only a
								<code class="code">maintain</code> fleet type can be modified. This state does
							not apply to other request types.</p>
				</dd>
				 
						<dt><span class="term"><code class="code">deleted_running</code></span></dt>
						<dd>
					<p>The EC2 Fleet request is deleted and does not launch additional instances. Its existing
							instances continue to run until they are interrupted or terminated
							manually. The request remains in this state until all instances are
							interrupted or terminated. Only an EC2 Fleet of type <code class="code">maintain</code> or
								<code class="code">request</code> can have running instances after the EC2 Fleet
							request is deleted. A deleted <code class="code">instant</code> fleet with running
							instances is not supported. This state does not apply to
								<code class="code">instant</code> fleets.</p>
				</dd>
					 
						<dt><span class="term"><code class="code">deleted_terminating</code></span></dt>
					<dd>
						<p>The EC2 Fleet request is deleted and
						its instances are terminating. The request remains in this state until all
						instances are terminated.</p>
				</dd>
					 
						<dt><span class="term"><code class="code">deleted</code></span></dt>
						<dd>
					<p>The EC2 Fleet is deleted and has no running
						instances. The request is deleted two days after its instances are
						terminated.</p>
				</dd>
					</dl></div>
			
			<p>The following illustration represents the transitions between the EC2 Fleet request
				states. If you exceed your fleet limits, the request is deleted immediately.</p>
			<div class="mediaobject">
				 
					<img src="/images/AWSEC2/latest/UserGuide/images/EC2_fleet_states.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;EC2 Fleet request states&#xA;&#x9;&#x9;&#x9;&#x9;" style="max-width:50%" />
				 
				 
			</div>
		 
			<h2 id="ec2-fleet-prerequisites">EC2 Fleet prerequisites</h2>
			<div class="highlights" id="inline-topiclist"><h6>To create an EC2 Fleet, the following prerequisites must be in place:</h6><ul><li><a href="#ec2-fleet-prerequisites-launch-template">Launch template</a></li><li><a href="#ec2-fleet-service-linked-role">Service-linked role for EC2 Fleet</a></li><li><a href="#ec2-fleet-service-linked-roles-access-to-cmks">Grant access to customer managed keys for use
						with encrypted AMIs and EBS snapshots</a></li><li><a href="#ec2-fleet-iam-users">Permissions for EC2 Fleet users</a></li></ul></div>
			
			 
				<h3 id="ec2-fleet-prerequisites-launch-template">Launch template</h3>
				<p>A launch template includes information about the instances to launch, such as
					the instance type, Availability Zone, and the maximum price that you are willing
					to pay. For more information, see <a href="./ec2-launch-templates.html">Launch an instance from a launch template</a>.</p>
			 
			 
				<h3 id="ec2-fleet-service-linked-role">Service-linked role for EC2 Fleet</h3>
				<p>The <code class="code">AWSServiceRoleForEC2Fleet</code> role grants the EC2 Fleet permission to
					request, launch, terminate, and tag instances on your behalf. Amazon EC2 uses this
					service-linked role to complete the following actions:</p>
				<div class="itemizedlist">
					 
					 
					 
					 
					 
					 
					 
				<ul class="itemizedlist"><li class="listitem">
						<p><code class="code">ec2:RunInstances</code> – Launch instances.</p>
					</li><li class="listitem">
						<p><code class="code">ec2:RequestSpotInstances</code> – Request Spot Instances.</p>
					</li><li class="listitem">
						<p><code class="code">ec2:TerminateInstances</code> – Terminate instances.</p>
					</li><li class="listitem">
						<p><code class="code">ec2:DescribeImages</code> – Describe Amazon Machine Images (AMIs) for the
							Spot Instances.</p>
					</li><li class="listitem">
						<p><code class="code">ec2:DescribeInstanceStatus</code> – Describe the status
							of the Spot Instances.</p>
					</li><li class="listitem">
						<p><code class="code">ec2:DescribeSubnets</code> – Describe the subnets for
							Spot Instances.</p>
					</li><li class="listitem">
						<p><code class="code">ec2:CreateTags</code> – Add tags to the EC2 Fleet, instances, and
							volumes.</p>
					</li></ul></div>
				<p>Ensure that this role exists before you use the AWS CLI or an API to create an EC2 Fleet.</p>
				<div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>An <code class="code">instant</code> EC2 Fleet does not require this role.</p></div></div>
				<p>To create the role, use the IAM console as follows.</p>
				<div class="procedure"><h6>To create the AWSServiceRoleForEC2Fleet role for EC2 Fleet</h6><ol><li><p>Open the IAM console at
         <a href="https://console.aws.amazon.com/iam/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/iam/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
						<p>In the navigation pane, choose <b>Roles</b>, and then
							choose <b>Create role</b>.</p>
					</li><li>
						<p>For <b>Select type of trusted entity</b>, choose
							<b>AWS service</b>.</p>
					</li><li>
						<p>For <b>Choose the service that will use this role</b>,
							choose <b>EC2 - Fleet</b>, and then choose <b>Next:
								Permissions</b>, <b>Next: Tags</b>, and
								<b>Next: Review</b>.</p>
					</li><li>
						<p>On the <b>Review</b> page, choose <b>Create
								role</b>.</p>
					</li></ol></div>
				<p>If you no longer need to use EC2 Fleet, we recommend that you delete the
						<b>AWSServiceRoleForEC2Fleet</b> role. After this role is
					deleted from your account, you can create the role again if you create another
					fleet.</p>
				<p>For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/using-service-linked-roles.html">Using
						service-linked roles</a> in the
					<em>IAM User Guide</em>.</p>
			 
			 
				<h3 id="ec2-fleet-service-linked-roles-access-to-cmks">Grant access to customer managed keys for use
						with encrypted AMIs and EBS snapshots</h3>
				<p>If you specify an <a href="./AMIEncryption.html">encrypted AMI</a> or an <a href="./EBSEncryption.html">encrypted Amazon EBS snapshot</a> in your EC2 Fleet and you
					use an AWS KMS key for encryption, you must grant
					the <b>AWSServiceRoleForEC2Fleet</b> role permission to use the
					customer managed key so that Amazon EC2 can launch instances on your behalf. To do this, you must add
					a grant to the customer managed key, as shown in the following procedure.</p>
				<p>When providing permissions, grants are an alternative to key policies. For more
					information, see <a href="https://docs.aws.amazon.com/kms/latest/developerguide/grants.html">Using grants</a> and
						<a href="https://docs.aws.amazon.com/kms/latest/developerguide/key-policies.html">Using key policies in
						AWS KMS</a> in the <em>AWS Key Management Service Developer Guide</em>.</p>
				<div class="procedure"><h6>To grant the AWSServiceRoleForEC2Fleet role permissions to use the
						customer managed key</h6><ul><li>
						<p>Use the <a href="https://docs.aws.amazon.com/cli/latest/reference/kms/create-grant.html">create-grant</a> command to add a grant to the customer managed key and to
							specify the principal (the
								<b>AWSServiceRoleForEC2Fleet</b> service-linked role)
							that is given permission to perform the operations that the grant
							permits. The customer managed key is specified by the <code class="code">key-id</code> parameter and
							the ARN of the customer managed key. The principal is specified by the
								<code class="code">grantee-principal</code> parameter and the ARN of the
								<b>AWSServiceRoleForEC2Fleet</b> service-linked
							role.</p>
						<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws kms create-grant \
    --region <code class="replaceable">us-east-1</code> \
    --key-id arn:aws:kms:<code class="replaceable">us-east-1</code>:<code class="replaceable">444455556666</code>:key/<code class="replaceable">1234abcd-12ab-34cd-56ef-1234567890ab</code> \
    --grantee-principal arn:aws:iam::<code class="replaceable">111122223333</code>:role/AWSServiceRoleForEC2Fleet \
    --operations "Decrypt" "Encrypt" "GenerateDataKey" "GenerateDataKeyWithoutPlaintext" "CreateGrant" "DescribeKey" "ReEncryptFrom" "ReEncryptTo"</code></pre>
					</li></ul></div>
			 
			 
				<h3 id="ec2-fleet-iam-users">Permissions for EC2 Fleet users</h3>
				<p>If your users will create or manage an EC2 Fleet, be sure to grant them the
					required permissions.</p>
				<div class="procedure"><h6>To create a policy for EC2 Fleet</h6><ol><li><p>Open the IAM console at
         <a href="https://console.aws.amazon.com/iam/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/iam/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
						<p>In the navigation pane, choose <b>Policies</b>.</p>
					</li><li>
						<p>Choose <b>Create policy</b>.</p>
					</li><li>
						<p>On the <b>Create policy</b> page, choose the
							<b>JSON</b> tab, replace the text with the following,
							and choose <b>Review policy</b>.</p>
						<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "ec2:*"
            ],
            "Resource": "*"
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
              "iam:ListRoles",
              "iam:PassRole",
              "iam:ListInstanceProfiles"
            ],
            "Resource":"arn:aws:iam::123456789012:role/DevTeam*"
        }
    ]
}</code></pre>
						<p>The <code class="code">ec2:*</code> grants a user permission to call all Amazon EC2 API actions. To limit
							the user to specific Amazon EC2 API actions, specify those actions
							instead.</p>
						<p>The user must have permission to call the <code class="code">iam:ListRoles</code> action to enumerate
							existing IAM roles, the <code class="code">iam:PassRole</code> action to specify
							the EC2 Fleet role, and the <code class="code">iam:ListInstanceProfiles</code> action to
							enumerate existing instance profiles.</p>
						<p>(Optional) To enable a user to create roles or instance profiles using the IAM
							console, you must also add the following actions to the policy:</p>
						<div class="itemizedlist">
							 
							 
							 
							 
							 
							 
						<ul class="itemizedlist"><li class="listitem">
								<p><code class="code">iam:AddRoleToInstanceProfile</code></p>
							</li><li class="listitem">
								<p><code class="code">iam:AttachRolePolicy</code></p>
							</li><li class="listitem">
								<p><code class="code">iam:CreateInstanceProfile</code></p>
							</li><li class="listitem">
								<p><code class="code">iam:CreateRole</code></p>
							</li><li class="listitem">
								<p><code class="code">iam:GetRole</code></p>
							</li><li class="listitem">
								<p><code class="code">iam:ListPolicies</code></p>
							</li></ul></div>
					</li><li>
						<p>On the <b>Review policy</b> page, enter a policy name
							and description, and choose <b>Create policy</b>.</p>
					</li><li>
  
  <p>To provide access, add permissions to your users, groups, or roles:</p>
  <div class="itemizedlist">
   
   
   
  <ul class="itemizedlist"><li class="listitem">
    <p>Users and groups in AWS IAM Identity Center (successor to AWS Single Sign-On):</p>
    <p>Create a permission set. Follow the instructions in <a href="https://docs.aws.amazon.com/singlesignon/latest/userguide/howtocreatepermissionset.html">Create a permission set</a> in the <em>AWS IAM Identity Center (successor to AWS Single Sign-On) User Guide</em>.</p>
  </li><li class="listitem">
    <p>Users managed in IAM through an identity provider:</p>
    <p>Create a role for identity federation. Follow the instructions in <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-idp.html">Creating a role
    for a third-party identity provider (federation)</a> in the <em>IAM User Guide</em>.</p>
  </li><li class="listitem">
    <p>IAM users:</p>
     <div class="itemizedlist">
        
        
     <ul class="itemizedlist"><li class="listitem">
         <p>Create a role that your user can assume. Follow the instructions in <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user.html">Creating a role for an IAM user</a> in the <em>IAM User Guide</em>.</p>
       </li><li class="listitem">
         <p>(Not recommended) Attach a policy directly to a user or add a user to a user group. Follow the instructions in <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users_change-permissions.html#users_change_permissions-add-console">Adding permissions to a user (console)</a> in the <em>IAM User Guide</em>.</p>
       </li></ul></div>
  </li></ul></div>
  </li></ol></div>
			 
		 
			<h2 id="ec2-fleet-health-checks">EC2 Fleet health checks</h2>
			<p>EC2 Fleet checks the health status of the instances in the fleet every two minutes. The health
				status of an instance is either <code class="code">healthy</code> or
				<code class="code">unhealthy</code>.</p>
			<p>EC2 Fleet determines  the health status of an instance by using the status checks provided by
				Amazon EC2. An instance is determined as <code class="code">unhealthy</code> when the status of either
				the instance status check or the system status check is <code class="code">impaired</code> for
				three consecutive health status checks. For more information, see <a href="./monitoring-system-instance-status-check.html">Status checks for your
                instances</a>.</p>
			<p>You can configure your fleet to replace unhealthy Spot Instances. After setting
					<code class="code">ReplaceUnhealthyInstances</code> to <code class="code">true</code>, a Spot Instance is replaced
				when it is reported as <code class="code">unhealthy</code>. The fleet can go below its target
				capacity for up to a few minutes while an unhealthy Spot Instance is being replaced.</p>
			<div class="itemizedlist">
				<h6>Requirements</h6>
				 
				 
				 
				 
			<ul class="itemizedlist"><li class="listitem">
					<p>Health check replacement is supported only for EC2 Fleets that maintain a
						target capacity (fleets of type <code class="code">maintain</code>), and not for fleets
						of type <code class="code">request</code> or <code class="code">instant</code>.</p>
				</li><li class="listitem">
					<p>Health check replacement is supported only for Spot Instances. This feature is not supported for
						On-Demand Instances.</p>
				</li><li class="listitem">
					<p>You can configure your EC2 Fleet to replace unhealthy instances only when you
						create it.</p>
				</li><li class="listitem">
					<p>Users can use health check replacement only if they have permission
						to call the <code class="code">ec2:DescribeInstanceStatus</code> action.</p>
				</li></ul></div>
			
			<div class="procedure"><h6>To configure an EC2 Fleet to replace unhealthy Spot Instances</h6><ol><li>
					<p>Follow the steps for creating an EC2 Fleet. For more information, see <a href="#create-ec2-fleet">Create an EC2 Fleet</a>.</p>
				</li><li>
					<p>To configure the fleet to replace unhealthy Spot Instances, in the JSON file, for
							<code class="code">ReplaceUnhealthyInstances</code>, enter <code class="code">true</code>. </p>
				</li></ol></div>
			
		 
			<h2 id="ec2-fleet-cli-skeleton">Generate an EC2 Fleet JSON configuration file</h2>
			<p>To view the full list of EC2 Fleet configuration parameters, you can generate a JSON file. For a
				description of each parameter, see <a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/create-fleet.html">create-fleet</a> in the
				AWS CLI Command Reference.</p>
			<div class="procedure"><h6>To generate a JSON file with all possible EC2 Fleet parameters using the command
					line</h6><ul><li>
					<p>Use the <a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/create-fleet.html">create-fleet</a> (AWS CLI)
						command and the <code class="code">--generate-cli-skeleton</code> parameter to generate
						an EC2 Fleet JSON file, and direct the output to a file to save it.</p>
					<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws ec2 create-fleet \
    --generate-cli-skeleton input &gt; <code class="replaceable">ec2createfleet.json</code></code></pre>
					<p>Example output</p>
					<pre class="programlisting"><div class="code-btn-container"></div><code class="json "><span>{</span>
    "DryRun": true,
    "ClientToken": "",
    "SpotOptions": <span>{</span>
        "AllocationStrategy": "capacity-optimized",
        "MaintenanceStrategies": <span>{</span>
            "CapacityRebalance": <span>{</span>
                "ReplacementStrategy": "launch"
            }
        },
        "InstanceInterruptionBehavior": "hibernate",
        "InstancePoolsToUseCount": 0,
        "SingleInstanceType": true,
        "SingleAvailabilityZone": true,
        "MinTargetCapacity": 0,
        "MaxTotalPrice": ""
    },
    "OnDemandOptions": <span>{</span>
        "AllocationStrategy": "prioritized",
        "CapacityReservationOptions": <span>{</span>
            "UsageStrategy": "use-capacity-reservations-first"
        },
        "SingleInstanceType": true,
        "SingleAvailabilityZone": true,
        "MinTargetCapacity": 0,
        "MaxTotalPrice": ""
    },
    "ExcessCapacityTerminationPolicy": "termination",
    "LaunchTemplateConfigs": [
        <span>{</span>
            "LaunchTemplateSpecification": <span>{</span>
                "LaunchTemplateId": "",
                "LaunchTemplateName": "",
                "Version": ""
            },
            "Overrides": [
                <span>{</span>
                    "InstanceType": "r5.metal",
                    "MaxPrice": "",
                    "SubnetId": "",
                    "AvailabilityZone": "",
                    "WeightedCapacity": 0.0,
                    "Priority": 0.0,
                    "Placement": <span>{</span>
                        "AvailabilityZone": "",
                        "Affinity": "",
                        "GroupName": "",
                        "PartitionNumber": 0,
                        "HostId": "",
                        "Tenancy": "dedicated",
                        "SpreadDomain": "",
                        "HostResourceGroupArn": ""
                    },
                    "InstanceRequirements": <span>{</span>
                        "VCpuCount": <span>{</span>
                            "Min": 0,
                            "Max": 0
                        },
                        "MemoryMiB": <span>{</span>
                            "Min": 0,
                            "Max": 0
                        },
                        "CpuManufacturers": [
                            "amd"
                        ],
                        "MemoryGiBPerVCpu": <span>{</span>
                            "Min": 0.0,
                            "Max": 0.0
                        },
                        "ExcludedInstanceTypes": [
                            ""
                        ],
                        "InstanceGenerations": [
                            "previous"
                        ],
                        "SpotMaxPricePercentageOverLowestPrice": 0,
                        "OnDemandMaxPricePercentageOverLowestPrice": 0,
                        "BareMetal": "included",
                        "BurstablePerformance": "required",
                        "RequireHibernateSupport": true,
                        "NetworkInterfaceCount": <span>{</span>
                            "Min": 0,
                            "Max": 0
                        },
                        "LocalStorage": "excluded",
                        "LocalStorageTypes": [
                            "ssd"
                        ],
                        "TotalLocalStorageGB": <span>{</span>
                            "Min": 0.0,
                            "Max": 0.0
                        },
                        "BaselineEbsBandwidthMbps": <span>{</span>
                            "Min": 0,
                            "Max": 0
                        },
                        "AcceleratorTypes": [
                            "inference"
                        ],
                        "AcceleratorCount": <span>{</span>
                            "Min": 0,
                            "Max": 0
                        },
                        "AcceleratorManufacturers": [
                            "amd"
                        ],
                        "AcceleratorNames": [
                            "a100"
                        ],
                        "AcceleratorTotalMemoryMiB": <span>{</span>
                            "Min": 0,
                            "Max": 0
                        }
                    }
                }
            ]
        }
    ],
    "TargetCapacitySpecification": <span>{</span>
        "TotalTargetCapacity": 0,
        "OnDemandTargetCapacity": 0,
        "SpotTargetCapacity": 0,
        "DefaultTargetCapacityType": "on-demand",
        "TargetCapacityUnitType": "memory-mib"
    },
    "TerminateInstancesWithExpiration": true,
    "Type": "instant",
    "ValidFrom": "1970-01-01T00:00:00",
    "ValidUntil": "1970-01-01T00:00:00",
    "ReplaceUnhealthyInstances": true,
    "TagSpecifications": [
        <span>{</span>
            "ResourceType": "fleet",
            "Tags": [
                <span>{</span>
                    "Key": "",
                    "Value": ""
                }
            ]
        }
    ],
    "Context": ""
}</code></pre>
				</li></ul></div>
		 
			<h2 id="create-ec2-fleet">Create an EC2 Fleet</h2>
			<p>To create an EC2 Fleet, you need only specify the following parameters:</p>
			<div class="itemizedlist">
				 
				 
				 
			<ul class="itemizedlist"><li class="listitem">
					<p><code class="code">LaunchTemplateId</code> or <code class="code">LaunchTemplateName</code> –
						Specifies the launch template to use (which contains the parameters for the
						instances to launch, such as the instance type, Availability Zone, and the
						maximum price you're willing to pay)</p>
				</li><li class="listitem">
					<p><code class="code">TotalTargetCapacity</code> – Specifies the total target
						capacity for the fleet</p>
				</li><li class="listitem">
					<p><code class="code">DefaultTargetCapacityType</code> – Specifies whether the
						default purchasing option is On-Demand or Spot</p>
				</li></ul></div>
			<p>You can specify multiple launch specifications that override the launch template. The
				launch specifications can vary by instance type, Availability Zone, subnet, and
				maximum price, and can include a different weighted capacity. <span>Alternatively, you can
				specify the attributes that an instance must have, and Amazon EC2 will identify all
				the instance types with those attributes. For more information, see <a href="./ec2-fleet-attribute-based-instance-type-selection.html">Attribute-based instance type selection for EC2 Fleet</a>.</span></p>
			<p>If you do not specify a parameter, the fleet uses the default value for the
				parameter.</p>
			<p>Specify the fleet parameters in a JSON file. For more information, see <a href="#ec2-fleet-cli-skeleton">Generate an EC2 Fleet JSON configuration file</a>.</p>
			<p>There is currently no console support for creating an EC2 Fleet.</p>
			<div class="procedure"><h6>To create an EC2 Fleet (AWS CLI)</h6><ul><li>
					<p>Use the <a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/create-fleet.html">create-fleet</a> (AWS CLI)
						command to create an EC2 Fleet and specify the JSON file that contains the fleet
						configuration parameters.</p>
				</li></ul></div>
			<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws ec2 create-fleet --cli-input-json file://<code class="replaceable">file_name.json</code></code></code></pre>
			<p>For example configuration files, see <a href="./ec2-fleet-examples.html">EC2 Fleet example configurations</a>.</p>
			<p>The following is example output for a fleet of type <code class="code">request</code> or
					<code class="code">maintain</code>.</p>
			<pre class="programlisting"><div class="code-btn-container"></div><code class="json "><span>{</span>
    "FleetId": "fleet-12a34b55-67cd-8ef9-ba9b-9208dEXAMPLE"
} </code></pre>
			<p>The following is example output for a fleet of type <code class="code">instant</code> that
				launched the target capacity.</p>
			<pre class="programlisting"><div class="code-btn-container"></div><code class="json "><span>{</span>
  "FleetId": "fleet-12a34b55-67cd-8ef9-ba9b-9208dEXAMPLE",
  "Errors": [],
  "Instances": [
    <span>{</span>
      "LaunchTemplateAndOverrides": <span>{</span>
        "LaunchTemplateSpecification": <span>{</span>
          "LaunchTemplateId": "lt-01234a567b8910abcEXAMPLE",
          "Version": "1"
        },
        "Overrides": <span>{</span>
          "InstanceType": "c5.large",
          "AvailabilityZone": "us-east-1a"
        }
      },
      "Lifecycle": "on-demand",
      "InstanceIds": [
        "i-1234567890abcdef0",
        "i-9876543210abcdef9" 
      ],
      "InstanceType": "c5.large",
      "Platform": null
    },
    <span>{</span>
      "LaunchTemplateAndOverrides": <span>{</span>
        "LaunchTemplateSpecification": <span>{</span>
          "LaunchTemplateId": "lt-01234a567b8910abcEXAMPLE",
          "Version": "1"
        },
        "Overrides": <span>{</span>
          "InstanceType": "c4.large",
          "AvailabilityZone": "us-east-1a"
        }
      },
      "Lifecycle": "on-demand",
      "InstanceIds": [
        "i-5678901234abcdef0",
        "i-5432109876abcdef9" 
      ]
  ]
}</code></pre>
			<p>The following is example output for a fleet of type <code class="code">instant</code> that
				launched part of the target capacity with errors for instances that were not
				launched.</p>
			<pre class="programlisting"><div class="code-btn-container"></div><code class="json "><span>{</span>
  "FleetId": "fleet-12a34b55-67cd-8ef9-ba9b-9208dEXAMPLE",
  "Errors": [
    <span>{</span>
      "LaunchTemplateAndOverrides": <span>{</span>
        "LaunchTemplateSpecification": <span>{</span>
          "LaunchTemplateId": "lt-01234a567b8910abcEXAMPLE",
          "Version": "1"
        },
        "Overrides": <span>{</span>
          "InstanceType": "c4.xlarge",
          "AvailabilityZone": "us-east-1a",
        }
      },
      "Lifecycle": "on-demand",
      "ErrorCode": "InsufficientInstanceCapacity",
      "ErrorMessage": ""
    },
  ],
  "Instances": [
    <span>{</span>
      "LaunchTemplateAndOverrides": <span>{</span>
        "LaunchTemplateSpecification": <span>{</span>
          "LaunchTemplateId": "lt-01234a567b8910abcEXAMPLE",
          "Version": "1"
        },
        "Overrides": <span>{</span>
          "InstanceType": "c5.large",
          "AvailabilityZone": "us-east-1a"
        }
      },
      "Lifecycle": "on-demand",
      "InstanceIds": [
        "i-1234567890abcdef0",
        "i-9876543210abcdef9" 
      ]
  ]
}</code></pre>
			<p>The following is example output for a fleet of type <code class="code">instant</code> that
				launched no instances.</p>
			<pre class="programlisting"><div class="code-btn-container"></div><code class="json "><span>{</span>
  "FleetId": "fleet-12a34b55-67cd-8ef9-ba9b-9208dEXAMPLE",
  "Errors": [
    <span>{</span>
      "LaunchTemplateAndOverrides": <span>{</span>
        "LaunchTemplateSpecification": <span>{</span>
          "LaunchTemplateId": "lt-01234a567b8910abcEXAMPLE",
          "Version": "1"
        },
        "Overrides": <span>{</span>
          "InstanceType": "c4.xlarge",
          "AvailabilityZone": "us-east-1a",
        }
      },
      "Lifecycle": "on-demand",
      "ErrorCode": "InsufficientCapacity",
      "ErrorMessage": ""
    },
    <span>{</span>
      "LaunchTemplateAndOverrides": <span>{</span>
        "LaunchTemplateSpecification": <span>{</span>
          "LaunchTemplateId": "lt-01234a567b8910abcEXAMPLE",
          "Version": "1"
        },
        "Overrides": <span>{</span>
          "InstanceType": "c5.large",
          "AvailabilityZone": "us-east-1a",
        }
      },
      "Lifecycle": "on-demand",
      "ErrorCode": "InsufficientCapacity",
      "ErrorMessage": ""
    },
  ],
  "Instances": []
}</code></pre>
		 
			<h2 id="tag-ec2-fleet">Tag an EC2 Fleet</h2>
			<p>To help categorize and manage your EC2 Fleet requests, you can tag them with custom metadata.
				You can assign a tag to an EC2 Fleet request when you create it, or afterward.</p>
			<p>When you tag a fleet request, the instances and volumes that are launched by the fleet are
				not automatically tagged. You need to explicitly tag the instances and volumes
				launched by the fleet. You can choose to assign tags to only the fleet request, or
				to only the instances launched by the fleet, or to only the volumes attached to the
				instances launched by the fleet, or to all three.</p>
			<div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>For <code class="code">instant</code> fleet types, you can tag volumes that are attached to On-Demand Instances and
					Spot Instances. For <code class="code">request</code> or <code class="code">maintain</code> fleet types, you can
					only tag volumes that are attached to On-Demand Instances.</p></div></div>
			<p>For more information about how tags work, see <a href="./Using_Tags.html">Tag your Amazon EC2 resources</a>.</p>
			
				<p><b>Prerequisite</b></p>
				<p>Grant the user the permission to tag resources. For more information, see <a href="./ExamplePolicies_EC2.html#iam-example-taggingresources">Example: Tag resources</a>.</p>
				 
					<h6>To grant a user the permission to tag resources</h6>
					<p>Create a IAM policy that includes the following:</p>
				 
				<div class="itemizedlist">
					 
					 
					 
				<ul class="itemizedlist"><li class="listitem">
						<p>The <code class="code">ec2:CreateTags</code> action. This grants the user permission to create tags.</p>	
					</li><li class="listitem">
						<p>The <code class="code">ec2:CreateFleet</code> action. This grants the user permission to create
							an EC2 Fleet request.</p>	
					</li><li class="listitem">
						<p>For <code class="code">Resource</code>, we recommend that you specify <code class="code">"*"</code>. This allows
						users to tag all resource types.</p>
					</li></ul></div>
				<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "TagEC2FleetRequest",
            "Effect": "Allow",
            "Action": [
                "ec2:CreateTags",
                "ec2:CreateFleet"
            ],
            "Resource": "*"
}</code></pre>
				<div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>We currently do not support resource-level permissions for the <code class="code">create-fleet</code>
						resource. If you specify <code class="code">create-fleet</code> as a resource, you will
						get an unauthorized exception when you try to tag the fleet. The following
						example illustrates how <em>not</em> to set the
						policy. </p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "Effect": "Allow",
    "Action": [
        "ec2:CreateTags",
        "ec2:CreateFleet"
    ],
    "Resource": "arn:aws:ec2:<code class="replaceable">us-east-1</code>:<code class="replaceable">111122223333</code>:create-fleet/*"
}</code></pre></div></div>
			
  
  <p>To provide access, add permissions to your users, groups, or roles:</p>
  <div class="itemizedlist">
   
   
   
  <ul class="itemizedlist"><li class="listitem">
    <p>Users and groups in AWS IAM Identity Center (successor to AWS Single Sign-On):</p>
    <p>Create a permission set. Follow the instructions in <a href="https://docs.aws.amazon.com/singlesignon/latest/userguide/howtocreatepermissionset.html">Create a permission set</a> in the <em>AWS IAM Identity Center (successor to AWS Single Sign-On) User Guide</em>.</p>
  </li><li class="listitem">
    <p>Users managed in IAM through an identity provider:</p>
    <p>Create a role for identity federation. Follow the instructions in <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-idp.html">Creating a role
    for a third-party identity provider (federation)</a> in the <em>IAM User Guide</em>.</p>
  </li><li class="listitem">
    <p>IAM users:</p>
     <div class="itemizedlist">
        
        
     <ul class="itemizedlist"><li class="listitem">
         <p>Create a role that your user can assume. Follow the instructions in <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user.html">Creating a role for an IAM user</a> in the <em>IAM User Guide</em>.</p>
       </li><li class="listitem">
         <p>(Not recommended) Attach a policy directly to a user or add a user to a user group. Follow the instructions in <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users_change-permissions.html#users_change_permissions-add-console">Adding permissions to a user (console)</a> in the <em>IAM User Guide</em>.</p>
       </li></ul></div>
  </li></ul></div>
  
			 
				<h6>To tag a new EC2 Fleet request</h6>
				<p>To tag an EC2 Fleet request when you create it, specify the key-value pair in the
						<a href="#ec2-fleet-cli-skeleton">JSON file</a> used to create the
					fleet. The value for <code class="code">ResourceType</code> must be <code class="code">fleet</code>. If
					you specify another value, the fleet request fails.</p>
			 
			
			 
				<h6>To tag instances and volumes launched by an EC2 Fleet</h6>
				<p>To tag instances and volumes when they are launched by the fleet, specify the tags in the
						<a href="./create-launch-template.html">launch template</a> that is
					referenced in the EC2 Fleet request.</p>
			 
			<div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You can't tag volumes attached to Spot Instances that are launched by a <code class="code">request</code> or
						<code class="code">maintain</code> fleet type.</p></div></div>
			
			 
				<h6>To tag an existing EC2 Fleet request, instance, and volume (AWS CLI)</h6>
				<p>Use the <a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/create-tags.html">create-tags</a> command to tag
					existing resources.</p>
			 
			<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws ec2 create-tags \
    --resources <code class="replaceable">fleet-12a34b55-67cd-8ef9-ba9b-9208dEXAMPLE</code> <code class="replaceable">i-1234567890abcdef0</code> <code class="replaceable">vol-1234567890EXAMPLE</code> \
    --tags Key=<code class="replaceable">purpose</code>,Value=<code class="replaceable">test</code></code></code></pre>
			
		 
			<h2 id="monitor-ec2-fleet">Describe your EC2 Fleet</h2>
			<p>You can describe your EC2 Fleet configuration, the instances in your EC2 Fleet, and the event history
				of your EC2 Fleet.</p>
			
			 
				<h6>To describe your EC2 Fleets (AWS CLI)</h6>
				<p>Use the <a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-fleets.html">describe-fleets</a> command
					to describe your EC2 Fleets.</p>
			 
			<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws ec2 describe-fleets</code></code></pre>
			
			<div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>If a fleet is of type <code class="code">instant</code>, you must specify the fleet ID, otherwise it
					does not appear in the response. Include <code class="code">--fleet-ids</code> as
					follows:</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws ec2 describe-fleets --fleet-ids <code class="replaceable">fleet-8a22eee4-f489-ab02-06b8-832a7EXAMPLE</code></code></code></pre></div></div>
			
			<p>Example output</p>
			<pre class="programlisting"><div class="code-btn-container"></div><code class="json "><span>{</span>
    "Fleets": [
        <span>{</span>
            "ActivityStatus": "fulfilled",
            "CreateTime": "2022-02-09T03:35:52+00:00",
            "FleetId": "fleet-364457cd-3a7a-4ed9-83d0-7b63e51bb1b7",
            "FleetState": "active",
            "ExcessCapacityTerminationPolicy": "termination",
            "FulfilledCapacity": 2.0,
            "FulfilledOnDemandCapacity": 0.0,
            "LaunchTemplateConfigs": [
                <span>{</span>
                    "LaunchTemplateSpecification": <span>{</span>
                        "LaunchTemplateName": "my-launch-template",
                        "Version": "$Latest"
                    }
                }
            ],
            "TargetCapacitySpecification": <span>{</span>
                "TotalTargetCapacity": 2,
                "OnDemandTargetCapacity": 0,
                "SpotTargetCapacity": 2,
                "DefaultTargetCapacityType": "spot"
            },
            "TerminateInstancesWithExpiration": false,
            "Type": "maintain",
            "ReplaceUnhealthyInstances": false,
            "SpotOptions": <span>{</span>
                "AllocationStrategy": "capacity-optimized",
                "InstanceInterruptionBehavior": "terminate"
            },
            "OnDemandOptions": <span>{</span>
                "AllocationStrategy": "lowestPrice"
            }
        }
    ]
}</code></pre>
			
			<p>Use the <a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-fleet-instances.html">describe-fleet-instances</a> command to describe the instances for the
				specified EC2 Fleet. The returned list of running instances is refreshed periodically and
				might be out of date.</p>
			<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws ec2 describe-fleet-instances  --fleet-id <code class="replaceable">fleet-73fbd2ce-aa30-494c-8788-1cee4EXAMPLE</code></code></code></pre>
			<p>Example output</p>
			<pre class="programlisting"><div class="code-btn-container"></div><code class="json "><span>{</span>
    "ActiveInstances": [
        <span>{</span>
            "InstanceId": "i-09cd595998cb3765e", 
            "InstanceHealth": "healthy", 
            "InstanceType": "m4.large", 
            "SpotInstanceRequestId": "sir-86k84j6p"
        }, 
        <span>{</span>
            "InstanceId": "i-09cf95167ca219f17", 
            "InstanceHealth": "healthy", 
            "InstanceType": "m4.large", 
            "SpotInstanceRequestId": "sir-dvxi7fsm"
        }
    ], 
    "FleetId": "fleet-73fbd2ce-aa30-494c-8788-1cee4EXAMPLE"
}</code></pre>
			
			<p>Use the <a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-fleet-history.html">describe-fleet-history</a> command to describe the history for the
				specified EC2 Fleet for the specified time. </p>
			<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws ec2 describe-fleet-history --fleet-id <code class="replaceable">fleet-73fbd2ce-aa30-494c-8788-1cee4EXAMPLE</code> --start-time 2018-04-10T00:00:00Z</code></code></pre>
			<p>Example output</p>
			<pre class="programlisting"><div class="code-btn-container"></div><code class="json "><span>{</span>
    "HistoryRecords": [
        <span>{</span>
            "EventInformation": <span>{</span>
                "EventSubType": "submitted"
            },
            "EventType": "fleetRequestChange",
            "Timestamp": "2020-09-01T18:26:05.000Z"
        },
        <span>{</span>
            "EventInformation": <span>{</span>
                "EventSubType": "active"
            },
            "EventType": "fleetRequestChange",
            "Timestamp": "2020-09-01T18:26:15.000Z"
        },
        <span>{</span>
            "EventInformation": <span>{</span>
                "EventDescription": "t2.small, ami-07c8bc5c1ce9598c3, ...",
                "EventSubType": "progress"
            },
            "EventType": "fleetRequestChange",
            "Timestamp": "2020-09-01T18:26:17.000Z"
        },
        <span>{</span>
            "EventInformation": <span>{</span>
                "EventDescription": "<span>{</span>\"instanceType\":\"t2.small\", ...}",
                "EventSubType": "launched",
                "InstanceId": "i-083a1c446e66085d2"
            },
            "EventType": "instanceChange",
            "Timestamp": "2020-09-01T18:26:17.000Z"
        },
        <span>{</span>
            "EventInformation": <span>{</span>
                "EventDescription": "<span>{</span>\"instanceType\":\"t2.small\", ...}",
                "EventSubType": "launched",
                "InstanceId": "i-090db02406cc3c2d6"
            },
            "EventType": "instanceChange",
            "Timestamp": "2020-09-01T18:26:17.000Z"
        }
    ], 
    "FleetId": "fleet-73fbd2ce-aa30-494c-8788-1cee4EXAMPLE", 
    "LastEvaluatedTime": "1970-01-01T00:00:00.000Z", 
    "StartTime": "2018-04-09T23:53:20.000Z"
}</code></pre>
			
		 
			<h2 id="modify-ec2-fleet">Modify an EC2 Fleet</h2>
			<p>You can modify an EC2 Fleet that is in the <code class="code">submitted</code> or
					<code class="code">active</code> state. When you modify a fleet, it enters the
					<code class="code">modifying</code> state.</p>
			<p>You can only modify an EC2 Fleet that is of type <code class="code">maintain</code>. You cannot
				modify an EC2 Fleet of type <code class="code">request</code> or <code class="code">instant</code>.</p>
			<p>You can modify the following parameters of an EC2 Fleet:</p>
			<div class="itemizedlist">
				 
				 
			<ul class="itemizedlist"><li class="listitem">
					<p><code class="code">target-capacity-specification</code> – Increase or decrease
						the target capacity for <code class="code">TotalTargetCapacity</code>,
							<code class="code">OnDemandTargetCapacity</code>, and
						<code class="code">SpotTargetCapacity</code>.</p>
				</li><li class="listitem">
					<p><code class="code">excess-capacity-termination-policy</code> – Whether running
						instances should be terminated if the total target capacity of the EC2 Fleet is
						decreased below the current size of the fleet. Valid values are
							<code class="code">no-termination</code> and <code class="code">termination</code>.</p>
				</li></ul></div>
			<p>When you increase the target capacity, the EC2 Fleet launches the additional instances
				according to the instance purchasing option specified for
					<code class="code">DefaultTargetCapacityType</code>, which are either On-Demand Instances or Spot Instances.</p>
			<p>If the <code class="code">DefaultTargetCapacityType</code> is <code class="code">spot</code>, the EC2 Fleet launches the
				additional Spot Instances according to its allocation strategy. If the allocation strategy is
					<code class="code">lowest-price</code>, the fleet launches the instances from the lowest
				priced Spot capacity pool in the request. If the allocation strategy is
					<code class="code">diversified</code>, the fleet distributes the instances across the pools
				in the request.</p>
			<p>When you decrease the target capacity, the EC2 Fleet deletes any open requests that exceed the
				new target capacity. You can request that the fleet terminate instances until the
				size of the fleet reaches the new target capacity. If the allocation strategy is
					<code class="code">lowest-price</code>, the fleet terminates the instances with the highest
				price per unit. If the allocation strategy is <code class="code">diversified</code>, the fleet
				terminates instances across the pools. Alternatively, you can request that EC2 Fleet keep
				the fleet at its current size, but not replace any Spot Instances that are interrupted or any
				instances that you terminate manually.</p>
			<p>When an EC2 Fleet terminates a Spot Instance because the target capacity was decreased, the
				instance receives a Spot Instance interruption notice.</p>
			 
				<h6>To modify an EC2 Fleet (AWS CLI)</h6>
				<p>Use the <a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/modify-fleet.html">modify-fleet</a> command to
					update the target capacity of the specified EC2 Fleet.</p>
			 
			<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws ec2 modify-fleet \
    --fleet-id <code class="replaceable">fleet-73fbd2ce-aa30-494c-8788-1cee4EXAMPLE</code> \
    --target-capacity-specification TotalTargetCapacity=<code class="replaceable">20</code></code></code></pre>
			<p>If you are decreasing the target capacity but want to keep the fleet at its
				current size, you can modify the previous command as follows.</p>
			<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws ec2 modify-fleet \
    --fleet-id <code class="replaceable">fleet-73fbd2ce-aa30-494c-8788-1cee4EXAMPLE</code> \
    --target-capacity-specification TotalTargetCapacity=<code class="replaceable">10</code> \
    --excess-capacity-termination-policy no-termination</code></code></pre>
		 
			<h2 id="delete-fleet">Delete an EC2 Fleet</h2>
			<p>If you no longer require an EC2 Fleet, you can delete it. After you delete a fleet, all Spot
				requests associated with the fleet are canceled, so that no new Spot Instances are
				launched.</p>
			<p>When you delete an EC2 Fleet, you must also specify if you want to terminate all of its
				instances. These include both On-Demand Instances and Spot Instances.</p>
			<p>If you specify that the instances must be terminated when the fleet is deleted, the fleet
				enters the <code class="code">deleted_terminating</code> state. Otherwise, it enters the
					<code class="code">deleted_running</code> state, and the instances continue to run until they
				are interrupted or you terminate them manually.</p>
						
			<div class="itemizedlist">
				<h6>Restrictions</h6>
				 
				 
			<ul class="itemizedlist"><li class="listitem">
					<p>You can delete up to 25 <code class="code">instant</code> fleets in a single request. If you exceed this
						number, no <code class="code">instant</code> fleets are deleted and an error is returned. There is no
						restriction on the number of fleets of type <code class="code">maintain</code> or <code class="code">request</code> that can be deleted
						in a single request.</p>
				</li><li class="listitem">
					<p>Up to 1000 instances can be terminated in a single request to delete <code class="code">instant</code> fleets.
					</p>
				</li></ul></div>
			
			 
				<h6>To delete an EC2 Fleet and terminate its instances (AWS CLI)</h6>
				<p>Use the <a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/delete-fleets.html">delete-fleets</a> command and
					the <code class="code">--terminate-instances</code> parameter to delete the specified EC2 Fleet
					and terminate its associated instances.</p>
			 
			<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws ec2 delete-fleets \
    --fleet-ids <code class="replaceable">fleet-73fbd2ce-aa30-494c-8788-1cee4EXAMPLE</code> \
    --terminate-instances</code></code></pre>
			<p>Example output</p>
			<pre class="programlisting"><div class="code-btn-container"></div><code class="json "><span>{</span>
    "UnsuccessfulFleetDeletions": [], 
    "SuccessfulFleetDeletions": [
        <span>{</span>
            "CurrentFleetState": "deleted_terminating", 
            "PreviousFleetState": "active", 
            "FleetId": "fleet-73fbd2ce-aa30-494c-8788-1cee4EXAMPLE"
        }
    ]
}</code></pre>
			
			 
				<h6>To delete an EC2 Fleet without terminating its instances (AWS CLI)</h6>
			<p>You can modify the previous command using the <code class="code">--no-terminate-instances</code>
					parameter to delete the specified EC2 Fleet without terminating its associated
					instances.</p>
			 
			<div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p><code class="code">--no-terminate-instances</code> is not supported for <code class="code">instant</code>
					fleets.</p></div></div>
			<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">aws ec2 delete-fleets \
    --fleet-ids <code class="replaceable">fleet-73fbd2ce-aa30-494c-8788-1cee4EXAMPLE</code> \
    --no-terminate-instances</code></code></pre>
			<p>Example output</p>
			<pre class="programlisting"><div class="code-btn-container"></div><code class="json "><span>{</span>
    "UnsuccessfulFleetDeletions": [], 
    "SuccessfulFleetDeletions": [
        <span>{</span>
            "CurrentFleetState": "deleted_running", 
            "PreviousFleetState": "active", 
            "FleetId": "fleet-4b8aaae8-dfb5-436d-a4c6-3dafa4c6b7dcEXAMPLE"
        }
    ]
}</code></pre>
			
			 
				<h3 id="troubleshoot-delete-fleet">Troubleshoot when a fleet fails to delete</h3>
					<p>If an EC2 Fleet fails to delete, <code class="code">UnsuccessfulFleetDeletions</code> in the output returns
					the ID of the EC2 Fleet, an error code, and an error message.</p>
				<p>The error codes are:</p>
				<div class="itemizedlist">
					 
					 
					 
					 
					 
					 
					 
				<ul class="itemizedlist"><li class="listitem">
						<p><code class="code">ExceededInstantFleetNumForDeletion</code></p>
					</li><li class="listitem">
						<p><code class="code">fleetIdDoesNotExist</code></p>
					</li><li class="listitem">
						<p><code class="code">fleetIdMalformed</code></p>
					</li><li class="listitem">
						<p><code class="code">fleetNotInDeletableState</code></p>
					</li><li class="listitem">
						<p><code class="code">NoTerminateInstancesNotSupported</code></p>
					</li><li class="listitem">
						<p><code class="code">UnauthorizedOperation</code></p>
					</li><li class="listitem">
						<p><code class="code">unexpectedError</code></p>
					</li></ul></div>
				 
					<h6>Troubleshooting <code class="code">ExceededInstantFleetNumForDeletion</code></h6>
					<p>If you try to delete more than 25 <code class="code">instant</code> fleets in a single request, the
							<code class="code">ExceededInstantFleetNumForDeletion</code> error is returned. The
						following is example output for this error.</p>
				 
				<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight "><span>{</span>
    "UnsuccessfulFleetDeletions": [
     <span>{</span>
          "FleetId": " fleet-5d130460-0c26-bfd9-2c32-0100a098f625",
          "Error": <span>{</span>
                  "Message": "Can’t delete more than 25 instant fleets in a single request.",
                  "Code": "ExceededInstantFleetNumForDeletion"
           }
     },
     <span>{</span>
           "FleetId": "fleet-9a941b23-0286-5bf4-2430-03a029a07e31",
           "Error": <span>{</span>
                  "Message": "Can’t delete more than 25 instant fleets in a single request.",
                  "Code": "ExceededInstantFleetNumForDeletion"
            }
     }
     .
     .
     .
     ],
     "SuccessfulFleetDeletions": []
}</code></pre>
				
				 
					<h6>Troubleshoot <code class="code">NoTerminateInstancesNotSupported</code></h6>
					<p>If you specify that the instances in an <code class="code">instant</code> fleet must not be terminated
						when you delete the fleet, the <code class="code">NoTerminateInstancesNotSupported</code>
						error is returned. <code class="code">--no-terminate-instances</code> is not supported
						for <code class="code">instant</code> fleets. The following is example output for this
						error.</p>
				 
				<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight "><span>{</span>
      "UnsuccessfulFleetDeletions": [
            <span>{</span>
                  "FleetId": "fleet-5d130460-0c26-bfd9-2c32-0100a098f625",
                  "Error": <span>{</span>
                          "Message": "NoTerminateInstances option is not supported for instant fleet",
                          "Code": "NoTerminateInstancesNotSupported"
                   }
            }
       ],
       "SuccessfulFleetDeletions": []</code></pre>
				
				 
					<h6>Troubleshoot <code class="code">UnauthorizedOperation</code></h6>
					<p>If you do not have permission to terminate instances, you get the
							<code class="code">UnauthorizedOperation</code> error when deleting a fleet that must
						terminate its instances. The following is the error response.</p>
				 
				<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight ">&lt;Response&gt;&lt;Errors&gt;&lt;Error&gt;&lt;Code&gt;UnauthorizedOperation&lt;/Code&gt;&lt;Message&gt;You are not authorized to perform this 
operation. Encoded authorization failure message: VvuncIxj7Z_CPGNYXWqnuFV-YjByeAU66Q9752NtQ-I3-qnDLWs6JLFd
KnSMMiq5s6cGqjjPtEDpsnGHzzyHasFHOaRYJpaDVravoW25azn6KNkUQQlFwhJyujt2dtNCdduJfrqcFYAjlEiRMkfDHt7N63SKlweKUl
BHturzDK6A560Y2nDSUiMmAB1y9UNtqaZJ9SNe5sNxKMqZaqKtjRbk02RZu5V2vn9VMk6fm2aMVHbY9JhLvGypLcMUjtJ76H9ytg2zRlje
VPiU5v2s-UgZ7h0p2yth6ysUdhlONg6dBYu8_y_HtEI54invCj4CoK0qawqzMNe6rcmCQHvtCxtXsbkgyaEbcwmrm2m01-EMhekLFZeJLr
DtYOpYcEl4_nWFX1wtQDCnNNCmxnJZAoJvb3VMDYpDTsxjQv1PxODZuqWHs23YXWVywzgnLtHeRf2o4lUhGBw17mXsS07k7XAfdPMP_brO
PT9vrHtQiILor5VVTsjSPWg7edj__1rsnXhwPSu8gI48ZLRGrPQqFq0RmKO_QIE8N8s6NWzCK4yoX-9gDcheurOGpkprPIC9YPGMLK9tug
&lt;/Message&gt;&lt;/Error&gt;&lt;/Errors&gt;&lt;RequestID&gt;89b1215c-7814-40ae-a8db-41761f43f2b0&lt;/RequestID&gt;&lt;/Response&gt;</code></pre>
				<p>To resolve the error, you must add the <code class="code">ec2:TerminateInstances</code> action to the
					IAM policy, as shown in the following example.</p>
				<pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight "><span>{</span>
       "Version": "2012-10-17",
       "Statement": [
            <span>{</span>
                "Sid": "DeleteFleetsAndTerminateInstances",
                "Effect": "Allow",
                "Action": [
                       "ec2:DeleteFleets"
                       "ec2:TerminateInstances"
                ],
                "Resource": "*"
            }
       ]
    }</code></pre>
				
			 
			
		<awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./ec2-fleet-instance-weighting.html">Instance weighting</div><div id="next" class="next-link" accesskey="n" href="./spot-fleet.html">Spot Fleet</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=EC2&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSEC2/latest/UserGuide/manage-ec2-fleet.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=EC2&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSEC2/latest/UserGuide/manage-ec2-fleet.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>