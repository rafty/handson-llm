<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Troubleshooting API request errors - Amazon Elastic Compute Cloud</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="query-api-troubleshooting" /><meta name="default_state" content="query-api-troubleshooting" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/query-api-troubleshooting.html" /><meta name="description" content="Troubleshoot errors using the error codes you receive from Amazon EC2." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Elastic Compute Cloud" /><meta name="guide" content="API Reference" /><meta name="abstract" content="Amazon Elastic Compute Cloud (Amazon EC2) provides secure and resizable computing capacity in the AWS Cloud. Using Amazon EC2 eliminates the need to invest in hardware up front, so you can develop and deploy applications faster. Amazon Virtual Private Cloud (Amazon VPC) enables you to provision a logically isolated section of the AWS Cloud where you can launch AWS resources in a virtual network that you've defined. Amazon Elastic Block Store (Amazon EBS) provides block level storage volumes for use with EC2 instances. EBS volumes are highly available and reliable storage volumes that can be attached to any running instance and used like a hard drive." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/query-api-troubleshooting.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/query-api-troubleshooting.html" hreflang="x-default" /><meta name="feedback-item" content="EC2 API" /><meta name="this_doc_product" content="Amazon Elastic Compute Cloud" /><meta name="this_doc_guide" content="API Reference" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'ec2'}"></script><meta id="panorama-serviceSubSection" value="API Reference" /><meta id="panorama-serviceConsolePage" value="Troubleshooting API request errors" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Troubleshooting API request errors - Amazon Elastic Compute Cloud</title><meta name="pdf" content="/pdfs/AWSEC2/latest/APIReference/ec2-api.pdf#query-api-troubleshooting" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=30" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=EC2%20API&amp;topic_url=http://docs.aws.amazon.com/en_us/AWSEC2/latest/APIReference/query-api-troubleshooting.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/AWSEC2/latest/APIReference/query-api-troubleshooting.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/AWSEC2/latest/APIReference/query-api-troubleshooting.html" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon EC2",
        "item" : "https://docs.aws.amazon.com/ec2/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "API Reference",
        "item" : "https://docs.aws.amazon.com/AWSEC2/latest/APIReference"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Making requests to the Amazon EC2 API",
        "item" : "https://docs.aws.amazon.com/AWSEC2/latest/APIReference/making-api-requests.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Troubleshooting API request errors",
        "item" : "https://docs.aws.amazon.com/AWSEC2/latest/APIReference/making-api-requests.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/AWSEC2/latest/APIReference/ec2-api.pdf#query-api-troubleshooting" target="_blank" rel="noopener noreferrer" title="Open PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/ec2/index.html">Amazon EC2</a><a href="Welcome.html">API Reference</a></div><div id="page-toc-src"><a href="#api-request-rate">Query API request rate</a><a href="#eventual-consistency">Eventual consistency</a><a href="#unauthorized-operation">Unauthorized operation</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="query-api-troubleshooting">Troubleshooting API request errors</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>In the Amazon EC2 Query API, errors codes are indicated as being either client or server.
			Client errors usually occur because there is a problem with the structure, content, or
			validity of the request. Server errors usually indicate a server-side issue. </p><p>For more information about API error codes, see <a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/api-error-codes.html">Error Codes</a>.</p><div class="highlights" id="inline-topiclist"><h6>Contents</h6><ul><li><a href="#api-request-rate">Query API request rate</a></li><li><a href="#eventual-consistency">Eventual consistency</a></li><li><a href="#unauthorized-operation">Unauthorized operation</a></li></ul></div>
			<h2 id="api-request-rate">Query API request rate</h2>
			<p>We throttle Amazon EC2 API requests for each AWS account on a per-Region basis to help the
				performance of the service. We ensure that all calls to the Amazon EC2 API (whether they
				originate from an application, calls to a command line interface, or the Amazon EC2
				console) don't exceed the maximum allowed API request rate. The maximum API request
				rate may vary across Regions. Note that API requests made by users are
				attributed to the underlying AWS account.</p>
			<p>The Amazon EC2 API actions are divided into the following categories:</p>
			<div class="itemizedlist">
				 
				 
				 
			<ul class="itemizedlist"><li class="listitem">
					<p>Describe actions, such as <code class="code">DescribeInstances</code> and
							<code class="code">DescribeVolumes</code>. These requests simply retrieve
						cached data, so they have the highest request limit.</p>
				</li><li class="listitem">
					<p>Modify actions, such as <code class="code">RunInstances</code> and
							<code class="code">CreateVolumes</code>. These requests create or modify
						resources, so they have a lower request limit than describe calls.</p>
				</li><li class="listitem">
					<p>The <code class="code">CreateKeyPair</code>,
						<code class="code">AuthorizeSecurityGroupIngress</code>, and
							<code class="code">RevokeSecurityGroupIngress</code> actions. These requests
						take the most time and resource to complete, so they have the lowest request
						limit.</p>
				</li></ul></div>
			<p>If an API request exceeds the API request rate for its category, the request returns the
					<code class="code">RequestLimitExceeded</code> error code. To prevent this error, ensure that
				your application doesn't retry API requests at a high rate. You can do this by using
				care when polling and by using exponential backoff retries.</p>
			 
				<h3 id="polling">Polling</h3>
				<p>Your application might need to call an API repeatedly to check for an update
					in status. Before you start polling, give the request time to potentially
					complete. When you begin polling, use an appropriate sleep interval between
					successive requests. For best results, use an increasing sleep interval.</p>
				<p>Alternatively, you can use Amazon CloudWatch Events to notify you of the status of some resources; for
					example, you can use the <b>EC2 Instance State-change
						Notification</b> event to notify you of a state change for an
					instance. For more information, see the
					<em><a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/events/">Amazon CloudWatch Events User Guide</a></em>.</p>
			 
			 
				<h3 id="retries">Retries or batch processing</h3>
				<p>Your application might need to retry an API request after it fails, or to
					process multiple resources (for example, all your volumes). To lower the rate of
					API requests, use an appropriate sleep interval between successive requests. For
					best results, use an increasing or variable sleep interval.</p>
			 
			 
				<h3 id="calculate_delay_interval">Calculating the sleep interval</h3>
				<p>When you have to poll or retry an API request, we recommend using an
					exponential backoff algorithm to calculate the sleep interval between API calls.
					The idea behind exponential backoff is to use progressively longer waits between
					retries for consecutive error responses. For more information, and
					implementation examples of this algorithm, see <a href="https://docs.aws.amazon.com/general/latest/gr/api-retries.html">Error retries and exponential backoff in
						AWS</a>.</p>
			 
		 
			<h2 id="eventual-consistency">Eventual consistency</h2>
			<p>The Amazon EC2 API follows an eventual consistency model, due to the distributed nature
				of the system supporting the API. This means that the result of an API command you
				run that affects your Amazon EC2 resources might not be immediately visible to all
				subsequent commands you run. You should keep this in mind when you carry out an API
				command that immediately follows a previous API command.</p>
			<p>Eventual consistency can affect the way you manage your resources. For example, if
				you run a command to create a resource, it will eventually be visible to other
				commands. This means that if you run a command to modify or describe the resource
				that you just created, its ID might not have propagated throughout the system, and
				you will get an error responding that the resource does not exist.</p>
			<p>To manage eventual consistency, you can do the following:</p>
			<div class="itemizedlist">
				 
				 
			<ul class="itemizedlist"><li class="listitem">
					<p>Confirm the state of the resource before you run a command to modify it.
						Run the appropriate <code class="code">Describe</code> command using an
						exponential backoff algorithm to ensure that you allow enough time for the
						previous command to propagate through the system. To do this, run the
							<code class="code">Describe</code> command repeatedly, starting with a couple
						of seconds of wait time, and increasing gradually up to five minutes of wait
						time. </p>
				</li><li class="listitem">
					<p>Add wait time between subsequent commands, even if a
							<code class="code">Describe</code> command returns an accurate response.
						Apply an exponential backoff algorithm starting with a couple of seconds of
						wait time, and increase gradually up to about five minutes of wait
						time.</p>
				</li></ul></div>
			 
				<h6>Eventual consistency error examples</h6>
				<p>The following are examples of error codes you may encounter as a result of
					eventual consistency.</p>
			 
			<div class="itemizedlist">
				 
				 
				 
			<ul class="itemizedlist"><li class="listitem">
					<p><code class="code">InvalidInstanceID.NotFound</code></p>
					<p>If you successfully run the <code class="code">RunInstances</code> command, and
						then immediately run another command using the instance ID that was provided
						in the response of <code class="code">RunInstances</code>, it may return an
							<code class="code">InvalidInstanceID.NotFound</code> error. This does not mean the
						instance does not exist. </p>
					<p>Some specific commands that may be affected are:</p>
					<div class="itemizedlist">
						 
						 
					<ul class="itemizedlist"><li class="listitem">
							<p><code class="code">DescribeInstances</code>: To confirm the actual
								state of the instance, run this command using an exponential
								backoff algorithm.</p>
						</li><li class="listitem">
							<p><code class="code">TerminateInstances</code>: To confirm the state of
								the instance, first run the <code class="code">DescribeInstances</code>
								command using an exponential backoff algorithm.</p>
							<div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>If you get an <code class="code">InvalidInstanceID.NotFound</code> error
									after running <code class="code">TerminateInstances</code>, this does
									not mean that the instance is or will be terminated. Your
									instance could still be running. This is why it is important to
									first confirm the instance’s state using
										<code class="code">DescribeInstances</code>.</p></div></div>
						</li></ul></div>
				</li><li class="listitem">
					<p><code class="code">InvalidGroup.NotFound</code></p>
					<p>If you successfully run the <code class="code">CreateSecurityGroup</code> command, and then
                        immediately run another command using the security group ID that was
                        provided in the response of <code class="code">CreateSecurityGroup</code>, it may return
                        an <code class="code">InvalidGroup.NotFound</code> error. To confirm the state of the
                        security group, run the <code class="code">DescribeSecurityGroups</code> command using an
                        exponential backoff algorithm.</p>
				</li><li class="listitem">
					<p><code class="code">InstanceLimitExceeded</code></p>
					<p>You have requested more instances than your current instance limit allows
						for the specified instance type. You could reach this limit unexpectedly if you 
						are launching and terminating instances rapidly, as terminated instances
						count toward your instance limit for a while after they've been terminated.</p>
				</li></ul></div>
		 
			<h2 id="unauthorized-operation">Unauthorized operation</h2>
			<p>By default, users, groups, and roles don't have permission to create or modify Amazon EC2
				resources, or perform tasks using the Amazon EC2 API. You must explicitly grant
				permission through IAM policies. If a user attempts to perform an action for which
				permission has not been granted, the request returns the following error:
					<code class="code">Client.UnauthorizedOperation</code>.</p>
			<p>This error may occur when a policy is unintentionally restrictive. For example, to allow 
				a user to launch instances into a specific subnet, you need to grant permissions
				for the following resources by specifying their ARNs in your IAM policy:
				instances, volumes, AMIs, the specific subnet, network interfaces, key pairs, and
				security groups. If you omit the permission for volumes, for example, the user is
				only able to launch an instance from an instance store-backed AMI, as they do not
				have permission to create the root EBS volume for an EBS-backed instance.</p>
			<p>For more information about creating IAM policies for Amazon EC2, see <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-policies-for-amazon-ec2.html">IAM policies for Amazon EC2</a>
				in the <em>Amazon EC2 User Guide for Linux Instances</em>.</p>
			<p>For more information about which ARNs you can use with which Amazon EC2 API actions, see 
				<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazonec2.html">Actions, resources, and condition keys for Amazon EC2</a> 
				in the <em>Service Authorization Reference</em>.</p>
		<awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./throttling.html">API request throttling</div><div id="next" class="next-link" accesskey="n" href="./Run_Instance_Idempotency.html">Ensuring idempotency</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=EC2 API&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSEC2/latest/APIReference/query-api-troubleshooting.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=EC2 API&amp;topic_url=https://docs.aws.amazon.com/en_us/AWSEC2/latest/APIReference/query-api-troubleshooting.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>