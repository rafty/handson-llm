<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="id-ID"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Memperkaya dokumen Anda selama konsumsi - Amazon Kendra</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="custom-document-enrichment" /><meta name="default_state" content="custom-document-enrichment" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/custom-document-enrichment.html" /><meta name="description" content="Cara membuat, memodifikasi, atau menghapus atribut dokumen dan konten selama proses konsumsi dokumen diAmazon Kendra." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Kendra" /><meta name="guide" content="Panduan Developer" /><meta name="abstract" content="Memberikan gambaran umum konseptualAmazon Kendra. Pelajari tentangAmazon Kendra fitur dan mulailah mengindeks dokumen menggunakan konsol, CLI, dan API." /><meta name="guide-locale" content="id_id" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/custom-document-enrichment.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/custom-document-enrichment.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/custom-document-enrichment.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kendra/latest/dg/custom-document-enrichment.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kendra/latest/dg/custom-document-enrichment.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/custom-document-enrichment.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/custom-document-enrichment.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kendra/latest/dg/custom-document-enrichment.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kendra/latest/dg/custom-document-enrichment.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/custom-document-enrichment.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/custom-document-enrichment.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kendra/latest/dg/custom-document-enrichment.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kendra/latest/dg/custom-document-enrichment.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/custom-document-enrichment.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/custom-document-enrichment.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kendra/latest/dg/custom-document-enrichment.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kendra/latest/dg/custom-document-enrichment.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kendra/latest/dg/custom-document-enrichment.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kendra/latest/dg/custom-document-enrichment.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/kendra/latest/dg/custom-document-enrichment.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/kendra/latest/dg/custom-document-enrichment.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/custom-document-enrichment.html" hreflang="x-default" /><meta name="feedback-item" content="Kendra" /><meta name="this_doc_product" content="Amazon Kendra" /><meta name="this_doc_guide" content="Panduan Developer" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'kendra'}"></script><meta id="panorama-serviceSubSection" value="Panduan Developer" /><meta id="panorama-serviceConsolePage" value="Memperkaya dokumen Anda selama konsumsi" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Memperkaya dokumen Anda selama konsumsi - Amazon Kendra</title><meta name="pdf" content="kendra-dg.pdf#custom-document-enrichment" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=http://docs.aws.amazon.com/id_id/kendra/latest/dg/custom-document-enrichment.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/id_id/kendra/latest/dg/custom-document-enrichment.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/id_id/kendra/latest/dg/custom-document-enrichment.html" /><meta name="keywords" content="Kendra,Amazon Kendra,pencarian,pencarian cerdas,bahasa alami,indeks,pertanyaan,kata kunci,sumber data,konektor,Pertanyaan yang Sering Diajukan,pertanyaan yang sering diajukan" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Kendra",
        "item" : "https://docs.aws.amazon.com/kendra/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Panduan Developer",
        "item" : "https://docs.aws.amazon.com/id_id/kendra/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Memperkaya dokumen Anda selama konsumsi",
        "item" : "https://docs.aws.amazon.com/id_id/kendra/latest/dg/custom-document-enrichment.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="kendra-dg.pdf#custom-document-enrichment" target="_blank" rel="noopener noreferrer" title="Buka PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Dokumentasi</a><a href="/kendra/index.html">Amazon Kendra</a><a href="what-is-kendra.html">Panduan Developer</a></div><div id="page-toc-src"><a href="#how-custom-document-enrichment-works">Bagaimana Custom Document Enrichment bekerja</a><a href="#basic-data-maniplation">Operasi dasar untuk mengubah metadata</a><a href="#advanced-data-manipulation">Fungsi Lambda: ekstrak dan ubah metadata atau konten</a><a href="#cde-data-contracts-lambda">Kontrak data untuk fungsi Lambda</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>Terjemahan disediakan oleh mesin penerjemah. Jika konten terjemahan yang diberikan bertentangan dengan versi bahasa Inggris aslinya, utamakan versi bahasa Inggris.</p></awsui-alert><h1 class="topictitle" id="custom-document-enrichment">Memperkaya dokumen Anda selama konsumsi</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Anda dapat mengubah bidang atau atribut metadata konten dan dokumen selama proses konsumsi dokumen. DenganAmazon Kendra fitur <em>Pengayaan Dokumen Kustom</em>, Anda dapat membuat, memodifikasi, atau menghapus atribut dan konten dokumen saat Anda memasukkan dokumen AndaAmazon Kendra. Ini berarti Anda dapat memanipulasi dan menelan data Anda sesuai kebutuhan.</p><p>Fitur ini memberi Anda kendali atas bagaimana dokumen Anda diperlakukan dan dicernaAmazon Kendra. Misalnya, Anda dapat menggosok informasi yang dapat diidentifikasi secara pribadi dalam metadata dokumen sambil menelan dokumen AndaAmazon Kendra.</p><p>Cara lain Anda dapat menggunakan fitur ini adalah dengan memanggil fungsi LambdaAWS Lambda untuk menjalankan Optical Character Recognition (OCR) pada gambar, terjemahan pada teks, dan tugas lain untuk menyiapkan data untuk pencarian atau analisis. Misalnya, Anda dapat memanggil fungsi untuk menjalankan OCR pada gambar. Fungsi ini dapat menafsirkan teks dari gambar dan memperlakukan setiap gambar sebagai dokumen tekstual. Sebuah perusahaan yang menerima surat-in survei pelanggan dan menyimpan survei ini sebagai gambar bisa menelan gambar-gambar ini sebagai dokumen tekstual ke dalamAmazon Kendra. Perusahaan kemudian dapat mencari informasi survei pelanggan yang berharga diAmazon Kendra.</p><p>Anda dapat menggunakan operasi dasar untuk menerapkan sebagai parse pertama data Anda, dan kemudian menggunakan fungsi Lambda untuk menerapkan operasi yang lebih kompleks pada data Anda. Misalnya, Anda dapat menggunakan operasi dasar untuk menghapus semua nilai di bidang metadata dokumen 'Customer_ID', dan kemudian menerapkan fungsi Lambda untuk mengekstrak teks dari gambar teks dalam dokumen.</p>
        <h2 id="how-custom-document-enrichment-works">Bagaimana Custom Document Enrichment bekerja</h2>
        <p>Keseluruhan proses Custom Document Enrichment adalah sebagai berikut:</p>
        <div class="orderedlist">
             
             
             
             
        <ol><li>
                <p>Anda mengonfigurasi Pengayaan Dokumen Kustom saat membuat atau memperbarui sumber data, atau mengindeks dokumen Anda secara langsungAmazon Kendra.</p>
            </li><li>
                <p>Amazon Kendramenerapkan konfigurasi inline atau logika dasar untuk mengubah data Anda. Untuk informasi selengkapnya, lihat <a href="#basic-data-maniplation">Operasi dasar untuk mengubah metadata</a>.</p>
            </li><li>
                <p>Jika Anda memilih untuk mengkonfigurasi manipulasi data lanjutan,Amazon Kendra dapat menerapkan ini pada dokumen asli, mentah Anda atau pada dokumen terstruktur dan diurai. Untuk informasi selengkapnya, lihat <a href="#advanced-data-manipulation">Fungsi Lambda: ekstrak dan ubah metadata atau konten</a>.</p>
            </li><li>
                <p>Dokumen Anda diubah dicerna ke dalamAmazon Kendra.</p>
            </li></ol></div>
        <p>Pada setiap titik dalam proses ini, jika konfigurasi Anda tidak valid,Amazon Kendra melempar kesalahan.</p>
        <p>Saat Anda menelepon <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_CreateDataSource.html">CreateDataSource<a href="https://docs.aws.amazon.com/kendra/latest/dg/API_UpdateDataSource.html">UpdateDataSource</a></a>,, atau <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_BatchPutDocument.html">BatchPutDocument</a>API, Anda menyediakan konfigurasi Pengayaan Dokumen Kustom. Jika Anda menelepon<code class="code">BatchPutDocument</code>, Anda harus mengkonfigurasi Pengayaan Dokumen Kustom dengan setiap permintaan. Jika Anda menggunakan konsol, Anda memilih indeks Anda dan kemudian pilih <b>Dokumen enrichments</b> untuk mengkonfigurasi Custom Document Enrichment.</p>
        <p>Jika Anda menggunakan <b>pengayaan Dokumen</b> di konsol, Anda dapat memilih untuk hanya mengonfigurasi operasi dasar atau hanya fungsi Lambda atau keduanya, seperti Anda dapat menggunakan API. Anda dapat memilih <b>Berikutnya</b> dalam langkah-langkah konsol untuk memilih untuk tidak mengonfigurasi operasi dasar dan hanya fungsi Lambda, termasuk apakah akan diterapkan ke data asli (pra-ekstraksi) atau terstruktur (pasca-ekstraksi). Anda hanya dapat menyimpan konfigurasi Anda dengan menyelesaikan semua langkah di konsol. Konfigurasi dokumen Anda tidak disimpan jika Anda tidak menyelesaikan semua langkah.</p>
     
        <h2 id="basic-data-maniplation">Operasi dasar untuk mengubah metadata</h2>
        <p>Anda dapat memanipulasi bidang dokumen dan konten Anda menggunakan logika dasar. Ini termasuk menghapus nilai dalam bidang, memodifikasi nilai dalam bidang menggunakan kondisi, atau membuat bidang. Untuk manipulasi lanjutan yang melampaui apa yang dapat Anda manipulasi menggunakan logika dasar, panggil fungsi Lambda. Untuk informasi selengkapnya, lihat <a href="#advanced-data-manipulation">Fungsi Lambda: ekstrak dan ubah metadata atau konten</a>.</p>
        <p>Untuk menerapkan logika dasar, Anda menentukan bidang target yang ingin Anda manipulasi menggunakan <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_DocumentAttributeTarget.html">DocumentAttributeTarget</a>objek. Anda memberikan kunci atribut. Misalnya, kunci 'Departemen' adalah bidang atau atribut yang menyimpan semua nama departemen yang terkait dengan dokumen. Anda juga dapat menentukan nilai yang akan digunakan di bidang target jika kondisi tertentu terpenuhi. Anda mengatur kondisi menggunakan <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_DocumentAttributeCondition.html">DocumentAttributeCondition</a>objek. Misalnya, jika kolom 'Source_URI' berisi 'keuangan' dalam nilai URI, maka isi ulang bidang target 'Departemen' dengan nilai target 'Keuangan' untuk dokumen. Anda juga dapat menghapus nilai-nilai atribut dokumen target.</p>
        <p>Untuk menerapkan logika dasar menggunakan konsol, pilih indeks Anda dan kemudian pilih <b>Pengayaan dokumen</b> di menu navigasi. Pergi ke <b>Konfigurasi operasi dasar</b> untuk menerapkan manipulasi dasar ke bidang dokumen dan konten Anda.</p>
        <p>Berikut ini adalah contoh menggunakan logika dasar untuk menghapus semua nomor identifikasi pelanggan di bidang dokumen yang disebut 'Customer_ID'.</p>
        <p><b>Contoh 1: Menghapus nomor identifikasi pelanggan yang terkait dengan dokumen</b></p>
        <p>Data sebelum manipulasi dasar diterapkan.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c13c15"><thead>
                    <tr>
                        <th><b>Document_ID</b></th>
                        <th><b>Tubuh_Teks</b></th>
                        <th><b>Customer_ID</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>Lorem Ipsum.</td>
                        <td>CID1234</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Lorem Ipsum.</td>
                        <td>CID1235</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Lorem Ipsum.</td>
                        <td>CID1236</td>
                    </tr>
                </table></div></div>
        <p>Data setelah manipulasi dasar diterapkan.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c13c19"><thead>
                    <tr>
                        <th><b>Document_ID</b></th>
                        <th><b>Tubuh_Teks</b></th>
                        <th><b>Customer_ID</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>Lorem Ipsum.</td>
                        <td> </td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Lorem Ipsum.</td>
                        <td> </td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Lorem Ipsum.</td>
                        <td> </td>
                    </tr>
                </table></div></div>
        <p>Berikut ini adalah contoh menggunakan logika dasar untuk membuat bidang yang disebut 'Departemen' dan mengisi ulang bidang ini dengan nama departemen berdasarkan informasi dari bidang 'Source_uri'. Ini menggunakan kondisi bahwa jika bidang 'Source_URI' berisi 'keuangan' dalam nilai URI, kemudian mengisi ulang bidang target 'Departemen' dengan nilai target 'Keuangan' untuk dokumen.</p>
        <p><b>Contoh 2: Membuat bidang 'Departemen' dan mengisi ulang dengan nama departemen yang terkait dengan dokumen menggunakan kondisi.</b></p>
        <p>Data sebelum manipulasi dasar diterapkan.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c13c27"><thead>
                    <tr>
                        <th><b>Document_ID</b></th>
                        <th><b>Tubuh_Teks</b></th>
                        <th><b>Sumber_URI</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>Lorem Ipsum.</td>
                        <td>keuangan/1</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Lorem Ipsum.</td>
                        <td>keuangan/2</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Lorem Ipsum.</td>
                        <td>keuangan/3</td>
                    </tr>
                </table></div></div>
        <p>Data setelah manipulasi dasar diterapkan.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c13c31"><thead>
                    <tr>
                        <th><b>Document_ID</b></th>
                        <th><b>Tubuh_Teks</b></th>
                        <th><b>Sumber_URI</b></th>
                        <th><b>Departemen</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>Lorem Ipsum.</td>
                        <td>keuangan/1</td>
                        <td>Keuangan</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Lorem Ipsum.</td>
                        <td>keuangan/2</td>
                        <td>Keuangan</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Lorem Ipsum.</td>
                        <td>keuangan/3</td>
                        <td>Keuangan</td>
                    </tr>
                </table></div></div>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>catatan</h6></div><div class="awsdocs-note-text"><p>Amazon Kendratidak dapat membuat kolom dokumen target jika belum dibuat sebagai bidang indeks. Setelah Anda membuat bidang indeks Anda, Anda dapat membuat bidang dokumen menggunakan<code class="code">DocumentAttributeTarget</code>. Amazon Kendrakemudian memetakan bidang metadata dokumen yang baru dibuat ke bidang indeks Anda.</p></div></div>
        <p>Kode berikut adalah contoh mengkonfigurasi manipulasi data dasar untuk menghapus nomor identifikasi pelanggan yang terkait dengan dokumen.</p>
        <awsdocs-tabs><dl style="display: none">
            <dt>Console</dt><dd tab-id="console">
                    
                    <div class="procedure"><h6>Untuk mengkonfigurasi manipulasi data dasar untuk menghapus nomor identifikasi pelanggan</h6><ol><li>
                            <p>Di panel navigasi kiri, di bawah <b>Indeks</b>, pilih <b>Pengayaan dokumen</b>, lalu pilih <b>Tambahkan pengayaan dokumen</b>.</p>
                        </li><li>
                            <p>Pada halaman <b>Konfigurasi operasi dasar</b>, pilih dari dropdown sumber data Anda yang ingin Anda ubah bidang dokumen dan konten. Kemudian pilih dari dropdown nama bidang dokumen 'Customer_ID', pilih dari dropdown nama bidang indeks 'Customer_ID', dan pilih dari dropdown tindakan target <b>Hapus</b>. Kemudian pilih <b>Tambahkan operasi dasar</b>.</p>
                        </li></ol></div>
                </dd>
            <dt>CLI</dt><dd tab-id="cli">
                    <p><b>Untuk mengkonfigurasi manipulasi data dasar untuk menghapus nomor identifikasi pelanggan</b></p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws kendra create-data-source \
 --name <code class="replaceable">data-source-name</code> \
 --index-id <code class="replaceable">index-id</code> \
 --role-arn <code class="replaceable">arn:aws:iam::account-id:role/role-name</code> \
 --type S3 \
 --configuration '<span>{</span>"S3Configuration":<span>{</span>"BucketName":"<code class="replaceable">S3-bucket-name</code>"}}' \
 --custom-document-enrichment-configuration '<span>{</span>"InlineConfigurations":[<span>{</span>"Target":<span>{</span>"TargetDocumentAttributeKey":"Customer_ID", "TargetDocumentAttributeValueDeletion": true}}]}' 
</code></pre>
                </dd>
            <dt>Python</dt><dd tab-id="python">
                    <p><b>Untuk mengkonfigurasi manipulasi data dasar untuk menghapus nomor identifikasi pelanggan</b></p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import boto3&#xD;
from botocore.exceptions import ClientError&#xD;
import pprint&#xD;
import time&#xD;
&#xD;
kendra = boto3.client("kendra")&#xD;
&#xD;
print("Create a data source with customizations")&#xD;
&#xD;
# Provide the name of the data source&#xD;
name = "data-source-name"&#xD;
# Provide the index ID for the data source&#xD;
index_id = "index-id"&#xD;
# Provide the IAM role ARN required for data sources&#xD;
role_arn = "arn:aws:iam::$<span>{</span>account-id}:role/$<span>{</span>role-name}"&#xD;
# Provide the data source connection information&#xD;
data_source_type = "S3"&#xD;
S3_bucket_name = "S3-bucket-name"&#xD;
# Configure the data source with Custom Document Enrichment&#xD;
configuration = <span>{</span>"S3Configuration":&#xD;
        <span>{</span>&#xD;
            "BucketName": S3_bucket_name&#xD;
        }&#xD;
    }&#xD;
custom_document_enrichment_configuration = <span>{</span>"InlineConfigurations":[&#xD;
        <span>{</span>&#xD;
            "Target":<span>{</span>"TargetDocumentAttributeKey":"Customer_ID",&#xD;
                       "TargetDocumentAttributeValueDeletion": True}&#xD;
        }]&#xD;
    }&#xD;
&#xD;
try:&#xD;
    data_source_response = kendra.create_data_source(&#xD;
        Name = name,&#xD;
        IndexId = index_id,&#xD;
        RoleArn = role_arn,&#xD;
        Type = data_source_type&#xD;
        Configuration = configuration&#xD;
        CustomDocumentEnrichmentConfiguration = custom_document_enrichment_configuration&#xD;
    )&#xD;
&#xD;
    pprint.pprint(data_source_response)&#xD;
&#xD;
    data_source_id = data_source_response["Id"]&#xD;
&#xD;
    print("Wait for Amazon Kendra to create the data source with your customizations.")&#xD;
&#xD;
    while True:&#xD;
        # Get the details of the data source, such as the status&#xD;
        data_source_description = kendra.describe_data_source(&#xD;
            Id = data_source_id,&#xD;
            IndexId = index_id&#xD;
        )&#xD;
        status = data_source_description["Status"]&#xD;
        print(" Creating data source. Status: "+status)&#xD;
        time.sleep(60)&#xD;
        if status != "CREATING":&#xD;
            break&#xD;
&#xD;
    print("Synchronize the data source.")&#xD;
&#xD;
    sync_response = kendra.start_data_source_sync_job(&#xD;
        Id = data_source_id,&#xD;
        IndexId = index_id&#xD;
    )&#xD;
&#xD;
    pprint.pprint(sync_response)&#xD;
&#xD;
    print("Wait for the data source to sync with the index.")&#xD;
&#xD;
    while True:&#xD;
&#xD;
        jobs = kendra.list_data_source_sync_jobs(&#xD;
            Id= data_source_id,&#xD;
            IndexId= index_id&#xD;
        )&#xD;
&#xD;
        # For this example, there should be one job&#xD;
        status = jobs["History"][0]["Status"]&#xD;
&#xD;
        print(" Syncing data source. Status: "+status)&#xD;
        time.sleep(60)&#xD;
        if status != "SYNCING":&#xD;
            break&#xD;
&#xD;
except  ClientError as e:&#xD;
        print("%s" % e)&#xD;
&#xD;
print("Program ends.")</code></pre>
                </dd>
            <dt>Java</dt><dd tab-id="java">
                    <p><b>Untuk mengkonfigurasi manipulasi data dasar untuk menghapus nomor identifikasi pelanggan</b></p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="java ">package com.amazonaws.kendra;

import java.util.concurrent.TimeUnit;
import software.amazon.awssdk.services.kendra.KendraClient;
import software.amazon.awssdk.services.kendra.model.CreateDataSourceRequest;
import software.amazon.awssdk.services.kendra.model.CreateDataSourceResponse;
import software.amazon.awssdk.services.kendra.model.CreateIndexRequest;
import software.amazon.awssdk.services.kendra.model.CreateIndexResponse;
import software.amazon.awssdk.services.kendra.model.DataSourceConfiguration;
import software.amazon.awssdk.services.kendra.model.DataSourceStatus;
import software.amazon.awssdk.services.kendra.model.DataSourceSyncJob;
import software.amazon.awssdk.services.kendra.model.DataSourceSyncJobStatus;
import software.amazon.awssdk.services.kendra.model.DataSourceType;
import software.amazon.awssdk.services.kendra.model.DescribeDataSourceRequest;
import software.amazon.awssdk.services.kendra.model.DescribeDataSourceResponse;
import software.amazon.awssdk.services.kendra.model.DescribeIndexRequest;
import software.amazon.awssdk.services.kendra.model.DescribeIndexResponse;
import software.amazon.awssdk.services.kendra.model.IndexStatus;
import software.amazon.awssdk.services.kendra.model.ListDataSourceSyncJobsRequest;
import software.amazon.awssdk.services.kendra.model.ListDataSourceSyncJobsResponse;
import software.amazon.awssdk.services.kendra.model.S3DataSourceConfiguration;
import software.amazon.awssdk.services.kendra.model.StartDataSourceSyncJobRequest;
import software.amazon.awssdk.services.kendra.model.StartDataSourceSyncJobResponse;

public class CreateDataSourceWithCustomizationsExample <span>{</span>

    public static void main(String[] args) throws InterruptedException <span>{</span>
        System.out.println("Create a data source with customizations");
        
        String dataSourceName = "data-source-name";
        String indexId = "index-id";
        String dataSourceRoleArn = "arn:aws:iam::account-id:role/role-name";
        String s3BucketName = "S3-bucket-name"

        KendraClient kendra = KendraClient.builder().build();
        
        CreateDataSourceRequest createDataSourceRequest = CreateDataSourceRequest
            .builder()
            .name(dataSourceName)
            .description(experienceDescription)
            .roleArn(experienceRoleArn)
            .type(DataSourceType.S3)
            .configuration(
                DataSourceConfiguration
                    .builder()
                    .s3Configuration(
                        S3DataSourceConfiguration
                            .builder()
                            .bucketName(s3BucketName)
                            .build()
                    ).build()
            )
            .customDocumentEnrichmentConfiguration(
                CustomDocumentEnrichmentConfiguration
                    .builder()
                    .inlineConfigurations(Arrays.asList(
                        InlineCustomDocumentEnrichmentConfiguration
                            .builder()
                            .target(
                                DocumentAttributeTarget
                                    .builder()
                                    .targetDocumentAttributeKey("Customer_ID")
                                    .targetDocumentAttributeValueDeletion(true)
                                    .build())
                            .build()
                    )).build();
        
        CreateDataSourceResponse createDataSourceResponse = kendra.createDataSource(createDataSourceRequest);
        System.out.println(String.format("Response of creating data source: %s", createDataSourceResponse));

        String dataSourceId = createDataSourceResponse.id();
        System.out.println(String.format("Waiting for Kendra to create the data source %s", dataSourceId));
        DescribeDataSourceRequest describeDataSourceRequest = DescribeDataSourceRequest
            .builder()
            .indexId(indexId)
            .id(dataSourceId)
            .build();

        while (true) <span>{</span>
            DescribeDataSourceResponse describeDataSourceResponse = kendra.describeDataSource(describeDataSourceRequest);

            DataSourceStatus status = describeDataSourceResponse.status();
            System.out.println(String.format("Creating data source. Status: %s", status));
            TimeUnit.SECONDS.sleep(60);
            if (status != DataSourceStatus.CREATING) <span>{</span>
                break;
            }
        }

        System.out.println(String.format("Synchronize the data source %s", dataSourceId));
        StartDataSourceSyncJobRequest startDataSourceSyncJobRequest = StartDataSourceSyncJobRequest
            .builder()
            .indexId(indexId)
            .id(dataSourceId)
            .build();
        StartDataSourceSyncJobResponse startDataSourceSyncJobResponse = kendra.startDataSourceSyncJob(startDataSourceSyncJobRequest);
        System.out.println(String.format("Waiting for the data source to sync with the index %s for execution ID %s", indexId, startDataSourceSyncJobResponse.executionId()));

        // For this example, there should be one job
        ListDataSourceSyncJobsRequest listDataSourceSyncJobsRequest = ListDataSourceSyncJobsRequest
            .builder()
            .indexId(indexId)
            .id(dataSourceId)
            .build();

        while (true) <span>{</span>
            ListDataSourceSyncJobsResponse listDataSourceSyncJobsResponse = kendra.listDataSourceSyncJobs(listDataSourceSyncJobsRequest);
            DataSourceSyncJob job = listDataSourceSyncJobsResponse.history().get(0);
            System.out.println(String.format("Syncing data source. Status: %s", job.status()));

            TimeUnit.SECONDS.sleep(60);
            if (job.status() != DataSourceSyncJobStatus.SYNCING) <span>{</span>
                break;
            }

        }

        System.out.println("Data source creation with customizations is complete");
    }
}</code></pre>
                </dd>
        </dl></awsdocs-tabs>
     
        <h2 id="advanced-data-manipulation">Fungsi Lambda: ekstrak dan ubah metadata atau konten</h2>
        <p>Anda dapat memanipulasi bidang dokumen dan konten Anda menggunakan fungsi Lambda. Ini berguna jika Anda ingin melampaui logika dasar dan menerapkan manipulasi data lanjutan. Misalnya, menggunakan Optical Character Recognition (OCR), yang menafsirkan teks dari gambar, dan memperlakukan setiap gambar sebagai dokumen tekstual. Atau, mengambil tanggal-waktu saat ini di zona waktu tertentu dan memasukkan tanggal-waktu di mana ada nilai kosong untuk bidang tanggal.</p>
        <p>Anda dapat menerapkan logika dasar terlebih dahulu dan kemudian menggunakan fungsi Lambda untuk memanipulasi data Anda lebih lanjut, atau sebaliknya. Anda juga dapat memilih untuk hanya menerapkan fungsi Lambda.</p>
        <p>Amazon Kendradapat memanggil fungsi Lambda untuk menerapkan manipulasi data lanjutan selama proses konsumsi sebagai bagian dari Anda <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_CustomDocumentEnrichmentConfiguration.html">CustomDocumentEnrichmentConfiguration</a>. Anda menentukan peran yang menyertakan izin untuk menjalankan fungsi Lambda dan mengaksesAmazon S3 bucket Anda untuk menyimpan output manipulasi data Anda—lihat <a href="https://docs.aws.amazon.com/kendra/latest/dg/iam-roles.html">peranIAM akses</a>.</p>
        <p>Amazon Kendradapat menerapkan fungsi Lambda pada dokumen asli, mentah Anda atau pada dokumen terstruktur dan terurai. Anda dapat mengonfigurasi fungsi Lambda yang mengambil data asli atau mentah Anda dan menerapkan manipulasi data Anda menggunakan <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_CustomDocumentEnrichmentConfiguration.html">PreExtractionHookConfiguration</a>. Anda juga dapat mengonfigurasi fungsi Lambda yang mengambil dokumen terstruktur dan menerapkan manipulasi data Anda <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_CustomDocumentEnrichmentConfiguration.html">PostExtractionHookConfiguration</a>. Amazon Kendramengekstrak metadata dokumen dan teks untuk menyusun dokumen Anda. Fungsi Lambda Anda harus mengikuti struktur permintaan dan respons wajib. Untuk informasi selengkapnya, lihat <a href="#cde-data-contracts-lambda">Kontrak data untuk fungsi Lambda</a>.</p>
        <p>Untuk mengonfigurasi fungsi Lambda di konsol, pilih indeks Anda, lalu pilih <b>Pengayaan dokumen</b> di menu navigasi. Pergi ke <b>fungsi Configure Lambda</b> untuk mengkonfigurasi fungsi Lambda.</p>
        <p>Anda dapat mengkonfigurasi hanya satu fungsi Lambda untuk<code class="code">PreExtractionHookConfiguration</code> dan dan hanya satu fungsi Lambda untuk<code class="code">PostExtractionHookConfiguration</code>. Namun, fungsi Lambda Anda dapat menjalankan fungsi lain yang dibutuhkannya. Anda dapat mengkonfigurasi keduanya<code class="code">PreExtractionHookConfiguration</code> dan<code class="code">PostExtractionHookConfiguration</code> atau salah satunya. Fungsi Lambda Anda tidak boleh melebihi waktu berjalan 5 menit dan fungsi Lambda Anda tidak boleh melebihi waktu berjalan 1 menit.<code class="code">PreExtractionHookConfiguration</code><code class="code">PostExtractionHookConfiguration</code> Mengkonfigurasi Custom Document Enrichment secara alami membutuhkan waktu lebih lama untuk menelan dokumen Anda ke dalamAmazon Kendra daripada jika Anda tidak mengkonfigurasi ini.</p>
        <p>Anda dapat mengkonfigurasiAmazon Kendra untuk memanggil fungsi Lambda hanya jika kondisi terpenuhi. Misalnya, Anda dapat menentukan kondisi bahwa jika ada nilai tanggal-waktu kosong, makaAmazon Kendra harus memanggil fungsi yang menyisipkan tanggal-waktu saat ini.</p>
        <p>Berikut ini adalah contoh penggunaan fungsi Lambda untuk menjalankan OCR untuk menafsirkan teks dari gambar dan menyimpan teks ini dalam bidang yang disebut 'Document_Image_Text'.</p>
        <p><b>Contoh 1: Mengekstrak teks dari gambar untuk membuat dokumen tekstual</b></p>
        <p>Data sebelum manipulasi lanjutan diterapkan.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c15c23"><thead>
                    <tr>
                        <th><b>Document_ID</b></th>
                        <th><b>Document_Image</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>image_1.png</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>image_2.png</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>image_3.png</td>
                    </tr>
                </table></div></div>
        <p>Data setelah manipulasi lanjutan diterapkan.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c15c27"><thead>
                    <tr>
                        <th><b>Document_ID</b></th>
                        <th><b>Document_Image</b></th>
                        <th><b>Document_Image_Text</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>image_1.png</td>
                        <td>Tanggapan survei yang dikirimkan</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>image_2.png</td>
                        <td>Tanggapan survei yang dikirimkan</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>image_3.png</td>
                        <td>Tanggapan survei yang dikirimkan</td>
                    </tr>
                </table></div></div>
        <p>Berikut ini adalah contoh penggunaan fungsi Lambda untuk memasukkan tanggal-waktu saat ini untuk nilai tanggal kosong. Ini menggunakan kondisi bahwa jika nilai bidang tanggal adalah 'null', kemudian ganti ini dengan tanggal-waktu saat ini.</p>
        <p><b>Contoh 2: Mengganti nilai kosong di bidang Last_Updated dengan tanggal-waktu saat ini.</b></p>
        <p>Data sebelum manipulasi lanjutan diterapkan.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c15c35"><thead>
                    <tr>
                        <th><b>Document_ID</b></th>
                        <th><b>Tubuh_Teks</b></th>
                        <th><b>Last_Diperbarui</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>Lorem Ipsum.</td>
                        <td>1 2020 2020</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Lorem Ipsum.</td>
                        <td> </td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Lorem Ipsum.</td>
                        <td>1 Juli 2020</td>
                    </tr>
                </table></div></div>
        <p>Data setelah manipulasi lanjutan diterapkan.</p>
        <div class="table-container"><div class="table-contents"><table id="w1460aac27c15c39"><thead>
                    <tr>
                        <th><b>Document_ID</b></th>
                        <th><b>Tubuh_Teks</b></th>
                        <th><b>Last_Diperbarui</b></th>
                    </tr>
                </thead>
                    <tr>
                        <td>1</td>
                        <td>Lorem Ipsum.</td>
                        <td>1 2020 2020</td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>Lorem Ipsum.</td>
                        <td>1 2021 01 2021 2021</td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>Lorem Ipsum.</td>
                        <td>1 Juli 2020</td>
                    </tr>
                </table></div></div>
        <p>Kode berikut adalah contoh konfigurasi fungsi Lambda untuk manipulasi data tingkat lanjut pada data asli mentah.</p>
        <awsdocs-tabs><dl style="display: none">
            <dt>Console</dt><dd tab-id="console">
                    
                    <div class="procedure"><h6>Untuk mengonfigurasi fungsi Lambda untuk manipulasi data lanjutan pada data asli mentah</h6><ol><li>
                            <p>Di panel navigasi kiri, di bawah <b>Indeks</b>, pilih <b>Pengayaan dokumen</b>, lalu pilih <b>Tambahkan pengayaan dokumen</b>.</p>
                        </li><li>
                            <p>Pada halaman <b>Konfigurasi fungsi Lambda</b>, di bagian <b>Lambda untuk pra-ekstraksi</b>, pilih dari dropdown fungsi Lambda ARN danAmazon S3 bucket Anda. Tambahkan peranIAM akses Anda dengan memilih opsi untuk membuat peran baru dari dropdown. Ini menciptakanAmazon Kendra izin yang diperlukan untuk membuat pengayaan dokumen.</p>
                        </li></ol></div>
                </dd>
            <dt>CLI</dt><dd tab-id="cli">
                    <p><b>Untuk mengonfigurasi fungsi Lambda untuk manipulasi data lanjutan pada data asli mentah</b></p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws kendra create-data-source \
 --name <code class="replaceable">data-source-name</code> \
 --index-id <code class="replaceable">index-id</code> \
 --role-arn <code class="replaceable">arn:aws:iam::account-id:role/role-name</code> \
 --type S3 \
 --configuration '<span>{</span>"S3Configuration":<span>{</span>"BucketName":"<code class="replaceable">S3-bucket-name</code>"}}' \
 --custom-document-enrichment-configuration '<span>{</span>"PreExtractionHookConfiguration":<span>{</span>"LambdaArn":"<code class="replaceable">arn:aws:iam::account-id:function/function-name</code>", "S3Bucket":"<code class="replaceable">S3-bucket-name</code>"}, "RoleArn": "<code class="replaceable">arn:aws:iam:account-id:role/cde-role-name</code>"}'
</code></pre>
                </dd>
            <dt>Python</dt><dd tab-id="python">
                    <p><b>Untuk mengonfigurasi fungsi Lambda untuk manipulasi data lanjutan pada data asli mentah</b></p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import boto3&#xD;
from botocore.exceptions import ClientError&#xD;
import pprint&#xD;
import time&#xD;
&#xD;
kendra = boto3.client("kendra")&#xD;
&#xD;
print("Create a data source with customizations.")&#xD;
&#xD;
# Provide the name of the data source&#xD;
name = "data-source-name"&#xD;
# Provide the index ID for the data source&#xD;
index_id = "index-id"&#xD;
# Provide the IAM role ARN required for data sources&#xD;
role_arn = "arn:aws:iam::$<span>{</span>account-id}:role/$<span>{</span>role-name}"&#xD;
# Provide the data source connection information&#xD;
data_source_type = "S3"&#xD;
S3_bucket_name = "S3-bucket-name"&#xD;
# Configure the data source with Custom Document Enrichment&#xD;
configuration = <span>{</span>"S3Configuration":&#xD;
        <span>{</span>&#xD;
            "BucketName": S3_bucket_name&#xD;
        }&#xD;
    }&#xD;
custom_document_enrichment_configuration = <span>{</span>"PreExtractionHookConfiguration":&#xD;
        <span>{</span>&#xD;
            "LambdaArn":"arn:aws:iam::account-id:function/function-name",&#xD;
            "S3Bucket":"S3-bucket-name"&#xD;
        }&#xD;
    "RoleArn":"arn:aws:iam::account-id:role/cde-role-name"&#xD;
    }&#xD;
&#xD;
try:&#xD;
    data_source_response = kendra.create_data_source(&#xD;
        Name = name,&#xD;
        IndexId = index_id,&#xD;
        RoleArn = role_arn,&#xD;
        Type = data_source_type&#xD;
        Configuration = configuration&#xD;
        CustomDocumentEnrichmentConfiguration = custom_document_enrichment_configuration&#xD;
    )&#xD;
&#xD;
    pprint.pprint(data_source_response)&#xD;
&#xD;
    data_source_id = data_source_response["Id"]&#xD;
&#xD;
    print("Wait for Amazon Kendra to create the data source with your customizations.")&#xD;
&#xD;
    while True:&#xD;
        # Get the details of the data source, such as the status&#xD;
        data_source_description = kendra.describe_data_source(&#xD;
            Id = data_source_id,&#xD;
            IndexId = index_id&#xD;
        )&#xD;
        status = data_source_description["Status"]&#xD;
        print(" Creating data source. Status: "+status)&#xD;
        time.sleep(60)&#xD;
        if status != "CREATING":&#xD;
            break&#xD;
&#xD;
    print("Synchronize the data source.")&#xD;
&#xD;
    sync_response = kendra.start_data_source_sync_job(&#xD;
        Id = data_source_id,&#xD;
        IndexId = index_id&#xD;
    )&#xD;
&#xD;
    pprint.pprint(sync_response)&#xD;
&#xD;
    print("Wait for the data source to sync with the index.")&#xD;
&#xD;
    while True:&#xD;
&#xD;
        jobs = kendra.list_data_source_sync_jobs(&#xD;
            Id = data_source_id,&#xD;
            IndexId = index_id&#xD;
        )&#xD;
&#xD;
        # For this example, there should be one job&#xD;
        status = jobs["History"][0]["Status"]&#xD;
&#xD;
        print(" Syncing data source. Status: "+status)&#xD;
        time.sleep(60)&#xD;
        if status != "SYNCING":&#xD;
            break&#xD;
&#xD;
except  ClientError as e:&#xD;
        print("%s" % e)&#xD;
&#xD;
print("Program ends.")&#xD;
</code></pre>
                </dd>
            <dt>Java</dt><dd tab-id="java">
                    <p><b>Untuk mengonfigurasi fungsi Lambda untuk manipulasi data lanjutan pada data asli mentah</b></p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="java ">package com.amazonaws.kendra;

import java.util.concurrent.TimeUnit;
import software.amazon.awssdk.services.kendra.KendraClient;
import software.amazon.awssdk.services.kendra.model.CreateDataSourceRequest;
import software.amazon.awssdk.services.kendra.model.CreateDataSourceResponse;
import software.amazon.awssdk.services.kendra.model.CreateIndexRequest;
import software.amazon.awssdk.services.kendra.model.CreateIndexResponse;
import software.amazon.awssdk.services.kendra.model.DataSourceConfiguration;
import software.amazon.awssdk.services.kendra.model.DataSourceStatus;
import software.amazon.awssdk.services.kendra.model.DataSourceSyncJob;
import software.amazon.awssdk.services.kendra.model.DataSourceSyncJobStatus;
import software.amazon.awssdk.services.kendra.model.DataSourceType;
import software.amazon.awssdk.services.kendra.model.DescribeDataSourceRequest;
import software.amazon.awssdk.services.kendra.model.DescribeDataSourceResponse;
import software.amazon.awssdk.services.kendra.model.DescribeIndexRequest;
import software.amazon.awssdk.services.kendra.model.DescribeIndexResponse;
import software.amazon.awssdk.services.kendra.model.IndexStatus;
import software.amazon.awssdk.services.kendra.model.ListDataSourceSyncJobsRequest;
import software.amazon.awssdk.services.kendra.model.ListDataSourceSyncJobsResponse;
import software.amazon.awssdk.services.kendra.model.S3DataSourceConfiguration;
import software.amazon.awssdk.services.kendra.model.StartDataSourceSyncJobRequest;
import software.amazon.awssdk.services.kendra.model.StartDataSourceSyncJobResponse;


public class CreateDataSourceWithCustomizationsExample <span>{</span>

    public static void main(String[] args) throws InterruptedException <span>{</span>
        System.out.println("Create a data source with customizations");
        
        String dataSourceName = "data-source-name";
        String indexId = "index-id";
        String dataSourceRoleArn = "arn:aws:iam::account-id:role/role-name";
        String s3BucketName = "S3-bucket-name"

        KendraClient kendra = KendraClient.builder().build();
        
        CreateDataSourceRequest createDataSourceRequest = CreateDataSourceRequest
            .builder()
            .name(dataSourceName)
            .description(experienceDescription)
            .roleArn(experienceRoleArn)
            .type(DataSourceType.S3)
            .configuration(
                DataSourceConfiguration
                    .builder()
                    .s3Configuration(
                        S3DataSourceConfiguration
                            .builder()
                            .bucketName(s3BucketName)
                            .build()
                    ).build()
            )
            .customDocumentEnrichmentConfiguration(
                CustomDocumentEnrichmentConfiguration
                    .builder()
                    .preExtractionHookConfiguration(
                        HookConfiguration
                            .builder()
                            .lambdaArn("arn:aws:iam::account-id:function/function-name")
                            .s3Bucket("S3-bucket-name")
                            .build())
                    .roleArn("arn:aws:iam::account-id:role/cde-role-name")
                    .build();
        
        CreateDataSourceResponse createDataSourceResponse = kendra.createDataSource(createDataSourceRequest);
        System.out.println(String.format("Response of creating data source: %s", createDataSourceResponse));

        String dataSourceId = createDataSourceResponse.id();
        System.out.println(String.format("Waiting for Kendra to create the data source %s", dataSourceId));
        DescribeDataSourceRequest describeDataSourceRequest = DescribeDataSourceRequest
            .builder()
            .indexId(indexId)
            .id(dataSourceId)
            .build();

        while (true) <span>{</span>
            DescribeDataSourceResponse describeDataSourceResponse = kendra.describeDataSource(describeDataSourceRequest);

            DataSourceStatus status = describeDataSourceResponse.status();
            System.out.println(String.format("Creating data source. Status: %s", status));
            TimeUnit.SECONDS.sleep(60);
            if (status != DataSourceStatus.CREATING) <span>{</span>
                break;
            }
        }

        System.out.println(String.format("Synchronize the data source %s", dataSourceId));
        StartDataSourceSyncJobRequest startDataSourceSyncJobRequest = StartDataSourceSyncJobRequest
            .builder()
            .indexId(indexId)
            .id(dataSourceId)
            .build();
        StartDataSourceSyncJobResponse startDataSourceSyncJobResponse = kendra.startDataSourceSyncJob(startDataSourceSyncJobRequest);
        System.out.println(String.format("Waiting for the data source to sync with the index %s for execution ID %s", indexId, startDataSourceSyncJobResponse.executionId()));

        // For this example, there should be one job
        ListDataSourceSyncJobsRequest listDataSourceSyncJobsRequest = ListDataSourceSyncJobsRequest
            .builder()
            .indexId(indexId)
            .id(dataSourceId)
            .build();

        while (true) <span>{</span>
            ListDataSourceSyncJobsResponse listDataSourceSyncJobsResponse = kendra.listDataSourceSyncJobs(listDataSourceSyncJobsRequest);
            DataSourceSyncJob job = listDataSourceSyncJobsResponse.history().get(0);
            System.out.println(String.format("Syncing data source. Status: %s", job.status()));

            TimeUnit.SECONDS.sleep(60);
            if (job.status() != DataSourceSyncJobStatus.SYNCING) <span>{</span>
                break;
            }

        }

        System.out.println("Data source creation with customizations is complete");
    }
}</code></pre>
                </dd>
        </dl></awsdocs-tabs>
     
        <h2 id="cde-data-contracts-lambda">Kontrak data untuk fungsi Lambda</h2>
        <p>Fungsi Lambda Anda untuk manipulasi data tingkat lanjut berinteraksi dengan kontrakAmazon Kendra data. Kontrak adalah struktur permintaan dan respons wajib dari fungsi Lambda Anda. Jika fungsi Lambda Anda tidak mengikuti struktur ini, makaAmazon Kendra lempar kesalahan.</p>
        <p>Fungsi Lambda Anda<code class="code">PreExtractionHookConfiguration</code> harus mengharapkan struktur permintaan berikut:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "version": &lt;str&gt;,
    "dataBlobStringEncodedInBase64": &lt;str&gt;, //In the case of a data blob
    "s3Bucket": &lt;str&gt;, //In the case of an S3 bucket
    "s3ObjectKey": &lt;str&gt;, //In the case of an S3 bucket
    "metadata": &lt;Metadata&gt;
}</code></pre>
        <p><code class="code">metadata</code>Struktur, yang meliputi<code class="code">CustomerDocumentAttribute</code> struktur, adalah sebagai berikut:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "attributes": [&lt;CustomerDocumentAttribute&lt;]
}

CustomerDocumentAttribute
<span>{</span>
    "name": &lt;str&gt;,
    "value": &lt;CustomerDocumentAttributeValue&gt;
}

CustomerDocumentAttributeValue
<span>{</span>
    "stringValue": &lt;str&gt;,
    "integerValue": &lt;int&gt;,
    "longValue": &lt;long&gt;,
    "stringListValue": list&lt;str&gt;,
    "dateValue": &lt;str&gt;
}</code></pre>
        <p>Fungsi Lambda<code class="code">PreExtractionHookConfiguration</code> harus mematuhi struktur respons berikut:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "version": &lt;str&gt;,
    "dataBlobStringEncodedInBase64": &lt;str&gt;, //In the case of a data blob
    "s3ObjectKey": &lt;str&gt;, //In the case of an S3 bucket
    "metadataUpdates": [&lt;CustomDocumentAttribute&gt;]
}</code></pre>
        <p>Fungsi Lambda Anda<code class="code">PostExtractionHookConfiguration</code> harus mengharapkan struktur permintaan berikut:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "version": &lt;str&gt;,
    "s3Bucket": &lt;str&gt;,
    "s3ObjectKey": &lt;str&gt;,
    "metadata": &lt;Metadata&gt;
}</code></pre>
        <p>Fungsi Lambda<code class="code">PostExtractionHookConfiguration</code> harus mematuhi struktur respons berikut:</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">PostExtractionHookConfiguration Lambda Response
<span>{</span>
    "version": &lt;str&gt;,
    "s3ObjectKey": &lt;str&gt;,
    "metadataUpdates": [&lt;CustomDocumentAttribute&gt;]
}</code></pre>
        <p>Dokumen Anda yang diubah diunggah keAmazon S3 bucket Anda. Dokumen yang diubah harus mengikuti format yang ditunjukkan di<a href="#structured-document-format">Format dokumen terstruktur</a>.</p>
         
            <h3 id="structured-document-format">Format dokumen terstruktur</h3>
            <p>Amazon Kendramengunggah dokumen terstruktur Anda keAmazon S3 bucket yang diberikan. Dokumen terstruktur mengikuti format ini:</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">Kendra document

<span>{</span>
   "textContent": &lt;TextContent&gt;
}

TextContent
<span>{</span>
  "documentBodyText": &lt;str&gt;
}</code></pre>
         
         
            <h3 id="example-lambda-function-advanced-manipulation">Contoh fungsi Lambda yang mematuhi kontrak data</h3>
            <p>Kode Python berikut adalah contoh fungsi Lambda yang menerapkan manipulasi lanjutan dari bidang metadata<code class="code">_authors</code>,<code class="code">_document_title</code>, dan isi isi pada dokumen mentah atau asli.</p>
            <p><b>Dalam kasus konten tubuh yang berada dalamAmazon S3 ember</b></p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import json&#xD;
import boto3&#xD;
     &#xD;
s3 = boto3.client("s3")&#xD;
&#xD;
# Lambda function for advanced data manipulation    &#xD;
def lambda_handler(event, context):&#xD;
    # Get the value of "S3Bucket" key name or item from the given event input&#xD;
    s3_bucket = event.get("s3Bucket")&#xD;
    # Get the value of "S3ObjectKey" key name or item from the given event input&#xD;
    s3_object_key = event.get("s3ObjectKey")&#xD;
    &#xD;
    content_object_before_CDE = s3.get_object(Bucket = s3_bucket, Key = s3_object_key)&#xD;
    content_before_CDE = content_object_before_CDE["Body"].read().decode("utf-8");&#xD;
    content_after_CDE = "CDEInvolved " + content_before_CDE&#xD;
    &#xD;
    # Get the value of "metadata" key name or item from the given event input&#xD;
    metadata = event.get("metadata")&#xD;
    # Get the document "attributes" from the metadata &#xD;
    document_attributes = metadata.get("attributes")&#xD;
    &#xD;
    s3.put_object(Bucket = s3_bucket, Key = "dummy_updated_kendra_document", Body=json.dumps(content_after_CDE))&#xD;
    return <span>{</span>&#xD;
        "version": "v0",&#xD;
        "s3ObjectKey": "dummy_updated_kendra_document",&#xD;
        "metadataUpdates": [&#xD;
            <span>{</span>"name":"_document_title", "value":<span>{</span>"stringValue":"title_from_pre_extraction_lambda"}},&#xD;
            <span>{</span>"name":"_authors", "value":<span>{</span>"stringListValue":["author1", "author2"]}}&#xD;
        ]&#xD;
    }</code></pre>
            <p><b>Dalam kasus konten tubuh yang berada dalam gumpalan data</b></p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import json&#xD;
import boto3&#xD;
import base64&#xD;
&#xD;
# Lambda function for advanced data manipulation&#xD;
def lambda_handler(event, context):&#xD;
    &#xD;
    # Get the value of "dataBlobStringEncodedInBase64" key name or item from the given event input &#xD;
    data_blob_string_encoded_in_base64 = event.get("dataBlobStringEncodedInBase64")&#xD;
    # Decode the data blob string in UTF-8&#xD;
    data_blob_string = base64.b64decode(data_blob_string_encoded_in_base64).decode("utf-8")&#xD;
    # Get the value of "metadata" key name or item from the given event input    &#xD;
    metadata = event.get("metadata")&#xD;
    # Get the document "attributes" from the metadata&#xD;
    document_attributes = metadata.get("attributes")&#xD;
    &#xD;
    new_data_blob = "This should be the modified data in the document by pre processing lambda ".encode("utf-8")&#xD;
    return <span>{</span>&#xD;
        "version": "v0",&#xD;
        "dataBlobStringEncodedInBase64": base64.b64encode(new_data_blob).decode("utf-8"),&#xD;
        "metadataUpdates": [&#xD;
            <span>{</span>"name":"_document_title", "value":<span>{</span>"stringValue":"title_from_pre_extraction_lambda"}},&#xD;
            <span>{</span>"name":"_authors", "value":<span>{</span>"stringListValue":["author1", "author2"]}}&#xD;
        ]&#xD;
    }</code></pre>
            <p>Kode Python berikut adalah contoh dari fungsi Lambda yang menerapkan manipulasi lanjutan dari bidang metadata<code class="code">_authors</code>,<code class="code">_document_title</code>, dan isi isi pada dokumen terstruktur atau diurai.</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Salinan"><awsui-icon name="copy"></awsui-icon></div></div><code class="python ">import json&#xD;
import boto3&#xD;
import time&#xD;
&#xD;
s3 = boto3.client("s3")&#xD;
&#xD;
# Lambda function for advanced data manipulation&#xD;
def lambda_handler(event, context):&#xD;
    &#xD;
    # Get the value of "S3Bucket" key name or item from the given event input&#xD;
    s3_bucket = event.get("s3Bucket")&#xD;
    # Get the value of "S3ObjectKey" key name or item from the given event input&#xD;
    s3_key = event.get("s3ObjectKey")&#xD;
    # Get the value of "metadata" key name or item from the given event input&#xD;
    metadata = event.get("metadata")&#xD;
    # Get the document "attributes" from the metadata &#xD;
    document_attributes = metadata.get("attributes")&#xD;
    &#xD;
    kendra_document_object = s3.get_object(Bucket = s3_bucket, Key = s3_key)&#xD;
    kendra_document_string = kendra_document_object['Body'].read().decode('utf-8')&#xD;
    kendra_document = json.loads(kendra_document_string)&#xD;
    kendra_document["textContent"]["documentBodyText"] = "Changing document body to a short sentence."&#xD;
    &#xD;
    s3.put_object(Bucket = s3_bucket, Key = "dummy_updated_kendra_document", Body=json.dumps(kendra_document))&#xD;
&#xD;
    return <span>{</span>&#xD;
        "version" : "v0",&#xD;
        "s3ObjectKey": "dummy_updated_kendra_document",&#xD;
        "metadataUpdates": [&#xD;
            <span>{</span>"name": "_document_title", "value":<span>{</span>"stringValue": "title_from_post_extraction_lambda"}},&#xD;
            <span>{</span>"name": "_authors", "value":<span>{</span>"stringListValue":["author1", "author2"]}}&#xD;
        ]&#xD;
    }</code></pre>
         
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Awas" /> <strong>Javascript dinonaktifkan atau tidak tersedia di browser Anda.</strong></p><p>Untuk menggunakan Dokumentasi AWS, Javascript harus diaktifkan. Lihat halaman Bantuan browser Anda untuk petunjuk.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Konvensi Dokumen</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./delete-data-source.html">Menghapus sumber data</div><div id="next" class="next-link" accesskey="n" href="./searching.html">Indeks pencarian</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Apakah halaman ini membantu Anda? - Ya</div><div class="content"><p>Terima kasih telah memberitahukan bahwa hasil pekerjaan kami sudah baik.</p><p>Jika Anda memiliki waktu luang, beri tahu kami aspek apa saja yang sudah bagus, agar kami dapat menerapkannya secara lebih luas.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Umpan Balik" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=https://docs.aws.amazon.com/id_id/kendra/latest/dg/custom-document-enrichment.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Apakah halaman ini membantu Anda? - Tidak</div><div class="content"><p>Terima kasih telah memberi tahu kami bahwa halaman ini perlu ditingkatkan. Maaf karena telah mengecewakan Anda.</p><p>Jika Anda memiliki waktu luang, beri tahu kami bagaimana dokumentasi ini dapat ditingkatkan.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Umpan Balik" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=https://docs.aws.amazon.com/id_id/kendra/latest/dg/custom-document-enrichment.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>