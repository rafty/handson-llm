<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>About SAML 2.0-based federation - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="id_roles_providers_saml" /><meta name="default_state" content="id_roles_providers_saml" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_saml.html" /><meta name="description" content="Use SAML federation to create temporary AWS security credentials that provide access to AWS resources." /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="User Guide" /><meta name="abstract" content="Control access to your AWS resources with user identity (authentication) and with policies that define specific permissions (authorization)." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_saml.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_saml.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="User Guide" /><meta id="panorama-serviceConsolePage" value="About SAML 2.0-based federation" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>About SAML 2.0-based federation - AWS Identity and Access Management</title><meta name="pdf" content="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#id_roles_providers_saml" /><meta name="github" content="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/id_roles_providers_saml.md" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_providers_saml.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_providers_saml.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_providers_saml.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM user,user,IAM group,group,IAM role,role,permission policy,trust policy,policy,access key,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "User Guide",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "IAM Identities (users, user groups, and roles)",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "IAM roles",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Identity providers and federation",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "About SAML 2.0-based federation",
        "item" : "https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/IAM/latest/UserGuide/iam-ug.pdf#id_roles_providers_saml" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/iam-user-guide/tree/main/doc_source/id_roles_providers_saml.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">User Guide</a></div><div id="page-toc-src"><a href="#CreatingSAML-configuring">Using SAML-based federation for API access to
        AWS</a><a href="#CreatingSAML-configuring-IdP">Overview of configuring SAML 2.0-based
          federation</a><a href="#CreatingSAML-configuring-role">Overview of the role to allow SAML-federated
          access to your AWS resources</a><a href="#CreatingSAML-userid">Uniquely identifying users in SAML-based
          federation</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="id_roles_providers_saml">About SAML 2.0-based federation</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>AWS supports identity federation with <a href="https://wiki.oasis-open.org/security" rel="noopener noreferrer" target="_blank"><span>SAML 2.0 (Security Assertion Markup Language 2.0)</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>, an open standard that many
    identity providers (IdPs) use. This feature enables federated single sign-on (SSO), so users can
    log into the AWS Management Console or call the AWS API operations without you having to create an IAM
    user for everyone in your organization. By using SAML, you can simplify the process of
    configuring federation with AWS, because you can use the IdP's service instead of <a href="https://docs.aws.amazon.com/STS/latest/UsingSTS/CreatingFedTokens.html">writing custom identity proxy code</a>.</p><p>IAM federation supports these use cases: </p><div class="itemizedlist">
     
     
  <ul class="itemizedlist"><li class="listitem">
      <p><a href="#CreatingSAML-configuring">Federated access to allow
            a user or application in your organization to call AWS API
          operations</a>. You use a SAML assertion (as part of the authentication
        response) that is generated in your organization to get temporary security credentials. This
        scenario is similar to other federation scenarios that IAM supports, like those described
        in <a href="./id_credentials_temp_request.html">Requesting temporary security credentials</a>
        and <a href="./id_roles_providers_oidc.html">About web identity federation</a>.
        However, SAML 2.0–based IdPs in your organization handle many of the details at run
        time for performing authentication and authorization checking. This is the scenario
        discussed in this topic.</p>
    </li><li class="listitem">
      <p><a href="./id_roles_providers_enable-console-saml.html">Web-based
            single sign-on (SSO) to the AWS Management Console from your organization</a>. Users
        can sign in to a portal in your organization hosted by a SAML 2.0–compatible IdP,
        select an option to go to AWS, and be redirected to the console without having to provide
        additional sign-in information. You can use a third-party SAML IdP to establish SSO access
        to the console or you can create a custom IdP to enable console access for your external
        users. For more information about building a custom IdP, see <a href="./id_roles_providers_enable-console-custom-url.html">Enabling custom identity broker
      access to the AWS console</a>.</p>
    </li></ul></div><div class="highlights" id="inline-topiclist"><h6>Topics</h6><ul><li><a href="#CreatingSAML-configuring">Using SAML-based federation for API access to
        AWS</a></li><li><a href="#CreatingSAML-configuring-IdP">Overview of configuring SAML 2.0-based
          federation</a></li><li><a href="#CreatingSAML-configuring-role">Overview of the role to allow SAML-federated
          access to your AWS resources</a></li><li><a href="#CreatingSAML-userid">Uniquely identifying users in SAML-based
          federation</a></li></ul></div>
    <h2 id="CreatingSAML-configuring">Using SAML-based federation for API access to
        AWS</h2>

    <p>Assume that you want to provide a way for employees to copy data from their computers to a
      backup folder. You build an application that users can run on their computers. On the back
      end, the application reads and writes objects in an S3 bucket. Users don't have direct access
      to AWS. Instead, the following process is used:</p>

    <div class="mediaobject">
       
        <img src="/images/IAM/latest/UserGuide/images/saml-based-federation.diagram.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;        Getting temporary security credentials based on a SAML assertion&#xA;      " style="max-width:100%" />
       
       
    </div>
    <div class="orderedlist">
       
       
       
       
       
       
    <ol><li>
        <p>A user in your organization uses a client app to request authentication from your
          organization's IdP.</p>
      </li><li>
        <p>The IdP authenticates the user against your organization's identity store.</p>
      </li><li>
        <p>The IdP constructs a SAML assertion with information about the user and sends the
          assertion to the client app.</p>
      </li><li>
        <p>The client app calls the AWS STS <a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html"><code class="code">AssumeRoleWithSAML</code></a> API, passing the ARN of the SAML provider,
          the ARN of the role to assume, and the SAML assertion from IdP.</p>
      </li><li>
        <p>The API response to the client app includes temporary security credentials.</p>
      </li><li>
        <p>The client app uses the temporary security credentials to call Amazon S3 API operations.
        </p>
      </li></ol></div>
   
      <h2 id="CreatingSAML-configuring-IdP">Overview of configuring SAML 2.0-based
          federation</h2>

      <p>Before you can use SAML 2.0-based federation as described in the preceding scenario and
        diagram, you must configure your organization's IdP and your AWS account to trust each
        other. The general process for configuring this trust is described in the following steps.
        Inside your organization, you must have an <a href="./id_roles_providers_saml_3rd-party.html">IdP that supports SAML 2.0</a>, like Microsoft Active Directory Federation Service (AD
        FS, part of Windows Server), Shibboleth, or another compatible SAML 2.0 provider. </p>

      <div class="procedure"><h6>To configure your organization's IdP and AWS to trust each other</h6><ol><li>
          <p>Register AWS as a service provider (SP) with the IdP of your organization. Use the
            SAML metadata document from <code class="code">https://<code class="replaceable">region-code</code>.signin.aws.amazon.com/static/saml-metadata.xml</code>
            </p>
          <p>For a list of possible <code class="replaceable">region-code</code> values, see the
              <b>Region</b> column in <a href="https://docs.aws.amazon.com/general/latest/gr/signin-service.html">AWS Sign-In
              endpoints</a>.</p>
          <p>You can optionally use the SAML metadata document from <code class="code">https://signin.aws.amazon.com/static/saml-metadata.xml</code>
            .</p>
        </li><li><a id="createxml"></a>
          <p>Using your organization's IdP, you generate an equivalent metadata XML file that can
            describe your IdP as an IAM identity provider in AWS. It must include the issuer
            name, a creation date, an expiration date, and keys that AWS can use to validate
            authentication responses (assertions) from your organization. </p>
        </li><li><a id="samlovrcreateentity"></a>
          <p>In the IAM console, you create a SAML identity provider entity. As part of this
            process, you upload the SAML metadata document that was produced by the IdP in your
            organization in <a href="#createxml">Step 2</a>. For more
            information, see <a href="./id_roles_providers_create_saml.html">Creating IAM SAML identity providers</a>.</p>
        </li><li><a id="samlovrcreaterole"></a>
          <p>In IAM, you create one or more IAM roles. In the role's trust policy, you set
            the SAML provider as the principal, which establishes a trust relationship between your
            organization and AWS. The role's permission policy establishes what users from your
            organization are allowed to do in AWS. For more information, see <a href="./id_roles_create_for-idp.html">Creating a role for a third-party Identity Provider
      (federation)</a>.</p>
        </li><li>
          <p>In your organization's IdP, you define assertions that map users or groups in your
            organization to the IAM roles. Note that different users and groups in your
            organization might map to different IAM roles. The exact steps for performing the
            mapping depend on what IdP you're using. In the <a href="#CreatingSAML-configuring">earlier scenario</a> of an Amazon S3 folder for
            users, it's possible that all users will map to the same role that provides Amazon S3
            permissions. For more information, see <a href="./id_roles_providers_create_saml_assertions.html">Configuring SAML assertions for the
      authentication response</a>.</p>
          <p>If your IdP enables SSO to the AWS console, then you can configure the maximum
            duration of the console sessions. For more information, see <a href="./id_roles_providers_enable-console-saml.html">Enabling SAML 2.0 federated users to
      access the AWS Management Console</a>.</p>
          <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>The AWS implementation of SAML 2.0 federation does not support encrypted SAML
              assertions between the IAM identity provider and AWS. However, the traffic between
              the customer's systems and AWS is transmitted over an encrypted (TLS)
              channel.</p></div></div>
        </li><li>
          <p>In the application that you're creating, you call the AWS Security Token Service
              <code class="code">AssumeRoleWithSAML</code> API, passing it the ARN of the SAML provider you
            created in <a href="#samlovrcreateentity">Step 3</a>, the ARN
            of the role to assume that you created in <a href="#samlovrcreaterole">Step 4</a>, and the SAML assertion about the current user that
            you get from your IdP. AWS makes sure that the request to assume the role comes from
            the IdP referenced in the SAML provider. </p>
          <p>For more information, see <a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoleWithSAML.html">AssumeRoleWithSAML</a> in the <em>AWS Security Token Service API Reference</em>.
          </p>
        </li><li>
          <p>If the request is successful, the API returns a set of temporary security
            credentials, which your application can use to make signed requests to AWS. Your
            application has information about the current user and can access user-specific folders
            in Amazon S3, as described in the previous scenario. </p>
        </li></ol></div>

     
      <h2 id="CreatingSAML-configuring-role">Overview of the role to allow SAML-federated
          access to your AWS resources</h2>

      <p>The role or roles that you create in IAM define what federated users from your
        organization are allowed to do in AWS. When you create the trust policy for the role, you
        specify the SAML provider that you created earlier as the <code class="code">Principal</code>. You can
        additionally scope the trust policy with a <code class="code">Condition</code> to allow only users that
        match certain SAML attributes to access the role. For example, you can specify that only
        users whose SAML affiliation is <code class="code">staff</code> (as asserted by https://openidp.feide.no)
        are allowed to access the role, as illustrated by the following sample policy:</p>

      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
  "Version": "2012-10-17",
  "Statement": [<span>{</span>
    "Effect": "Allow",
    "Principal": <span>{</span>"Federated": "arn:aws:iam::<code class="replaceable">account-id</code>:saml-provider/ExampleOrgSSOProvider"},
    "Action": "sts:AssumeRoleWithSAML",
    "Condition": <span>{</span>
      "StringEquals": <span>{</span>
        "saml:aud": "https://signin.aws.amazon.com/saml",
        "saml:iss": "https://openidp.feide.no"
      },
      "ForAllValues:StringLike": <span>{</span>"saml:edupersonaffiliation": ["staff"]}
    }
  }]
}</code></pre>
      

      <p>For more information about the SAML keys that you can check in a policy, see <a href="./reference_policies_iam-condition-keys.html#condition-keys-saml">Available keys for SAML-based AWS STS
            federation</a>.</p>
      <p>You can include regional endpoints for the <code class="code">saml:aud</code> attribute at
            <code class="code">https://<code class="replaceable">region-code</code>.signin.aws.amazon.com/static/saml-metadata.xml</code>.
        For a list of possible <code class="replaceable">region-code</code> values, see the
          <b>Region</b> column in <a href="https://docs.aws.amazon.com/general/latest/gr/signin-service.html">AWS Sign-In
          endpoints</a>.</p>
      <p>For the permission policy in the role, you specify permissions as you would for any
        role. For example, if users from your organization are allowed to administer Amazon Elastic Compute Cloud
        instances, you must explicitly allow Amazon EC2 actions in the permissions policy, such as those
        in the <b>AmazonEC2FullAccess</b> managed policy. </p>
     
      <h2 id="CreatingSAML-userid">Uniquely identifying users in SAML-based
          federation</h2>


      <p>When you create access policies in IAM, it's often useful to be able to specify
        permissions based on the identity of users. For example, for users who have been federated
        using SAML, an application might want to keep information in Amazon S3 using a structure like
        this: </p>

      <pre class="programlisting"><div class="code-btn-container"></div><code class="nohighlight">myBucket/app1/<code class="replaceable">user1</code>
myBucket/app1/<code class="replaceable">user2</code>
myBucket/app1/<code class="replaceable">user3</code></code></pre>

      <p>You can create the bucket (<code class="code">myBucket</code>) and folder (<code class="code">app1</code>) through
        the Amazon S3 console or the AWS CLI, since those are static values. However, the user-specific
        folders (<code class="replaceable">user1</code>, <code class="replaceable">user2</code>,
          <code class="replaceable">user3</code>, etc.) have to be created at run time using code, since
        the value that identifies the user isn't known until the first time the user signs in
        through the federation process. </p>

      <p>To write policies that reference user-specific details as part of a resource name, the
        user identity has to be available in SAML keys that can be used in policy conditions. The
        following keys are available for SAML 2.0–based federation for use in IAM policies.
        You can use the values returned by the following keys to create unique user identifiers for
        resources like Amazon S3 folders. </p>

      <div class="itemizedlist">
         

         

         
      <ul class="itemizedlist"><li class="listitem">
          <p><code class="code">saml:namequalifier</code>. A hash value based on the concatenation of the
              <code class="code">Issuer</code> response value (<code class="code">saml:iss</code>) and a string with the
              <code class="code">AWS</code> account ID and the friendly name (the last part of the ARN) of the
            SAML provider in IAM. The concatenation of the account ID and friendly name of the
            SAML provider is available to IAM policies as the key <code class="code">saml:doc</code>. The
            account ID and provider name must be separated by a '/' as in
            "123456789012/provider_name". For more information, see the
              <code class="code">saml:doc</code> key at <a href="./reference_policies_iam-condition-keys.html#condition-keys-saml">Available keys for SAML-based AWS STS
            federation</a>.</p>
          <p>The combination of <code class="code">NameQualifier</code> and <code class="code">Subject</code> can be used
            to uniquely identify a federated user. The following pseudocode shows how this value is
            calculated. In this pseudocode <code class="code">+</code> indicates concatenation, <code class="code">SHA1</code>
            represents a function that produces a message digest using SHA-1, and
              <code class="code">Base64</code> represents a function that produces Base-64 encoded version of the
            hash output.</p>
          <p>
            <code class="code">Base64 ( SHA1 ( "https://example.com/saml" + "123456789012" +
              "/MySAMLIdP" ) )</code>
          </p>
          <p> For more information about the policy keys that are available for SAML-based
            federation, see <a href="./reference_policies_iam-condition-keys.html#condition-keys-saml">Available keys for SAML-based AWS STS
            federation</a>.</p>
        </li><li class="listitem">
          <p><code class="code">saml:sub</code> (string). This is the subject of the claim, which includes a
            value that uniquely identifies an individual user within an organization (for example,
              <code class="code">_cbb88bf52c2510eabe00c1642d4643f41430fe25e3</code>). </p>
        </li><li class="listitem">
          <p><code class="code">saml:sub_type</code> (string). This key can be <code class="code">persistent</code>,
              <code class="code">transient</code>, or the full <code class="code">Format</code> URI from the
              <code class="code">Subject</code> and <code class="code">NameID</code> elements used in your SAML assertion. A
            value of <code class="code">persistent</code> indicates that the value in <code class="code">saml:sub</code> is
            the same for a user across all sessions. If the value is <code class="code">transient</code>, the
            user has a different <code class="code">saml:sub</code> value for each session. For information about
            the <code class="code">NameID</code> element's <code class="code">Format</code> attribute, see <a href="./id_roles_providers_create_saml_assertions.html">Configuring SAML assertions for the
      authentication response</a>. </p>
        </li></ul></div>

      <p>The following example shows a permission policy that uses the preceding keys to grant
        permissions to a user-specific folder in Amazon S3. The policy assumes that the Amazon S3 objects are
        identified using a prefix that includes both <code class="code">saml:namequalifier</code> and
          <code class="code">saml:sub</code>. Notice that the <code class="code">Condition</code> element includes a test to
        be sure that <code class="code">saml:sub_type</code> is set to <code class="code">persistent</code>. If it is set to
          <code class="code">transient</code>, the <code class="code">saml:sub</code> value for the user can be different for
        each session, and the combination of values should not be used to identify user-specific
        folders. </p>


      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
  "Version": "2012-10-17",
  "Statement": <span>{</span>
    "Effect": "Allow",
    "Action": [
      "s3:GetObject",
      "s3:PutObject",
      "s3:DeleteObject"
    ],
    "Resource": [
      "arn:aws:s3:::exampleorgBucket/backup/$<span>{</span>saml:namequalifier}/$<span>{</span>saml:sub}",
      "arn:aws:s3:::exampleorgBucket/backup/$<span>{</span>saml:namequalifier}/$<span>{</span>saml:sub}/*"
    ],
    "Condition": <span>{</span>"StringEquals": <span>{</span>"saml:sub_type": "persistent"}}
  }
}</code></pre>
      

      <p>For more information about mapping assertions from the IdP to policy keys, see <a href="./id_roles_providers_create_saml_assertions.html">Configuring SAML assertions for the
      authentication response</a>. </p>

    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./id_roles_providers_oidc_resources.html">Additional resources for web identity
      federation</div><div id="next" class="next-link" accesskey="n" href="./id_roles_providers_create.html">Creating IAM identity providers</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_providers_saml.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/en_us/IAM/latest/UserGuide/id_roles_providers_saml.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>