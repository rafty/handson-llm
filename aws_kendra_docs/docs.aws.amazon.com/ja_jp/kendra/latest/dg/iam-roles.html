<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="ja-JP"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>IAMのアクセスロールAmazon Kendra - Amazon Kendra</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="iam-roles" /><meta name="default_state" content="iam-roles" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/iam-roles.html" /><meta name="description" content="に必要なアクセス権限Amazon Kendra。" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Kendra" /><meta name="guide" content="デベロッパーガイド" /><meta name="abstract" content="Amazon Kendra の概念的な概要について説明します。Amazon Kendra機能について学び、コンソール、CLI、API を使用してドキュメントのインデックス作成を始めましょう。" /><meta name="guide-locale" content="ja_jp" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/iam-roles.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/iam-roles.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/kendra/latest/dg/iam-roles.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kendra/latest/dg/iam-roles.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/kendra/latest/dg/iam-roles.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/iam-roles.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/iam-roles.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kendra/latest/dg/iam-roles.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/kendra/latest/dg/iam-roles.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/iam-roles.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/kendra/latest/dg/iam-roles.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kendra/latest/dg/iam-roles.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/kendra/latest/dg/iam-roles.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/iam-roles.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/iam-roles.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kendra/latest/dg/iam-roles.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/kendra/latest/dg/iam-roles.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kendra/latest/dg/iam-roles.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/kendra/latest/dg/iam-roles.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/kendra/latest/dg/iam-roles.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/kendra/latest/dg/iam-roles.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/kendra/latest/dg/iam-roles.html" hreflang="x-default" /><meta name="feedback-item" content="Kendra" /><meta name="this_doc_product" content="Amazon Kendra" /><meta name="this_doc_guide" content="デベロッパーガイド" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'kendra'}"></script><meta id="panorama-serviceSubSection" value="デベロッパーガイド" /><meta id="panorama-serviceConsolePage" value="IAMのアクセスロールAmazon Kendra" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>IAMのアクセスロールAmazon Kendra - Amazon Kendra</title><meta name="pdf" content="kendra-dg.pdf#iam-roles" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=http://docs.aws.amazon.com/ja_jp/kendra/latest/dg/iam-roles.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/ja_jp/kendra/latest/dg/iam-roles.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/ja_jp/kendra/latest/dg/iam-roles.html" /><meta name="keywords" content="Kendra,Amazon Kendra,search (検索),インテリジェント検索,自然言語,インデックス,質問,キーワード,データソース,コネクタ,よくある質問" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Kendra",
        "item" : "https://docs.aws.amazon.com/kendra/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "デベロッパーガイド",
        "item" : "https://docs.aws.amazon.com/ja_jp/kendra/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "IAMのアクセスロールAmazon Kendra",
        "item" : "https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/iam-roles.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="kendra-dg.pdf#iam-roles" target="_blank" rel="noopener noreferrer" title="PDF を開く"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">ドキュメント</a><a href="/kendra/index.html">Amazon Kendra</a><a href="what-is-kendra.html">デベロッパーガイド</a></div><div id="page-toc-src"><a href="#iam-roles-index">IAMインデックスのロール</a><a href="#iam-roles-batch">IAM BatchPutDocumentAPI のロール</a><a href="#iam-roles-ds">IAMデータソースロール</a><a href="#iam-roles-ds-faq">IAMよくある質問ロール</a><a href="#iam-roles-query-suggestions">IAMクエリ提案のロール</a><a href="#iam-roles-principal-mapping">IAMユーザーとグループのプリンシパルマッピングロール</a><a href="#iam-roles-aws-sso">AWS IAM Identity Center (successor to AWS Single Sign-On) の IAM ロール</a><a href="#iam-roles-amazon-kendra-experiences">IAMAmazon Kendraエクスペリエンスの役割</a><a href="#iam-roles-custom-document-enrichment">IAMCustom Document Enrichment のロール</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>翻訳は機械翻訳により提供されています。提供された翻訳内容と英語版の間で齟齬、不一致または矛盾がある場合、英語版が優先します。</p></awsui-alert><h1 class="topictitle" id="iam-roles">IAMのアクセスロールAmazon Kendra</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>インデックス、データソース、または FAQ を作成する場合、Amazon KendraAWSAmazon Kendraリソースの作成に必要なリソースへのアクセスが必要です。Amazon Kendraリソースを作成する前に、AWS Identity and Access Management (IAM) ポリシーを作成する必要があります。演算を呼び出すときに、ポリシーを添付したロールの Amazon リソースネーム (ARN) を指定します。たとえば、<a href="https://docs.aws.amazon.com/kendra/latest/dg/API_BatchPutDocument.html">BatchPutDocument</a>API を呼び出してバケットからドキュメントを追加する場合は、Amazon S3バケットへのアクセス権を持つポリシーを持つロールを提供しますAmazon Kendra。</p><p>IAMAmazon Kendraコンソールで新しいロールを作成するか、IAM使用する既存のロールを選択できます。コンソールには、ロール名に「kendra」または「Kendra」という文字列が含まれるロールが表示されます。</p><p>次のトピックでは、必要なポリシーの詳細について説明します。IAMAmazon Kendraコンソールを使用してロールを作成すると、これらのポリシーが作成されます。</p><div class="highlights" id="inline-topiclist"><h6>トピック</h6><ul><li><a href="#iam-roles-index">IAMインデックスのロール</a></li><li><a href="#iam-roles-batch">IAM BatchPutDocumentAPI のロール</a></li><li><a href="#iam-roles-ds">IAMデータソースロール</a></li><li><a href="#iam-roles-ds-faq">IAMよくある質問ロール</a></li><li><a href="#iam-roles-query-suggestions">IAMクエリ提案のロール</a></li><li><a href="#iam-roles-principal-mapping">IAMユーザーとグループのプリンシパルマッピングロール</a></li><li><a href="#iam-roles-aws-sso">AWS IAM Identity Center (successor to AWS Single Sign-On) の IAM ロール</a></li><li><a href="#iam-roles-amazon-kendra-experiences">IAMAmazon Kendraエクスペリエンスの役割</a></li><li><a href="#iam-roles-custom-document-enrichment">IAMCustom Document Enrichment のロール</a></li></ul></div>
        <h2 id="iam-roles-index">IAMインデックスのロール</h2>
        <p>インデックスを作成するときは、IAMへの書き込み許可を持つロールを提供する必要がありますAmazon CloudWatch。Amazon Kendraがロールを引き受けることを許可する信頼ポリシーを提供する必要があります。次のポリシーは、提供する必要があるポリシーです。</p>
        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMインデックスのロール" id="permissions-policy" expanded="false"><p>Amazon KendraCloudWatchログへのアクセスを許可するロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": "cloudwatch:PutMetricData",
            "Resource": "*",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "cloudwatch:namespace": "AWS/Kendra"
                }
            }
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": "logs:DescribeLogGroups",
            "Resource": "*"
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": "logs:CreateLogGroup",
            "Resource": "arn:aws:logs:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:log-group:/aws/kendra/*"
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "logs:DescribeLogStreams",
                "logs:CreateLogStream",
                "logs:PutLogEvents"
            ],
            "Resource": "arn:aws:logs:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:log-group:/aws/kendra/*:log-stream:*"
        }
    ]
}</code></pre><p>Amazon Kendraアクセスを許可するロールポリシーAWS Secrets Manager。Secrets Managerキーの場所としてユーザーコンテキストを使用している場合は、次のポリシーを使用できます。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Action":"cloudwatch:PutMetricData",
         "Resource":"*",
         "Condition":<span>{</span>
            "StringEquals":<span>{</span>
               "cloudwatch:namespace":"AWS/Kendra"
            }
         }
      },
      <span>{</span>
         "Effect":"Allow",
         "Action":"logs:DescribeLogGroups",
         "Resource":"*"
      },
      <span>{</span>
         "Effect":"Allow",
         "Action":"logs:CreateLogGroup",
         "Resource":"arn:aws:logs:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:log-group:/aws/kendra/*"
      },
      <span>{</span>
         "Effect":"Allow",
         "Action":[
            "logs:DescribeLogStreams",
            "logs:CreateLogStream",
            "logs:PutLogEvents"
         ],
         "Resource":"arn:aws:logs:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:log-group:/aws/kendra/*:log-stream:*"
      },
      <span>{</span>
         "Effect":"Allow",
         "Action":[
            "secretsmanager:GetSecretValue"
         ],
         "Resource":[
            "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:secret:<code class="replaceable">secret_id</code>"
         ]
      },
      <span>{</span>
         "Effect":"Allow",
         "Action":[
            "kms:Decrypt"
         ],
         "Resource":[
            "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key_id</code>"
         ],
         "Condition":<span>{</span>
            "StringLike":<span>{</span>
               "kms:ViaService":[
                  "secretsmanager.*.amazonaws.com"
               ]
            }
         }
      }
   ]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>
     
        <h2 id="iam-roles-batch">IAM BatchPutDocumentAPI のロール</h2>
        <div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>警告</h6></div><div class="awsdocs-note-text"><p>Amazon Kendraは、S3Amazon Kendra バケットを操作するためのアクセス権限をプリンシパルに付与するバケットポリシーを使用していません。代わりに、IAMロールを使用します。誤って任意のプリンシパルにアクセス許可を付与することによるデータセキュリティ上の問題を避けるため、Amazon Kendraバケットポリシーに信頼できるメンバーとして含まれていないことを確認してください。ただし、バケットポリシーを追加して、Amazon S3複数のアカウントでバケットを使用することはできます。詳細については、「<a href="https://docs.aws.amazon.com/kendra/latest/dg/iam-roles.html#iam-roles-ds-s3-cross-accounts">Amazon S3アカウント間で使用するポリシー</a>」を参照してください。S3IAM データソースのロールについては、「<a href="https://docs.aws.amazon.com/kendra/latest/dg/iam-roles.html#iam-roles-ds-s3">IAMロール</a>」を参照してください。</p></div></div>
        <p><a href="https://docs.aws.amazon.com/kendra/latest/dg/API_BatchPutDocument.html">BatchPutDocument</a>API を使用してバケット内のドキュメントをインデックス化する場合、Amazon S3Amazon KendraIAMバケットへのアクセス権を持つロールを提供する必要があります。Amazon Kendraがロールを引き受けることを許可する信頼ポリシーを提供する必要があります。バケット内のドキュメントが暗号化されている場合は、ドキュメントを復号化する AWS KMS カスタマーマスターキー (CMK) を使用する許可を提供する必要があります。</p>
        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAM BatchPutDocument API のロール" id="iam-roles-batch-json" expanded="false"><p>Amazon KendraAmazon S3バケットへのアクセスを許可する必須ロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "s3:GetObject"
            ],
            "Resource": [
                "arn:aws:s3:::<code class="replaceable">bucket name</code>/*"
            ]
        }
    ]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
<p><code class="code">aws:sourceAccount</code><code class="code">aws:sourceArn</code>信頼ポリシーにはとを含めることをお勧めします。これにより、権限が制限され<code class="code">aws:sourceAccount</code>、<code class="code">aws:sourceArn</code>IAM<code class="code">sts:AssumeRole</code>アクションのロールポリシーで指定されているものと同じかどうかが安全にチェックされます。これにより、IAM権限のないエンティティがロールとその権限にアクセスするのを防ぐことができます。詳細については、混乱した代理」<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/confused-deputy.html">混乱した代理」AWS Identity and Access Management 問題に関するガイドを参照してください</a>。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Principal": <span>{</span>
                "Service": [
                    "kendra.*.amazonaws.com"
                ]
            },
            "Action": "sts:AssumeRole",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "aws:SourceAccount": "account ID"
                },
                "StringLike": <span>{</span>
                    "aws:SourceArn": "arn:aws:kendra:region:accountId:index/*"
                }
            }
        }
    ]
}</code></pre><p>Amazon S3バケット内のドキュメントを復号化するAWS KMSカスタマーマスターキー (CMK)Amazon Kendra を使用することを許可する任意のロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kms:Decrypt"
            ],
            "Resource": [
                "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
            ]
        }
    ]
}</code></pre></awsui-expandable-section></div>
     
        <h2 id="iam-roles-ds">IAMデータソースロール</h2>
        <p><a href="https://docs.aws.amazon.com/kendra/latest/dg/API_CreateDataSource.html">CreateDataSource</a>API を使用するときは、Amazon KendraIAMデータベースリソースにアクセスする権限を持つロールを付与する必要があります。必要な特定のアクセス権限、は、データソースによって異なります。</p>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMAlfresco データソースのロール" id="iam-roles-ds-alfresco" expanded="false"><p>Alfrescoを使用する場合、次のポリシーでロールを提供します。</p><div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>AWS Secrets ManagerシークレットにアクセスしてAlfrescoを認証する権限。</p>
                    </li><li class="listitem">
                        <p>Alfresco コネクタに必要なパブリック API の呼び出し許可。</p>
                    </li><li class="listitem">
                        <p><code class="code">BatchPutDocument</code>、、、<code class="code">BatchDeleteDocument</code><code class="code">PutPrincipalMapping</code><code class="code">DeletePrincipalMapping</code><code class="code">DescribePrincipalMapping</code>、および<code class="code">ListGroupsOlderThanOrderingId</code> API を呼び出す権限。</p>
                    </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:secret:[[secret_id]]"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:key/[[key_id]]"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
        "kendra:PutPrincipalMapping",
        "kendra:DeletePrincipalMapping",
        "kendra:ListGroupsOlderThanOrderingId",
        "kendra:DescribePrincipalMapping"
    ],
    "Resource": ["arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}", "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}/data-source/*"]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}"
  }]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMAmazon S3データソースの役割" id="iam-roles-ds-s3" expanded="false"><div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>警告</h6></div><div class="awsdocs-note-text"><p>Amazon Kendraは、S3Amazon Kendra バケットを操作するためのアクセス権限をプリンシパルに付与するバケットポリシーを使用していません。代わりに、IAMロールを使用します。誤って任意のプリンシパルにアクセス許可を付与することによるデータセキュリティ上の問題を避けるため、Amazon Kendraバケットポリシーに信頼できるメンバーとして含まれていないことを確認してください。ただし、バケットポリシーを追加して、Amazon S3複数のアカウントでバケットを使用することはできます。詳細については、<a href="#iam-roles-ds-s3-cross-accounts">Amazon S3アカウント間で使用するポリシー</a> (下へスクロール) を参照してください。</p></div></div><p>Amazon S3バケットをデータソースとして使用する場合、<code class="code">BatchPutDocument</code><code class="code">BatchDeleteDocument</code>バケットへのアクセスおよび演算を使用する許可を持つロールを提供します。Amazon S3バケット内のドキュメントが暗号化されている場合は、ドキュメントを復号化するAWS KMSカスタマーマスターキー (CMK) を使用する許可を提供する必要があります。</p><p>Amazon KendraAmazon S3バケットをデータソースとして使用できるようにする必須ロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
         <span>{</span>
            "Action": [
                "s3:GetObject"
            ],
            "Resource": [
                "arn:aws:s3:::<code class="replaceable">bucket name</code>/*"
            ],
            "Effect": "Allow"
        },
        <span>{</span>
            "Action": [
                "s3:ListBucket"
            ],
            "Resource": [
                "arn:aws:s3:::<code class="replaceable">bucket name</code>"
            ],
            "Effect": "Allow"
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kendra:BatchPutDocument",
                "kendra:BatchDeleteDocument"
            ],
            "Resource": [
                "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:index/<code class="replaceable">index ID</code>"
            ]
        }
    ]
}</code></pre><p>Amazon S3バケット内のドキュメントを復号化するAWS KMSカスタマーマスターキー (CMK)Amazon Kendra を使用することを許可する任意のロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kms:Decrypt"
            ],
            "Resource": [
                "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
            ]
        }
    ]
}</code></pre><p>AWS KMSAWS KMSアクセス権限をアクティブ化したり共有したりせずにAmazon VPC、Amazon KendraAmazon S3を使用しながらバケットにアクセスできるようにするオプションのロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Action": [
        "s3:GetObject"
      ],
      "Resource": [
        "arn:aws:s3:::<span>{</span><span>{</span>input_bucket_name}}/*"
      ],
      "Effect": "Allow"
    },
    <span>{</span>
      "Action": [
        "s3:ListBucket"
      ],
      "Resource": [
        "arn:aws:s3:::<span>{</span><span>{</span>input_bucket_name}}"
      ],
      "Effect": "Allow"
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:CreateNetworkInterface"
      ],
      "Resource": [
        "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:subnet/[[subnet_ids]]",
        "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:security-group/[[security_group]]"
      ]
    },
    <span>{</span>
        "Effect": "Allow",
        "Action": [
            "ec2:CreateNetworkInterface"
        ],
        "Resource": "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:network-interface/*",
        "Condition": <span>{</span>
            "StringLike": <span>{</span>
                "aws:RequestTag/AWS_KENDRA": "kendra_<span>{</span><span>{</span>account_id}}_<span>{</span><span>{</span>index_id}}_<span>{</span>datasource_id}}_*"
            }
        }
    },
    <span>{</span>
        "Effect": "Allow",
        "Action": [
            "ec2:CreateTags"
        ],
        "Resource": "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:network-interface/*",
        "Condition": <span>{</span>
            "StringEquals": <span>{</span>
                "ec2:CreateAction": "CreateNetworkInterface"
            }
        }
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:DescribeSubnets"
      ],
      "Resource": ["arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:subnet/[[subnet_ids]]"]
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:DescribeNetworkInterfaces"
      ],
      "Resource": "*"
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:CreateNetworkInterfacePermission"
      ],
      "Resource": "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:network-interface/*",
      "Condition": <span>{</span>
        "StringEquals": <span>{</span>
          "ec2:AuthorizedService": "kendra.amazonaws.com"
        },
        "ArnEquals": <span>{</span>
          "ec2:Subnet": [
            "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:subnet/[[subnet_ids]]"
          ]
        }
      }
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "kendra:PutPrincipalMapping",
        "kendra:DeletePrincipalMapping",
        "kendra:ListGroupsOlderThanOrderingId",
        "kendra:DescribePrincipalMapping"
      ],
      "Resource": [
        "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}",
        "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}/data-source/*"
      ]
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "kendra:BatchPutDocument",
        "kendra:BatchDeleteDocument"
      ],
      "Resource": "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}"
    }
  ]
}
<span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Effect": "Allow",
      "Principal": <span>{</span>
        "Service": "kendra.amazonaws.com"
      },
      "Action": "sts:AssumeRole"
    }
  ]
}</code></pre><p>Amazon KendraAmazon S3の使用中にバケットへのアクセスを許可し、Amazon VPCAWS KMS権限を有効にした状態でバケットにアクセスできるようにするオプションのロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Action": [
        "s3:GetObject"
      ],
      "Resource": [
        "arn:aws:s3:::<span>{</span><span>{</span>input_bucket_name}}/*"
      ],
      "Effect": "Allow"
    },
    <span>{</span>
      "Action": [
        "s3:ListBucket"
      ],
      "Resource": [
        "arn:aws:s3:::<span>{</span><span>{</span>input_bucket_name}}"
      ],
      "Effect": "Allow"
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "kms:Decrypt"
      ],
      "Resource": [
        "arn:aws:kms:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:key/<span>{</span><span>{</span>key_id}}"
      ],
      "Condition": <span>{</span>
        "StringLike": <span>{</span>
          "kms:ViaService": [
            "s3.*.amazonaws.com"
          ]
        }
      }
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:CreateNetworkInterface"
      ],
      "Resource": [
        "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:subnet/[[subnet_ids]]",
        "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:security-group/[[security_group]]"
      ]
    },
    <span>{</span>
        "Effect": "Allow",
        "Action": [
            "ec2:CreateNetworkInterface"
        ],
        "Resource": "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:network-interface/*",
        "Condition": <span>{</span>
            "StringLike": <span>{</span>
                "aws:RequestTag/AWS_KENDRA": "kendra_<span>{</span><span>{</span>account_id}}_<span>{</span><span>{</span>index_id}}_<span>{</span>datasource_id}}_*"
            }
        }
    },
    <span>{</span>
        "Effect": "Allow",
        "Action": [
            "ec2:CreateTags"
        ],
        "Resource": "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:network-interface/*",
        "Condition": <span>{</span>
            "StringEquals": <span>{</span>
                "ec2:CreateAction": "CreateNetworkInterface"
            }
        }
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:DescribeSubnets"
      ],
      "Resource": ["arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:subnet/[[subnet_ids]]"]
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:DescribeNetworkInterfaces"
      ],
      "Resource": "*"
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:CreateNetworkInterfacePermission"
      ],
      "Resource": "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:network-interface/*",
      "Condition": <span>{</span>
        "StringEquals": <span>{</span>
          "ec2:AuthorizedService": "kendra.amazonaws.com"
        },
        "ArnEquals": <span>{</span>
          "ec2:Subnet": [
            "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:subnet/[[subnet_ids]]"
          ]
        }
      }
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "kendra:PutPrincipalMapping",
        "kendra:DeletePrincipalMapping",
        "kendra:ListGroupsOlderThanOrderingId",
        "kendra:DescribePrincipalMapping"
      ],
      "Resource": [
        "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}",
        "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}/data-source/*"
      ]
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "kendra:BatchPutDocument",
        "kendra:BatchDeleteDocument"
      ],
      "Resource": "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}"
    }
  ]
}

<span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Effect": "Allow",
      "Principal": <span>{</span>
        "Service": "kendra.amazonaws.com"
      },
      "Action": "sts:AssumeRole"
    }
  ]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
 
                    <h4 id="iam-roles-ds-s3-cross-accounts">Amazon S3アカウント間で使用するポリシー</h4>
                    <p>Amazon S3Amazon Kendraバケットがインデックスに使用しているアカウントと異なるアカウントにある場合は、複数のアカウントでバケットを使用するポリシーを作成できます。</p>
                    <p>Amazon S3Amazon Kendraバケットがインデックスと別のアカウントにある場合に、バケットをデータソースとして使用するロールポリシー。</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
         <span>{</span>
            "Action": [
                "s3:GetObject"
            ],
            "Resource": [
                "arn:aws:s3:::$BUCKET_IN_OTHER_ACCOUNT/*"
            ],
            "Effect": "Allow"
        },
        <span>{</span>
            "Action": [
                "s3:ListBucket"
            ],
            "Resource": [
                "arn:aws:s3:::$BUCKET_IN_OTHER_ACCOUNT/*"
            ],
            "Effect": "Allow"
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kendra:BatchPutDocument",
                "kendra:BatchDeleteDocument"
            ],
            "Resource": [
                "arn:aws:kendra:$KENDRA_REGION:$KENDRA_ACCOUNT_ID:index/$KENDRA_INDEX_ID"
            ]
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "s3:GetObject",
                "s3:PutObject",
                "s3:PutObjectAcl"
            ],
            "Resource": "arn:aws:s3:::$BUCKET_IN_OTHER_ACCOUNT/*"
        }
    ]
}</code></pre>
                    <p>Amazon S3Amazon S3データソースロールが複数のアカウントでバケットにアクセスできるようにするバケットポリシー。</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Principal": <span>{</span>
                "AWS": "$KENDRA_S3_CONNECTOR_ROLE_ARN"
            },
            "Action": [
                "s3:GetObject",
                "s3:PutObject",
                "s3:PutObjectAcl"
            ],
            "Resource": [
                "arn:aws:s3:::$BUCKET_IN_OTHER_ACCOUNT/*"
            ]
        },
        <span>{</span>
            "Effect": "Allow",
            "Principal": <span>{</span>
                "AWS": "$KENDRA_S3_CONNECTOR_ROLE_ARN"
            },
            "Action": "s3:ListBucket",
            "Resource": "arn:aws:s3:::$BUCKET_IN_OTHER_ACCOUNT"
        }
    ]
}</code></pre>
                     
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
 
                </awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMデータベースデータソースのロール" id="iam-roles-ds-jdbc" expanded="false"><p>データベースをデータソースとして使用する場合、Amazon Kendraデータベースへの接続に必要な権限を持つロールを提供します。具体的には次のとおりです。</p><div class="itemizedlist">
                     
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>データベースサイトのユーザー名とパスワードを含む AWS Secrets Manager シークレットへのアクセス許可。シークレットの内容の詳細については、<a href="./data-source-database.html">Amazon RDS/Aurora</a> を参照してください。</p>
                    </li><li class="listitem">
                        <p>に保存されているユーザー名とパスワードシークレットを復号するAWS KMSカスタマーマスターキー (CMK) を使用する許可Secrets Manager。</p>
                    </li><li class="listitem">
                        <p>インデックスを更新するために <code class="code">BatchPutDocument</code> および <code class="code">BatchDeleteDocument</code> 演算を使用する許可。</p>
                    </li><li class="listitem">
                        <p>データベースサイトとの通信に使用される SSL 証明書を含むAmazon S3バケットへのアクセス許可。</p>
                    </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "secretsmanager:GetSecretValue"
            ],
            "Resource": [
                "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:secret:<code class="replaceable">secret ID</code>"
            ]
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kms:Decrypt"
            ],
            "Resource": [
                "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
            ]
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kendra:BatchPutDocument",
                "kendra:BatchDeleteDocument"
            ],
            "Resource": [
                "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:index/<code class="replaceable">index ID</code>"
            "Condition": <span>{</span>
                "StringLike": <span>{</span>
                    "kms:ViaService": [
                        "kendra.*.amazonaws.com"
                    ]
                }
            }
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "s3:GetObject"
            ],
            "Resource": [
                "arn:aws:s3:::<code class="replaceable">bucket name</code>/*"
            ]
        }
    ]
}</code></pre><p>データベースデータソースで使用できるオプションのポリシーは 2 つあります。</p><p>データベースとの通信に使用される SSL 証明書を含むAmazon S3バケットを暗号化している場合は、Amazon Kendraキーへのアクセスを許可するポリシーを提供します。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kms:Decrypt"
            ],
            "Resource": [
                "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
            ]
        }
    ]
}</code></pre><p>VPC を使用している場合は、Amazon Kendra必要なリソースへのアクセスを許可するポリシーを提供します。必要なポリシーについては、<a href="#iam-roles-vpc">Virtual private cloud (VPC) IAM ロール</a> を参照してください。</p>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMAmazon FSxデータソースの役割" id="iam-roles-ds-fsx" expanded="false"><p>を使用する場合Amazon FSx、次のポリシーでロールを提供します。</p><div class="itemizedlist">
                     
                     
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>AWS Secrets Managerシークレットにアクセスして認証する権限Amazon FSx.</p>
                    </li><li class="listitem">
                        <p>Amazon FSxあなたが住んでいる場所へのアクセス許可Amazon Virtual Private Cloud (VPC)。</p>
                    </li><li class="listitem">
                        <p>Amazon FSxWindows ファイルシステムのアクティブディレクトリのドメイン名の取得許可。</p>
                    </li><li class="listitem">
                        <p>Amazon FSxコネクタに必要なパブリック API の呼び出し許可。</p>
                    </li><li class="listitem">
                        <p><code class="code">BatchPutDocument</code>および<code class="code">BatchDeleteDocument</code> API を呼び出してインデックスを更新する権限。</p>
                    </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
        "Statement": [
        <span>{</span>
          "Effect": "Allow",
          "Action": [
            "secretsmanager:GetSecretValue"
          ],
          "Resource": [
            "arn:aws:secretsmanager:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:secret:<span>{</span><span>{</span>secret_id}}"
          ]
        },
        <span>{</span>
          "Effect": "Allow",
          "Action": [
            "kms:Decrypt"
          ],
          "Resource": [
            "arn:aws:kms:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:key/<span>{</span><span>{</span>key_id}}"
          ],
          "Condition": <span>{</span>
            "StringLike": <span>{</span>
              "kms:ViaService": [
                "secretsmanager.<span>{</span><span>{</span>region}}.amazonaws.com"
              ]
            }
          }
        },
        <span>{</span>
          "Effect": "Allow",
          "Action":[
            "ec2:CreateNetworkInterface",
            "ec2:DeleteNetworkInterface"
          ],
          "Resource": [
                "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:network-interface/*",
                "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:subnet/[[subnet_ids]]"
          ]   
        },
        <span>{</span>
          "Effect": "Allow",
          "Action": [
            "ec2:DescribeSubnets",
            "ec2:DescribeNetworkInterfaces"
          ],
          "Resource": "*"
        },
        <span>{</span>
          "Effect": "Allow",
          "Action": [
            "ec2:CreateNetworkInterfacePermission"
          ],
          "Resource": "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:network-interface/*",
          "Condition": <span>{</span>
            "StringEquals": <span>{</span>
              "ec2:AuthorizedService": "kendra.*.amazonaws.com"
            },
            "ArnEquals": <span>{</span>
              "ec2:Subnet": [
                "arn:aws:ec2:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:subnet/[[subnet_ids]]"
              ]
            }
          }
        },
        <span>{</span>
          "Sid": "AllowsKendraToGetDomainNameOfActiveDirectory",
          "Effect": "Allow",
          "Action": "ds:DescribeDirectories",
          "Resource": "*"
        },
        <span>{</span>
          "Sid": "AllowsKendraToCallRequiredFsxAPIs",
          "Effect": "Allow",
          "Action": [
              "fsx:DescribeFileSystems"
          ],
          "Resource": "*"
        },
        <span>{</span>
          "Sid": "iamPassRole",
          "Effect": "Allow",
          "Action": "iam:PassRole",
          "Resource": "*",
          "Condition": <span>{</span>
            "StringEquals": <span>{</span>
              "iam:PassedToService": [
                "kendra.*.amazonaws.com"
              ]
            }
          }
        },
        <span>{</span>
          "Effect": "Allow",
          "Action": [
            "kendra:BatchPutDocument",
            "kendra:BatchDeleteDocument"
          ],
          "Resource": "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}"
        }
        ]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMWeb クローラーデータソースのロール" id="iam-roles-ds-webcrawler" expanded="false"><p>Amazon KendraWeb Crawler を使用する場合、次のポリシーでロールを提供します。</p><div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>基本認証によってバックアップされるウェブサイトまたはウェブプロキシサーバーへの接続に使用するユーザー名とパスワードが含まれている AWS Secrets Manager シークレットへのアクセス許可。シークレットの内容に関する詳細は、<a href="https://docs.aws.amazon.com/kendra/latest/dg/data-source-web-crawler.html">ウェブクローラーデータソースの使用</a>を参照してください。</p>
                    </li><li class="listitem">
                        <p>に保存されているユーザー名とパスワードシークレットを復号するAWS KMSカスタマーマスターキー (CMK) を使用する許可Secrets Manager。</p>
                    </li><li class="listitem">
                        <p>インデックスを更新するために <code class="code">BatchPutDocument</code> および <code class="code">BatchDeleteDocument</code> 演算を使用する許可。</p>
                    </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:secret:<code class="replaceable">secret ID</code>"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:index/<code class="replaceable">index ID</code>"
  }]
}
</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMAmazon WorkDocsデータソースの役割" id="iam-roles-workdocs" expanded="false"><p>を使用する場合Amazon WorkDocs、次のポリシーでロールを提供します。</p><div class="itemizedlist">
                     
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>Amazon WorkDocsサイトリポジトリに対応するディレクトリ ID (組織 ID) の検証許可。</p>
                    </li><li class="listitem">
                        <p>Amazon WorkDocsサイトディレクトリを含む Active Directory のドメイン名の取得許可。</p>
                    </li><li class="listitem">
                        <p>Amazon WorkDocsコネクタに必要なパブリック API の呼び出し許可。</p>
                    </li><li class="listitem">
                        <p><code class="code">BatchPutDocument</code>および<code class="code">BatchDeleteDocument</code> API を呼び出してインデックスを更新する権限。</p>
                    </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Sid": "AllowsKendraToGetDomainNameOfActiveDirectory",
      "Effect": "Allow",
      "Action": "ds:DescribeDirectories",
      "Resource": "*"
    },
    <span>{</span>
      "Sid": "AllowsKendraToCallRequiredWorkDocsAPIs",
      "Effect": "Allow",
      "Action": [
        "workdocs:GetDocumentPath",
        "workdocs:GetGroup",
        "workdocs:GetDocument",
        "workdocs:DownloadDocumentVersions",
        "workdocs:DescribeUsers",
        "workdocs:DescribeFolderContents",
        "workdocs:DescribeActivities",
        "workdocs:DescribeComments",
        "workdocs:GetFolder",
        "workdocs:DescribeResourcePermissions",
        "workdocs:GetFolderPath",
        "workdocs:DescribeInstances"
      ],
      "Resource": "*"
    },
    <span>{</span>
      "Sid": "iamPassRole",
      "Effect": "Allow",
      "Action": "iam:PassRole",
      "Resource": "*",
      "Condition": <span>{</span>
        "StringEquals": <span>{</span>
          "iam:PassedToService": [
            "kendra.*.amazonaws.com"
          ]
        }
      }
    },
    <span>{</span>
      "Sid": "AllowsKendraToCallBatchPutDeleteAPIs",
      "Effect": "Allow",
      "Action": [
        "kendra:BatchPutDocument",
        "kendra:BatchDeleteDocument"
      ],
      "Resource": [
        "arn:aws:kendra:<span>{</span><span>{</span><code class="replaceable">region</code>}}:<span>{</span><span>{</span><code class="replaceable">account_id</code>}}:index/$<span>{</span><code class="replaceable">IndexId</code>}"
      ]
    }
  ]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMBox データソースのロール" id="iam-roles-ds-box" expanded="false"><p>Box を使用する場合、次のポリシーでロールを提供します。</p><div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>AWS Secrets ManagerシークレットにアクセスしてSlackを認証する権限。</p>
                    </li><li class="listitem">
                        <p>Box コネクタに必要なパブリック API の呼び出し許可。</p>
                    </li><li class="listitem">
                        <p><code class="code">BatchPutDocument</code>、、、<code class="code">BatchDeleteDocument</code><code class="code">PutPrincipalMapping</code><code class="code">DeletePrincipalMapping</code><code class="code">DescribePrincipalMapping</code>、および<code class="code">ListGroupsOlderThanOrderingId</code> API を呼び出す権限。</p>
                    </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:secret:[[secret_id]]"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:key/[[key_id]]"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
        "kendra:PutPrincipalMapping",
        "kendra:DeletePrincipalMapping",
        "kendra:ListGroupsOlderThanOrderingId",
        "kendra:DescribePrincipalMapping"
    ],
    "Resource": ["arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}", "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}/data-source/*"]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}"
  }]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMConfluence データソースのロール" id="iam-roles-ds-cnf" expanded="false"><div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMConfluence コネクタ v1.0 のロール" id="iam-roles-confluence-v1" expanded="false"><p>Confluence サーバーをデータソースとして使用する場合は、次のポリシーでロールを指定します。</p><div class="itemizedlist">
                             
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p>Confluence への接続に必要な認証情報を含むAWS Secrets Managerシークレットへのアクセス許可。シークレットの内容の詳細については、<a href="./data-source-confluence.html">Confluence</a> を参照してください。</p>
                            </li><li class="listitem">
                                <p>に保存されているユーザー名とパスワードシークレットを復号するAWS KMSカスタマーマスターキー (CMK) を使用する許可Secrets Manager。</p>
                            </li><li class="listitem">
                                <p>インデックスを更新するために <code class="code">BatchPutDocument</code> および <code class="code">BatchDeleteDocument</code> 演算を使用する許可。</p>
                            </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:secret:<code class="replaceable">secret ID</code>"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:index/<code class="replaceable">index ID</code>"
  }]
}</code></pre><p>VPC を使用している場合は、Amazon Kendra必要なリソースへのアクセスを許可するポリシーを提供します。必要なポリシーについては、<a href="#iam-roles-vpc">Virtual private cloud (VPC) IAM ロール</a> を参照してください。</p>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div><div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMConfluence コネクタ v2.0 のロール" id="iam-roles-confluence-v2" expanded="false"><p>Confluence コネクタ v2.0 データソースの場合、次のポリシーを持つロールを提供します。</p><div class="itemizedlist">
                             
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p>ConfluenceAWS Secrets Manager の認証情報を含むシークレットにアクセスする権限。シークレットの内容の詳細については、<a href="./data-source-confluence.html">Confluence</a> を参照してください。</p>
                            </li><li class="listitem">
                                <p>に保存されているユーザー名とパスワードシークレットを復号するAWS KMSカスタマーマスターキー (CMK) を使用する許可AWS Secrets Manager。</p>
                            </li><li class="listitem">
                                <p>インデックスを更新するために <code class="code">BatchPutDocument</code> および <code class="code">BatchDeleteDocument</code> 演算を使用する許可。</p>
                            </li></ul></div><p>Amazon Kendraがロールを引き受けることを許可する信頼ポリシーを添付する必要があります。</p><p>ConfluenceAmazon Kendra への接続を許可するロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "secretsmanager:GetSecretValue"
      ],
      "Resource": [
        "arn:aws:secretsmanager:region:account_id:secret:secret_id"
      ]
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "kms:Decrypt"
      ],
      "Resource": [
        "arn:aws:kms:region:account_id:key/key_id"
      ],
      "Condition": <span>{</span>
        "StringLike": <span>{</span>
          "kms:ViaService": [
            "secretsmanager.*.amazonaws.com"
          ]
        }
      }
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "kendra:PutPrincipalMapping",
        "kendra:DeletePrincipalMapping",
        "kendra:ListGroupsOlderThanOrderingId",
        "kendra:DescribePrincipalMapping"
      ],
      "Resource": [
        "arn:aws:kendra:region:account_id:index/index_id",
        "arn:aws:kendra:region:account_id:index/index_id/data-source/*"
      ]
    }
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "kendra:BatchPutDocument",
        "kendra:BatchDeleteDocument"
      ],
      "Resource": "arn:aws:kendra:region:account_id:index/index_id"
    }
  ]
}</code></pre><p>VPC 設定で ConfluenceAmazon Kendra に接続することを許可するロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "secretsmanager:GetSecretValue"
      ],
      "Resource": [
        "arn:aws:secretsmanager:region:account_id:secret:secret_id"
      ]
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "kms:Decrypt"
      ],
      "Resource": [
        "arn:aws:kms:region:account_id:key/key_id"
      ],
      "Condition": <span>{</span>
        "StringLike": <span>{</span>
          "kms:ViaService": [
            "secretsmanager.*.amazonaws.com"
          ]
        }
      }
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "kendra:PutPrincipalMapping",
        "kendra:DeletePrincipalMapping",
        "kendra:ListGroupsOlderThanOrderingId",
        "kendra:DescribePrincipalMapping"
      ],
      "Resource": [
        "arn:aws:kendra:region:account_id:index/index_id",
        "arn:aws:kendra:region:account_id:index/index_id/data-source/*"
      ]
    }
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "kendra:BatchPutDocument",
        "kendra:BatchDeleteDocument"
      ],
      "Resource": "arn:aws:kendra:region:account_id:index/index_id"
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:CreateNetworkInterface"
      ],
      "Resource": [
        "arn:aws:ec2:region:account_id:subnet/subnet_ids",
        "arn:aws:ec2:region:account_id:security-group/security_group"
      ]
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:CreateNetworkInterface"
      ],
      "Resource": "arn:aws:ec2:region:account_id:network-interface/*",
      "Condition": <span>{</span>
        "StringLike": <span>{</span>
          "aws:RequestTag/AWS_KENDRA": "kendra_account_id_index_id_*"
        }
      }
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:CreateTags"
      ],
      "Resource": "arn:aws:ec2:region:account_id:network-interface/*",
      "Condition": <span>{</span>
        "StringEquals": <span>{</span>
          "ec2:CreateAction": "CreateNetworkInterface"
        }
      }
    },
    
<span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:CreateNetworkInterfacePermission"
      ],
      "Resource": "arn:aws:ec2:region:account_id:network-interface/*",
      "Condition": <span>{</span>
        "StringLike": <span>{</span>
          "aws:ResourceTag/AWS_KENDRA": "kendra_account_id_index_id_*"
        }
      }
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:DescribeNetworkInterfaces",
        "ec2:DescribeAvailabilityZones",
        "ec2:DescribeNetworkInterfaceAttribute",
        "ec2:DescribeVpcs",
        "ec2:DescribeRegions",
        "ec2:DescribeNetworkInterfacePermissions",
        "ec2:DescribeSubnets"
      ],
      "Resource": "*"
    }
  ]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div></awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMDropbox データソースのロール" id="iam-roles-ds-dropbox" expanded="false"><p>Dropbox を使用する場合、次のポリシーでロールを提供します。</p><div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>AWS Secrets Managerシークレットにアクセスして Dropbox を認証する権限。</p>
                    </li><li class="listitem">
                        <p>Dropbox コネクタに必要なパブリック API の呼び出し許可。</p>
                    </li><li class="listitem">
                        <p><code class="code">BatchPutDocument</code>、、、<code class="code">BatchDeleteDocument</code><code class="code">PutPrincipalMapping</code><code class="code">DeletePrincipalMapping</code><code class="code">DescribePrincipalMapping</code>、および<code class="code">ListGroupsOlderThanOrderingId</code> API を呼び出す権限。</p>
                    </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
"Version": "2012-10-17",
  "Statement": [
  <span>{</span>"Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:secret:[[secret_id]]"
    ]
  },
  <span>{</span>"Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:key/[[key_id]]"
    ],
    "Condition": <span>{</span>"StringLike": <span>{</span>"kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>"Effect": "Allow",
    "Action": [
        "kendra:PutPrincipalMapping",
        "kendra:DeletePrincipalMapping",
        "kendra:ListGroupsOlderThanOrderingId",
        "kendra:DescribePrincipalMapping"
    ],
    "Resource": ["arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}", "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}/data-source/*"]
  },
  <span>{</span>"Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}"
  }]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAM GitHub データソースの役割" id="iam-roles-ds-github" expanded="false"><p>を使用する場合 GitHub、次のポリシーでロールを提供します。</p><div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>AWS Secrets Managerシークレットにアクセスして認証する権限 GitHub.</p>
                    </li><li class="listitem">
                        <p> GitHubコネクタに必要なパブリック API の呼び出し許可。</p>
                    </li><li class="listitem">
                        <p><code class="code">BatchPutDocument</code>、、、<code class="code">BatchDeleteDocument</code><code class="code">PutPrincipalMapping</code><code class="code">DeletePrincipalMapping</code><code class="code">DescribePrincipalMapping</code>、および<code class="code">ListGroupsOlderThanOrderingId</code> API を呼び出す権限。</p>
                    </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:secret:[[secret_id]]"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:key/[[key_id]]"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
        "kendra:PutPrincipalMapping",
        "kendra:DeletePrincipalMapping",
        "kendra:ListGroupsOlderThanOrderingId",
        "kendra:DescribePrincipalMapping"
    ],
    "Resource": ["arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}", "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}/data-source/*"]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}"
  }]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>


        
        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMGmail データソースのロール" id="iam-roles-ds-gmail" expanded="false"><p>Gmail を使用する場合、次のポリシーでロールを提供します。</p><div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>GmailAWS Secrets Manager を認証するためのシークレットへのアクセス権限。</p>
                    </li><li class="listitem">
                        <p>Gmail コネクタに必要なパブリック API の呼び出し許可。</p>
                    </li><li class="listitem">
                        <p><code class="code">BatchPutDocument</code>、、、<code class="code">BatchDeleteDocument</code><code class="code">PutPrincipalMapping</code><code class="code">DeletePrincipalMapping</code><code class="code">DescribePrincipalMapping</code>、および<code class="code">ListGroupsOlderThanOrderingId</code> API を呼び出す権限。</p>
                    </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
"Version": "2012-10-17",
  "Statement": [
  <span>{</span>"Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:secret:[[secret_id]]"
    ]
  },
  <span>{</span>"Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:key/[[key_id]]"
    ],
    "Condition": <span>{</span>"StringLike": <span>{</span>"kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>"Effect": "Allow",
    "Action": [
        "kendra:PutPrincipalMapping",
        "kendra:DeletePrincipalMapping",
        "kendra:ListGroupsOlderThanOrderingId",
        "kendra:DescribePrincipalMapping"
    ],
    "Resource": ["arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}", "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}/data-source/*"]
  },
  <span>{</span>"Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}"
  }]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMGoogle Drive データソースのロール" id="iam-roles-ds-gd" expanded="false"><p>Google WorkSpaces ドライブをデータソースとして使用する場合、Amazon Kendraサイトへの接続に必要な権限を持つロールを提供します。具体的には次のとおりです。</p><div class="itemizedlist">
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>Google Drive サイトへの接続に必要なクライアントアカウントの E メール、管理者アカウントの E メール、およびプライベートキーを含む AWS Secrets Manager シークレットの取得および復号許可。シークレットの内容の詳細については、<a href="./data-source-google-drive.html">Google ドライブ</a> を参照してください。</p>
                    </li><li class="listitem">
                        <p><a href="https://docs.aws.amazon.com/kendra/latest/dg/API_BatchPutDocument.html">BatchPutDocument</a>および <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_BatchDeleteDocument.html">BatchDeleteDocument</a>API を使用する権限。</p>
                    </li></ul></div><p>IAM次のポリシーで、必要な許可が提供されます。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:secret:<code class="replaceable">secret ID</code>"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:index/<code class="replaceable">index ID</code>"
  }]
}
</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMJira データソースのロール" id="iam-roles-ds-jira" expanded="false"><p>Jira を使用する場合、次のポリシーでロールを提供します。</p><div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>JiraAWS Secrets Manager を認証するためのシークレットへのアクセス権限。</p>
                    </li><li class="listitem">
                        <p>Jira コネクタに必要なパブリック API の呼び出し許可。</p>
                    </li><li class="listitem">
                        <p><code class="code">BatchPutDocument</code>、、、<code class="code">BatchDeleteDocument</code><code class="code">PutPrincipalMapping</code><code class="code">DeletePrincipalMapping</code><code class="code">DescribePrincipalMapping</code>、および<code class="code">ListGroupsOlderThanOrderingId</code> API を呼び出す権限。</p>
                    </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:secret:[[secret_id]]"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:key/[[key_id]]"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
        "kendra:PutPrincipalMapping",
        "kendra:DeletePrincipalMapping",
        "kendra:ListGroupsOlderThanOrderingId",
        "kendra:DescribePrincipalMapping"
    ],
    "Resource": ["arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}", "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}/data-source/*"]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}"
  }]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMMicrosoft Exchange データソースのロール" id="iam-roles-ds-exchange" expanded="false"><p>Google WorkConfiguration をデータソースとして使用する場合、Amazon Kendraサイトへの接続に必要な権限を持つロールを提供します。具体的には次のとおりです。</p><div class="itemizedlist">
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>Google WorkConfigurationAWS Secrets Manager およびシークレットキーを含むシークレットの取得および復号許可。シークレットの内容の詳細については、<a href="./data-source-yammer.html">Microsoft ヤマー</a> を参照してください。</p>
                    </li><li class="listitem">
                        <p><a href="https://docs.aws.amazon.com/kendra/latest/dg/API_BatchPutDocument.html">BatchPutDocument</a>および <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_BatchDeleteDocument.html">BatchDeleteDocument</a>API を使用する権限。</p>
                    </li></ul></div><p>IAM次のポリシーで、必要な許可が提供されます。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:secret:<code class="replaceable">secret ID</code>"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:index/<code class="replaceable">index ID</code>"
  }]
}
</code></pre><p>Amazon S3バケットにインデックス作成するためのユーザーのリストを保存する場合は、S3<code class="code">GetObject</code> 演算を使用するアクセス許可を提供する必要があります。IAM次のポリシーで、必要な許可が提供されます。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:secret:<code class="replaceable">secret ID</code>"
    ]
  },
  <span>{</span>
    "Action": [
      "s3:GetObject"
    ],
    "Resource": [
      "arn:aws:s3:::<code class="replaceable">input_bucket_name</code>/*"
    ],
    "Effect": "Allow"
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/[[key IDs]]"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com",
          "s3.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:index/<code class="replaceable">index ID</code>"
  }]
}
</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAM OneDrive マイクロソフトデータソースのロール" id="iam-roles-ds-on" expanded="false"><p>Google WorkConfiguration OneDrive  をデータソースとして使用する場合、Amazon Kendraサイトへの接続に必要な権限を持つロールを提供します。具体的には次のとおりです。</p><div class="itemizedlist">
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p> OneDrive サイトへの接続に必要なアプリケーション IDAWS Secrets Manager とシークレットキーを含むシークレットの取得および復号許可。シークレットの内容の詳細については、<a href="./data-source-onedrive.html">マイクロソフト OneDrive</a> を参照してください。</p>
                    </li><li class="listitem">
                        <p><a href="https://docs.aws.amazon.com/kendra/latest/dg/API_BatchPutDocument.html">BatchPutDocument</a>および <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_BatchDeleteDocument.html">BatchDeleteDocument</a>API を使用する権限。</p>
                    </li></ul></div><p>IAM次のポリシーで、必要な許可が提供されます。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:secret:<code class="replaceable">secret ID</code>"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:index/<code class="replaceable">index ID</code>"
  }]
}
</code></pre><p>Amazon S3バケットにインデックス作成するためのユーザーのリストを保存する場合は、S3<code class="code">GetObject</code> 演算を使用するアクセス許可を提供する必要があります。IAM次のポリシーで、必要な許可が提供されます。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:secret:<code class="replaceable">secret ID</code>"
    ]
  },
  <span>{</span>
    "Action": [
      "s3:GetObject"
    ],
    "Resource": [
      "arn:aws:s3:::<code class="replaceable">input_bucket_name</code>/*"
    ],
    "Effect": "Allow"
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/[[key IDs]]"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com",
          "s3.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:index/<code class="replaceable">index ID</code>"
  }]
}
</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAM SharePoint マイクロソフトデータソースのロール" id="iam-roles-ds-spo" expanded="false"><div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAM SharePoint コネクタ v1.0 のロール" id="iam-roles-sharepoint-v1" expanded="false"><p>Microsoft SharePoint  Connector v1.0 データソースの場合、次のポリシーを持つロールを提供します。</p><div class="itemizedlist">
                             
                             
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p> SharePoint サイトのユーザー名とパスワードを含むAWS Secrets Managerシークレットへのアクセス許可。シークレットの内容の詳細については、<a href="./data-source-sharepoint.html">マイクロソフト SharePoint</a> を参照してください。</p>
                            </li><li class="listitem">
                                <p>に保存されているユーザー名とパスワードシークレットを復号するAWS KMSカスタマーマスターキー (CMK) を使用する許可AWS Secrets Manager。</p>
                            </li><li class="listitem">
                                <p>インデックスを更新するために <code class="code">BatchPutDocument</code> および <code class="code">BatchDeleteDocument</code> 演算を使用する許可。</p>
                            </li><li class="listitem">
                                <p> SharePoint サイトとの通信に使用される SSL 証明書を含むAmazon S3バケットへのアクセス許可。</p>
                            </li></ul></div><p>Amazon Kendraがロールを引き受けることを許可する信頼ポリシーを添付する必要があります。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "secretsmanager:GetSecretValue"
            ],
            "Resource": [
                "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:secret:<code class="replaceable">secret ID</code>"
            ]
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kms:Decrypt"
            ],
            "Resource": [
                "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
            ]
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kendra:BatchPutDocument",
                "kendra:BatchDeleteDocument"
            ],
            "Resource": [
                "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:index/<code class="replaceable">index ID</code>"
            ],
            "Condition": <span>{</span>
                "StringLike": <span>{</span>
                    "kms:ViaService": [
                        "kendra.*.amazonaws.com"
                    ]
                }
            }
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "s3:GetObject"
            ],
            "Resource": [
                "arn:aws:s3:::<code class="replaceable">bucket name</code>/*"
            ]
        }
    ]
}</code></pre><p> SharePoint サイトとの通信に使用される SSL 証明書を含むAmazon S3バケットを暗号化している場合は、Amazon Kendraキーへのアクセスを許可するポリシーを提供します。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kms:Decrypt"
            ],
            "Resource": [
                "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
            ]
        }
    ]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div><div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAM SharePoint コネクタ v2.0 のロール" id="iam-roles-sharepoint-v2" expanded="false"><p>Microsoft SharePoint  コネクタ v2.0 データソースの場合、次のポリシーを持つロールを提供します。</p><div class="itemizedlist">
                             
                             
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p> SharePoint サイトの認証情報を含むAWS Secrets Managerシークレットへのアクセス許可。シークレットの内容の詳細については、<a href="./data-source-sharepoint.html">マイクロソフト SharePoint</a> を参照してください。</p>
                            </li><li class="listitem">
                                <p>に保存されているユーザー名とパスワードシークレットを復号するAWS KMSカスタマーマスターキー (CMK) を使用する許可AWS Secrets Manager。</p>
                            </li><li class="listitem">
                                <p>インデックスを更新するために <code class="code">BatchPutDocument</code> および <code class="code">BatchDeleteDocument</code> 演算を使用する許可。</p>
                            </li><li class="listitem">
                                <p> SharePoint サイトとの通信に使用される SSL 証明書を含むAmazon S3バケットへのアクセス許可。</p>
                            </li></ul></div><p>Amazon Kendraがロールを引き受けることを許可する信頼ポリシーを添付する必要があります。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "secretsmanager:GetSecretValue"
      ],
      "Resource": [
        "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">account_id</code>:secret:<code class="replaceable">secret_id</code>"
      ]
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "kms:Decrypt"
      ],
      "Resource": [
        "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account_id</code>:key/<code class="replaceable">key_id</code>"
      ],
      "Condition": <span>{</span>
        "StringLike": <span>{</span>
          "kms:ViaService": [
            "secretsmanager.*.amazonaws.com"
          ]
        }
      }
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "kendra:PutPrincipalMapping",
        "kendra:DeletePrincipalMapping",
        "kendra:ListGroupsOlderThanOrderingId",
        "kendra:DescribePrincipalMapping"
      ],
      "Resource": [
        "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account_id</code>:index/<code class="replaceable">index_id</code>",
        "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account_id</code>:index/<code class="replaceable">index_id</code>/data-source/*"
      ]
    },
    <span>{</span>
      "Action": [
        "s3:GetObject"
      ],
      "Resource": [
        "arn:aws:s3:::<code class="replaceable">input_bucket_name</code>/<code class="replaceable">input_key_name</code>"
      ],
      "Effect": "Allow"
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "kendra:BatchPutDocument",
        "kendra:BatchDeleteDocument"
      ],
      "Resource": "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account_id</code>:index/<code class="replaceable">index_id</code>"
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:CreateNetworkInterface"
      ],
      "Resource": [
        "arn:aws:ec2:<code class="replaceable">region</code>:<code class="replaceable">account_id</code>:subnet/<code class="replaceable">subnet_ids</code>",
        "arn:aws:ec2:<code class="replaceable">region</code>:<code class="replaceable">account_id</code>:security-group/<code class="replaceable">security_group</code>"
      ]
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:CreateNetworkInterface"
      ],
      "Resource": "arn:aws:ec2:<code class="replaceable">region</code>:<code class="replaceable">account_id</code>:network-interface/*",
      "Condition": <span>{</span>
        "StringLike": <span>{</span>
          "aws:RequestTag/AWS_KENDRA": "kendra_<code class="replaceable">account_id</code>_<code class="replaceable">index_id</code>_*"
        }
      }
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:CreateTags"
      ],
      "Resource": "arn:aws:ec2:<code class="replaceable">region</code>:<code class="replaceable">account_id</code>:network-interface/*",
      "Condition": <span>{</span>
        "StringEquals": <span>{</span>
          "ec2:CreateAction": "CreateNetworkInterface"
        }
      }
    },
    
<span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:CreateNetworkInterfacePermission"
      ],
      "Resource": "arn:aws:ec2:<code class="replaceable">region</code>:<code class="replaceable">account_id</code>:network-interface/*",
      "Condition": <span>{</span>
        "StringLike": <span>{</span>
          "aws:ResourceTag/AWS_KENDRA": "kendra_<code class="replaceable">account_id</code>_<code class="replaceable">index_id</code>_*"
        }
      }
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:DescribeNetworkInterfaces",
        "ec2:DescribeAvailabilityZones",
        "ec2:DescribeNetworkInterfaceAttribute",
        "ec2:DescribeVpcs",
        "ec2:DescribeRegions",
        "ec2:DescribeNetworkInterfacePermissions",
        "ec2:DescribeSubnets"
      ],
      "Resource": "*"
    }
  ]
}</code></pre><p> SharePoint サイトとの通信に使用される SSL 証明書を含むAmazon S3バケットを暗号化している場合は、Amazon Kendraキーへのアクセスを許可するポリシーを提供します。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kms:Decrypt"
            ],
            "Resource": [
                "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
            ]
        }
    ]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div></awsui-expandable-section></div>

        

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMMicrosoft Teams データソースのロール" id="iam-roles-ds-teams" expanded="false"><p>Google WorkConfiguration をデータソースとして使用する場合、Amazon Kendraサイトへの接続に必要な権限を持つロールを提供します。具体的には次のとおりです。</p><div class="itemizedlist">
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>Google WorkConfigurationAWS Secrets Manager およびクライアントシークレットを含むシークレットの取得および復号許可。シークレットの内容の詳細については、<a href="./data-source-teams.html">マイクロソフトチーム</a> を参照してください。</p>
                    </li><li class="listitem">
                         
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
 
                    </li></ul></div><p>IAM次のポリシーで、必要な許可が提供されます。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">client ID</code>:secret:<code class="replaceable">secret ID</code>"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:index/<code class="replaceable">index ID</code>"
  }]
}
        </code></pre></awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMMicrosoft Yammer データソースのロール" id="iam-roles-ds-yammer" expanded="false"><p>Google WorkSpaces ドライブをデータソースとして使用する場合、Amazon Kendraサイトへの接続に必要な権限を持つロールを提供します。具体的には次のとおりです。</p><div class="itemizedlist">
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>Google WorkConfigurationAWS Secrets Manager およびシークレットキーを含むシークレットの取得および復号許可。シークレットの内容の詳細については、<a href="./data-source-yammer.html">Microsoft ヤマー</a> を参照してください。</p>
                    </li><li class="listitem">
                        <p><a href="https://docs.aws.amazon.com/kendra/latest/dg/API_BatchPutDocument.html">BatchPutDocument</a>および <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_BatchDeleteDocument.html">BatchDeleteDocument</a>API を使用する権限。</p>
                    </li></ul></div><p>IAM次のポリシーで、必要な許可が提供されます。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:secret:<code class="replaceable">secret ID</code>"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:index/<code class="replaceable">index ID</code>"
  }]
}
</code></pre><p>Amazon S3バケットにインデックス作成するためのユーザーのリストを保存する場合は、S3<code class="code">GetObject</code> 演算を使用するアクセス許可を提供する必要があります。IAM次のポリシーで、必要な許可が提供されます。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:secret:<code class="replaceable">secret ID</code>"
    ]
  },
  <span>{</span>
    "Action": [
      "s3:GetObject"
    ],
    "Resource": [
      "arn:aws:s3:::<code class="replaceable">input_bucket_name</code>/*"
    ],
    "Effect": "Allow"
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/[[key IDs]]"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com",
          "s3.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:index/<code class="replaceable">index ID</code>"
  }]
}
</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMQuip データソースのロール" id="iam-roles-ds-quip" expanded="false"><p>Quip を使用する場合、次のポリシーでロールを提供します。</p><div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>QuipAWS Secrets Manager を認証するためのシークレットへのアクセス権限。</p>
                    </li><li class="listitem">
                        <p>Quip コネクタに必要なパブリック API の呼び出し許可。</p>
                    </li><li class="listitem">
                        <p><code class="code">BatchPutDocument</code>、、、<code class="code">BatchDeleteDocument</code><code class="code">PutPrincipalMapping</code><code class="code">DeletePrincipalMapping</code><code class="code">DescribePrincipalMapping</code>、および<code class="code">ListGroupsOlderThanOrderingId</code> API を呼び出す権限。</p>
                    </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:secret:[[secret_id]]"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:key/[[key_id]]"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
        "kendra:PutPrincipalMapping",
        "kendra:DeletePrincipalMapping",
        "kendra:ListGroupsOlderThanOrderingId",
        "kendra:DescribePrincipalMapping"
    ],
    "Resource": ["arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}", "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}/data-source/*"]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}"
  }]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMSalesforce データソースのロール" id="iam-roles-ds-sf" expanded="false"><p>Slaesforce をデータソースとして使用する場合は、次のポリシーでロールを指定します。</p><div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>Saleseforce サイトのユーザー名とパスワードを含む AWS Secrets Manager シークレットへのアクセス許可。シークレットの内容の詳細については、<a href="./data-source-salesforce.html">Salesforce</a> を参照してください。</p>
                    </li><li class="listitem">
                        <p>に保存されているユーザー名とパスワードシークレットを復号するAWS KMSカスタマーマスターキー (CMK) を使用する許可Secrets Manager。</p>
                    </li><li class="listitem">
                        <p>インデックスを更新するために <code class="code">BatchPutDocument</code> および <code class="code">BatchDeleteDocument</code> 演算を使用する許可。</p>
                    </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:secret:<code class="replaceable">secret ID</code>"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:index/<code class="replaceable">index ID</code>"
  }]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>


        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAM ServiceNow データソースの役割" id="iam-roles-ds-sn" expanded="false"><p> ServiceNow をデータソースとして使用する場合は、次のポリシーでロールを提供します。</p><div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p> ServiceNow サイトのユーザー名とパスワードを含むSecrets Managerシークレットへのアクセス許可。シークレットの内容の詳細については、<a href="./data-source-servicenow.html">ServiceNow</a> を参照してください。</p>
                    </li><li class="listitem">
                        <p>に保存されているユーザー名とパスワードシークレットを復号するAWS KMSカスタマーマスターキー (CMK) を使用する許可Secrets Manager。</p>
                    </li><li class="listitem">
                        <p>インデックスを更新するために <code class="code">BatchPutDocument</code> および <code class="code">BatchDeleteDocument</code> 演算を使用する許可。</p>
                    </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:secret:<code class="replaceable">secret ID</code>"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:index/<code class="replaceable">index ID</code>"
  }]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMSlack データソースのロール" id="iam-roles-ds-slack" expanded="false"><p>Slack を使用する場合、次のポリシーでロールを提供します。</p><div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>AWS Secrets ManagerシークレットにアクセスしてSlackを認証する権限。</p>
                    </li><li class="listitem">
                        <p>Slack コネクタに必要なパブリック API の呼び出し許可。</p>
                    </li><li class="listitem">
                        <p><code class="code">BatchPutDocument</code>、、、<code class="code">BatchDeleteDocument</code><code class="code">PutPrincipalMapping</code><code class="code">DeletePrincipalMapping</code><code class="code">DescribePrincipalMapping</code>、および<code class="code">ListGroupsOlderThanOrderingId</code> API を呼び出す権限。</p>
                    </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:secret:[[secret_id]]"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:key/[[key_id]]"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
        "kendra:PutPrincipalMapping",
        "kendra:DeletePrincipalMapping",
        "kendra:ListGroupsOlderThanOrderingId",
        "kendra:DescribePrincipalMapping"
    ],
    "Resource": ["arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}", "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}/data-source/*"]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}"
  }]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMZendesk データソースのロール" id="iam-roles-ds-zendesk" expanded="false"><p>Zendeskを使用する場合、次のポリシーでロールを提供します。</p><div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>ZendeskAWS Secrets Manager Suiteを認証するためにシークレットにアクセスする権限。</p>
                    </li><li class="listitem">
                        <p>Zendeskコネクタに必要なパブリックAPIの呼び出し許可。</p>
                    </li><li class="listitem">
                        <p><code class="code">BatchPutDocument</code>、、、<code class="code">BatchDeleteDocument</code><code class="code">PutPrincipalMapping</code><code class="code">DeletePrincipalMapping</code><code class="code">DescribePrincipalMapping</code>、および<code class="code">ListGroupsOlderThanOrderingId</code> API を呼び出す権限。</p>
                    </li></ul></div><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "secretsmanager:GetSecretValue"
    ],
    "Resource": [
      "arn:aws:secretsmanager:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:secret:[[secret_id]]"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt"
    ],
    "Resource": [
      "arn:aws:kms:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:key/[[key_id]]"
    ],
    "Condition": <span>{</span>
      "StringLike": <span>{</span>
        "kms:ViaService": [
          "secretsmanager.*.amazonaws.com"
        ]
      }
    }
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
        "kendra:PutPrincipalMapping",
        "kendra:DeletePrincipalMapping",
        "kendra:ListGroupsOlderThanOrderingId",
        "kendra:DescribePrincipalMapping"
    ],
    "Resource": ["arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}", "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}/data-source/*"]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kendra:BatchPutDocument",
      "kendra:BatchDeleteDocument"
    ],
    "Resource": "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>index_id}}"
  }]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>

        

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="Virtual private cloud (VPC) IAM ロール" id="iam-roles-vpc" expanded="false"><p>Virtual Private Cloud (VPC) を使用してデータソースに接続する場合は、次の許可を提供する必要があります。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:CreateNetworkInterface",
        "ec2:DescribeNetworkInterfaces",
        "ec2:DeleteNetworkInterface"
      ],
      "Resource": "*"
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:CreateNetworkInterfacePermission"
      ],
      "Resource": "*",
      "Condition": <span>{</span>
        "StringEquals": <span>{</span>
          "ec2:AuthorizedService": "kendra.*.amazonaws.com"
        },
        "ArnEquals": <span>{</span>
          "ec2:Subnet": [
            "arn:aws:ec2:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:subnet/<code class="replaceable">subnet IDs</code>"
          ]
        }
      }
    },
    <span>{</span>
      "Effect": "Allow",
      "Action": [
        "ec2:DescribeSubnets"
      ],
      "Resource": "*"
    },
    <span>{</span>
      "Sid": "iamPassRole",
      "Effect": "Allow",
      "Action": "iam:PassRole",
      "Resource": "*",
      "Condition": <span>{</span>
        "StringEquals": <span>{</span>
          "iam:PassedToService": [
            "kendra.*.amazonaws.com"
          ]
        }
      }
    }
  ]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>
     
        <h2 id="iam-roles-ds-faq">IAMよくある質問ロール</h2>
        <p><a href="https://docs.aws.amazon.com/kendra/latest/dg/API_CreateFaq.html">CreateFaq</a>API を使用して質問と回答をインデックスにロードする場合、Amazon KendraIAMAmazon S3ソースファイルを含むバケットへのアクセス権を持つロールを提供する必要があります。ソースファイルが暗号化されている場合は、ファイルを復号する AWS KMS カスタマーマスターキー (CMK) を使用する許可を提供する必要があります。</p>

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMよくある質問のロール" id="iam-roles-faq" expanded="false"><p>Amazon KendraAmazon S3バケットへのアクセスを許可する必須ロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "s3:GetObject"
            ],
            "Resource": [
                "arn:aws:s3:::<code class="replaceable">bucket name</code>/*"
            ]
        }
    ]
}</code></pre><p>Amazon S3バケットのファイルを復号化するAWS KMSカスタマーマスターキー (CMK)Amazon Kendra を使用することを許可する任意のロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kms:Decrypt"
            ],
            "Resource": [
                "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">account ID</code>:key/<code class="replaceable">key ID</code>"
            ],
            "Condition": <span>{</span>
                "StringLike": <span>{</span>
                    "kms:ViaService": [
                        "kendra.*.amazonaws.com"
                    ]
                }
            }
        }
    ]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>
     
        <h2 id="iam-roles-query-suggestions">IAMクエリ提案のロール</h2>
        <p>Amazon S3ファイルをクエリ提案ブロックリストとして使用する場合、Amazon S3Amazon S3ファイルとバケットへのアクセス許可を持つロールを提供します。Amazon S3バケット内のブロックリストテキストファイル (Amazon S3ファイル) が暗号化されている場合は、ドキュメントを復号化するAWS KMSカスタマーマスターキー (CMK) を使用する許可を提供する必要があります。</p>
        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMクエリ提案のロール" id="iam-roles-query-sugestions-json" expanded="false"><p>Amazon KendraAmazon S3クエリ提案ブロックリストとしてファイルを使用することを許可する必須ロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>"Effect": "Allow",
            "Action": [
                "s3:GetObject"
            ],
            "Resource": [
                "arn:aws:s3:::bucket name/*"
            ]
        }
    ]
}
</code></pre><p>Amazon S3バケット内のドキュメントを復号化するAWS KMSカスタマーマスターキー (CMK)Amazon Kendra を使用することを許可する任意のロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>"Effect": "Allow",
            "Action": [
                "kms:Decrypt"
            ],
            "Resource": [
                "arn:aws:kms:region:account ID:key/key ID"
            ]
        }
    ]
}
</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>
     
        <h2 id="iam-roles-principal-mapping">IAMユーザーとグループのプリンシパルマッピングロール</h2>
        <p><a href="https://docs.aws.amazon.com/kendra/latest/dg/API_PutPrincipalMapping.html">PutPrincipalMapping</a>API を使用してユーザーをグループにマッピングし、検索結果をユーザーコンテキストでフィルタリングするには、グループに属するユーザーまたはサブグループのリストを提供する必要があります。リストが 1 つのグループにつき 1,000 を超えるユーザーまたはサブグループを含む場合は、Amazon S3Amazon S3リストおよびバケットのファイルへのアクセス許可を持つロールを提供する必要があります。Amazon S3Amazon S3バケット内のリストのテキストファイル (ファイル) が暗号化されている場合は、ドキュメントを復号化するAWS KMSカスタマーマスターキー (CMK) を使用する許可を提供する必要があります。</p>

        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMプリンシパルマッピングのロール" id="iam-roles-principal-mapping-json" expanded="false"><p>Amazon KendraAmazon S3グループに属するユーザーおよびサブグループのリストとしてファイルを使用することを許可する必須ロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>"Effect": "Allow",
            "Action": [
                "s3:GetObject"
            ],
            "Resource": [
                "arn:aws:s3:::bucket name/*"
            ]
        }
    ]
}
</code></pre><p>Amazon S3バケット内のドキュメントを復号化するAWS KMSカスタマーマスターキー (CMK)Amazon Kendra を使用することを許可する任意のロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>"Effect": "Allow",
            "Action": [
                "kms:Decrypt"
            ],
            "Resource": [
                "arn:aws:kms:region:account ID:key/key ID"
            ]
        }
    ]
}
</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
<p><code class="code">aws:sourceAccount</code><code class="code">aws:sourceArn</code>信頼ポリシーにはとを含めることをお勧めします。これにより、権限が制限され<code class="code">aws:sourceAccount</code>、<code class="code">aws:sourceArn</code>IAM<code class="code">sts:AssumeRole</code>アクションのロールポリシーで指定されているものと同じかどうかが安全にチェックされます。これにより、IAM権限のないエンティティがロールとその権限にアクセスするのを防ぐことができます。詳細については、混乱した代理」<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/confused-deputy.html">混乱した代理」AWS Identity and Access Management 問題に関するガイドを参照してください</a>。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Principal": <span>{</span>
                "Service": [
                    "kendra.*.amazonaws.com"
                ]
            },
            "Action": "sts:AssumeRole",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "aws:SourceAccount": "account ID"
                },
                "StringLike": <span>{</span>
                    "aws:SourceArn": "arn:aws:kendra:region:accountId:index/*"
                }
            }
        }
    ]
}</code></pre></awsui-expandable-section></div>
     
        <h2 id="iam-roles-aws-sso">AWS IAM Identity Center (successor to AWS Single Sign-On) の IAM ロール</h2>
        <p><a href="https://docs.aws.amazon.com/kendra/latest/dg/API_UserGroupResolutionConfiguration.html">UserGroupResolutionConfiguration</a>オブジェクトを使用してグループおよびユーザーのアクセスレベルをAWS IAM Identity Center (successor to AWS Single Sign-On) ID ソースを取得する場合、アクセス許可を持つロールを提供する必要がありますIAM Identity Center。</p>
        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="AWS IAM Identity Center (successor to AWS Single Sign-On) の IAM ロール" id="iam-roles-aws-sso-json" expanded="false"><p>Amazon Kendraアクセスを許可をする必須ロールポリシーIAM Identity Center。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "sso-directory:SearchUsers",
                "sso-directory:ListGroupsForUser",
                "sso-directory:DescribeGroups",
                "sso:ListDirectoryAssociations"
            ],
            "Resource": [
                 "*"
            ]
        },
        <span>{</span>
          "Sid": "iamPassRole",
          "Effect": "Allow",
          "Action": "iam:PassRole",
          "Resource": "*",
          "Condition": <span>{</span>
            "StringEquals": <span>{</span>
              "iam:PassedToService": [
                "kendra.*.amazonaws.com"
              ]
            }
          }
        }
     ]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
</awsui-expandable-section></div>
     
        <h2 id="iam-roles-amazon-kendra-experiences">IAMAmazon Kendraエクスペリエンスの役割</h2>
        <p><a href="https://docs.aws.amazon.com/kendra/latest/dg/API_CreateExperience.html">CreateExperience</a>または <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_UpdateExperience.html">UpdateExperience</a>API を使用して検索アプリケーションを作成または更新する場合、必要な操作と IAM Identity Center にアクセスする権限を持つロールを指定する必要があります。</p>
        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMAmazon Kendra検索エクスペリエンスのロール" id="iam-roles-search-app-experience" expanded="false"><p>演算、<code class="code">Query</code>演算、<code class="code">QuerySuggestions</code>演算、およびユーザーおよびグループの情報を保存する IAM IfigurationAmazon Kendra へのアクセスを許可するための必須ロールポリシー。<code class="code">SubmitFeedback</code></p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Sid": "AllowsKendraSearchAppToCallKendraApi",
      "Effect": "Allow",
      "Action": [
        "kendra:GetQuerySuggestions",
        "kendra:Query",
        "kendra:DescribeIndex",
        "kendra:ListFaqs",
        "kendra:DescribeDataSource",
        "kendra:ListDataSources",
        "kendra:DescribeFaq",
        "kendra:SubmitFeedback"
      ],
      "Resource": [
        "arn:aws:kendra:<span>{</span><span>{</span>region}}:<span>{</span><span>{</span>account_id}}:index/<span>{</span><span>{</span>IndexId}}"
      ]
    },
    <span>{</span>
      "Sid": "AllowKendraSearchAppToDescribeDataSourcesAndFaq",
      "Effect": "Allow",
      "Action": [
        "kendra:DescribeDataSource",
        "kendra:DescribeFaq"
      ],
      "Resource": [
        "arn:aws:kendra:<span>{</span><span>{</span><code class="replaceable">region</code>}}:<span>{</span><span>{</span><code class="replaceable">account_id</code>}}:index/<span>{</span><span>{</span><code class="replaceable">IndexId</code>}}/data-source/<span>{</span><span>{</span><code class="replaceable">DataSourceId</code>}}",
        "arn:aws:kendra:<span>{</span><span>{</span><code class="replaceable">region</code>}}:<span>{</span><span>{</span><code class="replaceable">account_id</code>}}:index/<span>{</span><span>{</span><code class="replaceable">IndexId</code>}}/faq/<span>{</span><span>{</span><code class="replaceable">FaqId</code>}}"
      ]
    },
    <span>{</span>
      "Sid": "AllowKendraSearchAppToCallSSODescribeUsersAndGroups",
      "Effect": "Allow",
      "Action": [
        "sso-directory:ListGroupsForUser",
        "sso-directory:SearchGroups",
        "sso-directory:SearchUsers",
        "sso-directory:DescribeUser",
        "sso-directory:DescribeGroup",
        "sso-directory:DescribeGroups",
        "sso-directory:DescribeUsers"
      ],
      "Resource": [
        "*"
      ],
      "Condition": <span>{</span>
        "StringLike": <span>{</span>
          "kms:ViaService": [
            "kendra.*.amazonaws.com"
          ]
        }
      }
    }
  ]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
<p><code class="code">aws:sourceAccount</code><code class="code">aws:sourceArn</code>信頼ポリシーにはとを含めることをお勧めします。これにより、権限が制限され<code class="code">aws:sourceAccount</code>、<code class="code">aws:sourceArn</code>IAM<code class="code">sts:AssumeRole</code>アクションのロールポリシーで指定されているものと同じかどうかが安全にチェックされます。これにより、IAM権限のないエンティティがロールとその権限にアクセスするのを防ぐことができます。詳細については、混乱した代理」<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/confused-deputy.html">混乱した代理」AWS Identity and Access Management 問題に関するガイドを参照してください</a>。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Principal": <span>{</span>
                "Service": [
                    "kendra.*.amazonaws.com"
                ]
            },
            "Action": "sts:AssumeRole",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "aws:SourceAccount": "account ID"
                },
                "StringLike": <span>{</span>
                    "aws:SourceArn": "arn:aws:kendra:region:accountId:index/*"
                }
            }
        }
    ]
}</code></pre></awsui-expandable-section></div>
     
        <h2 id="iam-roles-custom-document-enrichment">IAMCustom Document Enrichment のロール</h2>
        <p><a href="https://docs.aws.amazon.com/kendra/latest/dg/API_CustomDocumentEnrichmentConfiguration.html">CustomDocumentEnrichmentConfiguration</a>オブジェクトを使用してドキュメントのメタデータとコンテンツの高度な変更を適用する場合、<code class="code">PreExtractionHookConfiguration</code>実行に必須の許可を持つロールを提供する必要があります<code class="code">PostExtractionHookConfiguration</code>。<code class="code">PreExtractionHookConfiguration</code> および/または <code class="code">PostExtractionHookConfiguration</code> の Lambda 関数を設定して、取り込みプロセス中にドキュメントのメタデータとコンテンツの高度な変更を適用します。バケットのサーバー側の暗号化を有効にする場合は、Amazon S3バケットに保存されているオブジェクトを暗号化および復号するためのAWS KMSカスタマーマスターキー (CMK) の使用許可を提供する必要があります。Amazon S3</p>
        <div class="collapsible" data-expand-section="_collapse_all_"><awsui-expandable-section variant="container" header="IAMCustom Document Enrichment のロール" id="iam-roles-custom-document-enrichment-json" expanded="false"><p>Amazon Kendra<code class="code">PreExtractionHookConfiguration</code>実行を許可し、<code class="code">PostExtractionHookConfiguration</code>Amazon S3バケットを暗号化するために必要なロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [<span>{</span>
    "Action": [
      "s3:GetObject",
      "s3:PutObject"
    ],
    "Resource": [
      "arn:aws:s3:::<span>{</span><span>{</span><code class="replaceable">input_bucket_name</code>}}/*"
    ],
    "Effect": "Allow"
  },
  <span>{</span>
    "Action": [
      "s3:ListBucket"
    ],
    "Resource": [
      "arn:aws:s3:::<span>{</span><span>{</span><code class="replaceable">input_bucket_name</code>}}"
    ],
    "Effect": "Allow"
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "kms:Decrypt",
      "kms:GenerateDataKey"
    ],
    "Resource": [
      "arn:aws:kms:<span>{</span><span>{</span><code class="replaceable">region</code>}}:<span>{</span><span>{</span><code class="replaceable">account_id</code>}}:key/<span>{</span><span>{</span><code class="replaceable">key_id</code>}}"
    ]
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "lambda:InvokeFunction"
    ],
    "Resource": "arn:aws:lambda:<span>{</span><span>{</span><code class="replaceable">region</code>}}:<span>{</span><span>{</span><code class="replaceable">account_id</code>}}:function:<span>{</span><span>{</span><code class="replaceable">lambda_function</code>}}"
  }]
}</code></pre><p>Amazon Kendra<code class="code">PreExtractionHookConfiguration</code><code class="code">PostExtractionHookConfiguration</code>Amazon S3バケットを暗号化せずに実行を許可するオプションのロールポリシー。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [<span>{</span>
    "Action": [
      "s3:GetObject",
      "s3:PutObject"
    ],
    "Resource": [
      "arn:aws:s3:::<span>{</span><span>{</span><code class="replaceable">input_bucket_name</code>}}/*"
    ],
    "Effect": "Allow"
  },
  <span>{</span>
    "Action": [
      "s3:ListBucket"
    ],
    "Resource": [
      "arn:aws:s3:::<span>{</span><span>{</span><code class="replaceable">input_bucket_name</code>}}"
    ],
    "Effect": "Allow"
  },
  <span>{</span>
    "Effect": "Allow",
    "Action": [
      "lambda:InvokeFunction"
    ],
    "Resource": "arn:aws:lambda:<span>{</span><span>{</span><code class="replaceable">region</code>}}:<span>{</span><span>{</span><code class="replaceable">account_id</code>}}:function:<span>{</span><span>{</span><code class="replaceable">lambda_function</code>}}"
  }]
}</code></pre>
   <p>Amazon Kendraロールを引き受ける許可をする信頼ポリシー。</p>
   <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
   "Version":"2012-10-17",
   "Statement":[
      <span>{</span>
         "Effect":"Allow",
         "Principal":<span>{</span>
            "Service":"kendra.amazonaws.com"
         },
         "Action":"sts:AssumeRole"
      }
   ]
}</code></pre>
<p><code class="code">aws:sourceAccount</code><code class="code">aws:sourceArn</code>信頼ポリシーにはとを含めることをお勧めします。これにより、権限が制限され<code class="code">aws:sourceAccount</code>、<code class="code">aws:sourceArn</code>IAM<code class="code">sts:AssumeRole</code>アクションのロールポリシーで指定されているものと同じかどうかが安全にチェックされます。これにより、IAM権限のないエンティティがロールとその権限にアクセスするのを防ぐことができます。詳細については、混乱した代理」<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/confused-deputy.html">混乱した代理」AWS Identity and Access Management 問題に関するガイドを参照してください</a>。</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Principal": <span>{</span>
                "Service": [
                    "kendra.*.amazonaws.com"
                ]
            },
            "Action": "sts:AssumeRole",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "aws:SourceAccount": "account ID"
                },
                "StringLike": <span>{</span>
                    "aws:SourceArn": "arn:aws:kendra:region:accountId:index/*"
                }
            }
        }
    ]
}</code></pre></awsui-expandable-section></div>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="警告" /> <strong>ブラウザで JavaScript が無効になっているか、使用できません。</strong></p><p>AWS ドキュメントを使用するには、JavaScript を有効にする必要があります。手順については、使用するブラウザのヘルプページを参照してください。</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">ドキュメントの表記規則</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./aws-kendra-set-up-sdks.html">AWS SDK のセットアップ</div><div id="next" class="next-link" accesskey="n" href="./deploying.html"> のデプロイAmazon Kendra</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">このページは役に立ちましたか? - はい</div><div class="content"><p>ページが役に立ったことをお知らせいただき、ありがとうございます。</p><p>お時間がある場合は、何が良かったかお知らせください。今後の参考にさせていただきます。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="フィードバック" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/iam-roles.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">このページは役に立ちましたか? - いいえ</div><div class="content"><p>このページは修正が必要なことをお知らせいただき、ありがとうございます。ご期待に沿うことができず申し訳ありません。</p><p>お時間がある場合は、ドキュメントを改善する方法についてお知らせください。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="フィードバック" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Kendra&amp;topic_url=https://docs.aws.amazon.com/ja_jp/kendra/latest/dg/iam-roles.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>