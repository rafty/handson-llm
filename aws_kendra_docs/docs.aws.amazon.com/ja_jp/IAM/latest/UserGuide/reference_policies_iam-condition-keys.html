<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="ja-JP"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>IAM および AWS STS の条件コンテキストキー - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="reference_policies_iam-condition-keys" /><meta name="default_state" content="reference_policies_iam-condition-keys" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" /><meta name="description" content="ポリシーで使用できる IAM およびその条件キーについて説明します。" /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="ユーザーガイド" /><meta name="abstract" content="ユーザー ID (認証) および特定のアクセス許可 (承認) を定義するポリシーで AWS リソースへのアクセスを制限します。" /><meta name="guide-locale" content="ja_jp" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="ユーザーガイド" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="ユーザーガイド" /><meta id="panorama-serviceConsolePage" value="IAM および AWS STS の条件コンテキストキー" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>IAM および AWS STS の条件コンテキストキー - AWS Identity and Access Management</title><meta name="pdf" content="iam-ug.pdf#reference_policies_iam-condition-keys" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM ユーザー,user,IAM グループ,グループ,[IAM role] (IAM ロール),ロール,アクセス許可ポリシー,信頼ポリシー,ポリシー,アクセスキー,パスワード" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "ユーザーガイド",
        "item" : "https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "AWS Identity and Access Management のリファレンス情報",
        "item" : "https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "IAM JSON ポリシーリファレンス",
        "item" : "https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "IAM および AWS STS の条件コンテキストキー",
        "item" : "https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="iam-ug.pdf#reference_policies_iam-condition-keys" target="_blank" rel="noopener noreferrer" title="PDF を開く"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">ドキュメント</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">ユーザーガイド</a></div><div id="page-toc-src"><a href="#available-keys-for-iam">IAM で使用可能なキー</a><a href="#condition-keys-wif">AWS ウェブ ID フェデレーションで利用可能なキー</a><a href="#cross-condition-keys-wif">クロスサービス AWS ウェブ ID フェデレーションコンテキストキー</a><a href="#condition-keys-saml">SAML ベースの AWS STS フェデレーションに利用可能なキー</a><a href="#cross-condition-keys-saml">クロスサービス SAML ベースの AWS STS フェデレーションコンテキストキー</a><a href="#condition-keys-sts">AWS STS に利用可能なキー</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="reference_policies_iam-condition-keys">IAM および AWS STS の条件コンテキストキー</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>JSON ポリシーの <code class="code">Condition</code> 要素を使用して、すべての AWS リクエストのリクエストコンテキストに含まれるキーの値をテストできます。これらのキーは、リクエスト自体、またはリクエストが参照するリソースに関する情報を示します。ユーザーが要求したアクションを許可する前に、キーが指定された値を持っているかどうかを確認できます。これにより、JSON ポリシーステートメントが着信リクエストと照合するとき、しないときを細かく制御できます。JSON ポリシーで <code class="code">Condition</code> 要素を使用する方法の詳細については、「<a href="./reference_policies_elements_condition.html">IAM JSON ポリシー要素Condition</a>」を参照してください。</p><p>このトピックでは、IAM サービス (<code class="code">iam:</code> プレフィックス付き) および AWS Security Token Service (AWS STS) サービス (<code class="code">sts:</code> プレフィックス付き) で定義および提供されているキーについて説明します。他のいくつかの AWS サービスは、そのサービスによって定義されたアクションおよびリソースに関連するサービス固有のキーも提供します。詳細については、「<a href="reference_policies_actions-resources-contextkeys.html" rel="noopener noreferrer" target="_blank">AWS のサービスのアクション、リソース、および条件キー</a>」を参照してください。条件キーをサポートするサービスのドキュメントには、追加情報がある場合があります。例えば、Amazon S3 リソースのポリシーで使用できるキーについては、<a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/amazon-s3-policy-keys.html#AvailableKeys-iamV2">Amazon Simple Storage Service ユーザーガイド</a>の「<em>Amazon S3 ポリシーキー</em>」を参照してください。</p><div class="highlights" id="inline-topiclist"><h6>トピック</h6><ul><li><a href="#available-keys-for-iam">IAM で使用可能なキー</a></li><li><a href="#condition-keys-wif">AWS ウェブ ID フェデレーションで利用可能なキー</a></li><li><a href="#cross-condition-keys-wif">クロスサービス AWS ウェブ ID フェデレーションコンテキストキー</a></li><li><a href="#condition-keys-saml">SAML ベースの AWS STS フェデレーションに利用可能なキー</a></li><li><a href="#cross-condition-keys-saml">クロスサービス SAML ベースの AWS STS フェデレーションコンテキストキー</a></li><li><a href="#condition-keys-sts">AWS STS に利用可能なキー</a></li></ul></div>
      <h2 id="available-keys-for-iam">IAM で使用可能なキー</h2>
      <p>IAM リソースへのアクセスを制御するポリシーで以下の条件キーを使用できます。</p>
      <div class="variablelist">
          
          
          
          
          
          
          
      <dl>
            <dt><b><span class="term"><a id="ck_AssociatedResourceArn"></a>iam:AssociatedResourceArn</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_ARN">ARN 演算子</a>で動作します。</p>
               <p>宛先サービスでこのロールが関連付けられるリソースの ARN を指定します。通常、リソースは、プリンシパルがロールを渡すサービスに属します。場合によっては、リソースが 3 番目のサービスに属することがあります。たとえば、Amazon EC2 インスタンスで使用するロールを Amazon EC2 Auto Scaling に渡すことができます。この場合、条件は Amazon EC2 インスタンスの ARN と一致します。</p>
               <p>この条件キーは、ポリシーの <a href="./id_roles_use_passrole.html">PassRole</a> アクションにのみ適用されます。他のアクションを制限するために使用することはできません。</p>
               <p>エンティティがロールを渡すことを許可するには、ポリシーでこの条件キーを使用しますが、そのロールが指定されたリソースに関連付けられている場合に限ります。ワイルドカード (*) を使用すると、リージョンまたはリソース ID を制限することなく、特定の種類のリソースに対して操作を実行できます。たとえば、IAM ユーザーまたはロールが、リージョン <code class="code">us-east-1</code> または <code class="code">us-west-1</code> のインスタンスで使用する任意のロールを Amazon EC2 サービスに渡すことを許可できます。IAM ユーザーまたはロールは、ロールを他のサービスに渡すことはできません。さらに、Amazon EC2 が他のリージョンのインスタンスでロールを使用することも許可しません。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Effect": "Allow",
    "Action": "iam:PassRole",
    "Resource": "*",
    "Condition": <span>{</span>
        "StringEquals": <span>{</span>"iam:PassedToService": "ec2.amazonaws.com"},
        "ArnLike": <span>{</span>
            "iam:AssociatedResourceARN": [
                "arn:aws:ec2:us-east-1:111122223333:instance/*",
                "arn:aws:ec2:us-west-1:111122223333:instance/*"
            ]
        }
    }
}</code></pre>
               <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注記</h6></div><div class="awsdocs-note-text"><p><a href="#ck_PassedToService">iam:PassedToService</a> をサポートする AWS サービスは、この条件キーもサポートします。</p></div></div>
            </dd>
         
            <dt><b><span class="term"><a id="ck_AWSServiceName"></a>iam:AWSServiceName</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
               <p>このロールがアタッチされる AWS のサービスを指定します。</p>
               <p>この例では、サービス名が access-analyzer.amazonaws.com である場合、エンティティがサービスにリンクされたロールを作成することを許可します。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
   "Version": "2012-10-17",
   "Statement": [<span>{</span>
       "Effect": "Allow",
       "Action": "iam:CreateServiceLinkedRole",
       "Resource": "*",
       "Condition": <span>{</span>
         "StringLike": <span>{</span>
           "iam:AWSServiceName": "access-analyzer.amazonaws.com"
         }
       }
     }]
 }</code></pre>

            </dd>
         
            <dt><b><span class="term"><a id="ck_OrganizationsPolicyId"></a>iam:OrganizationsPolicyId</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
               <p>指定された AWS Organizations IDを持つポリシーがリクエストで使用されたポリシーと一致するかどうかを確認します。この条件キーを使用する IAM ポリシーの例を表示するには、「<a href="./reference_policies_examples_iam_service-accessed-data-orgs.html">IAM: Organizations ポリシーのサービスの最終アクセス情報を表示</a>」を参照してください。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_PassedToService"></a>iam:PassedToService</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
               <p>ロールを渡すことができるサービスのサービスプリンシパルを指定します。この条件キーは、ポリシーの <a href="./id_roles_use_passrole.html">PassRole</a> アクションにのみ適用されます。他のアクションを制限するために使用することはできません。</p>
               <p>ポリシーでこの条件キーを使用する場合は、サービスプリンシパルを使用してサービスを指定します。サービスプリンシパルは、ポリシーの <code class="code">Principal</code> 要素で指定できるサービスの名前です。通常の形式は、<code class="code">SERVICE_NAME_URL.amazonaws.com</code> です。</p>
               <p>特定のサービスにのみロールを渡すことができるようにユーザーを制限するには、<code class="code">iam:PassedToService</code> を使用します。たとえば、ユーザーは、代理で Amazon S3 バケットにログデータを書き込むために CloudWatch を信頼する<a href="./id_roles_terms-and-concepts.html#iam-term-service-role">サービスロール</a>を作成する場合があります。次に、ユーザーは新しいサービスロールにアクセス許可ポリシーと信頼ポリシーをアタッチする必要があります。この場合、信頼ポリシーで、<code class="code">cloudwatch.amazonaws.com</code> 要素の <code class="code">Principal</code> を指定する必要があります。ユーザーが CloudWatch にロールを渡すことを許可するポリシーを表示するには、「<a href="./reference_policies_examples_iam-passrole-service.html">IAM: IAM ロールを特定の AWS のサービスに渡す</a>」を参照してください。</p>
               <p>この条件キーを使用することで、ユーザーは、指定したサービスにのみ、サービスロールを作成することができます。たとえば、前述のポリシーを持つユーザーが Amazon EC2 のサービスロールを作成しようとすると、オペレーションは失敗します。このエラーは、ユーザーにロールを Amazon EC2 に渡すアクセス許可がないために発生します。</p>
               <p>ロールをサービスに渡し、次に別のサービスにロールを渡すことがあります。<code class="code">iam:PassedToService</code> には、ロールを引き受ける最終サービスのみが含まれ、ロールを渡す中間サービスは含まれません。</p>
               <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注記</h6></div><div class="awsdocs-note-text"><p>一部のサービスでは、この条件キーをサポートしていません。</p></div></div>
            </dd>
         
            <dt><b><span class="term"><a id="ck_PermissionsBoundary"></a>iam:PermissionsBoundary</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_ARN">ARN 演算子</a>で動作します。</p>
               <p>指定したポリシーが IAM プリンシパルリソースのアクセス許可の境界としてアタッチされていることを確認します。詳細については、「<a href="./access_policies_boundaries.html">IAM エンティティのアクセス許可境界</a>」を参照してください。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_PolicyARN"></a>iam:PolicyARN</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_ARN">ARN 演算子</a>で動作します。</p>
               <p>管理ポリシーを含むリクエストの管理ポリシーの Amazon リソースネーム (ARN) を確認します。詳細については、「<a href="./access_controlling.html#access_controlling-policies">ポリシーへのアクセスの制御</a>」を参照してください。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_ResourceTag"></a>iam:ResourceTag/<code class="replaceable">key-name</code></span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
               <p>リソース (ユーザーまたはロール) を識別するためにアタッチされたタグが、指定されたキーの名前および値と一致するかどうかをチェックします。</p>
               <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注記</h6></div><div class="awsdocs-note-text"><p>IAM と AWS STS は <code class="code">iam:ResourceTag</code> IAM 条件キーと <code class="code">aws:ResourceTag</code>グローバル条件キーの両方をサポートします。</p></div></div>
               <p>カスタム属性は、キーバリューのペアの形式で IAM リソースに追加できます。IAM リソース のタグ付けの詳細については、「<a href="./id_tags.html">IAM リソースのタグ付け</a>」を参照してください。<code class="code">ResourceTag</code> リソース (IAM リソースを含む) への<a href="./access_tags.html#access_tags_control-resources">アクセスを制御</a>するには AWS を使用します。ただし、IAM ではグループのタグをサポートしていないため、タグを使用してグループへのアクセスを制御することはできません。</p>
               <p>この例は、<code class="userinput">status=terminated</code> タグを持つユーザーの削除を許可する ID ベースポリシーを作成する方法を示しています。このポリシーを使用するには、サンプルポリシーの<code class="replaceable">イタリック体のプレースホルダーテキスト</code>を独自の情報に置き換えます。次に、<a href="./access_policies_create.html">ポリシーの作成</a>または<a href="./access_policies_manage-edit.html">ポリシーの編集</a>の手順に従います。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "Version": "2012-10-17",
    "Statement": [<span>{</span>
        "Effect": "Allow",
        "Action": "iam:DeleteUser",
        "Resource": "*",
        "Condition": <span>{</span>"StringEquals": <span>{</span>"iam:ResourceTag/<code class="replaceable">status</code>": "<code class="replaceable">terminated</code>"}}
    }]
}</code></pre>
            </dd>
         </dl></div>
    
      <h2 id="condition-keys-wif">AWS ウェブ ID フェデレーションで利用可能なキー</h2>
      <p>ウェブ ID フェデレーションを使用して、OpenID Connect 準拠の OpenID プロバイダー (OP) を通じて認証されたユーザーに、一時的なセキュリティ認証情報を AWS アカウントの IAM OpenID Connect (OIDC) ID プロバイダーを通じて付与できます。このようなプロバイダーの例として、Login with Amazon、Amazon Cognito、Google、Facebook があります。Amazon Elastic Kubernetes Service クラスターのサービスアカウントに発行された id_tokens だけでなく、独自の OpenID OP から取得したアイデンティティトークン (id_tokens) も使用できます。その場合、一時的なセキュリティ認証情報を使用してリクエストするときに、他にも条件キーを使用することができます。これらのキーを使用して、フェデレーティッドユーザーの特定のプロバイダー、アプリケーション、またはユーザーに関連付けられたリソースへのアクセスを制限するポリシーを作成できます。これらのキーは、通常、ロールの信頼ポリシーで使用されます。OIDC プロバイダーの名前の後にクレーム (<code class="code">:aud</code>、<code class="code">:azp</code>、<code class="code">:amr</code>、<code class="code">sub</code>) を付けて条件キーを定義します。Amazon Cognito が使用するロールの場合、キーはクレームの後に <code class="code">cognito-identity.amazonaws.com</code> を使用して定義されます。</p>
      <div class="variablelist">
          
          
          
          
          
          
      <dl>
            <dt><b><span class="term"><a id="ck_wif-amr"></a>amr</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
               <p>例: <code class="code">cognito-identity.amazonaws.com:amr</code></p>
               <p>ウェブ ID フェデレーションに Amazon Cognito を使用する場合、<code class="code">cognito-identity.amazonaws.com:amr</code> キー（認証方法リファレンス）にユーザーのログイン情報が含まれます。このキーには複数の値が含まれるため、<a href="./reference_policies_multi-value-conditions.html">条件 set 演算子</a>を使用してポリシーでキーをテストします。キーには、次の値が含まれている可能性があります。</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p>ユーザーが認証されていない場合、キーには <code class="code">unauthenticated</code> のみが含まれています。</p>
                  </li><li class="listitem">
                     <p>ユーザーが認証されている場合、キーには <code class="code">authenticated</code> という値と、呼び出しで使用されるログインプロバイダーの名前 (<code class="code">graph.facebook.com</code>、<code class="code">accounts.google.com</code>、または <code class="code">www.amazon.com</code>) が含まれています。</p>
                  </li></ul></div>
               <p>たとえば、Amazon Cognito ロールの信頼ポリシーの次の条件では、ユーザーが認証されていないかどうかをテストします。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">"Condition": <span>{</span>
  "StringEquals": 
    <span>{</span> "cognito-identity.amazonaws.com:aud": "us-east-2:<code class="replaceable">identity-pool-id</code>" },
  "ForAnyValue:StringLike": 
    <span>{</span> "cognito-identity.amazonaws.com:amr": "unauthenticated" }
}</code></pre>
            </dd>
         
            <dt><b><span class="term"><a id="ck_wif-aud"></a>aud</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
               <p><code class="code">aud</code> 条件キーを使用して、Google クライアント ID または Amazon Cognito ID プール ID が、ポリシーで指定したものと一致することを確認します。<code class="code">aud</code> キーは、同じ ID プロバイダーの <code class="code">sub</code> キーで使用できます。</p>
               <p><b>例:</b></p>
               <div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><code class="code">graph.facebook.com:app_id</code></p>
                  </li><li class="listitem">
                     <p><code class="code">accounts.google.com:aud</code></p>
                  </li><li class="listitem">
                     <p><code class="code">cognito-identity.amazonaws.com:aud</code></p>
                  </li></ul></div>
               <p><code class="code">graph.facebook.com:app_id</code> フィールドは、他の ID プロバイダーが使用する aud フィールドと一致するオーディエンスコンテキストを提供します。</p>
               <p><code class="code">accounts.google.com:aud</code> 条件キーは、次の Google ID トークンのフィールドと一致します。</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><code class="code">azp</code> フィールドが設定されていない場合の、アプリケーションの <code class="code">aud</code> for OAuth 2.0 Google クライアント ID。<code class="code">azp</code> フィールドが設定されると、<code class="code">aud</code> フィールドは <a href="#ck_oaud">accounts.google.com:oaud</a> 条件キーと一致します。</p>
                  </li><li class="listitem">
                     <p><code class="code">azp</code> フィールドが設定されている場合の <code class="code">azp</code>。これは、ウェブアプリケーションおよび Android アプリに異なる OAuth 2.0 Google クライアント ID があるが同じ Google API プロジェクトを共有している、ハイブリッドアプリで発生する可能性があります。</p>
                  </li></ul></div>
               <p>Google <code class="code">aud</code> フィールドおよび <code class="code">azp</code> フィールドの詳細については、<a href="https://developers.google.com/identity/protocols/OpenIDConnect" rel="noopener noreferrer" target="_blank"><span>Google Identity Platform OpenID 接続</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>ガイドを参照してください。</p>
               <p><code class="code">accounts.google.com:aud</code> 条件キーを使用してポリシーを記述する場合、アプリが <code class="code">azp</code> フィールドを設定するハイブリッドアプリであるかどうかを知る必要があります。</p>
               <p><code class="code">azp</code> フィールドが設定されていません</p>
               <p>次のサンプルポリシーは、<code class="code">azp</code> フィールドを設定しない非ハイブリッドアプリケーションに対して機能します。この場合、Google ID トークン <code class="code">aud</code> フィールドの値は、<code class="code">accounts.google.com:aud</code> および <code class="code">accounts.google.com:oaud</code> 条件キーの両方の値に一致します。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Principal": <span>{</span>"Federated": "accounts.google.com"},
            "Action": "sts:AssumeRoleWithWebIdentity",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "accounts.google.com:aud": "aud-value",
                    "accounts.google.com:oaud": "aud-value",
                    "accounts.google.com:sub": "sub-value"
                }
            }
        }
    ]
}</code></pre>
               <p><code class="code">azp</code> フィールドが設定されました</p>
               <p>次のサンプルポリシーは、<code class="code">azp</code> フィールドを設定するハイブリッドアプリケーションに対して機能します。この場合、Google ID トークン <code class="code">aud</code> フィールドの値は <code class="code">accounts.google.com:oaud</code> 条件キーの値にのみ一致します。<code class="code">azp</code> フィールドの値は <code class="code">accounts.google.com:aud</code> 条件キーの値と一致します。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Principal": <span>{</span>"Federated": "accounts.google.com"},
            "Action": "sts:AssumeRoleWithWebIdentity",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "accounts.google.com:aud": "azp-value",
                    "accounts.google.com:oaud": "aud-value",
                    "accounts.google.com:sub": "sub-value"
                }
            }
        }
    ]
}</code></pre>
            </dd>
         
            <dt><b><span class="term"><a id="ck_wif-id"></a>id</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
               <p><b>例:</b></p>
               <div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><code class="code">graph.facebook.com:id</code></p>
                  </li><li class="listitem">
                     <p><code class="code">www.amazon.com:app_id</code></p>
                  </li><li class="listitem">
                     <p><code class="code">www.amazon.com:user_id</code></p>
                  </li></ul></div>
               <p>これらのキーを使用して、アプリケーション（またはサイト）ID またはユーザー ID が、ポリシーで指定したものと一致することを確認します。これは Facebook または Login with Amazon で機能します。<code class="code">app_id</code> キーは、同じ ID プロバイダーの <code class="code">id</code> キーで使用できます。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_oaud"></a>oaud</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
               <p>例: <code class="code">accounts.google.com:oaud</code></p>
               <p>ウェブ ID フェデレーションに Google を使用する場合、このキーはこの ID トークンの対象となるアカウントの Google 対象者 (<code class="code">aud</code>) を指定します。アプリケーションの OAuth 2.0 クライアント ID のひとつである必要があります。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_wif-sub"></a>sub</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
               <p><b>例:</b> </p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><code class="code">accounts.google.com:sub</code></p>
                  </li><li class="listitem">
                     <p><code class="code">cognito-identity.amazonaws.com:sub</code></p>
                  </li></ul></div>
               <p>これらのキーを使用して、ユーザー ID がポリシーで指定したものと一致することを確認します。<code class="code">sub</code> キーは、同じ ID プロバイダーの <code class="code">aud</code> キーで使用できます。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        "Condition": <span>{</span>
              "StringEquals": <span>{</span>
                  "oidc.eks.us-east-1.amazonaws.com/id/111122223333:aud": "sts.amazonaws.com",
                  "oidc.eks.us-east-1.amazonaws.com/id/111122223333:sub": "system:serviceaccount:default:assumer"
               }
            }
    ]
      }</code></pre>
            </dd>
         
            <dt><b><span class="term">ウェブ ID フェデレーションの詳細</span></b></dt>
            <dd>
               <p>ウェブ ID フェデレーションの詳細については、以下を参照してください。</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><a href="https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-identity.html">Amazon Cognito ユーザーガイド</a></p>
                  </li><li class="listitem">
                     <p><a href="./id_roles_providers_oidc.html">ウェブ ID フェデレーションについて</a></p>
                  </li></ul></div>
            </dd>
         </dl></div>
    
      <h2 id="cross-condition-keys-wif">クロスサービス AWS ウェブ ID フェデレーションコンテキストキー</h2>
      <p>一部のウェブ ID フェデレーション条件キーは、ロールの信頼ポリシーで使用して、他の AWS サービスへのアクセスを許可するユーザーを定義することができます。フェデレーテッドプリンシパルが別のロールを引き受けるときのロール信頼ポリシーや、フェデレーションプリンシパルによるリソースアクセスを許可する他の AWS サービスのリソースポリシーで使用できる条件キーは以下のとおりです。ウェブ ID フェデレーションに Amazon Cognito を使用する場合、これらのキーはユーザーの認証時に使用できます。</p>
      <p>条件キーを選択すると、説明が表示されます。</p>
      <div class="itemizedlist">
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><a href="#ck_wif-amr">amr</a></p>
         </li><li class="listitem">
            <p><a href="#ck_wif-aud">aud</a></p>
         </li><li class="listitem">
            <p><a href="#ck_wif-id">id</a></p>
         </li><li class="listitem">
            <p><a href="#ck_wif-sub">sub</a></p>
         </li></ul></div>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注記</h6></div><div class="awsdocs-note-text"><p>ID プロバイダー (IdP) による認証と最初の AssumeRoleWithWebIdentity 操作の承認後は、他のウェブ ID ベースのフェデレーション条件キーは使用できません。</p></div></div>
    
      <h2 id="condition-keys-saml">SAML ベースの AWS STS フェデレーションに利用可能なキー</h2>
      <p>AWS Security Token Service (AWS STS) を使用して <a href="https://docs.aws.amazon.com/STS/latest/UsingSTS/CreatingSAML.html">SAML ベースのフェデレーション</a>を操作する場合、追加の条件キーをポリシーに含めることができます。</p>
       
         <h3 id="condition-keys-saml_trust-policy">SAML ロールの信頼ポリシー</h3>
         <p>ロールの信頼ポリシーには、以下のキーを含めることができます。これらのキーは、ロールの引き受け許可を発信者に与えるかどうかを規定するのに役立ちます。<code class="code">saml:doc</code> を除いて、すべての値が SAML アサーションから派生します。条件付きのポリシーを作成または編集すると、リスト内のすべての項目が IAM コンソールのビジュアルエディタで使用できるようになります。<code class="code">[]</code> とマークされている項目は、指定された型のリストである値を持つことが<em>できます</em>。</p>
         <div class="variablelist">
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
         <dl>
               <dt><b><span class="term"><a id="ck_aud"></a>saml:aud </span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>SAML アサーションの提供先のエンドポイント URL。このキーの値は、アサーションの <code class="code">SAML Recipient</code> フィールドから取得されます。<code class="code">Audience</code> フィールドから取得された値では<em>ありません</em>。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_commonname"></a>saml:commonName[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">commonName</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_cn"></a>saml:cn[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduOrg</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_doc"></a>saml:doc</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは、ロールの引き受けに使用されたプリンシパルを表します。形式は、<code class="replaceable">account-ID</code>/<code class="replaceable">provider-friendly-name</code> です (<code class="code">123456789012/SAMLProviderName</code> など)。<em>account-ID</em> 値は、<a href="./id_roles_providers_create_saml.html">SAML プロバイダー</a>を所有するアカウントを参照します。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonaffiliation"></a>saml:edupersonaffiliation[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduPerson</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonassurance"></a>saml:edupersonassurance[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduPerson</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonentitlement"></a>saml:edupersonentitlement[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduPerson</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonnickname"></a>saml:edupersonnickname[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduPerson</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonorgdn"></a>saml:edupersonorgdn</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduPerson</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonorgunitdn"></a>saml:edupersonorgunitdn[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduPerson</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonprimaryaffiliation"></a>saml:edupersonprimaryaffiliation</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduPerson</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonprimaryorgunitdn"></a>saml:edupersonprimaryorgunitdn</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduPerson</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonprincipalname"></a>saml:edupersonprincipalname</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduPerson</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonscopedaffiliation"></a>saml:edupersonscopedaffiliation[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduPerson</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersontargetedid"></a>saml:edupersontargetedid[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduPerson</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_eduorghomepageuri"></a>saml:eduorghomepageuri[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduOrg</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_eduorgidentityauthnpolicyuri"></a>saml:eduorgidentityauthnpolicyuri[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduOrg</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_eduorglegalname"></a>saml:eduorglegalname[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduOrg</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_eduorgsuperioruri"></a>saml:eduorgsuperioruri[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduOrg</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_eduorgwhitepagesuri"></a>saml:eduorgwhitepagesuri[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">eduOrg</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_givenname"></a>saml:givenName[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">givenName</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_iss"></a>saml:iss</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>発行者。URN で表されます。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_mail"></a>saml:mail[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">mail</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_name"></a>saml:name[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">name</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_saml-namequalifier"></a>saml:namequalifier</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>SAML プロバイダーのフレンドリ名に基づくハッシュ値。値は、次の値を順番に連結し、'/' 文字で区切ります。</p>
                  <div class="orderedlist">
                      
                      
                      
                  <ol><li>
                        <p><code class="code">Issuer</code> 応答値 (<code class="code">saml:iss</code>)</p>
                     </li><li>
                        <p><code class="code">AWS</code> アカウント ID</p>
                     </li><li>
                        <p> IAM の SAML プロバイダーのフレンドリ名（ARN の最後の部分） </p>
                     </li></ol></div>
                  <p>SAML プロバイダーのアカウント ID とフレンドリ名の連結は、キー <code class="code">saml:doc</code> として IAM ポリシーで使用できます。詳細については、「<a href="./id_roles_providers_saml.html#CreatingSAML-userid">SAML ベースのフェデレーションでユーザーを一意に識別する</a>」を参照してください。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_organizationstatus"></a>saml:organizationStatus[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">organizationStatus</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_primarygroupsid"></a>saml:primaryGroupSID[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">primaryGroupSID</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_saml-sub"></a>saml:sub</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>* これはクレームの件名です。組織内の個々のユーザーを一意に識別する値が含まれます（例: <code class="code">_cbb88bf52c2510eabe00c1642d4643f41430fe25e3</code>）。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_saml-subtype"></a>saml:sub_type</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>このキーの値は、<code class="code">persistent</code> か <code class="code">transient</code>、または SAML アサーションで使用されている <code class="code">Format</code> と <code class="code">Subject</code> 要素の完全な <code class="code">NameID</code> URI で構成されます。<code class="code">persistent</code> の値は、<code class="code">saml:sub</code> 値がセッション間のユーザーでも同じことを意味します。値が <code class="code">transient</code> の場合、ユーザーの <code class="code">saml:sub</code> 値はセッションごとに異なります。<code class="code">NameID</code> 要素の <code class="code">Format</code> 属性の詳細については、「<a href="./id_roles_providers_create_saml_assertions.html">認証レスポンスの SAML アサーションを設定する</a>」を参照してください。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_surname"></a>saml:surname[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">surnameuid</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_uid"></a>saml:uid[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">uid</code> 属性です。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_x500uniqueidentifier"></a>saml:x500UniqueIdentifier[]</span></b></dt>
               <dd>
                  <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
                  <p>これは <code class="code">x500UniqueIdentifier</code> 属性です。</p>
               </dd>
            </dl></div>
         <p><code class="code">eduPerson</code> および <code class="code">eduOrg</code> 属性に関する一般的な情報については、<a href="https://wiki.refeds.org/display/STAN/eduPerson" rel="noopener noreferrer" target="_blank"><span>REFEDS Wiki ウェブサイト</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>を参照してください。<code class="code">eduPerson</code> 属性のリストについては、「<a href="https://software.internet2.edu/eduperson/internet2-mace-dir-eduperson-201602.html" rel="noopener noreferrer" target="_blank"><span>eduPerson オブジェクトクラス仕様 (201602)</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>」を参照してください。</p>
         <p>リストタイプの条件キーには、複数の値を含めることができます。リスト値のポリシー内で条件を作成するには、<a href="./reference_policies_multi-value-conditions.html">set 演算子</a> (<code class="code">ForAllValues</code>、<code class="code">ForAnyValue</code>) を使用できます。たとえば、所属先が「faculty」または「staff」である（ただし、「student」ではない）すべてのユーザーを許可するには、次のような条件を使用します。</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="">"Condition": <span>{</span>
   "ForAllValues:StringLike": <span>{</span>
     "saml:edupersonaffiliation":[ "faculty", "staff"] 
   }
}</code></pre>
       
    
      <h2 id="cross-condition-keys-saml">クロスサービス SAML ベースの AWS STS フェデレーションコンテキストキー</h2>
      <p>SAML ベースのフェデレーション条件キーの中には、後続のリクエストで使用することで、他のサービスや <code class="code">AssumeRole</code> 呼び出しで AWS の操作を許可できるものがあります。フェデレーテッドプリンシパルが別のロールを引き受けるときのロール信頼ポリシーや、フェデレーションプリンシパルによるリソースアクセスを許可する他の AWS サービスのリソースポリシーで使用できる条件キーは以下のとおりです。これらのキーの使用に関する詳細は、<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_saml.html#CreatingSAML-userid">「SAML 2.0 ベースのフェデレーションについて」</a>を参照してください。</p>
      <p>条件キーを選択すると、説明が表示されます。</p>
      <div class="itemizedlist">
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><a href="#ck_saml-namequalifier">saml:namequalifier</a></p>
         </li><li class="listitem">
            <p><a href="#ck_saml-sub">saml:sub</a></p>
         </li><li class="listitem">
            <p><a href="#ck_saml-subtype">saml:sub_type</a></p>
         </li></ul></div>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注記</h6></div><div class="awsdocs-note-text"><p>最初の外部 ID プロバイダー (IdP) 認証レスポンスの後は、他の SAML ベースのフェデレーション条件キーは使用できません。</p></div></div>
    
      <h2 id="condition-keys-sts">AWS STS に利用可能なキー</h2>
      <p>AWS Security Token Service (AWS STS) オペレーションを使用して引き受けたロールについては、IAM ロール信頼ポリシーで以下の条件キーを使用できます。</p>
      <div class="variablelist">
          
          
          
          
          
          
      <dl>
            <dt><b><span class="term"><a id="ck_awsservicename"></a>sts:AWSServiceName</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
               <p>ベアラートークンを使用できるサービスを指定するには、このキーを使用します。ポリシーでこの条件キーを使用する場合は、サービスプリンシパルを使用してサービスを指定します。サービスプリンシパルは、ポリシーの <code class="code">Principal</code> 要素で指定できるサービスの名前です。たとえば、<code class="code">codeartifact.amazonaws.com</code> は AWS CodeArtifact サービスプリンシパルです。</p>
               <p>一部の AWS のサービスでは、プログラムでリソースにアクセスする前に、AWS STS サービスベアラートークンを取得するアクセス許可が必要です。たとえば、AWS CodeArtifact では、プリンシパルがベアラートークンを使用して一部のオペレーションを実行する必要があります。<code class="code">aws codeartifact get-authorization-token</code> コマンドは、ベアラートークンを返します。その後、ベアラートークンを使用して AWS CodeArtifact オペレーションを実行できます。ベアラートークンの詳細については、「<a href="./id_credentials_bearer.html">ベアラートークンを使用する</a>」を参照してください。</p>
               <p><b>可用性</b> – このキーは、ベアラートークンを取得するリクエストに含まれています。AWS STS を直接呼び出してベアラートークンを取得することはできません。他のサービスでいくつかのオペレーションを実行すると、自動的にベアラートークンがリクエストされます。</p>
               <p>この条件キーを使用すると、プリンシパルが特定のサービスで使用するベアラートークンを取得することを許可できます。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_durationseconds"></a>sts:DurationSeconds</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_Numeric">桁演算子</a>で動作します。</p>
               <p>AWS STS ベアラートークンを取得するときにプリンシパルが使用できる時間 (秒) を指定するには、このキーを使用します。</p>
               <p>一部の AWS のサービスでは、プログラムでリソースにアクセスする前に、AWS STS サービスベアラートークンを取得するアクセス許可が必要です。たとえば、AWS CodeArtifact では、プリンシパルがベアラートークンを使用して一部のオペレーションを実行する必要があります。<code class="code">aws codeartifact get-authorization-token</code> コマンドは、ベアラートークンを返します。その後、ベアラートークンを使用して AWS CodeArtifact オペレーションを実行できます。ベアラートークンの詳細については、「<a href="./id_credentials_bearer.html">ベアラートークンを使用する</a>」を参照してください。</p>
               <p><b>可用性</b> – このキーは、ベアラートークンを取得するリクエストに含まれています。AWS STS を直接呼び出してベアラートークンを取得することはできません。他のサービスでいくつかのオペレーションを実行すると、自動的にベアラートークンがリクエストされます。このキーは、AWS STS assume-role オペレーションには含まれていません。</p>
               
            </dd>
         
            <dt><b><span class="term"><a id="ck_externalid"></a>sts:ExternalId</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
               <p>IAM  ロールを引き受けるときにプリンシパルが特定の識別子を提供するように要求するには、このキーを使用します。</p>
               <p><b>可用性</b> – このキーは、AWS CLI または AWS API を使用してロールを引き受ける際にプリンシパルが外部 ID を提供するときにリクエストに含まれています。</p>
               <p>別のアカウントでロールを引き受ける際に必要になる場合がある一意の ID。ロールが属するアカウントの管理者から外部 ID が提供された場合は、その値を <code class="code">ExternalId</code> パラメータに指定します。この値は、パスフレーズやアカウント番号などの任意の文字列とすることができます。外部 ID の最も重要な機能は、混乱した代理問題の防止と対処です。外部 ID と混乱した代理問題の詳細については、「<a href="./id_roles_create_for-user_externalid.html">AWS リソースへのアクセス権を第三者に付与するときに外部 ID を使用する方法</a>」を参照してください。</p>
               <p><code class="code">ExternalId</code> の値は、2～1,224 文字で構成されている必要があります。この値は、空白のない英数字にする必要があります。次の記号を含めることもできます。プラス記号 (+)、等号 (=)、カンマ (,)、ピリオド (.)、アットマーク (@)、コロン (:)、スラッシュ (/)、およびハイフン (-)。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_rolesessionname"></a>sts:RoleSessionName</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
               <p>このキーを使用して、ロールを引き受けるときにプリンシパルが指定するセッション名と、ポリシーで指定されている値を比較します。</p>
               <p><b>可用性</b> – このキーは、プリンシパルが AWS Management Console、assume-role CLI コマンド、または  AWS STS <code class="code">AssumeRole</code>  API オペレーションを使用してロールを引き受けるときにリクエストに含まれています。</p>
               <p>ロール信頼ポリシーでこのキーを使用すると、ユーザーがロールを引き受けるときに特定のセッション名を指定するように要求できます。たとえば、IAM ユーザーがセッション名として自分のユーザー名を指定するように要求できます。IAM ユーザーがロールを引き受けると、ユーザー名と一致するセッション名とともにアクティビティが<a href="./cloudtrail-integration.html#cloudtrail-integration_signin-tempcreds">AWS CloudTrail ログ</a>に表示されます。これにより、管理者がロールを異なるプリンシパルで使用する場合に、ロールセッションを区別しやすくなります。</p>
               <p>次のロール信頼ポリシーは、アカウント <code class="code">111122223333</code> の IAM ユーザーがロールを引き受けるときに、セッション名として  ユーザー名を指定することを要求します。この要件は、条件キーの <code class="code">aws:username</code> <a href="./reference_policies_variables.html">条件変数</a>を使用して適用されます。このポリシーにより、IAM ユーザーはポリシーがアタッチされているロールを引き受けることができます。このポリシーでは、<code class="code">username</code> 変数が IAM ユーザーのみに存在するため、一時的な認証情報を使用するどのユーザーもロールを引き受けることはできません。</p>
               <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>重要</h6></div><div class="awsdocs-note-text"><p>単一値の条件キーは、<a href="./reference_policies_variables.html">変数</a>として使用できます。複数値の条件キーは、変数としては使用できません。</p></div></div>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "RoleTrustPolicyRequireUsernameForSessionName",
            "Effect": "Allow",
            "Action": "sts:AssumeRole",
            "Principal": <span>{</span>"AWS": "arn:aws:iam::111122223333:root"},
            "Condition": <span>{</span>
                "StringLike": <span>{</span>"sts:RoleSessionName": "$<span>{</span>aws:username}"}
            }
        }
    ]
}</code></pre>
               <p>管理者がアクションの AWS CloudTrail ログを表示すると、セッション名とアカウントのユーザー名を比較できます。次の例では、<code class="code">matjac</code> という名前のユーザーが <code class="code">MateoRole</code> というロールを使用してオペレーションを実行しました。管理者は、<code class="code">matjac</code> という名前のユーザーを持っている Mateo Jackson に連絡することができます。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">    "assumedRoleUser": <span>{</span>
        "assumedRoleId": "AROACQRSTUVWRAOEXAMPLE:<code class="replaceable">matjac</code>",
        "arn": "arn:aws:sts::111122223333:assumed-role/<code class="replaceable">MateoRole</code>/<code class="replaceable">matjac</code>"
    }</code></pre>
               <p><a href="./id_roles_common-scenarios_aws-accounts.html">ロールを使用したクロスアカウントアクセス</a>を許可した場合、あるアカウントのユーザーが別のアカウントのロールを引き受けることができます。CloudTrail に一覧表示されている引き受けたロールユーザーの ARN には、その<em>ロールが存在する</em>アカウントが含まれます。ロールを引き受けるユーザーのアカウントは含まれません。ユーザーはアカウント内でのみ一意です。したがって、自分が管理しているアカウントのユーザーが引き受けたロールの CloudTrail ログを確認する場合のみこの方法を使用することをお勧めします。ユーザーは、複数のアカウントで同じユーザー名を使用していることがあります。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_sourceidentity"></a>ST: 送信元アイデンティティ</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
               <p>このキーを使用して、ロールを引き受けるときにプリンシパルが指定するセッション名と、ポリシーで指定されている値を比較します。</p>
               <p><b>可用性</b> — このキーは、AWS STS assume-role CLI コマンドまたは AWS STS <code class="code">AssumeRole</code> API オペレーションを使用してロールを引き受けるときに、プリンシパルがソース ID を提供するときに要求に存在します。</p>
               <p>ロール信頼ポリシーでこのキーを使用して、ユーザーがロールを引き受けるときに特定のセッション名を設定するように要求できます。たとえば、従業員またはフェデレーション ID にソース ID の値を指定するように要求できます。ユーザー名や電子メールなど、ユーザーに関連付けられている属性の 1 つをソース ID として使用するように ID プロバイダ (IdP) を設定できます。次に、IdP は、AWS に送信するアサーションまたはクレームの属性としてソース ID を渡します。ソース ID 属性の値は、ロールを引き受けるユーザーまたはアプリケーションを識別します。</p>
               <p>ユーザーがロールを引き受けると、設定されたソース ID 値とともにアクティビティが<a href="./cloudtrail-integration.html#cloudtrail-integration_signin-tempcreds">AWS CloudTrail ログ</a>に表示されます。これにより、管理者は、AWS のロールで誰がどういったアクションを実行したかを簡単に判断できます。IDがソースIDを設定できるようにするには、<code class="code">sts:SetSourceIdentity</code> アクションのアクセス許可を付与する必要があります。</p>
               <p><a href="#ck_rolesessionname">sts:RoleSessionName</a> とは異なり、ソースIDを設定した後は、値を変更できません。これは、ソース ID によってロールで実行されたすべてのアクションのリクエストコンテキストに存在します。この値は、セッション認証情報を使用して別のロールを引き受けるときに、後続のロールセッションに保持されます。別のロールからあるロールを引き受けると、<a href="./id_roles_terms-and-concepts.html#iam-term-role-chaining">ロールの連鎖</a>と呼ばれます。</p>
               <p><a href="./reference_policies_condition-keys.html#condition-keys-sourceidentity">aws:SourceIdentity</a>グローバル条件キーを使用して、後続の要求のソースIDの値に基づいて AWS リソースへのアクセスをさらに制御できます。</p>
               <p>次のロール信頼ポリシーにより、IAM ユーザー <code class="code">AdminUser</code> はアカウント <code class="code">111122223333</code> でロールを引き受けることができます。また、ソース ID セットが <code class="code">AdminUser</code> である限り、<code class="code">DiegoRamirez</code> にソースIDを設定する権限を付与します。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="コピー"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "AllowAdminUserAssumeRole",
            "Effect": "Allow",
            "Principal": <span>{</span>"AWS": " arn:aws:iam::111122223333:user/AdminUser"},
            "Action": [
                "sts:AssumeRole",
                "sts:SetSourceIdentity"
            ],
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>"sts:SourceIdentity": "DiegoRamirez"}
            }
        }
    ]
}
</code></pre>
               <p>ソース ID 情報の使用の詳細については、「<a href="./id_credentials_temp_control-access_monitor.html">引き受けたロールで実行されるアクションのモニタリングと制御</a>」を参照してください。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_transitivetagkeys"></a>sts:TransitiveTagKeys</span></b></dt>
            <dd>
               <p><a href="./reference_policies_elements_condition_operators.html#Conditions_String">文字列演算子</a>で動作します。</p>
               <p>このキーを使用して、リクエスト内の推移的なセッションタグキーとポリシーで指定されたセッションタグキーを比較します。</p>
               <p><b>可用性</b> – このキーは、一時的なセキュリティ認証情報を使用してリクエストを作成するときにリクエストに含まれます。これらの認証情報には、assume-role オペレーションまたは <code class="code">GetFederationToken</code> オペレーションを使用して作成されたものが含まれます。</p>
               <p>一時的なセキュリティ認証情報を使用してリクエストを行う場合、<a href="./reference_policies_elements_condition.html#AccessPolicyLanguage_RequestContext">リクエストコンテキスト</a>には <code class="code"><a href="./reference_policies_condition-keys.html#condition-keys-principaltag">aws:PrincipalTag</a></code> コンテキストキーが含まれます。このキーには、<a href="./id_session-tags.html">セッションタグ</a>、<a href="./id_session-tags.html#id_session-tags_role-chaining">推移的セッションタグ</a>、およびロールタグのリストが含まれます。推移的セッションタグは、セッション認証情報を使用して別のロールを引き受けるときに、後続のすべてのセッションに保持されるタグです。別のロールからあるロールを引き受けると、<a href="./id_roles_terms-and-concepts.html#iam-term-role-chaining">ロールの連鎖</a>と呼ばれます。</p>
               <p>この条件キーをポリシーで使用すると、ロールの引き受け時またはユーザーのフェデレーション時に、特定のセッションタグを推移的として設定するよう要求できます。</p>
            </dd>
         </dl></div>
   <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="警告" /> <strong>ブラウザで JavaScript が無効になっているか、使用できません。</strong></p><p>AWS ドキュメントを使用するには、JavaScript を有効にする必要があります。手順については、使用するブラウザのヘルプページを参照してください。</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">ドキュメントの表記規則</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./reference_policies_condition-keys.html">グローバル条件キー</div><div id="next" class="next-link" accesskey="n" href="./reference_policies_actions-resources-contextkeys.html">アクション、リソース、および条件キー</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">このページは役に立ちましたか? - はい</div><div class="content"><p>ページが役に立ったことをお知らせいただき、ありがとうございます。</p><p>お時間がある場合は、何が良かったかお知らせください。今後の参考にさせていただきます。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="フィードバック" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">このページは役に立ちましたか? - いいえ</div><div class="content"><p>このページは修正が必要なことをお知らせいただき、ありがとうございます。ご期待に沿うことができず申し訳ありません。</p><p>お時間がある場合は、ドキュメントを改善する方法についてお知らせください。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="フィードバック" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>