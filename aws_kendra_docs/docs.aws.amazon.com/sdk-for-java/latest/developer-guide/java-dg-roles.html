<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Configuring IAM roles for Amazon EC2 - AWS SDK for Java 2.x</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="ec2-iam-roles" /><meta name="default_state" content="ec2-iam-roles" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" /><meta name="description" content="You can use an IAM role to manage temporary credentials for applications that are running on an EC2 instance and making AWS CLI or AWS API requests. This is preferable to storing access keys within the EC2 instance. To assign an AWS role to an EC2 instance and make it available to all of its applications, you create an instance profile that is attached to the instance. An instance profile contains the role and enables programs that are running on the EC2 instance to get temporary credentials. For more information, see" /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS SDK for Java 2.x" /><meta name="guide" content="Developer Guide for version 2.x" /><meta name="abstract" content="Describes the new features in version 2.x of the AWS SDK for Java." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" hreflang="x-default" /><meta name="feedback-item" content="AWS SDK for Java" /><meta name="this_doc_product" content="AWS SDK for Java 2.x" /><meta name="this_doc_guide" content="Developer Guide for version 2.x " /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'sdk-for-java'}"></script><meta id="panorama-serviceSubSection" value="Developer Guide for version 2.x " /><meta id="panorama-serviceConsolePage" value="Configuring IAM roles for Amazon EC2" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Configuring IAM roles for Amazon EC2 - AWS SDK for Java 2.x</title><meta name="pdf" content="/pdfs/sdk-for-java/latest/developer-guide/aws-sdk-java-dg-v2.pdf#ec2-iam-roles" /><meta name="github" content="https://github.com/awsdocs/aws-java-developer-guide-v2/tree/base/doc_source/ec2-iam-roles.md" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=70" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWS%20SDK%20for%20Java&amp;topic_url=http://docs.aws.amazon.com/en_us/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/sdk-for-java/latest/developer-guide/ec2-iam-roles.html" /><meta name="keywords" content="temporary credentials,credential provider,single sign-on settings,credential access configuration" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS SDK for Java",
        "item" : "https://docs.aws.amazon.com/sdk-for-java/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Developer Guide for version 2.x ",
        "item" : "https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Use the AWS SDK for Java 2.x",
        "item" : "https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/using.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Provide temporary credentials to the SDK",
        "item" : "https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/credentials.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Configuring IAM roles for Amazon EC2",
        "item" : "https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/credentials.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/sdk-for-java/latest/developer-guide/aws-sdk-java-dg-v2.pdf#ec2-iam-roles" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/aws-java-developer-guide-v2/tree/base/doc_source/ec2-iam-roles.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/sdk-for-java/index.html">AWS SDK for Java</a><a href="home.html">Developer Guide for version 2.x </a></div><div id="page-toc-src"><a href="#default-provider-chain">Default provider chain and Amazon EC2 instance profiles</a><a href="#roles-walkthrough">Walkthrough: Using IAM roles for EC2 instances</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="ec2-iam-roles">Configuring IAM roles for Amazon EC2</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>

      You can use an IAM role to manage temporary credentials for applications that are running on an EC2 instance and making AWS CLI or AWS API requests. 
      This is preferable to storing access keys within the EC2 instance. To assign an AWS role to an EC2 instance and make it 
      available to all of its applications, you create an instance profile that is attached to the 
      instance. An instance profile contains the role and enables programs that are running on the EC2 instance to
      get temporary credentials. For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_use_switch-role-ec2.html">Using an IAM role to grant permissions to applications running on Amazon EC2 instances</a> in the 
      <em>IAM User Guide</em>.
 </p><p>This topic provides information about how to use IAM roles with AWS SDK for Java applications running on Amazon EC2.</p>
      <h2 id="default-provider-chain">Default provider chain and Amazon EC2 instance profiles</h2>
      <p>If your application creates an AWS client using the <code class="code">create</code>
         method, the client searches for temporary credentials using the <em>default
            credentials provider chain</em>, as described in the <a href="./credentials-chain.html">Default credentials provider chain</a> section .</p>
      <p>The final step in the default provider chain is available only when running your
         application on an Amazon EC2 instance. However, it provides better ease of use and
         security when working with Amazon EC2 instances. You can also pass an <a href="https://sdk.amazonaws.com/java/api/latest/software/amazon/awssdk/auth/credentials/InstanceProfileCredentialsProvider.html" rel="noopener noreferrer" target="_blank"><span>InstanceProfileCredentialsProvider</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> instance directly to the client constructor
         to get instance profile credentials without going through the entire default provider
         chain.</p>
      <p>This is demonstrated in the following example:</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class="java ">S3Client s3 = S3Client.builder()
       .credentialsProvider(InstanceProfileCredentialsProvider.builder().build())
       .build();</code></pre>
      <p>When you use this approach, the SDK retrieves temporary AWS credentials
         that have the same permissions as those associated with the IAM role that is
         associated with the Amazon EC2 instance in its instance profile. Although these
         credentials are temporary and would eventually expire,
            <code class="code">InstanceProfileCredentialsProvider</code> periodically refreshes them for you so
         that they continue to allow access to AWS.</p>
    
      <h2 id="roles-walkthrough">Walkthrough: Using IAM roles for EC2 instances</h2>
      <p>This walkthrough shows you how to retrieve an object from Amazon S3 using an IAM role to manage access.</p>
       
         <h3 id="java-dg-create-the-role">Create an IAM role</h3>
         <p>Create an IAM role that grants read-only access to Amazon S3.</p>
         <div class="orderedlist">
             
             
             
             
         <ol style="list-style-type:arabic ! important;"><li>
               <p>Open the <a href="https://console.aws.amazon.com/iam/home" rel="noopener noreferrer" target="_blank"><span>IAM console</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
            </li><li>
               <p>In the navigation pane, choose <b>Roles</b>, then
                     <b>Create Role</b>.</p>
            </li><li>
               <p>On the <b>Select trusted entity</b> page, choose
                     <b>AWS service</b>. Under <b>Use case</b>, choose <b>EC2</b>.
                  Choose <b>Next</b>.</p>
            </li><li>
               <p>On the <b>Add permissions</b> page, choose <b>Amazon S3ReadOnlyAccess</b> from the permissions
                  policy list, then choose <b>Next</b>.</p>
               <p>Enter a name for the role, then select <b>Create
                     role</b>. Note this name. You need it to launch your Amazon EC2
                  instance.</p>
            </li></ol></div>
       
       
         <h3 id="java-dg-launch-ec2-instance-with-instance-profile">Launch an EC2 instance and specify your IAM role</h3>
         <p>To launch an Amazon EC2 instance with an IAM role using the console, follow the
            instructions in <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html#working-with-iam-roles">the Amazon EC2 User Guide for Linux Instances</a>.</p>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>You need to create or use an existing security group and key pair to connect to the instance.</p></div></div>
         <p>With this IAM and Amazon EC2 setup, you can deploy your
            application to the Amazon EC2 instance and it will have read access to Amazon S3.</p>
       
   <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./credentials-explicit.html">Supply temporary credentials in code</div><div id="next" class="next-link" accesskey="n" href="./region-selection.html">AWS region selection</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWS SDK for Java&amp;topic_url=https://docs.aws.amazon.com/en_us/sdk-for-java/latest/developer-guide/ec2-iam-roles.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=AWS SDK for Java&amp;topic_url=https://docs.aws.amazon.com/en_us/sdk-for-java/latest/developer-guide/ec2-iam-roles.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>