<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>排查一般 IAM 问题 - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="troubleshoot_general" /><meta name="default_state" content="troubleshoot_general" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/troubleshoot_general.html" /><meta name="description" content="诊断并修复在使用 AWS Identity and Access Management (IAM) 时可能遇到的问题。" /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="用户指南" /><meta name="abstract" content="通过用户身份（身份验证）定义特定权限的策略（授权）控制对您的 AWS 资源的访问。" /><meta name="guide-locale" content="zh_cn" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/troubleshoot_general.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/troubleshoot_general.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="用户指南" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="用户指南" /><meta id="panorama-serviceConsolePage" value="排查一般 IAM 问题" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>排查一般 IAM 问题 - AWS Identity and Access Management</title><meta name="pdf" content="iam-ug.pdf#troubleshoot_general" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/troubleshoot_general.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/troubleshoot_general.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/troubleshoot_general.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM 用户,user,IAM 组,group,IAM 角色,role,权限策略,信任策略,策略,访问密钥,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "用户指南",
        "item" : "https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "IAM 故障排除",
        "item" : "https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/troubleshoot.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "排查一般 IAM 问题",
        "item" : "https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/troubleshoot.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="iam-ug.pdf#troubleshoot_general" target="_blank" rel="noopener noreferrer" title="打开 PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">文档</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">用户指南</a></div><div id="page-toc-src"><a href="#troubleshoot_general_cant-sign-in">我无法登录我的 AWS 账户</a><a href="#troubleshoot_general_access-keys">我丢失了访问密钥</a><a href="#troubleshoot_general_access-denied-service">当我向某个 AWS 服务发送请求时，收到了“访问被拒绝”</a><a href="#troubleshoot_general_access-denied-temp-creds">当我使用临时安全凭证发送请求时，收到了“访问被拒绝”</a><a href="#troubleshoot_general_policy-variables-dont-work">策略变量不起作用</a><a href="#troubleshoot_general_eventual-consistency">我所做的更改可能不会立即可见</a><a href="#troubleshoot_general_access-denied-delete-mfa">我没有权限执行：iam:DeleteVirtualMFADevice</a><a href="#troubleshoot_general_securely-create-iam-users">如何安全地创建 IAM 用户？</a><a href="#troubleshoot_general_resources">其他资源</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="troubleshoot_general">排查一般 IAM 问题</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>使用此处的信息可帮助您诊断和修复在使用 AWS Identity and Access Management (IAM) 时出现的访问被拒绝或其他常见问题。</p><div class="highlights" id="inline-topiclist"><h6>问题</h6><ul><li><a href="#troubleshoot_general_cant-sign-in">我无法登录我的 AWS 账户</a></li><li><a href="#troubleshoot_general_access-keys">我丢失了访问密钥</a></li><li><a href="#troubleshoot_general_access-denied-service">当我向某个 AWS 服务发送请求时，收到了“访问被拒绝”</a></li><li><a href="#troubleshoot_general_access-denied-temp-creds">当我使用临时安全凭证发送请求时，收到了“访问被拒绝”</a></li><li><a href="#troubleshoot_general_policy-variables-dont-work">策略变量不起作用</a></li><li><a href="#troubleshoot_general_eventual-consistency">我所做的更改可能不会立即可见</a></li><li><a href="#troubleshoot_general_access-denied-delete-mfa">我没有权限执行：iam:DeleteVirtualMFADevice</a></li><li><a href="#troubleshoot_general_securely-create-iam-users">如何安全地创建 IAM 用户？</a></li><li><a href="#troubleshoot_general_resources">其他资源</a></li></ul></div>
      <h2 id="troubleshoot_general_cant-sign-in">我无法登录我的 AWS 账户</h2>
      <p>确认您具有正确的凭证，并且使用正确的方法进行登录。有关更多信息，请参阅《AWS 登录 用户指南》<em></em>中的<a href="https://docs.aws.amazon.com/signin/latest/userguide/troubleshooting-sign-in-issues.html">登录问题排查</a>。</p>
    
      <h2 id="troubleshoot_general_access-keys">我丢失了访问密钥</h2>
      <p>访问密钥由两个部分组成：</p>
      <div class="itemizedlist">
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><b>访问密钥标识符</b>。标识符是公开的，您可以在列出访问密钥的任意 IAM 控制台中进行查看，例如用户摘要页面。</p>
         </li><li class="listitem">
            <p><b>秘密访问密钥</b>。该密钥会在您最初创建访问密钥对时提供。它与密码一样，<b><em>之后无法检索</em></b>。如果您丢失了私有访问密钥，则必须创建新的访问密钥对。如果您已达到<a href="./reference_iam-quotas.html#reference_iam-quotas-entities">访问密钥的数量上限</a>，必须删除一个现有的密钥对，然后才可以创建另一个。</p>
         </li></ul></div>
      <p>有关更多信息，请参阅<a href="./id_credentials_access-keys_retrieve.html">重置您丢失或遗忘的 AWS 密码或访问密钥</a>。</p>
    
      <h2 id="troubleshoot_general_access-denied-service">当我向某个 AWS 服务发送请求时，收到了“访问被拒绝”</h2>
      <div class="itemizedlist">
          
          
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>检查错误消息是否包含与拒绝访问有关的策略类型。例如，如果错误提到由于服务控制策略 (SCP) 而拒绝访问，则可以专注于对 SCP 问题进行故障排除。知晓策略类型后，您还可以检查该策略类型策略中的特定操作是否存在拒绝语句或缺少允许。有关更多信息，请参阅<a href="./troubleshoot_access-denied.html">排查访问被拒绝错误消息</a>。如果错误消息没有提到与拒绝访问有关的策略类型，请使用本部分中的其余指南进一步排除故障。</p>
         </li><li class="listitem">
            <p>验证您是否具有调用您请求的操作和资源的基于身份的策略权限。如果设置了任何条件，您还必须在发送请求时满足这些条件。有关查看或修改用于 IAM 用户、组或角色的策略的信息，请参阅 <a href="./access_policies_manage.html">管理 IAM policy</a>。</p>
         </li><li class="listitem">
            <p>如果 AWS Management Console 返回消息称您无权执行某个操作，则必须联系您的管理员寻求帮助。您的管理员为您提供了登录凭证或登录链接。</p>
            <p>当 <code class="code">mateojackson</code> IAM 用户尝试使用控制台查看有关虚构 <code class="code"><code class="replaceable">my-example-widget</code></code> 资源的详细信息，但不具有虚构 <code class="code">widgets:<code class="replaceable">GetWidget</code></code> 权限时，会发生以下示例错误。</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">User: arn:aws:iam::123456789012:user/mateojackson is not authorized to perform: widgets:<code class="replaceable">GetWidget</code> on resource: <code class="replaceable">my-example-widget</code></code></pre>
            <p>在这种情况下，Mateo 必须请求他的管理员更新其策略，以允许他使用 <code class="code">widgets:<code class="replaceable">GetWidget</code></code> 操作访问 <code class="code"><code class="replaceable">my-example-widget</code></code> 资源。</p>
         </li><li class="listitem">
            <p>您是否尝试访问支持<a href="./access_policies_identity-vs-resource.html">基于资源的策略</a>（如 Amazon S3、Amazon SNS 或 Amazon SQS）的服务？ 如果是，请确认策略将您指定为主体并为您授予访问权限。如果您在您的账户中向服务发出请求，基于身份的策略或基于资源的策略将向您授予相应的权限。如果您在不同的账户中向服务发出请求，则基于身份的策略和基于资源的策略这两者都必须向您授予权限。要查看哪些服务支持基于资源的策略，请参阅<a href="./reference_aws-services-that-work-with-iam.html">使用 IAM 的AWS服务</a>。</p>
         </li><li class="listitem">
            <p>如果您的策略包含的条件具有键值对，请仔细检查。示例包括 <a href="./reference_policies_condition-keys.html">aws:RequestTag/tag-key</a> 全局条件密钥、 AWS KMS <a href="https://docs.aws.amazon.com/kms/latest/developerguide/policy-conditions.html#conditions-kms-encryption-context"><code class="code">kms:EncryptionContext:<code class="replaceable">encryption_context_key</code></code></a> 和多个服务支持的 <code class="code">ResourceTag/<code class="replaceable">tag-key</code></code> 条件键。确保键名称不与多个结果匹配。由于条件键名称不区分大小写，因为检查名为 <code class="code">foo</code> 的键的条件将与 <code class="code">foo</code>、<code class="code">Foo</code> 或 <code class="code">FOO</code> 匹配。如果您的请求包含多个键值对，其中的键名称只是大小写形式不同，则您的访问可能会被意外拒绝。有关更多信息，请参阅<a href="./reference_policies_elements_condition.html">IAM JSON 策略元素：Condition</a>。</p>
         </li><li class="listitem">
            <p>如果您具有<a href="./access_policies_boundaries.html">权限边界</a>，请验证用于权限边界的策略是否允许您的请求。如果基于身份的策略允许请求，但权限边界不允许，则会拒绝请求。权限边界控制 IAM 主体（用户或角色）可以拥有的最大权限。基于资源的策略不受权限边界限制。权限边界不常用。有关 AWS 如何评估这些策略的更多信息，请参阅 <a href="./reference_policies_evaluation-logic.html">策略评估逻辑</a>。</p>
         </li><li class="listitem">
            <p>如果您手动签署请求（不使用 <a href="http://aws.amazon.com/tools/" rel="noopener noreferrer" target="_blank"><span>AWS SDK</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>），请验证您已正确<a href="https://docs.aws.amazon.com/general/latest/gr/signing_aws_api_requests.html">签署请求</a>。</p>
         </li></ul></div>
    
      <h2 id="troubleshoot_general_access-denied-temp-creds">当我使用临时安全凭证发送请求时，收到了“访问被拒绝”</h2>
      <div class="itemizedlist">
          
          
          
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>首先，请确保您未因与您的临时凭证无关的原因而被拒绝访问。有关更多信息，请参阅<a href="#troubleshoot_general_access-denied-service">当我向某个 AWS 服务发送请求时，收到了“访问被拒绝”</a>。</p>
         </li><li class="listitem">
            <p>要验证服务是否接受临时安全凭证，请参阅<a href="./reference_aws-services-that-work-with-iam.html">使用 IAM 的AWS服务</a>。</p>
         </li><li class="listitem">
            <p>验证您的请求是否采用了正确的签名和适当的格式。有关详细信息，请参阅<a href="http://aws.amazon.com/tools/" rel="noopener noreferrer" target="_blank"><span>工具包</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>文档或 <a href="./id_credentials_temp_use-resources.html">将临时凭证用于 AWS 资源</a>。</p>
         </li><li class="listitem">
            <p>验证您的临时安全凭证没有过期。有关更多信息，请参阅<a href="./id_credentials_temp.html">IAM 临时安全凭证</a>。</p>
         </li><li class="listitem">
            <p>验证 IAM 用户或角色拥有正确的许可。临时安全证书的权限派生自 IAM 用户或角色。因此，权限限于向您已担任其临时凭证的角色授予的权限。有关如何确定临时安全凭证的权限的更多信息，请参阅 <a href="./id_credentials_temp_control-access.html">控制临时安全凭证的权限</a>。</p>
         </li><li class="listitem">
            <p>如果您担任一个角色，您的角色会话可能受会话策略的限制。以编程方式使用 AWS STS <a href="./id_credentials_temp_request.html">请求临时安全凭证</a>时，您可以选择传递内联或托管<a href="./access_policies.html#policies_session">会话策略</a>。会话策略是高级策略，在以编程方式为角色创建临时凭证会话时，这些策略将作为参数进行传递。您可以使用 <code class="code">Policy</code> 参数传递单个 JSON 内联会话策略文档。您可以使用 <code class="code">PolicyArns</code> 参数指定最多 10 个托管会话策略。生成的会话的权限是角色的基于身份的策略与会话策略的交集。或者，如果您的管理员或自定义程序为您提供临时凭证，它们可能已包含会话策略以限制您的访问。</p>
         </li><li class="listitem">
            <p>如果您是联合身份用户，您的会话可能受会话策略的限制。您以 IAM 用户身份登录到 AWS，然后请求联合令牌以成为联合身份用户。有关联合身份用户的更多信息，请参阅<a href="./id_credentials_temp_request.html#api_getfederationtoken">GetFederationToken – 通过自定义身份凭证代理程序进行联合身份验证</a>。在请求联合令牌时，如果您或您的身份代理传递了会话策略，则您的会话受这些策略的限制。生成的会话的权限是您的 IAM 用户的基于身份的策略与会话策略的交集。有关会话策略的更多信息，请参阅<a href="./access_policies.html#policies_session">会话策略</a>。</p>
         </li><li class="listitem">
            <p>如果您使用角色访问具有基于资源的策略的资源，则验证策略已授予该角色权限。例如，以下策略允许 <code class="code">MyRole</code> 从账户 <code class="code">111122223333</code> 访问 <code class="code">MyBucket</code>。</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
  "Version": "2012-10-17",
  "Statement": [<span>{</span>
    "Sid": "S3BucketPolicy",
    "Effect": "Allow",
    "Principal": <span>{</span>"AWS": ["arn:aws:iam::111122223333:role/MyRole"]},
    "Action": ["s3:PutObject"],
    "Resource": ["arn:aws:s3:::MyBucket/*"]
  }]
}</code></pre>
         </li></ul></div>
    
      <h2 id="troubleshoot_general_policy-variables-dont-work">策略变量不起作用</h2>
      <div class="itemizedlist">
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p>验证包含变量的所有策略（包括以下策略版本编号）：<code class="code">"Version": "2012-10-17"</code>。如果没有正确的版本编号，则在评估过程中不会更换变量。只会从字面上评估这些变量。如果您包含最新的版本号，则不包含变量的任何策略仍将起作用。</p>
            <p><code class="code">Version</code> 策略元素与策略版本不同。<code class="code">Version</code> 策略元素用在策略之中，用于定义策略语言的版本。另一方面，当您对 IAM 中的客户托管策略进行更改时，将创建一个策略版本。已更改的策略不会覆盖现有策略。而是由 IAM 创建新的托管策略版本。要了解 <code class="code">Version</code> 策略元素的更多信息，请参阅<a href="./reference_policies_elements_version.html">IAM JSON 策略元素：Version</a>。要了解策略版本的更多信息，请参阅<a href="./access_policies_managed-versioning.html">IAM policy 版本控制</a>。</p>
         </li><li class="listitem">
            <p>验证您的策略变量为正确的大小写。有关详细信息，请参阅 <a href="./reference_policies_variables.html">IAM policy 元素：变量和标签</a>。</p>
         </li></ul></div>
    
      <h2 id="troubleshoot_general_eventual-consistency">我所做的更改可能不会立即可见</h2>
      <p>作为全球数据中心的计算机要访问的服务，IAM 使用称为<a href="https://wikipedia.org/wiki/Eventual_consistency" rel="noopener noreferrer" target="_blank"><span>最终一致性</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>的分布式计算模型。您在 IAM（或其他 AWS 服务）中所做的任何更改，包括在<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction_attribute-based-access-control.html">基于属性的访问控制 (ABAC)</a> 中使用的标记，都需要一段时间才能在所有可能的端点中可见。它在服务器与服务器之间、复制区域与复制区域之间，以及全球的区域与区域之间发送数据需要时间，这会造成一定的延迟。IAM 也使用缓存来提高性能，但在某些情况下，这可能会增加时间。在之前缓存的数据超时之前，更改可能不可见。</p>
      <p>您在设计全球应用程序时，必须考虑到这些可能的延迟。确保应用程序可以按预期工作，即使在一个位置进行的更改不能立即在其他位置可见。此类更改包括创建或更新用户、组、角色或策略。在应用程序的关键、高可用性代码路径中，我们不建议进行此类 IAM 更改。而应在不常运行的、单独的初始化或设置例程中进行 IAM 更改。另外，在生产工作流程依赖这些更改之前，请务必验证更改已传播。</p>
      <p>有关其他某些 AWS 服务如何受此影响的更多信息，请参阅以下资源：</p>
      <div class="itemizedlist">
          
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><b>Amazon DynamoDB</b>：<em>DynamoDB 常见问题</em>中的<a href="http://aws.amazon.com/dynamodb/faqs" rel="noopener noreferrer" target="_blank"><span>什么是 Amazon DynamoDB 的一致性模型？</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>和 Amazon DynamoDB 开发人员指南中的<a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.ReadConsistency.html">读取一致性</a>。</p>
         </li><li class="listitem">
            <p><b>Amazon EC2</b>：<em>Amazon EC2 API 参考</em>中的 <a href="https://docs.aws.amazon.com/AWSEC2/latest/APIReference/query-api-troubleshooting.html#eventual-consistency">EC2 最终一致性</a>。</p>
         </li><li class="listitem">
            <p><b>Amazon EMR</b>：AWS 大数据博客中的 <a href="http://aws.amazon.com/blogs/big-data/ensuring-consistency-when-using-amazon-s3-and-amazon-elastic-mapreduce-for-etl-workflows/" rel="noopener noreferrer" target="_blank"><span>Ensuring Consistency When Using Amazon S3 and Amazon Elastic MapReduce for ETL Workflows</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></p>
         </li><li class="listitem">
            <p><b>Amazon Redshift</b>：<em>Amazon Redshift 数据库开发人员指南</em>中的<a href="https://docs.aws.amazon.com/redshift/latest/dg/managing-data-consistency.html">管理数据一致性</a></p>
         </li><li class="listitem">
            <p><b>Amazon S3</b>：<em>Amazon Simple Storage Service 用户指南</em>中的 <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/Introduction.html#ConsistencyModel">Amazon S3 数据一致性模型</a></p>
         </li></ul></div>
    
      <h2 id="troubleshoot_general_access-denied-delete-mfa">我没有权限执行：iam:DeleteVirtualMFADevice</h2>
      <p>当您尝试为自己或其他用户分配或删除虚拟 MFA 设备时，可能会收到以下错误：</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="">User: arn:aws:iam::123456789012:user/Diego is not authorized to perform: iam:DeleteVirtualMFADevice on resource: arn:aws:iam::123456789012:mfa/Diego with an explicit deny</code></pre>
      <p>如果某个人以前在 IAM 控制台中开始将虚拟 MFA 设备分配给用户后取消该过程，则可能会发生这种情况。这会在 IAM 中为用户创建一个虚拟 MFA 设备，但绝不将其分配给用户。您必须先删除现有的虚拟 MFA 设备，然后才能使用相同设备名称创建新的虚拟 MFA 设备。</p>
      <p>要修复此问题，管理员<b>不应</b>编辑策略权限。相反，管理员必须使用 AWS CLI 或 AWS API 来删除现有但未分配的虚拟 MFA 设备。</p>
      <div class="procedure"><h6>删除现有但未分配的虚拟 MFA 设备</h6><ol><li>
            <p>查看您账户中的虚拟 MFA 设备。</p>
            <div class="itemizedlist">
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>AWS CLI: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/list-virtual-mfa-devices.html"><code class="code">aws iam
                           list-virtual-mfa-devices</code></a></p>
               </li><li class="listitem">
                  <p>AWS API：<a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_ListVirtualMFADevices.html"><code class="code">ListVirtualMFADevices</code></a></p>
               </li></ul></div>
         </li><li>
            <p>在响应中，找到您要修复的用户的虚拟 MFA 设备 ARN。</p>
         </li><li>
            <p>删除虚拟 MFA 设备。</p>
            <div class="itemizedlist">
                
                
            <ul class="itemizedlist"><li class="listitem">
                  <p>AWS CLI: <a href="https://docs.aws.amazon.com/cli/latest/reference/iam/delete-virtual-mfa-device.html"><code class="code">aws
                           iam delete-virtual-mfa-device</code></a></p>
               </li><li class="listitem">
                  <p>AWS API：<a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_DeleteVirtualMFADevice.html"><code class="code">DeleteVirtualMFADevice</code></a></p>
               </li></ul></div>
         </li></ol></div>
    
      <h2 id="troubleshoot_general_securely-create-iam-users">如何安全地创建 IAM 用户？</h2>
      <p>如果您的员工需要访问 AWS，则可以选择创建 IAM 用户或<a href="https://docs.aws.amazon.com/singlesignon/latest/userguide/what-is.html">使用 IAM Identity Center 进行身份验证</a>。如果使用 IAM，AWS 建议您创建 IAM 用户并将凭证安全地传达给员工。如果您不在员工身旁，请使用安全的工作流程向员工传达凭证。</p>
      <p>使用以下工作流程在 IAM 中安全地创建新用户：</p>
      <div class="procedure"><ol><li>
            <p>使用 AWS Management Console <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users_create.html">创建新用户</a>。选择使用自动生成的密码授予 AWS Management Console 访问权限。如有必要，请选中 <b>Users must create a new password at next sign-in</b>（用户必须在下次登录时创建新密码）复选框。在用户更改密码之前，不要向用户添加权限策略。</p>
         </li><li>
            <p>添加用户后，复制新用户的登录 URL、用户名和密码。要查看密码，请选择 <b>Show</b>（显示）。</p>
         </li><li>
            <p>使用贵公司中的安全通信方法（如电子邮件、聊天或支持工单系统）将密码发送给员工。单独为您的用户提供 IAM 用户控制台链接及其用户名。在授予员工权限之前，告诉员工确认他们可以成功登录。</p>
         </li><li>
            <p>员工确认后，添加他们所需的权限。作为安全最佳实践，添加一个策略，要求用户使用 MFA 进行身份验证以管理其凭证。有关策略示例，请参阅 <a href="./reference_policies_examples_aws_my-sec-creds-self-manage.html">AWS：允许经过 MFA 身份验证的 IAM 用户在“My Security Credentials”（我的安全凭证）页面上管理自己的凭证</a>。</p>
         </li></ol></div>
    
      <h2 id="troubleshoot_general_resources">其他资源</h2>
      <p>下列相关资源有助于您在使用 AWS 期间排查问题。</p>
      <div class="itemizedlist">
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><b><a href="https://docs.aws.amazon.com/awscloudtrail/latest/userguide/">AWS CloudTrail 用户指南</a></b> - 使用 AWS CloudTrail 可跟踪对 AWS 进行的 API 调用的历史记录并将这些信息存储在日志文件中。这有助于确定访问了您账户中的资源的用户和账户、进行调用的时间、请求的操作等。有关更多信息，请参阅<a href="./cloudtrail-integration.html">使用 AWS CloudTrail 记录 IAM 和 AWS STS API 调用</a>。</p>
         </li><li class="listitem">
            <p><b><a href="http://aws.amazon.com/premiumsupport/knowledge-center/" rel="noopener noreferrer" target="_blank"><span>AWS 知识中心</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></b> – 查找常见问题解答和其他资源的链接，帮助您排查问题。</p>
         </li><li class="listitem">
            <p><b><a href="https://console.aws.amazon.com/support/home#/" rel="noopener noreferrer" target="_blank"><span>AWS 支持中心</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></b> – 获取技术支持。</p>
         </li><li class="listitem">
            <p><b><a href="http://aws.amazon.com/premiumsupport/" rel="noopener noreferrer" target="_blank"><span>AWS Premium Support 中心</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a></b> – 获取高级技术支持。</p>
         </li></ul></div>
   <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="警告" /> <strong>Javascript 在您的浏览器中被禁用或不可用。</strong></p><p>要使用 Amazon Web Services 文档，必须启用 Javascript。请参阅浏览器的帮助页面以了解相关说明。</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">文档惯例</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./troubleshoot.html">IAM 故障排除</div><div id="next" class="next-link" accesskey="n" href="./troubleshoot_access-denied.html">拒绝访问错误消息</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">此页面对您有帮助吗？- 是</div><div class="content"><p>感谢您对我们工作的肯定！</p><p>如果不耽误您的时间，请告诉我们做得好的地方，让我们做得更好。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="反馈" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/troubleshoot_general.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">此页面对您有帮助吗？- 否</div><div class="content"><p>感谢您告诉我们本页内容还需要完善。很抱歉让您失望了。</p><p>如果不耽误您的时间，请告诉我们如何改进文档。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="反馈" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/troubleshoot_general.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>