<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS JSON 策略元素：Principal - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="reference_policies_elements_principal" /><meta name="default_state" content="reference_policies_elements_principal" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_elements_principal.html" /><meta name="description" content="描述 AWS JSON 策略语言的 Principal 元素。" /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="用户指南" /><meta name="abstract" content="通过用户身份（身份验证）定义特定权限的策略（授权）控制对您的 AWS 资源的访问。" /><meta name="guide-locale" content="zh_cn" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_elements_principal.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_elements_principal.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="用户指南" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="用户指南" /><meta id="panorama-serviceConsolePage" value="AWS JSON 策略元素：Principal" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS JSON 策略元素：Principal - AWS Identity and Access Management</title><meta name="pdf" content="iam-ug.pdf#reference_policies_elements_principal" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_elements_principal.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_elements_principal.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_elements_principal.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM 用户,user,IAM 组,group,IAM 角色,role,权限策略,信任策略,策略,访问密钥,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "用户指南",
        "item" : "https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "AWS Identity and Access Management 的参考信息",
        "item" : "https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "IAM JSON 策略参考",
        "item" : "https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "IAM JSON 策略元素参考",
        "item" : "https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_elements.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "AWS JSON 策略元素：Principal",
        "item" : "https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_elements.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="iam-ug.pdf#reference_policies_elements_principal" target="_blank" rel="noopener noreferrer" title="打开 PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">文档</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">用户指南</a></div><div id="page-toc-src"><a href="#Principal_specifying">指定主体</a><a href="#principal-accounts">AWS 账户 主体</a><a href="#principal-roles">IAM 角色主体</a><a href="#principal-role-session">角色会话主体</a><a href="#principal-users">IAM 用户主体</a><a href="#sts-session-principals">联合身份用户会话主体</a><a href="#principal-services">AWS 服务主体</a><a href="#principal-services-in-opt-in-regions">选择加入区域的 AWS 服务主体</a><a href="#principal-anonymous">所有主体</a><a href="#Principal_more-info">更多信息</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="reference_policies_elements_principal">AWS JSON 策略元素：Principal</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>在基于资源的 JSON 策略中使用 <code class="code">Principal</code> 元素指定允许或拒绝访问资源的主体。</p><p>您必须使用<a href="./access_policies_identity-vs-resource.html">基于资源的策略</a>中的 <code class="code">Principal</code> 元素。包括 IAM 在内的多项服务支持基于资源的策略。IAM 中唯一基于资源的策略类型是角色信任策略。在 IAM 角色中，在角色的信任策略中使用 <code class="code">Principal</code> 元素来指定可担任该角色的对象。对于跨账户存取，您必须指定受信任账户的 12 位标识符。要了解您信任区域之外的账户（受信任的企业或账户）中的主体是否有权承担您的角色，请参阅<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html">什么是 IAM Access Analyzer？</a>。</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>创建角色后，您可以将账户更改为 "*"，允许所有人担任该角色。如果执行此操作，我们强烈建议您通过其他方法 (如将访问只限定为特定 IP 地址的 <code class="code">Condition</code> 元素) 限制能够访问该角色的用户。不要将角色的访问权限开放给所有人！</p></div></div><p>支持基于资源的策略的其他资源示例包括 Amazon S3 存储桶或 AWS KMS key。</p><p>无法在基于身份的策略中使用 <code class="code">Principal</code> 元素。基于身份的策略是附加到 IAM 身份（用户、群体或角色）的权限策略。在这些策略中，附加了策略的身份即是主体的身份。</p><div class="highlights" id="inline-topiclist"><h6>主题</h6><ul><li><a href="#Principal_specifying">指定主体</a></li><li><a href="#principal-accounts">AWS 账户 主体</a></li><li><a href="#principal-roles">IAM 角色主体</a></li><li><a href="#principal-role-session">角色会话主体</a></li><li><a href="#principal-users">IAM 用户主体</a></li><li><a href="#sts-session-principals">AWS STS 联合身份用户会话主体</a></li><li><a href="#principal-services">AWS 服务主体</a></li><li><a href="#principal-services-in-opt-in-regions">选择加入区域的 AWS 服务主体</a></li><li><a href="#principal-anonymous">所有主体</a></li><li><a href="#Principal_more-info">更多信息</a></li></ul></div>
    <h2 id="Principal_specifying">指定主体</h2>
    <p>您可以在基于资源的策略的 <code class="code">Principal</code> 元素中或在支持主体的条件密钥中指定主体。</p>
    <p>您可以在策略中指定以下任意主体：</p>
    <div class="itemizedlist">
       
       
       
       
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>AWS 账户 和根用户</p>
      </li><li class="listitem">
        <p>IAM 角色</p>
      </li><li class="listitem">
        <p>角色会话 </p>
      </li><li class="listitem">
        <p>IAM 用户</p>
      </li><li class="listitem">
        <p>联合身份用户会话</p>
      </li><li class="listitem">
        <p>AWS 服务</p>
      </li><li class="listitem">
        <p>所有主体</p>
      </li></ul></div>
    <p>您无法在策略（例如基于资源的策略）中将用户组标识为主体，因为组与权限相关，与身份验证无关，并且主体是经过身份验证的 IAM 实体。</p>
    <p>您可以使用数组在以下部分中为每个主体类型指定多个主体。数组可以采用一个或多个值。如果您在该元素中指定多个主体，则表示您向每个主体授予权限。这是逻辑 <code class="code">OR</code> 而不是逻辑 <code class="code">AND</code>，因为您一次被认证为一个主体。如果包含多个值，请使用方括号（<code class="code">[</code> 和 <code class="code">]</code>）并用逗号分隔数组的每个条目。以下示例策略定义了 123456789012 账户或 555555555555 账户的权限。</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal" : <span>{</span> 
"AWS": [ 
  "123456789012",
  "555555555555" 
  ]
}</code></pre>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>您不能使用通配符匹配一部分主体名称或 ARN。</p></div></div>
   
    <h2 id="principal-accounts">AWS 账户 主体</h2>
    <p>您可以在基于资源策略的 <code class="code">Principal</code> 元素中或支持主体的条件键中指定 AWS 账户 标识符。这将权限委派给账户。当您允许访问其他账户时，该账户中的管理员必须为该账户中身份（IAM 用户或角色）授予访问权限。在指定 AWS 账户 时，您可以使用账户 ARN (arn:aws:iam::<code class="replaceable">account-ID</code>:root) 或 <code class="code">"AWS":</code> 前缀后加账户 ID 构成的简略格式。</p>
    <p>例如，给定账户 ID 为 <code class="code">123456789012</code> 的情况下，您可以使用以下任一方法来在 <code class="code">Principal</code> 元素中指定账户：</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span> "AWS": "arn:aws:iam::123456789012:root" }</code></pre>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span> "AWS": "123456789012" }</code></pre>
    <p>账户 ARN 和缩短的账户 ID 的行为方式相同。两者都向账户委派权限。在 <code class="code">Principal</code> 元素中使用账户 ARN 并不会将权限限制为该账户的根用户。</p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>当您保存包含缩短账户 ID 的基于资源的策略时，服务可能会将其转换为主体 ARN。这不会更改策略的功能。</p></div></div>
    <p>某些 AWS 服务支持其他用于指定账户主体的选项。例如，Amazon S3 允许您使用以下格式指定<a href="https://docs.aws.amazon.com/general/latest/gr/acct-identifiers.html#FindingCanonicalId">规范用户 ID</a>：</p>
    <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"Principal": <span>{</span> "CanonicalUser": "79a59df900b949e55d96a1e698fbacedfd6e09d98eacf8f8d5218e7cd47ef2be" }</code></pre>
    <p>您还可以指定多个 AWS 账户（或规范用户 ID）作为使用数组的主体。例如，您可以使用所有三种方法在存储桶策略中指定主体。</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span> 
  "AWS": [
    "arn:aws:iam::123456789012:root",
    "999999999999"
  ],
  "CanonicalUser": "79a59df900b949e55d96a1e698fbacedfd6e09d98eacf8f8d5218e7cd47ef2be"
}</code></pre>
   
    <h2 id="principal-roles">IAM 角色主体</h2>
    <p>您可以在支持主体的基于资源的策略或条件密钥的 <code class="code">Principal</code> 元素中指定 IAM 角色主体 ARN。IAM 角色是身份。在 IAM 中，身份是您可以向其分配权限的资源。角色信任另一个身份验证来担任该角色。这包含 AWS 中的主体或来自外部身份提供程序 (IdP) 的用户。当主体或身份代入角色时，他们会收到具有代入角色权限的临时安全证书。当他们使用这些凭证在 AWS 中执行操作时，将变为<em>角色会话主体</em>。</p>
    <p>IAM 角色是 IAM 中存在的身份。角色信任另一个经过身份验证的身份，如 AWS 中的主体或来自外部身份提供程序的用户。当主体或身份代入角色时，他们会收到临时安全凭证。然后，他们可以使用这些凭证作为角色会话主体在 AWS 中执行操作。</p>
    <p>当您在基于资源的策略中指定角色主体时，主体的有效权限受限制该角色权限的任何策略类型的限制。这包括会话策略和权限边界。有关如何评估角色会话的有效权限的更多信息，请参阅 <a href="./reference_policies_evaluation-logic.html">策略评估逻辑</a>。</p>
    <p>要指定 <code class="code">Principal</code> 元素中的角色 ARN，请采用以下格式：</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span> "AWS": "arn:aws:iam::<code class="replaceable">AWS-account-ID</code>:role/<code class="replaceable">role-name</code>" }</code></pre>
    <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>重要</h6></div><div class="awsdocs-note-text"><p>如果角色信任策略的 <code class="code">Principal</code> 元素中包含指向特定 IAM 角色的 ARN，在保存策略时该 ARN 将转换为该角色的唯一主体 ID。如果有人希望通过删除并重新创建角色来提升特权，这样有助于减轻此类风险。您通常不会在控制台中看到这个 ID，因为 IAM 在显示信任策略时使用反向转换回角色 ARN。但是，如果您删除角色，这种关系即被打破。即使您重新创建角色，策略也不再适用。因为新角色拥有新的主体 ID，与信任策略中存储的 ID 不匹配。发生这种情况时，主体 ID 会出现在基于资源的策略中，因为 AWS 无法将其映射回有效的 ARN。最终结果是，如果您删除并重新创建了信任策略的 <code class="code">Principal</code> 元素所引用的角色，您必须编辑策略中的角色，用正确的 ARN 替换主体 ID。当您保存策略时，ARN 会再次转换为该角色新的主体 ID。</p></div></div>
    <p><a href="#principal-anonymous">IAM 联合身份用户</a> — IAM 用户使用 <code class="code">aws:PrincipalArn</code> 操作联合身份，为 IAM 用户生成联合身份用户会话主体。当您使用此密钥时，角色会话主体将根据所担任的角色的 ARN 而不是所生成的会话的 ARN 授予权限。由于 AWS 不将条件密钥 ARN 转换为 ID，如果您删除该角色，然后创建一个具有相同名称的新角色，则授予该角色 ARN 的权限将继续存在。基于身份的策略类型，例如权限边界或会话策略，不限制在 <code class="code">Principal</code> 元素中使用带通配符（*）的 <code class="code">aws:PrincipalArn</code> 条件键授予权限，除非基于身份的策略包含显式拒绝。</p>
   
    <h2 id="principal-role-session">角色会话主体</h2>
    <p>您可以在支持主体的基于资源的策略或条件密钥的 <code class="code">Principal</code> 元素中指定角色会话。当主体或身份代入角色时，他们会收到具有代入角色权限的临时安全证书。当他们使用这些凭证，在 AWS 中执行操作时，将变为<em>角色会话主体</em>。</p>
    <p>您用于角色会话主体的格式取决于用来代入角色的 AWS STS 操作。</p>
    <p>此外，管理员可以设计一个流程来控制角色会话的发放方式。例如，他们可以为用户提供一键式解决方案，以创建可预测的会话名称。如果管理员执行此操作，则您可以在策略或条件密钥中使用角色会话主体。否则，您可以在 <code class="code">aws:PrincipalArn</code> 条件键中将角色 ARN 指定为主体。如何将角色指定为主体可以更改所生成的会话的有效权限。有关更多信息，请参阅<a href="#principal-roles">IAM 角色主体</a>。</p>
     
      <h3 id="principal-sessions">代入角色会话主体</h3>
      <p><em>代入的角色会话主体</em>是使用 AWS STS <code class="code">AssumeRole</code> 操作所产生的会话主体。有关哪些主体可以使用此操作代入角色的更多信息，请参阅 <a href="./id_credentials_temp_request.html#stsapi_comparison">比较 AWS STS API 操作</a>。</p>
      <p>要指定 <code class="code">Principal</code> 元素中代入角色会话的 ARN，请采用以下格式：</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span> "AWS": "arn:aws:sts::<code class="replaceable">AWS-account-ID</code>:assumed-role/role-name/role-session-name" }</code></pre>
      <p>当您在 <code class="code">Principal</code> 元素中指定代入角色会话时，不能使用通配符 "*" 表示所有会话。主体必须始终指明特定会话。</p>
     
     
      <h3 id="principal-federated-web-identity">Web 身份会话主体</h3>
      <p><em>Web 身份会话主体</em>是使用 AWS STS <code class="code">AssumeRoleWithWebIdentity</code> 操作产生的会话主体。您可以使用外部 Web 身份提供程序 (IdP) 登录，然后使用此操作代入 IAM 角色。这利用了联合身份并发出角色会话。有关哪些主体可以使用此操作代入角色的更多信息，请参阅 <a href="./id_credentials_temp_request.html#stsapi_comparison">比较 AWS STS API 操作</a>。</p>
      <p>当通过 Web 身份提供程序发出角色时，您将获得这种特殊类型的会话主体，其中包括 Web 身份提供程序相关信息。</p>
      <p>在策略中使用此主体类型可基于受信任的 Web 身份提供程序来允许或拒绝访问。要指定角色信任策略 <code class="code">Principal</code> 元素中 Web 身份角色会话的 ARN，请采用以下格式：</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span> "Federated": "cognito-identity.amazonaws.com" }</code></pre>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span> "Federated": "www.amazon.com" }</code></pre>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span> "Federated": "graph.facebook.com" }</code></pre>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span> "Federated": "accounts.google.com" }</code></pre>
     
     
      <h3 id="principal-saml">SAML 会话主体</h3>
      <p><em>SAML 会话主体</em>是使用 AWS STS <code class="code">AssumeRoleWithSAML</code> 操作产生的会话主体。您可以使用外部 SAML 身份提供程序 (IdP) 登录，然后使用此操作代入 IAM 角色。这利用了身份联合身份验证并发出角色会话。有关哪些主体可以使用此操作代入角色的更多信息，请参阅 <a href="./id_credentials_temp_request.html#stsapi_comparison">比较 AWS STS API 操作</a>。</p>
      <p>从 SAML 身份提供程序发出角色时，您将获得这种特殊类型的会话主体，其中包括有关 SAML 身份提供程序的信息。</p>
      <p>在策略中使用此主体类型可基于受信任的 SAML 身份提供程序来允许或拒绝访问。要指定角色信任策略 <code class="code">Principal</code> 元素中 SAML 身份角色会话的 ARN，请采用以下格式：</p>
      <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span> "Federated": "arn:aws:iam::<code class="replaceable">AWS-account-ID</code>:saml-provider/<code class="replaceable">provider-name</code>" }</code></pre>
     
   
    <h2 id="principal-users">IAM 用户主体</h2>
    <p>您可以在支持主体的基于资源的策略或条件键的 <code class="code">Principal</code> 元素中指定 IAM 用户。</p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>在 <code class="code">Principal</code> 元素中，<a href="./reference_identifiers.html#identifiers-arns">Amazon Resource Name (ARN)</a> 的用户名部分区分大小写。</p></div></div>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span> "AWS": "arn:aws:iam::<code class="replaceable">AWS-account-ID</code>:user/<code class="replaceable">user-name</code>" }</code></pre>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span>
  "AWS": [
    "arn:aws:iam::<code class="replaceable">AWS-account-ID</code>:user/<code class="replaceable">user-name-1</code>", 
    "arn:aws:iam::<code class="replaceable">AWS-account-ID</code>:user/<code class="replaceable">user-name-2</code>"
  ]
}</code></pre>
    <p>当在 <code class="code">Principal</code> 元素中指定用户时，不能使用通配符 (<code class="code">*</code>) 表示“所有用户”。主体必须始终指明特定用户。</p>
    <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>重要</h6></div><div class="awsdocs-note-text"><p>如果角色信任策略的 <code class="code">Principal</code> 元素中包含指向特定 IAM 用户的 ARN，则在保存策略时该 IAM 将 ARN 转换为该用户的唯一主体 ID。如果有人希望通过删除并重新创建用户来提升特权，这样有助于减轻此类风险。您通常不会在控制台中看到这个 ID，因为显示信任策略时它还会反向转换为用户的 ARN。但是，如果您删除角色，这种关系即被打破。即使您重新创建用户，策略也不再适用。这是因为：新用户拥有新的主体 ID，该 ID 与信任策略中存储的 ID 不匹配。发生这种情况时，主体 ID 会出现在基于资源的策略中，因为 AWS 无法将其映射回有效的 ARN。结果是，如果您删除并重新创建了信任策略的 <code class="code">Principal</code> 元素所引用的用户，您必须编辑角色，用正确的 ARN 替换目前不正确的主体 ID。当您保存策略时，IAM 会再次将 ARN 转换为该用户新的主体 ID。</p></div></div>
   
    <h2 id="sts-session-principals">AWS STS 联合身份用户会话主体</h2>
    <p>您可以在支持主体的基于资源的策略或条件密钥的 <code class="code">Principal</code> 元素中指定 <em>federated user sessions</em>（联合身份用户会话）。</p>
    <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>重要</h6></div><div class="awsdocs-note-text"><p>AWS 建议只在必要时使用 AWS STS 联合身份用户会话，如<a href="https://docs.aws.amazon.com/general/latest/gr/root-vs-iam.html#aws_tasks-that-require-root">需要使用根用户访问权限</a>时。反过来，<a href="./tutorial_cross-account-with-roles.html">使用角色来委托权限</a>。</p></div></div>
    <p><em>AWS STS 联合身份用户会话主体</em>是使用 AWS STS <code class="code">GetFederationToken</code> 操作产生的会话主体。在这种情况下，AWS STS 将<a href="http://aws.amazon.com/identity/federation/" rel="noopener noreferrer" target="_blank"><span>联合身份</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>而非 IAM 角色作为获取临时访问令牌的方法。</p>
    <p>在 AWS 中，IAM 用户或 AWS 账户根用户 可以使用长期访问密钥进行身份验证。有关哪些主体可以使用此操作联合身份的更多信息，请参阅 <a href="./id_credentials_temp_request.html#stsapi_comparison">比较 AWS STS API 操作</a>。</p>
    <div class="itemizedlist">
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p><b>IAM 联合身份用户</b> — IAM 用户使用 <code class="code">GetFederationToken</code> 操作联合身份，为 IAM 用户生成联合身份用户会话主体。</p>
      </li><li class="listitem">
        <p><b>联合身份根用户</b>— 一个根用户联邦成员使用对该根用户产生联邦用户会话主体的 <code class="code">GetFederationToken</code> 操作。</p>
      </li></ul></div>
    <p>当 IAM 用户或根用户通过使用此操作的 AWS STS 请求临时凭证时，他们开启临时的联合身份会话。本会话的 ARN 基于联合身份的原始身份。</p>
    <p>要指定 <code class="code">Principal</code> 元素中联合身份用户会话的 ARN，请采用以下格式：</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span> "AWS": "arn:aws:sts::<code class="replaceable">AWS-account-ID</code>:federated-user/<code class="replaceable">user-name</code>" }</code></pre>
   
    <h2 id="principal-services">AWS 服务主体</h2>
    <p>您可以在支持主体的基于资源的策略或条件密钥的 <code class="code">Principal</code> 元素中指定 AWS 服务。一个<em>服务主体</em>是服务的标识符。</p>
    <p>可以由 AWS 服务担任的 IAM 角色称为<em><a href="./id_roles_terms-and-concepts.html#iam-term-service-role">服务角色</a></em>。服务角色必须包括信任策略。<em>信任策略</em>是附加到角色的基于资源的策略，这些策略定义了可担任该角色的主体。某些服务角色具有预定义的信任策略。但有些情况下，您必须在信任策略中指定服务主体。</p>
    
    <p>服务主体的标识符包括服务名称，通常采用以下格式：</p>
    <p><code class="code"><code class="replaceable">service-name</code>.amazonaws.com</code></p>
    
    
    <p>服务主体由服务定义。可以通过以下方式找到某些服务的服务主体：打开 <a href="./reference_aws-services-that-work-with-iam.html">使用 IAM 的AWS服务</a>，检查服务在 <b>Service-linked role</b>（服务相关角色）列中是否具有 <b>Yes</b>，然后打开 <b>Yes</b>（是）链接以查看该服务的服务相关角色文档。查找该服务的<b>服务相关角色权限</b>部分，查看服务主体。</p>
    <p>以下示例显示了一个可以附加到服务角色的策略。该策略可启用两个服务（Amazon ECS 和 Elastic Load Balancing）以担任该角色。然后，这些服务可执行由分配给该角色 (未显示) 的权限策略授权执行的任何任务。要指定多个服务主体，不用指定两个 <code class="code">Service</code> 元素；您可以只使用一个该元素。实际上，您可以将一组多个服务主体作为单个 <code class="code">Service</code> 元素的值。</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span>
    "Service": [
        "ecs.amazonaws.com",
        "elasticloadbalancing.amazonaws.com"
   ]
}</code></pre>
   
    <h2 id="principal-services-in-opt-in-regions">选择加入区域的 AWS 服务主体</h2>
    <p>您可以在多个 AWS 区域以及您必须选择加入的其中一些区域启动资源。有关您必须选择加入的区域的完整列表，请参阅 <em>AWS 一般参考</em> 指南中的<a href="https://docs.aws.amazon.com/general/latest/gr/rande-manage.html">管理 AWS 区域</a>。</p>
    
    <p>当选择加入区域中的 AWS 服务在同一区域内提出请求时，服务主体名称格式被标识为其服务主体名称的非区域化版本：</p>
    <p><code class="code"><code class="replaceable">service-name</code>.amazonaws.com</code></p>
    <p>当选择加入区域中的 AWS 服务向另一个区域内提出跨区域请求时，服务主体名称格式被标识为其服务主体名称的区域化版本：</p>
    <p><code class="code"><code class="replaceable">service-name</code>.<code class="replaceable"><span>{</span>region}</code>.amazonaws.com</code></p>
    <p>例如，您有一个 Amazon SNS 主题位于区域 <code class="code">ap-southeast-1</code>，一个 Amazon S3 桶位于选择加入区域 <code class="code">ap-east-1</code>。您想要配置 S3 桶通知以向 SNS 主题发布消息。要允许 S3 服务向 SNS 主题发布消息，您必须通过该主题的基于资源的访问策略授予 S3 服务主体 <code class="code">sns:Publish</code> 权限。</p>
    <p>如果您在主题访问策略中指定了 S3 服务主体的非区域化版本 <code class="code">s3.amazonaws.com</code>，则从桶向主题发出的 <code class="code">sns:Publish</code> 请求将失败。以下示例在 SNS 主题访问策略的 <code class="code">Principal</code> 策略元素中指定了非区域化 S3 服务主体。</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span> "Service": "s3.amazonaws.com" }</code></pre>
    <p>由于桶位于选择加入区域，并且请求是在同一区域之外发出的，因此 S3 服务主体显示为区域化服务主体名称 <code class="code">s3.ap-east-1.amazonaws.com</code>。当选择加入区域中的 AWS 服务向另一个区域发出请求时，您必须使用区域化服务主体名称。指定区域化服务主体名称后，如果桶向位于另一个区域的 SNS 主题发出 <code class="code">sns:Publish</code> 请求，则请求将成功。以下示例在 SNS 主题访问策略的 <code class="code">Principal</code> 策略元素中指定了区域化 S3 服务主体。</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": <span>{</span> "Service": "s3.ap-east-1.amazonaws.com" }</code></pre>
    <p>只有指定了区域化服务主体名称，资源策略或基于服务主体的允许列表才能成功处理从一个选择加入区域到另一个区域的跨区域请求。</p>
    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>对于 IAM 角色信任策略，我们建议使用非区域化服务主体名称。IAM 资源是全局性的，因此可以在任何区域使用相同的角色。</p></div></div>
   
    <h2 id="principal-anonymous">所有主体</h2>
    <p>您可以在基于资源的策略的 <code class="code">Principal</code> 元素或在支持主体的条件键中使用通配符（*）指定所有主体。使用 <a href="./access_policies.html#policies_resource-based">基于资源的策略</a> <em>授予</em>权限和<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html">条件键</a>来限制策略语句的条件。</p>
    <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>重要</h6></div><div class="awsdocs-note-text"><p>我们强烈建议不要在带有 <code class="code">Allow</code> 效果的基于资源的策略的 <code class="code">Principal</code> 元素中使用通配符（*），除非您打算授予公共或匿名访问权限。否则，请在 <code class="code">Principal</code> 元素中指定预期的主体、服务或 AWS 账户，然后进一步将访问权限限制在 <code class="code">Condition</code> 元素内。对于 IAM 角色信任策略尤其如此，因为它们允许其他主体成为您账户中的主体。</p></div></div>
    <p>对于基于资源的策略，使用带 <code class="code">Allow</code> 效果的通配符（*）向所有用户（包括匿名用户）授予访问权限（公共访问权限）。对于账户中的 IAM 用户和角色主体，不需要其他权限。对于其他账户中的主体，他们还必须在其账户中拥有基于身份的权限，以允许他们访问您的资源。这称为 <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_evaluation-logic-cross-account.html">cross-account access</a>（跨账户存取）。</p>
    <p>对于匿名用户，以下元素是等效的：</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal": "*"</code></pre>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Principal" : <span>{</span> "AWS" : "*" }</code></pre>
    <p>您不能使用通配符匹配一部分主体名称或 ARN。</p>
    <p>以下示例说明了基于资源的策略（而非 <a href="./reference_policies_elements_notprincipal.html#specifying-notprincipal">NotPrincipal 与 Deny</a>）可用于显式拒绝<em>除</em> <code class="code">Condition</code> 元素中指定的主体之外的所有主体。</p>
    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Sid": "UsePrincipalArnInsteadOfNotPrincipalWithDeny",
      "Effect": "Deny",
      "Action": "s3:*",
      "Principal": "*",
      "Resource": [
        "arn:aws:s3:::<code class="replaceable">BUCKETNAME</code>/*",
        "arn:aws:s3:::<code class="replaceable">BUCKETNAME</code>"
      ],
      "Condition": <span>{</span>
        "ArnNotEquals": <span>{</span>
          "aws:PrincipalArn": "arn:aws:iam::444455556666:user/<code class="replaceable">user-name</code>"
        }
      }
    }
  ]
}</code></pre>
   
    <h2 id="Principal_more-info">更多信息</h2>
    <p>有关更多信息，请参阅下列内容：</p>
    <div class="itemizedlist">
       
       
       
       
       
       
    <ul class="itemizedlist"><li class="listitem">
        <p>《Amazon Simple Storage Service 用户指南》中的 <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies.html">存储桶策略示例</a></p>
      </li><li class="listitem">
        <p>《Amazon Simple Notification Service 开发人员指南》中的 <a href="https://docs.aws.amazon.com/sns/latest/dg/UsingIAMwithSNS.html#ExamplePolicies_SNS">Amazon SNS 示例策略</a><em></em></p>
      </li><li class="listitem">
        <p>《Amazon Simple Queue Service 开发商指南》中的 <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/SQSExamples.html">Amazon SQS 策略示例</a><em></em></p>
      </li><li class="listitem">
        <p>《AWS Key Management Service 开发人员指南》中的 <a href="https://docs.aws.amazon.com/kms/latest/developerguide/key-policies.html">密钥策略</a><em></em></p>
      </li><li class="listitem">
        <p>《AWS 一般参考》中的 <a href="https://docs.aws.amazon.com/general/latest/gr/acct-identifiers.html">账户标识符</a><em></em></p>
      </li><li class="listitem">
        <p><a href="./id_roles_providers_oidc.html">关于 Web 联合身份验证</a></p>
      </li></ul></div>
  <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="警告" /> <strong>Javascript 在您的浏览器中被禁用或不可用。</strong></p><p>要使用 Amazon Web Services 文档，必须启用 Javascript。请参阅浏览器的帮助页面以了解相关说明。</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">文档惯例</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./reference_policies_elements_effect.html">Effect</div><div id="next" class="next-link" accesskey="n" href="./reference_policies_elements_notprincipal.html">NotPrincipal</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">此页面对您有帮助吗？- 是</div><div class="content"><p>感谢您对我们工作的肯定！</p><p>如果不耽误您的时间，请告诉我们做得好的地方，让我们做得更好。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="反馈" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_elements_principal.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">此页面对您有帮助吗？- 否</div><div class="content"><p>感谢您告诉我们本页内容还需要完善。很抱歉让您失望了。</p><p>如果不耽误您的时间，请告诉我们如何改进文档。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="反馈" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_elements_principal.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>