<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>IAM 和 AWS STS 条件上下文密钥 - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="reference_policies_iam-condition-keys" /><meta name="default_state" content="reference_policies_iam-condition-keys" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" /><meta name="description" content="描述 IAM 以及可在策略中使用的相关条件键。" /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="用户指南" /><meta name="abstract" content="通过用户身份（身份验证）定义特定权限的策略（授权）控制对您的 AWS 资源的访问。" /><meta name="guide-locale" content="zh_cn" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="用户指南" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="用户指南" /><meta id="panorama-serviceConsolePage" value="IAM 和 AWS STS 条件上下文密钥" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>IAM 和 AWS STS 条件上下文密钥 - AWS Identity and Access Management</title><meta name="pdf" content="iam-ug.pdf#reference_policies_iam-condition-keys" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM 用户,user,IAM 组,group,IAM 角色,role,权限策略,信任策略,策略,访问密钥,password" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "用户指南",
        "item" : "https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "AWS Identity and Access Management 的参考信息",
        "item" : "https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "IAM JSON 策略参考",
        "item" : "https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "IAM 和 AWS STS 条件上下文密钥",
        "item" : "https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="iam-ug.pdf#reference_policies_iam-condition-keys" target="_blank" rel="noopener noreferrer" title="打开 PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">文档</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">用户指南</a></div><div id="page-toc-src"><a href="#available-keys-for-iam">IAM 的可用键</a><a href="#condition-keys-wif">AWS Web 联合身份验证的可用键</a><a href="#cross-condition-keys-wif">跨服务 AWS Web 身份联合验证上下文键</a><a href="#condition-keys-saml">基于 SAML 的 AWS STS 联合身份验证的可用键</a><a href="#cross-condition-keys-saml">基于 SAML 的跨服务 AWS STS 联合身份验证上下文键</a><a href="#condition-keys-sts">AWS STS 的可用键</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="reference_policies_iam-condition-keys">IAM 和 AWS STS 条件上下文密钥</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>您可以在 JSON 策略中使用 <code class="code">Condition</code> 元素来测试所有 AWS 请求的请求上下文中所包含键的值。这些键提供有关请求本身或请求所引用资源的信息。在允许用户请求的操作之前，您可以检查这些键是否具有指定值。这样，您就可以精细控制 JSON 策略语句何时与传入的请求匹配或不匹配。有关如何在 JSON 策略中使用 <code class="code">Condition</code> 元素的信息，请参阅<a href="./reference_policies_elements_condition.html">IAM JSON 策略元素：Condition</a>。</p><p>本主题介绍了由 IAM 服务定义和提供的键（带 <code class="code">iam:</code> 前缀）以及由 AWS Security Token Service (AWS STS) 服务定义和提供的键（带 <code class="code">sts:</code> 前缀）。其他几个 AWS 服务也提供与该服务定义的操作和资源相关的服务特定键。有关更多信息，请参阅 <a href="reference_policies_actions-resources-contextkeys.html" rel="noopener noreferrer" target="_blank">AWS 服务的操作、资源和条件键</a>。支持条件键的服务的文档通常包含附加信息。例如，有关可在 Amazon S3 资源的策略中使用的密钥信息，请参阅 <em>Amazon Simple Storage Service 用户指南</em>中的 <a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/amazon-s3-policy-keys.html#AvailableKeys-iamV2">Amazon S3 策略密钥</a>。</p><div class="highlights" id="inline-topiclist"><h6>主题</h6><ul><li><a href="#available-keys-for-iam">IAM 的可用键</a></li><li><a href="#condition-keys-wif">AWS Web 联合身份验证的可用键</a></li><li><a href="#cross-condition-keys-wif">跨服务 AWS Web 身份联合验证上下文键</a></li><li><a href="#condition-keys-saml">基于 SAML 的 AWS STS 联合身份验证的可用键</a></li><li><a href="#cross-condition-keys-saml">基于 SAML 的跨服务 AWS STS 联合身份验证上下文键</a></li><li><a href="#condition-keys-sts">AWS STS 的可用键</a></li></ul></div>
      <h2 id="available-keys-for-iam">IAM 的可用键</h2>
      <p>可以在控制对 IAM 资源的访问的策略中使用以下条件键：</p>
      <div class="variablelist">
          
          
          
          
          
          
          
      <dl>
            <dt><b><span class="term"><a id="ck_AssociatedResourceArn"></a>iam:AssociatedResourceArn</span></b></dt>
            <dd>
               <p>与 <a href="./reference_policies_elements_condition_operators.html#Conditions_ARN">ARN 运算符</a>结合使用。</p>
               <p>指定此角色在目标服务上关联的资源的 ARN。资源通常属于主体将角色传递到的服务。有时，资源可能属于第三个服务。例如，您可以将角色传递给他们在 Amazon EC2 实例上使用的 Amazon EC2 Auto Scaling。在这种情况下，条件将匹配 Amazon EC2 实例的 ARN。</p>
               <p>此条件键仅适用于策略中的 <a href="./id_roles_use_passrole.html">PassRole</a> 操作。无法使用它来限制任何其他操作。</p>
               <p>在策略中使用此条件键可允许实体传递角色，但前提是角色与指定资源相关联。您可以使用通配符 (*) 允许对特定类型的资源执行操作，而无需限制区域或资源 ID。例如，您可以允许 IAM 用户或角色将任何角色传递给 Amazon EC2 服务，以便用于 <code class="code">us-east-1</code> 或 <code class="code">us-west-1</code> 区域中的实例。不允许将 IAM 用户或角色传递给其他服务。此外，它不允许 Amazon EC2 将角色用于其他区域中的实例。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Effect": "Allow",
    "Action": "iam:PassRole",
    "Resource": "*",
    "Condition": <span>{</span>
        "StringEquals": <span>{</span>"iam:PassedToService": "ec2.amazonaws.com"},
        "ArnLike": <span>{</span>
            "iam:AssociatedResourceARN": [
                "arn:aws:ec2:us-east-1:111122223333:instance/*",
                "arn:aws:ec2:us-west-1:111122223333:instance/*"
            ]
        }
    }
}</code></pre>
               <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>支持 <a href="#ck_PassedToService">iam:PassedToService</a> 的 AWS 服务也支持此条件键。</p></div></div>
            </dd>
         
            <dt><b><span class="term"><a id="ck_AWSServiceName"></a>iam:AWSServiceName</span></b></dt>
            <dd>
               <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
               <p>指定此角色将附加到的 AWS 服务。</p>
               <p>在此示例中，如果服务名称为 <em>access-analyzer.amazonaws.com</em>，您将允许实体创建与服务关联的角色。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
   "Version": "2012-10-17",
   "Statement": [<span>{</span>
       "Effect": "Allow",
       "Action": "iam:CreateServiceLinkedRole",
       "Resource": "*",
       "Condition": <span>{</span>
         "StringLike": <span>{</span>
           "iam:AWSServiceName": "access-analyzer.amazonaws.com"
         }
       }
     }]
 }</code></pre>

            </dd>
         
            <dt><b><span class="term"><a id="ck_OrganizationsPolicyId"></a>iam:OrganizationsPolicyId</span></b></dt>
            <dd>
               <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
               <p>检查具有指定 AWS Organizations ID 的策略是否与请求中使用的策略匹配。要查看使用此条件键的示例 IAM policy，请参阅。<a href="./reference_policies_examples_iam_service-accessed-data-orgs.html">IAM：查看 Organizations 策略的上次访问的服务信息</a></p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_PassedToService"></a>iam:PassedToService</span></b></dt>
            <dd>
               <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
               <p>指定可将角色传递到的服务的服务主体。此条件键仅适用于策略中的 <a href="./id_roles_use_passrole.html">PassRole</a> 操作。无法使用它来限制任何其他操作。</p>
               <p>在策略中使用此条件键时，请使用服务主体指定服务。服务主体是可在策略的 <code class="code">Principal</code> 元素中指定的服务的名称。常见格式为：<code class="code">SERVICE_NAME_URL.amazonaws.com</code>。</p>
               <p>您可以使用 <code class="code">iam:PassedToService</code> 限制您的用户，使其只能将角色传递到特定服务。例如，用户可能会创建一个<a href="./id_roles_terms-and-concepts.html#iam-term-service-role">服务角色</a>，该角色信任 CloudWatch 代表用户将日志数据写入到 Amazon S3 存储桶。之后，用户必须将一个权限策略和一个信任策略附加到新的服务角色。在此情况下，信任策略必须指定 <code class="code">cloudwatch.amazonaws.com</code> 元素中的 <code class="code">Principal</code>。要查看允许用户将角色传递给 CloudWatch 的策略，请参阅 <a href="./reference_policies_examples_iam-passrole-service.html">IAM：将 IAM 角色传递给特定 AWS 服务</a>。</p>
               <p>通过使用此条件键，您可以确保用户仅为您指定的服务创建服务角色。例如，如果具有之前的策略的用户尝试为 Amazon EC2 创建服务角色，操作将失败。失败的原因是因为用户无权将角色传递到 Amazon EC2。</p>
               <p>有时，您会将角色传递给一个服务，随后将角色传递给另一个服务。<code class="code">iam:PassedToService</code> 仅包含担任角色的最终服务，而不包括传递角色的中间服务。</p>
               <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>某些服务不支持此条件键。</p></div></div>
            </dd>
         
            <dt><b><span class="term"><a id="ck_PermissionsBoundary"></a>iam:PermissionsBoundary</span></b></dt>
            <dd>
               <p>与 <a href="./reference_policies_elements_condition_operators.html#Conditions_ARN">ARN 运算符</a>结合使用。</p>
               <p>检查指定的策略附加为 IAM 主体资源上的权限边界。有关更多信息，请参阅 <a href="./access_policies_boundaries.html">IAM 实体的权限边界</a></p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_PolicyARN"></a>iam:PolicyARN</span></b></dt>
            <dd>
               <p>与 <a href="./reference_policies_elements_condition_operators.html#Conditions_ARN">ARN 运算符</a>结合使用。</p>
               <p>检查涉及托管策略的请求中的托管策略的 Amazon Resource Name (ARN)。有关更多信息，请参阅<a href="./access_controlling.html#access_controlling-policies">控制对策略的访问</a>。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_ResourceTag"></a>iam:ResourceTag/<code class="replaceable">key-name</code></span></b></dt>
            <dd>
               <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
               <p>检查附加到身份资源（用户或角色）的标签是否与指定的键名称和键值匹配。</p>
               <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>IAM 和 AWS STS 同时支持 <code class="code">iam:ResourceTag</code> IAM 条件键和 <code class="code">aws:ResourceTag</code> 全局条件键。</p></div></div>
               <p>您可采用键值对的形式向 IAM 资源添加自定义属性。有关 IAM 资源的标签的更多信息，请参阅 <a href="./id_tags.html">标记 IAM 资源</a>。您可以使用 <code class="code">ResourceTag</code> <a href="./access_tags.html#access_tags_control-resources">控制</a>对 AWS 资源（包括 IAM 资源）的访问。但是，由于 IAM 不支持组的标签，因此您不能使用标签来控制对组的访问。</p>
               <p>此示例说明如何创建基于身份的策略以允许删除具有 <code class="userinput">status=terminated</code> 标签的用户。要使用此策略，请将示例策略中的<code class="replaceable">斜体占位符文本</code>替换为您自己的信息。然后，按照<a href="./access_policies_create.html">创建策略</a>或<a href="./access_policies_manage-edit.html">编辑策略</a>中的说明操作。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><span>{</span>
    "Version": "2012-10-17",
    "Statement": [<span>{</span>
        "Effect": "Allow",
        "Action": "iam:DeleteUser",
        "Resource": "*",
        "Condition": <span>{</span>"StringEquals": <span>{</span>"iam:ResourceTag/<code class="replaceable">status</code>": "<code class="replaceable">terminated</code>"}}
    }]
}</code></pre>
            </dd>
         </dl></div>
    
      <h2 id="condition-keys-wif">AWS Web 联合身份验证的可用键</h2>
      <p>您可以使用 Web 身份联合验证，将通过兼容 OpenID Connect 提供程序（OP）进行身份验证的用户的临时安全凭证，提供给您 AWS 中的 IAM OpenID Connect（OIDC）身份提供程序。此类提供商的示例包括 Login with Amazon、Amazon Cognito、Google 或 Facebook。可以使用您自己的 OpenID OP 中的身份令牌 (id_tokens)，也可以使用发给 Amazon Elastic Kubernetes Service 集群的服务账户的 id_tokens。在此情况下，当使用临时安全凭证发出请求时，将会有额外条件键可用。您可以使用这些键编写策略，将联合身份用户的访问权限限制为与特定提供商、应用程序或用户关联的资源。这些键通常在角色的信任策略中使用。使用 OIDC 提供商的名称和声明（<code class="code">:aud</code>、<code class="code">:azp</code>、<code class="code">:amr</code>、<code class="code">sub</code>）定义条件键。对于 Amazon Cognito 使用的角色，键是使用 <code class="code">cognito-identity.amazonaws.com</code> 和声明定义的。</p>
      <div class="variablelist">
          
          
          
          
          
          
      <dl>
            <dt><b><span class="term"><a id="ck_wif-amr"></a>amr</span></b></dt>
            <dd>
               <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
               <p><b>示例</b>: <code class="code">cognito-identity.amazonaws.com:amr</code></p>
               <p>如果您正在使用 Amazon Cognito 进行 Web 联合身份验证，则 <code class="code">cognito-identity.amazonaws.com:amr</code> 键（身份验证方法引用）包含有关该用户的登录信息。该键有多个值，这意味着您要在使用<a href="./reference_policies_multi-value-conditions.html">条件集合运算符</a>的策略中对它进行测试。该键可包含以下值：</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p>如果用户未经过身份验证，则该键仅包含 <code class="code">unauthenticated</code>。</p>
                  </li><li class="listitem">
                     <p>如果该用户已经过身份验证，则该键包含值 <code class="code">authenticated</code> 以及在调用中使用的登录提供商的名称 (<code class="code">graph.facebook.com</code>、<code class="code">accounts.google.com</code> 或 <code class="code">www.amazon.com</code>)。</p>
                  </li></ul></div>
               <p>例如，某 Amazon Cognito 角色信任策略中的以下条件测试用户是否未经过身份验证：</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">"Condition": <span>{</span>
  "StringEquals": 
    <span>{</span> "cognito-identity.amazonaws.com:aud": "us-east-2:<code class="replaceable">identity-pool-id</code>" },
  "ForAnyValue:StringLike": 
    <span>{</span> "cognito-identity.amazonaws.com:amr": "unauthenticated" }
}</code></pre>
            </dd>
         
            <dt><b><span class="term"><a id="ck_wif-aud"></a>aud</span></b></dt>
            <dd>
               <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
               <p>使用 <code class="code">aud</code> 条件键可验证 Google 客户端 ID 或 Amazon Cognito 身份池 ID 是否与您在策略中指定的 ID 匹配。对于同一身份提供程序，可以将 <code class="code">aud</code> 键与 <code class="code">sub</code> 键结合使用。</p>
               <p><b>示例：</b></p>
               <div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><code class="code">graph.facebook.com:app_id</code></p>
                  </li><li class="listitem">
                     <p><code class="code">accounts.google.com:aud</code></p>
                  </li><li class="listitem">
                     <p><code class="code">cognito-identity.amazonaws.com:aud</code></p>
                  </li></ul></div>
               <p><code class="code">graph.facebook.com:app_id</code> 字段提供的受众上下文与其他身份提供程序使用的 aud 字段相匹配。</p>
               <p><code class="code">accounts.google.com:aud</code> 条件键与以下 Google ID 令牌字段匹配。</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p>应用程序的 OAuth 2.0 Google 客户端 ID 的 <code class="code">aud</code>（如果未设置 <code class="code">azp</code> 字段）。如果设置了 <code class="code">azp</code> 字段，则 <code class="code">aud</code> 字段将与 <a href="#ck_oaud">accounts.google.com:oaud</a> 条件键匹配。</p>
                  </li><li class="listitem">
                     <p><code class="code">azp</code>（如果设置了 <code class="code">azp</code> 字段）。对于 Web 应用程序和 Android 应用程序具有不同的 OAuth 2.0 Google 客户端 ID 但共享相同的 Google API 项目的混合应用程序，可能会出现这种情况。</p>
                  </li></ul></div>
               <p>有关 Google <code class="code">aud</code> 和 <code class="code">azp</code> 字段的更多信息，请参阅 <a href="https://developers.google.com/identity/protocols/OpenIDConnect" rel="noopener noreferrer" target="_blank"><span>Google Identity Platform OpenID Connect</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> 指南。</p>
               <p>在使用 <code class="code">accounts.google.com:aud</code> 条件键编写策略时，您必须了解该应用程序是否为设置 <code class="code">azp</code> 字段的混合应用程序。</p>
               <p><code class="code">azp</code> 字段未设置</p>
               <p>以下示例策略适用于未设置 <code class="code">azp</code> 字段的非混合应用程序。在此情况下，Google ID 令牌 <code class="code">aud</code> 字段值将与 <code class="code">accounts.google.com:aud</code> 和 <code class="code">accounts.google.com:oaud</code> 条件键值匹配。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Principal": <span>{</span>"Federated": "accounts.google.com"},
            "Action": "sts:AssumeRoleWithWebIdentity",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "accounts.google.com:aud": "aud-value",
                    "accounts.google.com:oaud": "aud-value",
                    "accounts.google.com:sub": "sub-value"
                }
            }
        }
    ]
}</code></pre>
               <p><code class="code">azp</code> 字段已设置</p>
               <p>以下示例策略适用于设置 <code class="code">azp</code> 字段的混合应用程序。在此情况下，Google ID 令牌 <code class="code">aud</code> 字段值仅与 <code class="code">accounts.google.com:oaud</code> 条件键值匹配。<code class="code">azp</code> 字段值与 <code class="code">accounts.google.com:aud</code> 条件键值匹配。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Principal": <span>{</span>"Federated": "accounts.google.com"},
            "Action": "sts:AssumeRoleWithWebIdentity",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "accounts.google.com:aud": "azp-value",
                    "accounts.google.com:oaud": "aud-value",
                    "accounts.google.com:sub": "sub-value"
                }
            }
        }
    ]
}</code></pre>
            </dd>
         
            <dt><b><span class="term"><a id="ck_wif-id"></a>id</span></b></dt>
            <dd>
               <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
               <p><b>示例：</b></p>
               <div class="itemizedlist">
                   
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><code class="code">graph.facebook.com:id</code></p>
                  </li><li class="listitem">
                     <p><code class="code">www.amazon.com:app_id</code></p>
                  </li><li class="listitem">
                     <p><code class="code">www.amazon.com:user_id</code></p>
                  </li></ul></div>
               <p>使用这些键可验证应用程序（或站点）ID 或用户 ID 是否与您在策略中指定的 ID 匹配。这适用于 Facebook 或 Login with Amazon。对于同一身份提供程序，可以将 <code class="code">app_id</code> 键与 <code class="code">id</code> 键结合使用。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_oaud"></a>oaud</span></b></dt>
            <dd>
               <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
               <p><b>示例</b>: <code class="code">accounts.google.com:oaud</code></p>
               <p>如果您使用 Google 进行 Web 联合身份验证，则此键将指定该 ID 令牌用于的 Google 受众 (<code class="code">aud</code>)。它必须是应用程序的 OAuth 2.0 客户端 ID 之一。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_wif-sub"></a>sub</span></b></dt>
            <dd>
               <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
               <p><b>示例：</b></p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><code class="code">accounts.google.com:sub</code></p>
                  </li><li class="listitem">
                     <p><code class="code">cognito-identity.amazonaws.com:sub</code></p>
                  </li></ul></div>
               <p>使用这些键可验证用户 ID 是否与您在策略中指定的 ID 匹配。对于同一身份提供程序，可以将 <code class="code">sub</code> 键与 <code class="code">aud</code> 键结合使用。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        "Condition": <span>{</span>
              "StringEquals": <span>{</span>
                  "oidc.eks.us-east-1.amazonaws.com/id/111122223333:aud": "sts.amazonaws.com",
                  "oidc.eks.us-east-1.amazonaws.com/id/111122223333:sub": "system:serviceaccount:default:assumer"
               }
            }
    ]
      }</code></pre>
            </dd>
         
            <dt><b><span class="term">有关 Web 联合身份验证的更多信息</span></b></dt>
            <dd>
               <p>有关 Web 联合身份验证的更多信息，请参阅以下内容：</p>
               <div class="itemizedlist">
                   
                   
               <ul class="itemizedlist"><li class="listitem">
                     <p><a href="https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-identity.html">Amazon Cognito 用户指南</a>。</p>
                  </li><li class="listitem">
                     <p><a href="./id_roles_providers_oidc.html">关于 Web 联合身份验证</a></p>
                  </li></ul></div>
            </dd>
         </dl></div>
    
      <h2 id="cross-condition-keys-wif">跨服务 AWS Web 身份联合验证上下文键</h2>
      <p>某些 Web 身份联合验证条件键可用于角色信任策略中，以定义允许哪些用户在其他 AWS 服务中进行访问。以下是条件键，当联合主体担任其他角色时，可以在角色信任策略中使用它们，也可以在其他 AWS 服务的资源策略中使用它们来授权联合主体访问资源。如果您正在使用 Amazon Cognito 进行 Web 身份联合验证，则这些键在进行用户身份验证时可用。</p>
      <p>选择条件键以查看描述。</p>
      <div class="itemizedlist">
          
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><a href="#ck_wif-amr">amr</a></p>
         </li><li class="listitem">
            <p><a href="#ck_wif-aud">aud</a></p>
         </li><li class="listitem">
            <p><a href="#ck_wif-id">id</a></p>
         </li><li class="listitem">
            <p><a href="#ck_wif-sub">sub</a></p>
         </li></ul></div>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>在外部身份提供者（IdP）对初始 AssumeRoleWithWebIdentity 操作进行身份验证和授权后，没有其他基于 Web 身份的联合身份验证条件键可供使用。</p></div></div>
    
      <h2 id="condition-keys-saml">基于 SAML 的 AWS STS 联合身份验证的可用键</h2>
      <p>如果您通过 AWS Security Token Service (AWS STS) 使用<a href="https://docs.aws.amazon.com/STS/latest/UsingSTS/CreatingSAML.html">基于 SAML 的联合</a>，则可以在策略中包含更多条件键。</p>
       
         <h3 id="condition-keys-saml_trust-policy">SAML 角色信任策略</h3>
         <p>在角色的信任策略中，您可以包括以下键，以帮助您确定发起人是否有权担任角色。除了 <code class="code">saml:doc</code>，所有值均源自 SAML 断言。在创建或编辑带条件的策略时，可在 IAM 控制台可视化编辑器中使用列表中的所有项目。标有 <code class="code">[]</code> 的项目<em>可以</em> 具有指定类型列表中的值。</p>
         <div class="variablelist">
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
             
         <dl>
               <dt><b><span class="term"><a id="ck_aud"></a>saml:aud </span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>SAML 断言提交到的终端节点 URL。此键的值来自断言中的 <code class="code">SAML Recipient</code> 字段，而<em>不是</em> <code class="code">Audience</code> 字段。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_commonname"></a>saml:commonName[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">commonName</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_cn"></a>saml:cn[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduOrg</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_doc"></a>saml:doc</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这代表担任角色所用的主体。格式为 <code class="replaceable">account-ID</code>/<code class="replaceable">provider-friendly-name</code>，例如 <code class="code">123456789012/SAMLProviderName</code>。<em>账户 ID</em> 值指拥有 <a href="./id_roles_providers_create_saml.html">SAML 提供商</a>的账户。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonaffiliation"></a>saml:edupersonaffiliation[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduPerson</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonassurance"></a>saml:edupersonassurance[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduPerson</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonentitlement"></a>saml:edupersonentitlement[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduPerson</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonnickname"></a>saml:edupersonnickname[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduPerson</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonorgdn"></a>saml:edupersonorgdn</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduPerson</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonorgunitdn"></a>saml:edupersonorgunitdn[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduPerson</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonprimaryaffiliation"></a>saml:edupersonprimaryaffiliation</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduPerson</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonprimaryorgunitdn"></a>saml:edupersonprimaryorgunitdn</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduPerson</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonprincipalname"></a>saml:edupersonprincipalname</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduPerson</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersonscopedaffiliation"></a>saml:edupersonscopedaffiliation[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduPerson</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_edupersontargetedid"></a>saml:edupersontargetedid[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduPerson</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_eduorghomepageuri"></a>saml:eduorghomepageuri[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduOrg</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_eduorgidentityauthnpolicyuri"></a>saml:eduorgidentityauthnpolicyuri[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduOrg</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_eduorglegalname"></a>saml:eduorglegalname[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduOrg</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_eduorgsuperioruri"></a>saml:eduorgsuperioruri[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduOrg</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_eduorgwhitepagesuri"></a>saml:eduorgwhitepagesuri[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">eduOrg</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_givenname"></a>saml:givenName[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">givenName</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_iss"></a>saml:iss</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>发布者，以 URN 表示。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_mail"></a>saml:mail[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">mail</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_name"></a>saml:name[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">name</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_saml-namequalifier"></a>saml:namequalifier</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>基于 SAML 提供商的友好名称的哈希值。该值是以下值按顺序的连接，以“/”字符分隔：</p>
                  <div class="orderedlist">
                      
                      
                      
                  <ol><li>
                        <p><code class="code">Issuer</code> 响应值 (<code class="code">saml:iss</code>)</p>
                     </li><li>
                        <p><code class="code">AWS</code> 账户 ID</p>
                     </li><li>
                        <p> IAM 中 SAML 提供商的友好名称（ARN 的最后一部分） </p>
                     </li></ol></div>
                  <p>账户 ID 与 SAML 提供商的易记名称的串联可作为键 <code class="code">saml:doc</code> 供 IAM policy 使用。有关更多信息，请参阅<a href="./id_roles_providers_saml.html#CreatingSAML-userid">唯一标识基于 SAML 的联合中的用户</a>。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_organizationstatus"></a>saml:organizationStatus[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">organizationStatus</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_primarygroupsid"></a>saml:primaryGroupSID[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">primaryGroupSID</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_saml-sub"></a>saml:sub</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是该陈述的主题，其中包含唯一标识组织中某个用户的值 (例如 <code class="code">_cbb88bf52c2510eabe00c1642d4643f41430fe25e3</code>)。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_saml-subtype"></a>saml:sub_type</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>此键的值可以是 <code class="code">persistent</code>、<code class="code">transient</code> 或由 SAML 断言中使用的 <code class="code">Format</code> 和 <code class="code">Subject</code> 元素的完整 <code class="code">NameID</code> URI 构成。<code class="code">persistent</code> 值表示在不同会话之间用户的 <code class="code">saml:sub</code> 值是相同的。如果值为 <code class="code">transient</code>，则用户在每个会话中拥有不同的 <code class="code">saml:sub</code> 值。有关 <code class="code">NameID</code> 元素的 <code class="code">Format</code> 属性的信息，请参阅<a href="./id_roles_providers_create_saml_assertions.html">为身份验证响应配置 SAML 断言</a>。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_surname"></a>saml:surname[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">surnameuid</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_uid"></a>saml:uid[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">uid</code> 属性。</p>
               </dd>
            
               <dt><b><span class="term"><a id="ck_x500uniqueidentifier"></a>saml:x500UniqueIdentifier[]</span></b></dt>
               <dd>
                  <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
                  <p>这是 <code class="code">x500UniqueIdentifier</code> 属性。</p>
               </dd>
            </dl></div>
         <p>有关 <code class="code">eduPerson</code> 和 <code class="code">eduOrg</code> 属性的一般信息，请参阅 <a href="https://wiki.refeds.org/display/STAN/eduPerson" rel="noopener noreferrer" target="_blank"><span>REFEDS Wiki 网站</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>。有关 <code class="code">eduPerson</code> 属性的列表，请参阅 <a href="https://software.internet2.edu/eduperson/internet2-mace-dir-eduperson-201602.html" rel="noopener noreferrer" target="_blank"><span>eduPerson 对象类规范 (201602)</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>。</p>
         <p>列表类型的条件键可以包含多个值。要在策略中创建条件以获取列表值，可以使用<a href="./reference_policies_multi-value-conditions.html">集合运算符</a>（<code class="code">ForAllValues</code>、<code class="code">ForAnyValue</code>）。例如，要支持从属关系为“教员”或“职员”（而非“学生”）的用户，可以使用下面这样的条件：</p>
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="">"Condition": <span>{</span>
   "ForAllValues:StringLike": <span>{</span>
     "saml:edupersonaffiliation":[ "faculty", "staff"] 
   }
}</code></pre>
       
    
      <h2 id="cross-condition-keys-saml">基于 SAML 的跨服务 AWS STS 联合身份验证上下文键</h2>
      <p>一些基于 SAML 的联合身份验证条件键可用于后续请求中，以授权其他服务和 <code class="code">AssumeRole</code> 调用中的 AWS 操作。以下是条件键，当联合主体担任其他角色时，可以在角色信任策略中使用它们，也可以在其他 AWS 服务的资源策略中使用它们来授权联合主体访问资源。有关使用这些键的更多信息，请参阅<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_providers_saml.html#CreatingSAML-userid">关于基于 SAML 2.0 的联合身份验证</a>。</p>
      <p>选择条件键以查看描述。</p>
      <div class="itemizedlist">
          
          
          
      <ul class="itemizedlist"><li class="listitem">
            <p><a href="#ck_saml-namequalifier">saml:namequalifier</a></p>
         </li><li class="listitem">
            <p><a href="#ck_saml-sub">saml:sub</a></p>
         </li><li class="listitem">
            <p><a href="#ck_saml-subtype">saml:sub_type</a></p>
         </li></ul></div>
      <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>在初始外部身份提供者（IdP）身份验证响应后，没有其他基于 SAML 的联合身份验证条件键可供使用。</p></div></div>
    
      <h2 id="condition-keys-sts">AWS STS 的可用键</h2>
      <p>您可以对使用 AWS Security Token Service (AWS STS) 操作担任的角色使用 IAM 角色信任策略中的以下条件键。</p>
      <div class="variablelist">
          
          
          
          
          
          
      <dl>
            <dt><b><span class="term"><a id="ck_awsservicename"></a>sts:AWSServiceName</span></b></dt>
            <dd>
               <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
               <p>使用此键指定可以在其中使用持有者令牌的服务。在策略中使用此条件键时，请使用服务主体指定服务。服务主体是可在策略的 <code class="code">Principal</code> 元素中指定的服务的名称。例如，<code class="code">codeartifact.amazonaws.com</code> 是 AWS CodeArtifact 服务主体。</p>
               <p>某些 AWS 服务需要您有权获取 AWS STS 服务持有者令牌，然后您才能以编程方式访问它们的资源。例如，AWS CodeArtifact 要求主体使用持有者令牌来执行某些操作。<code class="code">aws codeartifact get-authorization-token</code> 命令返回一个持有者令牌。然后，您可以使用持有者令牌来执行 AWS CodeArtifact 操作。有关持有者令牌的更多信息，请参阅 <a href="./id_credentials_bearer.html">使用持有者令牌</a>。</p>
               <p><b>Availability</b>（可用性）- 此键存在于获取持有者令牌的请求中。您不能直接调用 AWS STS 以获取持有者令牌。当您在其他服务中执行某些操作时，服务代表您请求持有者令牌。</p>
               <p>您可以使用此条件键以允许主体获取用于特定服务的持有人令牌。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_durationseconds"></a>sts:DurationSeconds</span></b></dt>
            <dd>
               <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_Numeric">数字运算符</a>结合使用。</p>
               <p>使用此键指定主体在获取 AWS STS 持有者令牌时可以使用的持续时间（以秒为单位）。</p>
               <p>某些 AWS 服务需要您有权获取 AWS STS 服务持有者令牌，然后您才能以编程方式访问它们的资源。例如，AWS CodeArtifact 要求主体使用持有者令牌来执行某些操作。<code class="code">aws codeartifact get-authorization-token</code> 命令返回一个持有者令牌。然后，您可以使用持有者令牌来执行 AWS CodeArtifact 操作。有关持有者令牌的更多信息，请参阅 <a href="./id_credentials_bearer.html">使用持有者令牌</a>。</p>
               <p><b>Availability</b>（可用性）- 此键存在于获取持有者令牌的请求中。您不能直接调用 AWS STS 以获取持有者令牌。当您在其他服务中执行某些操作时，服务代表您请求持有者令牌。此键不适用于 AWS STS assume-role 操作。</p>
               
            </dd>
         
            <dt><b><span class="term"><a id="ck_externalid"></a>sts:ExternalId</span></b></dt>
            <dd>
               <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
               <p>使用此键可要求主体在代入 IAM 角色时提供特定标识符。</p>
               <p><b>可用性</b> - 如果主体在使用 AWS CLI 或 AWS API 代入角色时提供外部 ID，则请求中存在此键。</p>
               <p>在其他账户中担任角色时可能需要的唯一标识符。如果角色所属的账户的管理员为您提供了外部 ID，请在 <code class="code">ExternalId</code> 参数中提供该值。该值可以是任意字符串，如密码或账号。外部 ID 的主要功能是解决并防止混淆代理人问题。有关外部 ID 和混淆代理人问题的更多信息，请参阅<a href="./id_roles_create_for-user_externalid.html">如何在向第三方授予对 AWS 资源的访问权时使用外部 ID</a>。</p>
               <p><code class="code">ExternalId</code> 值的长度必须最少为 2 个字符，最多为 1224 个字符。该值必须是字母数字，没有空格。它还可以包含以下符号：加号 (+)、等号 (=)、逗号 (,)、句点 (.)、@ 符号、冒号 (:)、正斜杠 (/) 和连字符 (-)。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_rolesessionname"></a>sts:RoleSessionName</span></b></dt>
            <dd>
               <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
               <p>使用此键可将主体在代入角色时指定的会话名称与策略中指定的值进行比较。</p>
               <p><b>可用性</b> - 当主体使用 AWS Management Console 管理控制台、assume-role CLI 命令或 AWS STS <code class="code">AssumeRole</code> API 操作代入角色时，则请求中存在此键。</p>
               <p>您可以在角色信任策略中使用此键，以要求您的用户在代入角色时提供特定的会话名称。例如，您可以要求 IAM 用户指定自己的用户名作为其会话名称。在 IAM 用户代入角色后，活动将与匹配用户名的会话名称一起显示在 <a href="./cloudtrail-integration.html#cloudtrail-integration_signin-tempcreds">AWS CloudTrail 日志</a>中。这样，当不同的主体使用角色时，管理员可以更轻松地区分角色会话。</p>
               <p>以下角色信任策略要求账户 <code class="code">111122223333</code> 中的 IAM 用户在代入角色时提供其 IAM 用户名作为会话名称。使用条件键中的 <code class="code">aws:username</code> <a href="./reference_policies_variables.html">条件变量</a>来强制执行此要求。此策略允许 IAM 用户代入策略附加到的角色。此策略禁止任何使用临时凭证的人员代入角色，因为 <code class="code">username</code> 变量仅适用于 IAM 用户。</p>
               <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>重要</h6></div><div class="awsdocs-note-text"><p>您可以使用任何可用的单值条件密钥作为<a href="./reference_policies_variables.html">变量</a>。您不能使用多值条件键作为变量。</p></div></div>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "RoleTrustPolicyRequireUsernameForSessionName",
            "Effect": "Allow",
            "Action": "sts:AssumeRole",
            "Principal": <span>{</span>"AWS": "arn:aws:iam::111122223333:root"},
            "Condition": <span>{</span>
                "StringLike": <span>{</span>"sts:RoleSessionName": "$<span>{</span>aws:username}"}
            }
        }
    ]
}</code></pre>
               <p>当管理员查看操作的 AWS CloudTrail 日志时，他们可以将会话名称与其账户中的用户名进行比较。在以下示例中，名为 <code class="code">matjac</code> 的用户使用名为 <code class="code">MateoRole</code> 的角色执行操作。之后，管理员会联系具有名为 <code class="code">matjac</code> 用户的 Mateo Jackson。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">    "assumedRoleUser": <span>{</span>
        "assumedRoleId": "AROACQRSTUVWRAOEXAMPLE:<code class="replaceable">matjac</code>",
        "arn": "arn:aws:sts::111122223333:assumed-role/<code class="replaceable">MateoRole</code>/<code class="replaceable">matjac</code>"
    }</code></pre>
               <p>如果您允许<a href="./id_roles_common-scenarios_aws-accounts.html">使用角色进行跨账户访问</a>，则一个账户中的用户可以代入另一个账户中的角色。CloudTrail 中列出的代入角色的 ARN 包括<em>角色所在</em>的账户。它不包括已代入角色的用户的账户。用户仅在账户中是唯一的。因此，我们建议您使用此方法以仅在 CloudTrail 日志中查看您管理的账户中的用户所代入的角色。您的用户可以在多个账户中使用相同的用户名。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_sourceidentity"></a>sts:SourceIdentity</span></b></dt>
            <dd>
               <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
               <p>使用此键可将主体在代入角色时指定的源身份与策略中指定的值进行比较。</p>
               <p><b>可用性</b> — 如果主体提供源身份，同时担任使用任何 AWS STS 担任角色 CLI 命令或 AWS STS <code class="code">AssumeRole</code> API 操作时，此密钥将会出现在请求中。</p>
               <p>您可以在角色信任策略中使用此键，以要求您的用户在代入角色时设置特定的源身份。例如，您可以要求您的工作人员或联合身份为源身份指定值。您可以将身份提供程序 (IdP) 配置为使用与用户关联的属性之一（例如用户名或电子邮件）作为源身份。然后，IdP 会将源身份作为其发送的断言或声明中的一个属性传递给 AWS。源身份属性的值标识担任角色的用户或应用程序。</p>
               <p>在用户担任角色后，活动将在使用已设置源身份值的 <a href="./cloudtrail-integration.html#cloudtrail-integration_signin-tempcreds">AWS CloudTrail 日志</a>中出现。这使管理员能够更轻松地确定什么角色在 AWS 中执行了操作。您必须授予 <code class="code">sts:SetSourceIdentity</code> 操作相应权限以允许身份设置源身份。</p>
               <p>与 <a href="#ck_rolesessionname">sts:RoleSessionName</a> 不同，在设置源身份后，无法更改该值。它将存在于源身份对角色执行的所有操作的请求上下文中。当您使用会话凭证担任另一个角色时，该值将保留到后续角色会话中。从一个角色代入另一个角色的过程称为<a href="./id_roles_terms-and-concepts.html#iam-term-role-chaining">角色链</a>。</p>
               <p>您可以使用 <a href="./reference_policies_condition-keys.html#condition-keys-sourceidentity">aws:SourceIdentity</a> 全局条件键根据后续请求中源身份的值进一步控制对 AWS 资源的访问权限。</p>
               <p>以下角色信任策略允许 IAM 用户 <code class="code">AdminUser</code> 在账户中担任角色 <code class="code">111122223333</code>。它还会向 <code class="code">AdminUser</code> 授予权限来设置源身份，只要源身份设置为 <code class="code">DiegoRamirez</code> 即可。</p>
               <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "AllowAdminUserAssumeRole",
            "Effect": "Allow",
            "Principal": <span>{</span>"AWS": " arn:aws:iam::111122223333:user/AdminUser"},
            "Action": [
                "sts:AssumeRole",
                "sts:SetSourceIdentity"
            ],
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>"sts:SourceIdentity": "DiegoRamirez"}
            }
        }
    ]
}
</code></pre>
               <p>要了解有关使用源身份信息的更多信息，请参阅 <a href="./id_credentials_temp_control-access_monitor.html">监控和控制使用所担任角色执行的操作</a>。</p>
            </dd>
         
            <dt><b><span class="term"><a id="ck_transitivetagkeys"></a>sts:TransitiveTagKeys</span></b></dt>
            <dd>
               <p>与<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字符串运算符</a>结合使用。</p>
               <p>使用此键将请求中的可传递会话标签键，与在策略中指定的键进行比较。</p>
               <p><b>Availability</b>（可用性）- 使用临时安全凭证发出请求时，请求中存在此密钥。这些凭证包括使用任何 assume-role 操作或 <code class="code">GetFederationToken</code> 操作创建的凭证。</p>
               <p>当您使用临时安全凭证发出请求时，<a href="./reference_policies_elements_condition.html#AccessPolicyLanguage_RequestContext">请求上下文</a>包含 <code class="code"><a href="./reference_policies_condition-keys.html#condition-keys-principaltag">aws:PrincipalTag</a></code> 上下文密钥。此键包括<a href="./id_session-tags.html">会话标签</a>、<a href="./id_session-tags.html#id_session-tags_role-chaining">可传递会话标签</a>和角色标签的列表。可传递会话标签是当您使用会话凭证代入另一个角色时，持续传递到所有后续会话中的标记。从一个角色代入另一个角色的过程称为<a href="./id_roles_terms-and-concepts.html#iam-term-role-chaining">角色链</a>。</p>
               <p>您可以在策略中使用此条件键，以便要求在代入角色或联合身份用户身份时，要求将特定会话标签设置为可传递标签。</p>
            </dd>
         </dl></div>
   <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="警告" /> <strong>Javascript 在您的浏览器中被禁用或不可用。</strong></p><p>要使用 Amazon Web Services 文档，必须启用 Javascript。请参阅浏览器的帮助页面以了解相关说明。</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">文档惯例</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./reference_policies_condition-keys.html">全局条件键</div><div id="next" class="next-link" accesskey="n" href="./reference_policies_actions-resources-contextkeys.html">操作、资源和条件键</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">此页面对您有帮助吗？- 是</div><div class="content"><p>感谢您对我们工作的肯定！</p><p>如果不耽误您的时间，请告诉我们做得好的地方，让我们做得更好。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="反馈" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">此页面对您有帮助吗？- 否</div><div class="content"><p>感谢您告诉我们本页内容还需要完善。很抱歉让您失望了。</p><p>如果不耽误您的时间，请告诉我们如何改进文档。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="反馈" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>