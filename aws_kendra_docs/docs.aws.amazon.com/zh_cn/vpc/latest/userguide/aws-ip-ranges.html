<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS IP 地址范围 - Amazon Virtual Private Cloud</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="aws-ip-ranges" /><meta name="default_state" content="aws-ip-ranges" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_cn/vpc/latest/userguide/aws-ip-ranges.html" /><meta name="description" content="列出 AWS 的 IP 地址范围。" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Virtual Private Cloud" /><meta name="guide" content="用户指南" /><meta name="abstract" content="使用 Amazon VPC 在属于 AWS 云中逻辑隔离部分的虚拟网络中启动 AWS 资源。" /><meta name="guide-locale" content="zh_cn" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_cn/vpc/latest/userguide/aws-ip-ranges.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/vpc/latest/userguide/aws-ip-ranges.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/vpc/latest/userguide/aws-ip-ranges.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/vpc/latest/userguide/aws-ip-ranges.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/vpc/latest/userguide/aws-ip-ranges.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/vpc/latest/userguide/aws-ip-ranges.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/vpc/latest/userguide/aws-ip-ranges.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/vpc/latest/userguide/aws-ip-ranges.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/vpc/latest/userguide/aws-ip-ranges.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/vpc/latest/userguide/aws-ip-ranges.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/vpc/latest/userguide/aws-ip-ranges.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/vpc/latest/userguide/aws-ip-ranges.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/vpc/latest/userguide/aws-ip-ranges.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/vpc/latest/userguide/aws-ip-ranges.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/vpc/latest/userguide/aws-ip-ranges.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/vpc/latest/userguide/aws-ip-ranges.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/vpc/latest/userguide/aws-ip-ranges.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/vpc/latest/userguide/aws-ip-ranges.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/vpc/latest/userguide/aws-ip-ranges.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/vpc/latest/userguide/aws-ip-ranges.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/vpc/latest/userguide/aws-ip-ranges.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/vpc/latest/userguide/aws-ip-ranges.html" hreflang="x-default" /><meta name="feedback-item" content="VPC" /><meta name="this_doc_product" content="Amazon Virtual Private Cloud" /><meta name="this_doc_guide" content="用户指南" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'vpc'}"></script><meta id="panorama-serviceSubSection" value="用户指南" /><meta id="panorama-serviceConsolePage" value="AWS IP 地址范围" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS IP 地址范围 - Amazon Virtual Private Cloud</title><meta name="pdf" content="vpc-ug.pdf#aws-ip-ranges" /><meta name="rss" content="amazon-vpc-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=58" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=VPC&amp;topic_url=http://docs.aws.amazon.com/zh_cn/vpc/latest/userguide/aws-ip-ranges.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/zh_cn/vpc/latest/userguide/aws-ip-ranges.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/zh_cn/vpc/latest/userguide/aws-ip-ranges.html" /><meta name="keywords" content="VPC,Amazon VPC,network,路由表,互联网网关,子网,NAT" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon VPC",
        "item" : "https://docs.aws.amazon.com/vpc/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "用户指南",
        "item" : "https://docs.aws.amazon.com/zh_cn/vpc/latest/userguide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "为 VPC 和子网分配 IP 地址",
        "item" : "https://docs.aws.amazon.com/zh_cn/vpc/latest/userguide/vpc-ip-addressing.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "AWS IP 地址范围",
        "item" : "https://docs.aws.amazon.com/zh_cn/vpc/latest/userguide/vpc-ip-addressing.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="vpc-ug.pdf#aws-ip-ranges" target="_blank" rel="noopener noreferrer" title="打开 PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">文档</a><a href="/vpc/index.html">Amazon VPC</a><a href="what-is-amazon-vpc.html">用户指南</a></div><div id="page-toc-src"><a href="#aws-ip-download">下载</a><a href="#aws-ip-syntax">语法</a><a href="#filter-json-file">筛选 JSON 文件</a><a href="#aws-ip-egress-control">实施出口控制</a><a href="#subscribe-notifications">AWS IP 地址范围通知</a><a href="#aws-ip-release-notes">发布说明</a><a href="#aws-ip-learn-more">了解更多信息</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="aws-ip-ranges">AWS IP 地址范围</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>AWS 以 JSON 格式发布其当前的 IP 地址范围。利用这些信息，您可以识别来自 AWS 的流量。您还可以允许或拒绝发往或来自特定类型 AWS 资源的流量。</p><p>要查看当前范围，请下载 <code>.json</code> 文件。要维护历史记录，请将连续版本的 <code>.json</code> 文件保存在系统上。要确定自上次保存文件以来是否发生更改，请检查当前文件中的发布时间，并将其与上次保存文件中的发布时间进行比较。</p><p>通过自带 IP 地址（BYOIP）引入到 AWS 的 IP 地址范围不包含在 <code>.json</code> 文件内。</p><p>或者，某些服务使用 AWS 托管式前缀列表发布其地址范围。有关更多信息，请参阅<a href="./working-with-aws-managed-prefix-lists.html#available-aws-managed-prefix-lists">可用的 AWS 托管前缀列表</a>。</p><div class="highlights" id="inline-topiclist"><h6>目录</h6><ul><li><a href="#aws-ip-download">下载</a></li><li><a href="#aws-ip-syntax">语法</a></li><li><a href="#filter-json-file">筛选 JSON 文件</a></li><li><a href="#aws-ip-egress-control">实施出口控制</a></li><li><a href="#subscribe-notifications">AWS IP 地址范围通知</a></li><li><a href="#aws-ip-release-notes">发布说明</a></li><li><a href="#aws-ip-learn-more">了解更多信息</a></li></ul></div>
        <h2 id="aws-ip-download">下载</h2>

        
        <p>下载 <a href="https://ip-ranges.amazonaws.com/ip-ranges.json" rel="noopener noreferrer" target="_blank"><span>ip-ranges.json</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>。</p>
        <p>如果您以编程方式访问此文件，您有责任确保仅在成功验证服务器提供的 TLS 证书之后，应用程序才能下载文件。</p>

        
     
        <h2 id="aws-ip-syntax">语法</h2>

        <p><code>ip-ranges.json</code> 的语法如下。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "syncToken": "<code class="replaceable">0123456789</code>",
  "createDate": "<code class="replaceable">yyyy</code>-<code class="replaceable">mm</code>-<code class="replaceable">dd</code>-<code class="replaceable">hh</code>-<code class="replaceable">mm</code>-<code class="replaceable">ss</code>",
  "prefixes": [
    <span>{</span>
      "ip_prefix": "<code class="replaceable">cidr</code>",
      "region": "<code class="replaceable">region</code>",
      "network_border_group": "<code class="replaceable">network_border_group</code>",
      "service": "<code class="replaceable">subset</code>"
    }
  ],
  "ipv6_prefixes": [
    <span>{</span>
      "ipv6_prefix": "<code class="replaceable">cidr</code>",
      "region": "<code class="replaceable">region</code>",
      "network_border_group": "<code class="replaceable">network_border_group</code>",
      "service": "<code class="replaceable">subset</code>"
    }
  ]  
}</code></pre>
        <div class="variablelist">
             
             
             
             
             
             
             
             
             
        <dl>
                <dt><b><span class="term">syncToken</span></b></dt>
                <dd>
                    <p>采用 Unix 纪元时间格式的发布时间。</p>
                    <p>类型：字符串</p>
                    <p>示例：<code class="code">"syncToken": "1416435608"</code></p>
                </dd>
            
                <dt><b><span class="term">createDate</span></b></dt>
                <dd>
                    <p>发布日期和时间，采用 UTC YY-MM-DD-hh-mm-ss 格式。</p>
                    <p>类型：字符串</p>
                    <p>示例：<code class="code">"createDate": "2014-11-19-23-29-02"</code></p>
                </dd>
            
                <dt><b><span class="term">prefixes</span></b></dt>
                <dd>
                    <p>IPv4 地址范围的 IP 前缀。</p>
                    <p>类型：数组</p>
                </dd>
            
                <dt><b><span class="term">ipv6_prefixes</span></b></dt>
                <dd>
                    <p>IPv6 地址范围的 IP 前缀。</p>
                    <p>类型：数组</p>
                </dd>
            
                <dt><b><span class="term">ip_prefix</span></b></dt>
                <dd>
                    <p>用 CIDR 表示法指定的公有 IPv4 地址范围。请注意，AWS 可在更具体的范围内公布前缀。例如，文件中的前缀 96.127.0.0/17 可公布为 96.127.0.0/21、96.127.8.0/21、96.127.32.0/19 和 96.127.64.0/18。</p>
                    <p>类型：字符串</p>
                    <p>示例：<code class="code">"ip_prefix": "198.51.100.2/24"</code></p>
                </dd>
            
                <dt><b><span class="term">ipv6_prefix</span></b></dt>
                <dd>
                    <p>用 CIDR 表示法指定的公有 IPv6 地址范围。请注意，AWS 可在更具体的范围内公布前缀。</p>
                    <p>类型：字符串</p>
                    <p>示例：<code class="code">"ipv6_prefix": "2001:db8:1234::/64"</code></p>
                </dd>
            
                <dt><b><span class="term">network_border_group</span></b></dt>
                <dd>
                    <p>网络边界组的名称，这是 AWS 通告 IP 地址的可用区或 Local Zones 的唯一集合。</p>
                    <p>类型：字符串</p>
                    <p>示例：<code class="code">"network_border_group": "us-west-2-lax-1"</code></p>
                </dd>
            
                <dt><b><span class="term">区域</span></b></dt>
                <dd>
                    <p>AWS 区域或 <code class="code">GLOBAL</code>（针对边缘站点）。<code class="code">CLOUDFRONT</code> 和 <code class="code">ROUTE53</code> 范围是 <code class="code">GLOBAL</code>。</p>
                    <p>类型：字符串</p>
                    <p>有效值：<code class="code">af-south-1</code> | <code class="code">ap-east-1</code> | <code class="code">ap-northeast-1</code> | <code class="code">ap-northeast-2</code> | <code class="code">ap-northeast-3</code> | <code class="code">ap-south-1</code> | <code class="code">ap-south-2</code> | <code class="code">ap-southeast-1</code> | <code class="code">ap-southeast-2</code> | <code class="code">ap-southeast-3</code> | <code class="code">ap-southeast-4</code> | <code class="code">ca-central-1</code> | <code class="code">cn-north-1</code> | <code class="code">cn-northwest-1</code> | <code class="code">eu-central-1</code> | <code class="code">eu-central-2</code> | <code class="code">eu-north-1</code> | <code class="code">eu-south-1</code> | <code class="code">eu-south-2</code> | <code class="code">eu-west-1</code> | <code class="code">eu-west-2</code> | <code class="code">eu-west-3</code> | <code class="code">me-central-1</code> | <code class="code">me-south-1</code> | <code class="code">sa-east-1</code> | <code class="code">us-east-1</code> | <code class="code">us-east-2</code> | <code class="code">us-gov-east-1</code> | <code class="code">us-gov-west-1</code> | <code class="code">us-west-1</code> | <code class="code">us-west-2</code> | <code class="code">GLOBAL</code></p>
                    <p>示例：<code class="code">"region": "us-east-1"</code></p>
                </dd>
            
                <dt><b><span class="term">service</span></b></dt>
                <dd>
                    <p>IP 地址范围的子集。为 <code class="code">API_GATEWAY</code> 列出的地址仅为出口 IP 地址。指定 <code class="code">AMAZON</code> 可获得所有 IP 地址范围（这意味着每个子集也在 <code class="code">AMAZON</code> 子集中）。但是，某些 IP 地址范围仅在 <code class="code">AMAZON</code> 子集中（这意味着它们不会再包含在其他子集中）。</p>
                    <p>类型：字符串</p>
                    <p>有效值：<code class="code">AMAZON</code> | <code class="code">AMAZON_APPFLOW</code> | <code class="code">AMAZON_CONNECT</code> | <code class="code">API_GATEWAY</code> | <code class="code">CHIME_MEETINGS</code> | <code class="code">CHIME_VOICECONNECTOR</code> | <code class="code">CLOUD9</code> | <code class="code">CLOUDFRONT</code> | <code class="code">CLOUDFRONT_ORIGIN_FACING</code> | <code class="code">CODEBUILD</code> | <code class="code">DYNAMODB</code> | <code class="code">EBS</code> | <code class="code">EC2</code> | <code class="code">EC2_INSTANCE_CONNECT</code> | <code class="code">GLOBALACCELERATOR</code> | <code class="code">KINESIS_VIDEO_STREAMS</code> | <code class="code">MEDIA_PACKAGE_V2</code> | <code class="code">ROUTE53</code> | <code class="code">ROUTE53_HEALTHCHECKS</code> | <code class="code">ROUTE53_HEALTHCHECKS_PUBLISHING</code> | <code class="code">ROUTE53_RESOLVER</code> | <code class="code">S3</code> | <code class="code">WORKSPACES_GATEWAYS</code></p>
                    <p>示例：<code class="code">"service": "AMAZON"</code></p>
                </dd>
            </dl></div>
     
        <h2 id="filter-json-file">筛选 JSON 文件</h2>

        <p>您可以下载命令行工具以帮助您筛选出自己所要查找的信息。</p>

         
            <h3 id="Get-AWSPublicIpAddressRange-examples">Windows</h3>

            <p><a href="https://docs.aws.amazon.com/powershell/latest/userguide/">AWS Tools for Windows PowerShell</a> 包含 cmdlet <code class="code">Get-AWSPublicIpAddressRange</code> 以便分析此 JSON 文件。以下示例展示了其用法。有关更多信息，请参阅<a href="http://aws.amazon.com/blogs/developer/querying-the-public-ip-address-ranges-for-aws/" rel="noopener noreferrer" target="_blank"><span>查询 AWS 的公有 IP 地址范围</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>和 <a href="https://docs.aws.amazon.com/powershell/latest/reference/items/Get-AWSPublicIpAddressRange.html">Get-AWSPublicIpAddressRange</a>。</p>
            <div class="example"><h6>例 1. 获取创建日期</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="prompt" copy="false">PS C:\&gt; </code><code class="userinput">Get-AWSPublicIpAddressRange -OutputPublicationDate</code><code class="computeroutput" copy="false">

Wednesday, August 22, 2018 9:22:35 PM</code></code></pre></div></div>
            <div class="example"><h6>例 2. 获取特定区域的信息</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="prompt" copy="false">PS C:\&gt; </code><code class="userinput">Get-AWSPublicIpAddressRange -Region us-east-1</code><code class="computeroutput" copy="false">

IpPrefix        Region      NetworkBorderGroup         Service
--------        ------       -------                   -------
23.20.0.0/14    us-east-1    us-east-1                 AMAZON
50.16.0.0/15    us-east-1    us-east-1                 AMAZON
50.19.0.0/16    us-east-1    us-east-1                 AMAZON
...</code></code></pre></div></div>
            <div class="example"><h6>例 3. 获取所有 IP 地址</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="prompt" copy="false">PS C:\&gt; </code><code class="userinput">(Get-AWSPublicIpAddressRange).IpPrefix</code><code class="computeroutput" copy="false">
23.20.0.0/14
27.0.0.0/22
43.250.192.0/24
...
2406:da00:ff00::/64
2600:1fff:6000::/40
2a01:578:3::/64
2600:9000::/28</code></code></pre></div></div>
            <div class="example"><h6>例 4. 获取所有 IPv4 地址</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="prompt" copy="false">PS C:\&gt; </code><code class="userinput">Get-AWSPublicIpAddressRange | where <span>{</span>$_.IpAddressFormat -eq "Ipv4"} | select IpPrefix</code><code class="computeroutput" copy="false">

IpPrefix
--------
23.20.0.0/14
27.0.0.0/22
43.250.192.0/24
...</code></code></pre></div></div>
            <div class="example"><h6>例 5. 获取所有 IPv6 地址</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="prompt" copy="false">PS C:\&gt; </code><code class="userinput">Get-AWSPublicIpAddressRange | where <span>{</span>$_.IpAddressFormat -eq "Ipv6"} | select IpPrefix</code><code class="computeroutput" copy="false">

IpPrefix
--------
2a05:d07c:2000::/40
2a05:d000:8000::/40
2406:dafe:2000::/40
...</code></code></pre></div></div>
            <div class="example"><h6>例 6. 获取特定服务的所有 IP 地址</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="prompt" copy="false">PS C:\&gt; </code><code class="userinput">Get-AWSPublicIpAddressRange -ServiceKey CODEBUILD | select IpPrefix</code><code class="computeroutput" copy="false">

IpPrefix
--------
52.47.73.72/29
13.55.255.216/29
52.15.247.208/29
...</code></code></pre></div></div>
         

         
            <h3 id="jq-examples">Linux</h3>

            <p>以下示例命令使用 <a href="https://stedolan.github.io/jq/" rel="noopener noreferrer" target="_blank"><span>jq 工具</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>分析 JSON 文件的本地副本。</p>
            <div class="example"><h6>例 1. 获取创建日期</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="prompt" copy="false">$ </code><code class="userinput">jq .createDate &lt; ip-ranges.json</code><code class="computeroutput" copy="false">

"2016-02-18-17-22-15"</code></code></pre></div></div>
            <div class="example"><h6>例 2. 获取特定区域的信息</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><code class="prompt" copy="false">$ </code><code class="userinput">jq '.prefixes[] | select(.region=="us-east-1")' &lt; ip-ranges.json</code><code class="computeroutput" copy="false">

<span>{</span>
  "ip_prefix": "23.20.0.0/14",
  "region": "us-east-1",
  "network_border_group": "us-east-1",
  "service": "AMAZON"
},
<span>{</span>
  "ip_prefix": "50.16.0.0/15",
  "region": "us-east-1",
  "network_border_group": "us-east-1",
  "service": "AMAZON"
},
<span>{</span>
  "ip_prefix": "50.19.0.0/16",
  "region": "us-east-1",
  "network_border_group": "us-east-1",
  "service": "AMAZON"
},
...</code></code></pre></div></div>
            <div class="example"><h6>例 3. 获取所有 IPv4 地址</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="prompt" copy="false">$ </code><code class="userinput">jq -r '.prefixes | .[].ip_prefix' &lt; ip-ranges.json</code><code class="computeroutput" copy="false">

23.20.0.0/14
27.0.0.0/22
43.250.192.0/24
...</code></code></pre></div></div>
            <div class="example"><h6>例 4. 获取所有 IPv6 地址</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="prompt" copy="false">$ </code><code class="userinput">jq -r '.ipv6_prefixes | .[].ipv6_prefix' &lt; ip-ranges.json</code><code class="computeroutput" copy="false">

2a05:d07c:2000::/40
2a05:d000:8000::/40
2406:dafe:2000::/40
...</code></code></pre></div></div>
            <div class="example"><h6>例 5. 获取特定服务的所有 IPv4 地址</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="prompt" copy="false">$ </code><code class="userinput">jq -r '.prefixes[] | select(.service=="CODEBUILD") | .ip_prefix' &lt; ip-ranges.json</code><code class="computeroutput" copy="false">

52.47.73.72/29
13.55.255.216/29
52.15.247.208/29
...</code></code></pre></div></div>
            <div class="example"><h6>例 6. 获取特定区域中的特定服务的所有 IPv4 地址</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="prompt" copy="false">$ </code><code class="userinput">jq -r '.prefixes[] | select(.region=="us-east-1") | select(.service=="CODEBUILD") | .ip_prefix' &lt; ip-ranges.json</code><code class="computeroutput" copy="false">

34.228.4.208/28</code></code></pre></div></div>
            <div class="example"><h6>例 7. 获取特定网络边界组的信息</h6><div class="example-contents"><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="prompt" copy="false">$ </code><code class="userinput">jq -r '.prefixes[] | select(.region=="us-west-2") | select(.network_border_group=="us-west-2-lax-1") | .ip_prefix' &lt; ip-ranges.json</code><code class="computeroutput" copy="false">
70.224.192.0/18
52.95.230.0/24
15.253.0.0/16
...</code></code></pre></div></div>
         
     
        <h2 id="aws-ip-egress-control">实施出口控制</h2>

        <p>要仅允许实例访问 AWS 服务，可创建相应的安全组，安全组的规则应允许指向 <code class="code">AMAZON</code> 列表中 CIDR 块（并排除同时也在 <code class="code">EC2</code> 列表中的 CIDR 块）的出站流量。<code class="code">EC2</code> 列表中的 IP 地址可以分配给 EC2 实例。</p>
        <p><a href="./amazon-vpc-limits.html#vpc-limits-security-groups">安全组存在限额</a>。根据每个区域中 IP 地址范围的数量，每个区域可能需要使用多个安全组。</p>

         
            <h3 id="filter-addresses-powershell">Windows PowerShell</h3>

            <p>以下 PowerShell 示例显示了如何获取位于 <code class="code">AMAZON</code> 列表中但不位于 <code class="code">EC2</code> 列表中的 IP 地址。复制脚本并将其保存到名为 <code>Select_address.ps1</code> 的文件中。</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">$amazon_addresses = Get-AWSPublicIpAddressRange -ServiceKey amazon
$ec2_addresses = Get-AWSPublicIpAddressRange -ServiceKey ec2

ForEach ($address in $amazon_addresses)
<span>{</span>
    if( $ec2_addresses.IpPrefix -notcontains $address.IpPrefix)
    <span>{</span>
       ($address).IpPrefix 
    }
}</code></code></pre>
            <p>您可以按如下方式运行此脚本：</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="prompt" copy="false">PS C:\&gt; </code><code class="userinput">.\Select_address.ps1</code><code class="computeroutput" copy="false">
13.32.0.0/15
13.35.0.0/16
13.248.0.0/20
13.248.16.0/21
13.248.24.0/22
13.248.28.0/22
27.0.0.0/22
43.250.192.0/24
43.250.193.0/24
...</code></code></pre>
         

         
            <h3 id="filter-addresses-bash-jq">jq</h3>

            <p>以下示例说明如何获取位于 <code class="code">AMAZON</code> 列表中但不位于 <code class="code">EC2</code> 列表中的 IP 地址（针对所有区域）：</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">jq -r '[.prefixes[] | select(.service=="AMAZON").ip_prefix] - [.prefixes[] | select(.service=="EC2").ip_prefix] | .[]' &lt; ip-ranges.json</code><code class="computeroutput" copy="false">

52.94.22.0/24
52.94.17.0/24
52.95.154.0/23
52.95.212.0/22
54.239.0.240/28
54.239.54.0/23
52.119.224.0/21
...</code></code></pre>

            <p>以下示例说明如何将结果筛选到一个区域：</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">jq -r '[.prefixes[] | select(.region=="us-east-1" and .service=="AMAZON").ip_prefix] - [.prefixes[] | select(.region=="us-east-1" and .service=="EC2").ip_prefix] | .[]' &lt; ip-ranges.json</code></code></pre>
         

         
            <h3 id="filter-addresses-python">Python</h3>

            <p>以下 python 脚本显示了如何获取位于 <code class="code">AMAZON</code> 列表中但不位于 <code class="code">EC2</code> 列表中的 IP 地址。复制脚本并将其保存到名为 <code>get_ips.py</code> 的文件中。</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="userinput">#!/usr/bin/env python
import requests

ip_ranges = requests.get('https://ip-ranges.amazonaws.com/ip-ranges.json').json()['prefixes']
amazon_ips = [item['ip_prefix'] for item in ip_ranges if item["service"] == "AMAZON"]
ec2_ips = [item['ip_prefix'] for item in ip_ranges if item["service"] == "EC2"]

amazon_ips_less_ec2=[]
     
for ip in amazon_ips:
    if ip not in ec2_ips:
        amazon_ips_less_ec2.append(ip)

for ip in amazon_ips_less_ec2: print(str(ip))</code></code></pre>
            <p>您可以按如下方式运行此脚本：</p>
            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="prompt" copy="false">$ </code><code class="userinput">python ./get_ips.py</code><code class="computeroutput" copy="false">
13.32.0.0/15
13.35.0.0/16
13.248.0.0/20
13.248.16.0/21
13.248.24.0/22
13.248.28.0/22
27.0.0.0/22
43.250.192.0/24
43.250.193.0/24
...</code></code></pre>
         

     
        <h2 id="subscribe-notifications">AWS IP 地址范围通知</h2>

        
        <p>只要AWS IP 地址范围发生更改，我们就会向 <code class="code">AmazonIpSpaceChanged</code> 主题的订阅者发送通知。有效负载包含以下格式的信息：</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "create-time":"<code class="replaceable">yyyy</code>-<code class="replaceable">mm</code>-<code class="replaceable">dd</code>T<code class="replaceable">hh</code>:<code class="replaceable">mm</code>:<code class="replaceable">ss</code>+00:00",
  "synctoken":"<code class="replaceable">0123456789</code>",
  "md5":"<code class="replaceable">6a45316e8bc9463c9e926d5d37836d33</code>",
  "url":"https://ip-ranges.amazonaws.com/ip-ranges.json"
}</code></pre>
        
        <div class="variablelist">
             
             
             
             
        <dl>
                <dt><b><span class="term">create-time</span></b></dt>
                <dd>
                    <p>创建日期和时间。</p>
                    <p>通知可能不按顺序传输。因此，我们建议您检查时间戳以确保正确的顺序。</p>
                </dd>
            
                <dt><b><span class="term">synctoken</span></b></dt>
                <dd>
                    <p>采用 Unix 纪元时间格式的发布时间。</p>
                </dd>
            
                <dt><b><span class="term">md5</span></b></dt>
                <dd>
                    <p><code>ip-ranges.json</code> 文件的加密哈希值。可以使用此值来检查下载的文件是否已损坏。</p>
                </dd>
            
                <dt><b><span class="term">url</span></b></dt>
                <dd>
                    <p><code>ip-ranges.json</code> 文件的位置。</p>
                </dd>
            </dl></div>

        <p>如果您希望只要AWS IP 地址范围发生更改就收到通知，可以按以下所示进行订阅，以便使用 Amazon SNS 接收通知。</p>
        <div class="procedure"><h6>订阅AWS IP 地址范围通知</h6><ol><li><p>通过以下网址打开 Amazon SNS 控制台：<a href="https://console.aws.amazon.com/sns/v3/home" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/sns/v3/home</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>。</p></li><li>
                <p>如果需要，可在导航栏中将区域更改为<b>美国东部（弗吉尼亚北部）</b>。您必须选择此区域，因为您订阅的 SNS 通知是在此区域中创建的。</p>
            </li><li>
                <p>在导航窗格中，选择 <b>Subscriptions</b>。</p>
            </li><li>
                <p>选择 <b>Create subscription</b>。</p>
            </li><li>
                <p>在 <b>Create subscription</b> 对话框中，执行以下操作：</p>
                <ol><li>
                        <p>对于 <b>Topic ARN</b>，复制以下 Amazon Resource Name（ARN）：</p>
                        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="复制"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight ">arn:aws:sns:us-east-1:806199016981:AmazonIpSpaceChanged</code></pre>
                        
                        
                    </li><li>
                        <p>对于 <b>Protocol</b>，选择要使用的协议 (例如 <code class="code">Email</code>)。</p>
                    </li><li>
                        <p>对于 <b>Endpoint</b>，键入用于接收通知的终端节点 (例如，您的电子邮件地址)。</p>
                    </li><li>
                        <p>选择 <b>Create subscription</b>（创建订阅）。</p>
                    </li></ol>
            </li><li>
                <p>将通过您指定的终端节点与您联系并要求您确认订阅。例如，如果指定了电子邮件地址，您会收到一封主题行为 <code class="code">AWS Notification -
                        Subscription Confirmation</code> 的电子邮件。请按照说明确认订阅。</p>
            </li></ol></div>

        <p>通知受到终端节点可用性约束。因此，应定期检查 JSON 文件以确保您在最新范围内。有关 Amazon SNS 可靠性的更多信息，请参阅<a href="http://aws.amazon.com/sns/faqs/#Reliability" rel="noopener noreferrer" target="_blank"><span>http://aws.amazon.com/sns/faqs/#Reliability</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>。</p>

        <p>如果您不希望再收到这些通知，请通过以下步骤取消订阅。</p>
        <div class="procedure"><h6>取消订阅AWS IP 地址范围通知</h6><ol><li> <p>通过以下网址打开 Amazon SNS 控制台：<a href="https://console.aws.amazon.com/sns/v3/home" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/sns/v3/home</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>。</p> </li><li>
                <p>在导航窗格中，选择 <b>Subscriptions</b>。</p>
            </li><li>
                <p>选中订阅对应的复选框。</p>
            </li><li>
                <p>选择 <b>Actions</b> 和 <b>Delete subscriptions</b>。</p>
            </li><li>
                <p>当系统提示进行确认时，选择 <b>Delete（删除）</b>。</p>
            </li></ol></div>

        <p>有关 Amazon SNS 的更多信息，请参阅《<a href="https://docs.aws.amazon.com/sns/latest/dg/">Amazon Simple Notification Service 开发人员指南</a>》<em></em>。</p>
     
        <h2 id="aws-ip-release-notes">发布说明</h2>

        <p>下表介绍了 <code>ip-ranges.json</code> 语法的更新。我们还会在推出每个区域时添加新的区域代码。</p>
        <div class="table-container"><div class="table-contents"><table id="w282aac11c27c23b5"><thead>
                    <tr>
                        <th>描述</th>
                        <th>发行日期</th>
                    </tr>
                </thead>
                    <tr>
                        <td>添加了 <code class="code">MEDIA_PACKAGE_V2</code> 服务代码。</td>
                        <td>2023 年 5 月 9 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">CLOUDFRONT_ORIGIN_FACING</code> 服务代码。</td>
                        <td>2021 年 10 月 12 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">ROUTE53_RESOLVER</code> 服务代码。</td>
                        <td>2021 年 6 月 24 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">EBS</code> 服务代码。</td>
                        <td>2021 年 5 月 12 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">KINESIS_VIDEO_STREAMS</code> 服务代码。</td>
                        <td>2020 年 11 月 19 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">CHIME_MEETINGS</code> 和 <code class="code">CHIME_VOICECONNECTOR</code> 服务代码。</td>
                        <td>2020 年 6 月 19 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">AMAZON_APPFLOW</code> 服务代码。</td>
                        <td>2020 年 6 月 9 日</td>
                    </tr>
                    <tr>
                        <td>增加了对网络边界组的支持。</td>
                        <td>2020 年 4 月 7 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">WORKSPACES_GATEWAYS</code> 服务代码。</td>
                        <td>2020 年 3 月 30 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">ROUTE53_HEALTHCHECK_PUBLISHING</code> 服务代码。</td>
                        <td>2020 年 1 月 30 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">API_GATEWAY</code> 服务代码。</td>
                        <td>2019 年 9 月 26 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">EC2_INSTANCE_CONNECT</code> 服务代码。</td>
                        <td>2019 年 6 月 26 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">DYNAMODB</code> 服务代码。</td>
                        <td>2019 年 4 月 25 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">GLOBALACCELERATOR</code> 服务代码。</td>
                        <td>2018 年 12 月 20 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">AMAZON_CONNECT</code> 服务代码。</td>
                        <td>2018 年 6 月 20 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">CLOUD9</code> 服务代码。</td>
                        <td>2018 年 6 月 20 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">CODEBUILD</code> 服务代码。</td>
                        <td>2018 年 4 月 19 日</td>
                    </tr>
                    <tr>
                        <td>添加了 <code class="code">S3</code> 服务代码。</td>
                        <td>2017 年 2 月 28 日</td>
                    </tr>
                    <tr>
                        <td>添加了对 IPv6 地址范围的支持。</td>
                        <td>2016 年 8 月 22 日</td>
                    </tr>
                    <tr>
                        <td>首次发布</td>
                        <td>2014 年 11 月 19 日</td>
                    </tr>
                </table></div></div>
     
        <h2 id="aws-ip-learn-more">了解更多信息</h2>
        <div class="itemizedlist">
             
             
             
             
             
             
             
             
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><code class="code">AMAZON_APPFLOW</code> – <a href="https://docs.aws.amazon.com/appflow/latest/userguide/requirements.html#general">IP 地址范围</a></p>
            </li><li class="listitem">
                <p><code class="code">AMAZON_CONNECT</code> – <a href="https://docs.aws.amazon.com/connect/latest/adminguide/ccp-networking.html">设置您的网络</a></p>
            </li><li class="listitem">
                <p><code class="code">CLOUDFRONT</code> – <a href="https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/LocationsOfEdgeServers.html">CloudFront 边缘服务器的位置和 IP 地址范围</a></p>
            </li><li class="listitem">
                <p><code class="code">DYNAMODB</code> – <a href="https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/Using.IPRanges.html">IP 地址范围</a></p>
            </li><li class="listitem">
                <p><code class="code">EC2</code> – <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses">公有 IPV4 地址</a></p>
            </li><li class="listitem">
                <p><code class="code">EC2_INSTANCE_CONNECT</code> – <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-instance-connect-set-up.html">设置 EC2 Instance Connect</a></p>
            </li><li class="listitem">
                <p><code class="code">GLOBALACCELERATOR</code> – <a href="https://docs.aws.amazon.com/global-accelerator/latest/dg/introduction-ip-ranges.html">Global Accelerator 边缘服务器的位置和 IP 地址范围</a></p>
            </li><li class="listitem">
                <p><code class="code">ROUTE53</code> – <a href="https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/route-53-ip-addresses.html">Amazon Route 53 服务器的 IP 地址范围</a></p>
            </li><li class="listitem">
                <p><code class="code">ROUTE53_HEALTHCHECKS</code> – <a href="https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/route-53-ip-addresses.html">Amazon Route 53 服务器的 IP 地址范围</a></p>
            </li><li class="listitem">
                <p><code class="code">ROUTE53_HEALTHCHECKS_PUBLISHING</code> – <a href="https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/route-53-ip-addresses.html">Amazon Route 53 服务器的 IP 地址范围</a></p>
            </li><li class="listitem">
                <p><code class="code">WORKSPACES_GATEWAYS</code>–<a href="https://docs.aws.amazon.com/workspaces/latest/adminguide/workspaces-port-requirements.html#gateway_IP">PCoIP 网关服务器</a></p>
            </li></ul></div>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="警告" /> <strong>Javascript 在您的浏览器中被禁用或不可用。</strong></p><p>要使用 Amazon Web Services 文档，必须启用 Javascript。请参阅浏览器的帮助页面以了解相关说明。</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">文档惯例</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./managed-prefix-lists-referencing.html">在AWS资源中引用前缀列表</div><div id="next" class="next-link" accesskey="n" href="./vpc-migrate-ipv6.html">从 IPv4 迁移到 IPv6</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">此页面对您有帮助吗？- 是</div><div class="content"><p>感谢您对我们工作的肯定！</p><p>如果不耽误您的时间，请告诉我们做得好的地方，让我们做得更好。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="反馈" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=VPC&amp;topic_url=https://docs.aws.amazon.com/zh_cn/vpc/latest/userguide/aws-ip-ranges.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">此页面对您有帮助吗？- 否</div><div class="content"><p>感谢您告诉我们本页内容还需要完善。很抱歉让您失望了。</p><p>如果不耽误您的时间，请告诉我们如何改进文档。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="反馈" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=VPC&amp;topic_url=https://docs.aws.amazon.com/zh_cn/vpc/latest/userguide/aws-ip-ranges.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>