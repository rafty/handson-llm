<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AMAZÔNIA. KendraSearchIntent - Amazon Lex</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="built-in-intent-kendra-search" /><meta name="default_state" content="built-in-intent-kendra-search" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/lexv2/latest/dg/built-in-intent-kendra-search.html" /><meta name="description" content="Para pesquisar documentos que você indexou com o Amazon Kendra, use a AMAZON.KendraSearchIntent intenção. Quando o Amazon Lex V2 não consegue determinar a próxima ação em uma conversa com o usuário, ele aciona a intenção de pesquisa." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Lex" /><meta name="guide" content="Guia do desenvolvedor do V2" /><meta name="abstract" content="Fornece uma visão geral conceitual do Amazon Lex V2. Inclui instruções detalhadas para usar vários recursos, como streaming de conversas, e fornece uma referência completa para as APIs V2." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/lexv2/latest/dg/built-in-intent-kendra-search.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="x-default" /><meta name="feedback-item" content="Lex" /><meta name="this_doc_product" content="Amazon Lex" /><meta name="this_doc_guide" content="Guia do desenvolvedor do V2" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'lex'}"></script><meta id="panorama-serviceSubSection" value="Guia do desenvolvedor do V2" /><meta id="panorama-serviceConsolePage" value="AMAZÔNIA. KendraSearchIntent" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AMAZÔNIA. KendraSearchIntent - Amazon Lex</title><meta name="pdf" content="lex2.0.pdf#built-in-intent-kendra-search" /><meta name="rss" content="amazon-lex-v2-document-history.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=251" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lex&amp;topic_url=http://docs.aws.amazon.com/pt_br/lexv2/latest/dg/built-in-intent-kendra-search.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/pt_br/lexv2/latest/dg/built-in-intent-kendra-search.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/pt_br/lexv2/latest/dg/built-in-intent-kendra-search.html" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Lex",
        "item" : "https://docs.aws.amazon.com/lex/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Guia do desenvolvedor do V2",
        "item" : "https://docs.aws.amazon.com/pt_br/lexv2/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Construindo bots",
        "item" : "https://docs.aws.amazon.com/pt_br/lexv2/latest/dg/building-bots.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Intenções e tipos de slots integrados",
        "item" : "https://docs.aws.amazon.com/pt_br/lexv2/latest/dg/built-in.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Intenções integradas",
        "item" : "https://docs.aws.amazon.com/pt_br/lexv2/latest/dg/howitworks-builtins-intents.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "AMAZÔNIA. KendraSearchIntent",
        "item" : "https://docs.aws.amazon.com/pt_br/lexv2/latest/dg/howitworks-builtins-intents.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="lex2.0.pdf#built-in-intent-kendra-search" target="_blank" rel="noopener noreferrer" title="Abrir em PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/lex/index.html">Amazon Lex</a><a href="what-is.html">Guia do desenvolvedor do V2</a></div><div id="page-toc-src"><a href="#kendra-search-iam">Política do IAM</a><a href="#kendra-search-filter">Usar atributos de solicitação e sessão como filtros</a><a href="#kendra-search-response">Usar a resposta da pesquisa</a><a href="#kendra-search-lambda">Usando uma função Lambda para gerenciar a solicitação e a resposta</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>As traduções são geradas por tradução automática. Em caso de conflito entre o conteúdo da tradução e da versão original em inglês, a versão em inglês prevalecerá.</p></awsui-alert><h1 class="topictitle" id="built-in-intent-kendra-search">AMAZÔNIA. KendraSearchIntent</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Para pesquisar documentos que você indexou com o Amazon Kendra, use a<code class="code">AMAZON.KendraSearchIntent</code> intenção. Quando o Amazon Lex V2 não consegue determinar a próxima ação em uma conversa com o usuário, ele aciona a intenção de pesquisa.</p><p>O<code class="code">AMAZON.KendraSearchIntent</code> está disponível somente na versão de inglês (EUA) e Europa (Irlanda).</p><p>O Amazon Kendra é um serviço de machine-learning-based  pesquisa que indexa documentos em linguagem natural, como documentos PDF ou arquivos do Microsoft Word. Ele pode pesquisar documentos indexados e retornar os seguintes tipos de respostas a uma pergunta:</p><div class="itemizedlist">
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>Uma resposta </p>
                </li><li class="listitem">
                    <p>Uma entrada de uma pergunta frequente que pode responder à pergunta</p>
                </li><li class="listitem">
                    <p>Um documento relacionado à pergunta</p>
                </li></ul></div><p>Para ver um exemplo de uso de <code class="code">AMAZON.KendraSearchIntent</code>, consulte <a href="./faq-bot-kendra-search.html">Exemplo: Criação de um bot de perguntas frequentes para um índice Amazon Kendra</a>.</p><p>Se você configurar uma<code class="code">AMAZON.KendraSearchIntent</code> intenção para seu bot, o Amazon Lex V2 chamará a intenção sempre que não conseguir determinar a expressão do usuário para uma intenção. Se não houver resposta do Amazon Kendra, a conversa continuará conforme configurado no bot.</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p> Atualmente, o Amazon Lex V2 não oferece suporte à elicitação de slots<code class="code">AMAZON.KendraSearchIntent</code> durante a elicitação. Se o Amazon Lex V2 não conseguir determinar a expressão do usuário para um slot, ele chamará<code class="code">AMAZON.FallbackIntent</code> o. </p></div></div><p>Quando você usa o<code class="code">AMAZON.KendraSearchIntent</code> com o<code class="code">AMAZON.FallbackIntent</code> no mesmo bot, o Amazon Lex V2 usa as seguintes intenções:</p><div class="orderedlist">
                 
                 
                 
                 
            <ol><li>
                    <p>O Amazon Lex V2 chama<code class="code">AMAZON.KendraSearchIntent</code> o. A intenção chama a<code class="code">Query</code> operação Amazon Kendra.</p>
                </li><li>
                    <p>Se o Amazon Kendra retornar uma resposta, o Amazon Lex V2 exibirá o resultado para o usuário.</p>
                </li><li>
                    <p>Se não houver resposta do Amazon Kendra, o Amazon Lex V2 solicitará novamente o usuário. A próxima ação depende da resposta do usuário.</p>
                    <div class="itemizedlist">
                         
                         
                    <ul class="itemizedlist"><li class="listitem">
                            <p>Se a resposta do usuário contiver uma declaração que o Amazon Lex V2 reconheça, como preencher um valor de slot ou confirmar uma intenção, a conversa com o usuário continuará conforme configurada para o bot.</p>
                        </li><li class="listitem">
                            <p>Se a resposta do usuário não contiver uma declaração que o Amazon Lex V2 reconheça, o Amazon Lex V2 fará outra chamada para a<code class="code">Query</code> operação.</p>
                        </li></ul></div>
                </li><li>
                    <p>Se não houver resposta após o número configurado de novas tentativas, o Amazon Lex V2 chamará o<code class="code">AMAZON.FallbackIntent</code> e encerrará a conversa com o usuário.</p>
                </li></ol></div><p>Há três maneiras de usar o<code class="code">AMAZON.KendraSearchIntent</code> para fazer uma solicitação ao Amazon Kendra:</p><div class="itemizedlist">
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>Deixe que a intenção de pesquisa faça a solicitação por você. O Amazon Lex V2 chama o Amazon Kendra com a expressão do usuário como string de pesquisa. Ao criar a intenção, você pode definir uma sequência de caracteres de filtro de consulta que limita o número de respostas que o Amazon Kendra retorna. O Amazon Lex V2 usa o filtro na solicitação de consulta.</p>
                </li><li class="listitem">
                    <p>Adicione parâmetros de consulta adicionais à solicitação para restringir os resultados da pesquisa usando sua função Lambda. Você adiciona um<code class="code">kendraQueryFilterString</code> campo que contém parâmetros de consulta do Amazon Kendra à ação da<code class="code">delegate</code> caixa de diálogo. Quando você adiciona parâmetros de consulta à solicitação com a função Lambda, eles têm precedência sobre o filtro de consulta que você definiu ao criar a intenção.</p>
                </li><li class="listitem">
                    <p>Crie uma nova consulta usando a função do Lambda. Você pode criar uma solicitação de consulta completa do Amazon Kendra enviada pelo Amazon Lex V2. Especifique a consulta no campo <code class="code">kendraQueryRequestPayload</code> na ação de diálogo <code class="code">delegate</code>. O campo <code class="code">kendraQueryRequestPayload</code> tem precedência sobre o campo <code class="code">kendraQueryFilterString</code>.</p>
                </li></ul></div><p>Para especificar o<code class="code">queryFilterString</code> parâmetro ao criar um bot ou especificar o<code class="code">kendraQueryFilterString</code> campo ao chamar a<code class="code">delegate</code> ação em uma função de diálogo do Lambda, você especifica uma string que é usada como filtro de atributos para a consulta do Amazon Kendra. Se a string não for um filtro de atributo válido, você receberá uma exceção <code class="code">InvalidBotConfigException</code> em tempo de execução. Para obter mais informações sobre filtros de atributos, consulte <a href="https://docs.aws.amazon.com/kendra/latest/dg/filtering.html#search-filtering">Uso de atributos de documentos para filtrar consultas</a> no <em>Guia do desenvolvedor do Amazon Kendra</em>.</p><p>Para ter controle sobre a consulta que o Amazon Lex V2 envia ao Amazon Kendra, você pode especificar uma consulta no<code class="code">kendraQueryRequestPayload</code> campo em sua função Lambda. Se a consulta não for válida, o Amazon Lex V2 retornará uma<code class="code">InvalidLambdaResponseException</code> exceção. Para obter mais informações, consulte a <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_Query.html">operação de consulta</a> no <em>Guia do desenvolvedor do Amazon Kendra</em>.</p><p>Para obter um exemplo de como usar a <code class="code">AMAZON.KendraSearchIntent</code>, consulte <a href="./faq-bot-kendra-search.html">Exemplo: Criação de um bot de perguntas frequentes para um índice Amazon Kendra</a>.</p>
                <h2 id="kendra-search-iam">Política do IAM para o Amazon Kendra Search</h2>
                <p>Para usar a<code class="code">AMAZON.KendraSearchIntent</code> intenção, você deve usar uma função que forneça políticasAWS Identity and Access Management (IAM) que permitam que o Amazon Lex V2 assuma uma função de tempo de execução que tenha permissão para chamar a<code class="code">Query</code> intenção do Amazon Kendra. As configurações do IAM que você usa dependem de você criar o<code class="code">AMAZON.KendraSearchIntent</code> usando o console Amazon Lex V2 ou usando um SDK da AWS ou oAWS Command Line Interface (AWS CLI). Ao usar o console, você pode escolher entre adicionar permissão para chamar o Amazon Kendra para a função vinculada ao serviço Amazon Lex V2 ou usar uma função específica para chamar a<code class="code">Query</code> operação Amazon Kendra. Quando a AWS CLI ou um SDK é usado para criar a intenção, é necessário usar uma função especificamente para chamar a operação <code class="code">Query</code>.</p>
                 
                    <h3 id="kendra-iam-attach">Anexar permissões </h3>
                    <p>Você pode usar o console para anexar permissões de acesso à<code class="code">Query</code> operação do Amazon Kendra à função padrão vinculada ao serviço Amazon Lex V2. Ao atribuir permissões à função vinculada ao serviço, você não precisa criar e gerenciar uma função de tempo de execução especificamente para se conectar ao índice Amazon Kendra.</p>
                    <p>O usuário, função ou grupo que você usa para acessar o console Amazon Lex V2 deve ter permissões para gerenciar políticas de função. Anexe a política do IAM a seguir à função de acesso ao console. Quando essas permissões são concedidas, a função tem permissões para alterar a política de função vinculada ao serviço existente. </p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "iam:AttachRolePolicy",
                "iam:PutRolePolicy",
                "iam:GetRolePolicy"
            ],
            "Resource": "arn:aws:iam::*:role/aws-service-role/lexv2.amazonaws.com/AWSServiceRoleForLexBots*"
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": "iam:ListRoles",
            "Resource": "*"
        }
    ]
}</code></pre>
                 
                 
                    <h3 id="kendra-iam-role">Especificar uma função </h3>
                    <p>Você pode usar o consoleAWS CLI, o ou a API para especificar uma função de tempo de execução a ser usada ao chamar a<code class="code">Query</code> operação Amazon Kendra. </p>
                    <p>O usuário, função ou grupo que você usa para especificar a função de tempo de execução deve ter a<code class="code">iam:PassRole</code> permissão. A política a seguir define a permissão. É possível usar as chaves de contexto de condição <code class="code">iam:AssociatedResourceArn</code> e <code class="code">iam:PassedToService</code> para limitar ainda mais o escopo das permissões. Para obter mais informações, consulte <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html">IAM e chaves de contexto deAWS STS condição</a> no <em>GuiaAWS Identity and Access Management do usuário</em>.</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": "iam:PassRole",
            "Resource": "arn:aws:iam::<code class="replaceable">account</code>:role/<code class="replaceable">role</code>"
        }
    ]
}</code></pre>
                    <p>A função de tempo de execução que o Amazon Lex V2 precisa usar para chamar o Amazon Kendra deve ter as<code class="code">kendra:Query</code> permissões. Quando você usa uma função existente do IAM para obter permissão para chamar a<code class="code">Query</code> operação Amazon Kendra, a função deve ter a seguinte política anexada.</p>
                    <p>Também é possível usar o console do IAM, a API do IAM ou aAWS CLI para criar uma política e anexá-la a uma função. Essas instruções usam a CLI da AWS para criar a função e as políticas.</p>
                    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>nota</h6></div><div class="awsdocs-note-text"><p>O código a seguir é formatado para Linux e MacOS. Para Windows, substitua o caractere de continuação de linha do Linux (\) pelo circunflexo (^).</p></div></div>
                    <div class="procedure"><h6>Como adicionar permissão de operação de consulta a uma função</h6><ol><li>
                            <p>Crie um documento chamado <code class="userinput">KendraQueryPolicy.json</code> no diretório atual, adicione a ele o código a seguir e salve-o.</p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kendra:Query"
            ],
            "Resource": [
                "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account</code>:index/<code class="replaceable">index ID</code>"
            ]
        }
    ]
}</code></pre>
                        </li><li>
                            <p>NoAWS CLI, execute o comando a seguir para criar a política do IAM para executar a<code class="code">Query</code> operação Amazon Kendra.</p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iam create-policy \
    --policy-name <code class="replaceable">query-policy-name</code> \
    --policy-document file://KendraQueryPolicy.json</code></pre>
                        </li><li>
                            <p>Anexe a política à função do IAM que você está usando para chamar a<code class="code">Query</code> operação.</p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iam attach-role-policy \
    --policy-arn arn:aws:iam::<code class="replaceable">account-id</code>:policy/<code class="replaceable">query-policy-name</code>
    --role-name <code class="replaceable">role-name</code></code></pre>
                        </li></ol></div>
                    <p>Você pode optar por atualizar a função vinculada ao serviço Amazon Lex V2 ou usar uma função que você criou ao criar a<code class="code">AMAZON.KendraSearchIntent</code> para o seu bot. O procedimento a seguir mostra como escolher a função do IAM a ser usada.</p>
                    <div class="procedure"><h6>Para especificar a função de tempo de execução da AMAZON. KendraSearchIntent</h6><ol><li>
                            <p>Faça login noAWS Management Console e abra o console do Lex do Amazon Lex em <a href="https://console.aws.amazon.com/lex/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/lex/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p>
                        </li><li>
                            <p>Escolha o bot ao qual você deseja adicionar a <code class="code">AMAZON.KendraSearchIntent</code>.</p>
                        </li><li>
                            <p>Escolha o sinal de adição (+) ao lado de <b>Intenções</b>.</p>
                        </li><li>
                            <p>Em <b>Adicionar intenção</b>, escolha <b>Pesquisar intenções existentes</b>.</p>
                        </li><li>
                            <p>Em <b>Intenções de pesquisa</b>, insira <code class="userinput">AMAZON.KendraSearchIntent</code> e escolha <b>Adicionar</b>.</p>
                        </li><li>
                            <p>Em <b>Copiar intenção interna</b>, insira um nome para a intenção, como <code class="userinput">KendraSearchIntent</code>, e escolha <b>Adicionar</b>.</p>
                        </li><li>
                            <p>Abra a seção <b>Consulta do Amazon Kendra</b>.</p>
                        </li><li>
                            <p>Para <b>Função do IAM</b>, escolha uma das seguintes opções:</p>
                            <div class="itemizedlist">
                                 
                                 
                            <ul class="itemizedlist"><li class="listitem">
                                    <p>Para atualizar a função vinculada ao serviço Amazon Lex V2 para permitir que seu bot consulte os índices do Amazon Kendra, escolha <b>Adicionar permissões do Amazon Kendra</b>.</p>
                                </li><li class="listitem">
                                    <p>Para usar uma função que tenha permissão para chamar a<code class="code">Query</code> operação Amazon Kendra, escolha <b>Usar uma função existente</b>.</p>
                                </li></ul></div>
                        </li></ol></div>
                 
             
                <h2 id="kendra-search-filter">Usar atributos de solicitação e sessão como filtros</h2>
                <p>Para filtrar a resposta do Amazon Kendra aos itens relacionados à conversa atual, use atributos de sessão e solicitação como filtros adicionando o<code class="code">queryFilterString</code> parâmetro ao criar seu bot. Você especifica um espaço reservado para o atributo ao criar a intenção e, em seguida, o Amazon Lex V2 substitui um valor antes de chamar o Amazon Kendra. Para obter mais informações sobre atributos de solicitação, consulte <a href="./context-mgmt-request-attribs.html">Definir atributos de solicitações</a>. Para obter mais informações sobre atributos de sessão, consulte <a href="./context-mgmt-session-attribs.html">Definir atributos de sessões</a>.</p>
                <p>Veja a seguir um exemplo de um<code class="code">queryFilterString</code> parâmetro que usa uma string para filtrar a consulta do Amazon Kendra.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"<span>{</span>"equalsTo": <span>{</span>"key": "City", "value": <span>{</span>"stringValue": "Seattle"}}}"</code></pre>
                <p>Veja a seguir um exemplo de um<code class="code">queryFilterString</code> parâmetro que usa um atributo de sessão chamado<code class="code">"SourceURI"</code> para filtrar a consulta do Amazon Kendra.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"<span>{</span>"equalsTo": <span>{</span>"key": "SourceURI","value": <span>{</span>"stringValue": "[FileURL]"}}}"</code></pre>
                <p>Veja a seguir um exemplo de um<code class="code">queryFilterString</code> parâmetro que usa um atributo de solicitação chamado<code class="code">"DepartmentName"</code> para filtrar a consulta do Amazon Kendra.</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"<span>{</span>"equalsTo": <span>{</span>"key": "Department","value": <span>{</span>"stringValue": "((DepartmentName))"}}}"</code></pre>
                <p>Os<code class="code">AMAZON.KendraSearchInteng</code> filtros usam o mesmo formato dos filtros de pesquisa do Amazon Kendra. Para obter mais informações, consulte <a href="https://docs.aws.amazon.com/kendra/latest/dg/filtering.html#search-filtering">Uso de atributos de documentos para filtrar resultados de pesquisa</a> no <em>guia do desenvolvedor do Amazon Kendra</em>.</p>
                <p>A sequência de caracteres do filtro de consulta usada com o<code class="code">AMAZON.KendraSearchIntent</code> deve usar letras minúsculas para a primeira letra de cada filtro. Por exemplo, o seguinte é um filtro<code class="code">AMAZON.KendraSearchIntent</code></p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "andAllFilters": [
        <span>{</span>
            "equalsTo": <span>{</span>
                "key": "City",
                "value": <span>{</span>
                    "stringValue": "Seattle"
                }
            }
        },
        <span>{</span>
            "equalsTo": <span>{</span>
                "key": "State",
                "value": <span>{</span>
                    "stringValue": "Washington"
                }
            }
        }
    ]
}</code></pre>
             
                <h2 id="kendra-search-response">Usar a resposta da pesquisa</h2>
                <p>O Amazon Kendra retorna a resposta a uma pesquisa em uma resposta à<code class="code">IntentClosingSetting</code> declaração da intenção. A intenção deve ter uma<code class="code">closingResponse</code> declaração, a menos que uma função Lambda produza uma mensagem de resposta final.</p>
                <p>O Amazon Kendra tem cinco tipos de respostas. </p>
                <div class="itemizedlist">
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>As duas respostas a seguir exigem que uma FAQ seja configurada para seu índice Amazon Kendra. Para obter mais detalhes, consulte <a href="https://docs.aws.amazon.com/kendra/latest/dg/in-creating-faq.html">Adicionar perguntas e respostas diretamente a um índice</a>.</p>
                        <div class="itemizedlist">
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p> <code class="code">x-amz-lex:kendra-search-response-question_answer-question-&lt;N&gt;</code>— A pergunta de um FAQ que corresponde à pesquisa. </p>
                            </li><li class="listitem">
                                <p> <code class="code">x-amz-lex:kendra-search-response-question_answer-answer-&lt;N&gt;</code>— A resposta de um FAQ que corresponde à pesquisa. </p>
                            </li></ul></div>                        
                    </li><li class="listitem">
                        <p>As três respostas a seguir exigem que uma fonte de dados seja configurada para seu índice Amazon Kendra. Para obter mais detalhes, consulte <a href="https://docs.aws.amazon.com/kendra/latest/dg/data-source.html">Como criar uma fonte de dados</a>. </p>
                        <div class="itemizedlist">
                             
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p><code class="code">x-amz-lex:kendra-search-response-document-&lt;N&gt;</code>— Um trecho de um documento no índice relacionado ao texto do enunciado.</p>
                            </li><li class="listitem">
                                <p><code class="code">x-amz-lex:kendra-search-response-document-link-&lt;N&gt;</code>— O URL de um documento no índice relacionado ao texto do enunciado.</p>
                            </li><li class="listitem">
                                <p><code class="code">x-amz-lex:kendra-search-response-answer-&lt;N&gt;</code>— Um trecho de um documento no índice que responde à pergunta.</p>
                            </li></ul></div>
                    </li></ul></div>
                <p>As respostas são retornadas em atributos <code class="code">request</code>. Pode haver até cinco respostas para cada atributo, numeradas de 1 a 5. Para obter mais informações sobre respostas, consulte <a href="https://docs.aws.amazon.com/kendra/latest/dg/response-types.html">Tipos de resposta</a> no <em>Guia do desenvolvedor do Amazon Kendra</em>. </p>
                <p>A instrução <code class="code">closingResponse</code> deve ter um ou mais grupos de mensagens. Cada grupo de mensagens contém uma ou mais mensagens. Cada mensagem pode conter uma ou mais variáveis de espaço reservado que são substituídas por atributos de solicitação na resposta do Amazon Kendra. Deve haver pelo menos uma mensagem no grupo de mensagens em que todas as variáveis na mensagem são substituídas por valores de atributo de solicitação na resposta de tempo de execução, ou deve haver uma mensagem no grupo sem variáveis de espaço reservado. Os atributos de solicitação são ativados com parênteses duplos ("((" "))"). As seguintes mensagens do grupo de mensagens correspondem a qualquer resposta do Amazon Kendra:</p>
                <div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>“Encontrei uma pergunta de perguntas frequentes para você: ((x-amz-lex:kendra-search-response-question _answer-question-1)), e a resposta é ((x-amz-lex:kendra-search-response-question _answer-answer-1))”</p>
                    </li><li class="listitem">
                        <p>“Encontrei um trecho de um documento útil: ((x-amz-lex:kendra-search-response-document -1))”</p>
                    </li><li class="listitem">
                        <p>“Acho que a resposta para suas perguntas é ((x-amz-lex:kendra-search-response-answer -1))”</p>
                    </li></ul></div>
             
                <h2 id="kendra-search-lambda">Usando uma função Lambda para gerenciar a solicitação e a resposta</h2>
                <p>A<code class="code">AMAZON.KendraSearchIntent</code> intenção pode usar seu gancho de código de diálogo e gancho de código de atendimento para gerenciar a solicitação ao Amazon Kendra e a resposta. Use a função Lambda de gancho de código de diálogo quando quiser modificar a consulta que você envia para o Amazon Kendra e a função Lambda de gancho de código de atendimento quando quiser modificar a resposta.</p>
                 
                    <h3 id="kendra-search-lambda-dialog">Criar uma consulta com o gancho de código de diálogo</h3>
                    <p>Você pode usar o gancho de código de diálogo para criar uma consulta para enviar ao Amazon Kendra. O uso do gancho de código de diálogo é opcional. Se você não especificar um gancho de código de diálogo, o Amazon Lex V2 constrói uma consulta a partir da expressão do usuário e usa a<code class="code">queryFilterString</code> que você forneceu quando configurou a intenção, se tiver fornecido uma.</p>
                    <p>Você pode usar dois campos na resposta do gancho de código de diálogo para modificar a solicitação para o Amazon Kendra:</p>
                    <div class="itemizedlist">
                         
                         
                    <ul class="itemizedlist"><li class="listitem">
                            <p><code class="code">kendraQueryFilterString</code>— Use essa string para especificar filtros de atributos para a solicitação do Amazon Kendra. É possível filtrar a consulta usando qualquer um dos campos de índice definidos no índice. Para ver a estrutura da cadeia de caracteres de filtro, consulte <a href="https://docs.aws.amazon.com/kendra/latest/dg/filtering.html#search-filtering">Uso de atributos de documentos para filtrar consultas</a> no <em>Guia do desenvolvedor do Amazon Kendra</em>. Se a string de filtro especificada não for válida, você receberá uma exceção <code class="code">InvalidLambdaResponseException</code>. A string <code class="code">kendraQueryFilterString</code> substitui qualquer string de consulta especificada na <code class="code">queryFilterString</code> configurada para a intenção.</p>
                        </li><li class="listitem">
                            <p><code class="code">kendraQueryRequestPayload</code>— Use essa string para especificar uma consulta do Amazon Kendra. Sua consulta pode usar qualquer um dos recursos do Amazon Kendra. Se você não especificar uma consulta válida, receberá uma exceção <code class="code">InvalidLambdaResponseException</code>. Para obter mais informações, consulte <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_Query.html">Consulta</a> no <em>Guia do desenvolvedor do Amazon Kendra</em>.</p>
                        </li></ul></div>
                    <p>Depois de criar o filtro ou a sequência de consulta, você envia a resposta para o Amazon Lex V2 com o<code class="code">dialogAction</code> campo da resposta definido como<code class="code">delegate</code>. O Amazon Lex V2 envia a consulta para o Amazon Kendra e, em seguida, retorna a resposta da consulta ao gancho do código de atendimento.</p>
                 
                 
                    <h3 id="kendra-search-lambda-fulfillment">Usar o gancho de código de atendimento para a resposta</h3>
                    <p>Depois que o Amazon Lex V2 envia uma consulta ao Amazon Kendra, a resposta da consulta é retornada para a função de<code class="code">AMAZON.KendraSearchIntent</code> atendimento do Lambda. O evento de entrada no gancho de código contém a resposta completa do Amazon Kendra. Os dados da consulta estão na mesma estrutura retornada pela<code class="code">Query</code> operação Amazon Kendra. Para obter mais informações, consulte <a href="https://docs.aws.amazon.com/kendra/latest/dg/API_Query.html#API_Query_ResponseSyntax">Sintaxe de resposta à consulta</a> no <em>Guia do desenvolvedor do Amazon Kendra</em>.</p>
                    <p>O gancho de código de atendimento é opcional. Se um não existir ou se o gancho de código não retornar uma mensagem na resposta, o Amazon Lex V2 usará a<code class="code">closingResponse</code> declaração para respostas.</p>
                 
            <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./built-in-intent-help.html">AMAZÔNIA. HelpIntent</div><div id="next" class="next-link" accesskey="n" href="./faq-bot-kendra-search.html">Exemplo: Criação de um bot de perguntas frequentes para um índice Amazon Kendra</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lex&amp;topic_url=https://docs.aws.amazon.com/pt_br/lexv2/latest/dg/built-in-intent-kendra-search.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lex&amp;topic_url=https://docs.aws.amazon.com/pt_br/lexv2/latest/dg/built-in-intent-kendra-search.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>