<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="pt-BR"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Endpoints de gateway para o Amazon S3 - Amazon Virtual Private Cloud</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="vpc-endpoints-s3" /><meta name="default_state" content="vpc-endpoints-s3" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/vpc/latest/privatelink/vpc-endpoints-s3.html" /><meta name="description" content="É possível acessar o Amazon S3 de sua VPC usando endpoints da VPC de gateway. Depois de criar o endpoint de gateway, é possível adicioná-lo como um destino na tabela de rotas para o tráfego destinado da VPC ao Amazon S3." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Virtual Private Cloud" /><meta name="guide" content="AWS PrivateLink" /><meta name="abstract" content="Use o AWS PrivateLink para conectar a VPC aos Serviços da AWS compatíveis, aos serviços hospedados por outras Contas da AWS e aos serviços compatíveis de parceiros do AWS Marketplace." /><meta name="guide-locale" content="pt_br" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/pt_br/vpc/latest/privatelink/vpc-endpoints-s3.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints-s3.html" hreflang="x-default" /><meta name="feedback-item" content="PrivateLink" /><meta name="this_doc_product" content="Amazon Virtual Private Cloud" /><meta name="this_doc_guide" content="AWS PrivateLink" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'vpc'}"></script><meta id="panorama-serviceSubSection" value="AWS PrivateLink" /><meta id="panorama-serviceConsolePage" value="Endpoints de gateway para o Amazon S3" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Endpoints de gateway para o Amazon S3 - Amazon Virtual Private Cloud</title><meta name="pdf" content="aws-privatelink.pdf#vpc-endpoints-s3" /><meta name="rss" content="privatelink-updates.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=58" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=PrivateLink&amp;topic_url=http://docs.aws.amazon.com/pt_br/vpc/latest/privatelink/vpc-endpoints-s3.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/pt_br/vpc/latest/privatelink/vpc-endpoints-s3.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/pt_br/vpc/latest/privatelink/vpc-endpoints-s3.html" /><meta name="keywords" content="VPC,Amazon VPC,PrivateLink" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon VPC",
        "item" : "https://docs.aws.amazon.com/vpc/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "AWS PrivateLink",
        "item" : "https://docs.aws.amazon.com/pt_br/vpc/latest/privatelink"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Acessar os Serviços da AWS pelo AWS PrivateLink",
        "item" : "https://docs.aws.amazon.com/pt_br/vpc/latest/privatelink/privatelink-access-aws-services.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Endpoints de gateway",
        "item" : "https://docs.aws.amazon.com/pt_br/vpc/latest/privatelink/gateway-endpoints.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Endpoints de gateway para o Amazon S3",
        "item" : "https://docs.aws.amazon.com/pt_br/vpc/latest/privatelink/gateway-endpoints.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="aws-privatelink.pdf#vpc-endpoints-s3" target="_blank" rel="noopener noreferrer" title="Abrir em PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentação</a><a href="/vpc/index.html">Amazon VPC</a><a href="what-is-privatelink.html">AWS PrivateLink</a></div><div id="page-toc-src"><a href="#gateway-endpoint-considerations-s3">Considerações</a><a href="#private-dns-s3">DNS privado</a><a href="#create-gateway-endpoint-s3">Criar um endpoint do gateway</a><a href="#bucket-policies-s3">Controlar acesso usando políticas de bucket</a><a href="#associate-route-tables-s3">Associar tabela de rotas</a><a href="#edit-vpc-endpoint-policy-s3">Editar a política de endpoints da VPC</a><a href="#delete-gateway-endpoint-s3">Excluir um endpoint de gateway</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="vpc-endpoints-s3">Endpoints de gateway para o Amazon S3</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>É possível acessar o Amazon S3 de sua VPC usando endpoints da VPC de gateway. Depois de criar o endpoint de gateway, é possível adicioná-lo como um destino na tabela de rotas para o tráfego destinado da VPC ao Amazon S3.</p><p>Não há cobrança adicional pelo uso de endpoints do gateway.</p><p>O Amazon S3 oferece suporte a endpoints de gateway e de interface. Com um endpoint de gateway, é possível acessar o Amazon S3 utilizando a sua VPC sem precisar de um gateway de Internet ou um dispositivo de NAT para a sua VPC, e tudo isso sem custos adicionais. No entanto, os endpoints de gateway não permitem acesso de redes on-premises, de VPCs emparelhadas em outras regiões da AWS ou por meio de um gateway de trânsito. Para esses cenários, você deve usar um endpoint de interface, o qual está disponível por um custo adicional. Para obter mais informações, consulte <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/privatelink-interface-endpoints.html#types-of-vpc-endpoints-for-s3">Tipos de endpoints da VPC para o Amazon S3</a> no <em>Guia do usuário da Amazon VPC</em>.</p><div class="highlights" id="inline-topiclist"><h6>Índice</h6><ul><li><a href="#gateway-endpoint-considerations-s3">Considerações</a></li><li><a href="#private-dns-s3">DNS privado</a></li><li><a href="#create-gateway-endpoint-s3">Criar um endpoint do gateway</a></li><li><a href="#bucket-policies-s3">Controlar acesso usando políticas de bucket</a></li><li><a href="#associate-route-tables-s3">Associar tabela de rotas</a></li><li><a href="#edit-vpc-endpoint-policy-s3">Editar a política de endpoints da VPC</a></li><li><a href="#delete-gateway-endpoint-s3">Excluir um endpoint de gateway</a></li></ul></div>
      <h2 id="gateway-endpoint-considerations-s3">Considerações</h2>
      <div class="itemizedlist">
         
         
         
         
         
         
         
         
         
      <ul class="itemizedlist"><li class="listitem">
          <p>Um endpoint de gateway só estará disponível na região em que você o criou. Crie o endpoint de gateway na mesma região que os buckets do S3.</p>
        </li><li class="listitem">
          <p>Se você estiver usando os servidores DNS da Amazon, será necessário habilitar os <a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-dns.html#vpc-dns-updating">nomes de host DNS e a resolução de DNS</a> para sua VPC. Se você estiver usando seu próprio servidor DNS, certifique-se de que as solicitações para o Amazon S3 sejam resolvidas corretamente para os endereços IP mantidos pela AWS.</p>
        </li><li class="listitem">
          <p>Verifique se está usando um AWS service (Serviço da AWS) que requer acesso a um bucket do S3. Por exemplo, um serviço pode requerer acesso a buckets que contêm arquivos de log ou pode requerer que você baixe drivers ou agentes para suas instâncias do EC2. Se for esse o caso, certifique-se de que a política de endpoint permita que o recurso ou o AWS service (Serviço da AWS) acessem esses buckets usando a ação <code class="code">s3:GetObject</code>.</p>
        </li><li class="listitem">
          <p>Você não pode usar uma política do IAM ou uma política de bucket para permitir acesso de um intervalo CIDR IPv4 da VPC. Os blocos CIDR da VPC podem ser coincidentes ou idênticos, o que poderá gerar resultados inesperados. Por isso, não é possível usar a condição <code class="code">aws:SourceIp</code> nas políticas do IAM para solicitações ao Amazon S3 por meio de um endpoint da VPC. Isso se aplica a políticas com base em identidade e a qualquer política de bucket. Se uma declaração incluir a condição <code class="code">aws:SourceIp</code>, o valor não corresponderá a nenhum endereço IP ou intervalo fornecido. Em vez disso, você pode fazer o seguinte:</p>
          <div class="itemizedlist">
             
             
          <ul class="itemizedlist"><li class="listitem">
              <p>Use tabelas de rotas para controlar quais instâncias poderão acessar recursos no Amazon S3 pelo endpoint de gateway.</p>
            </li><li class="listitem">
              <p>Use <a href="#bucket-policies-s3">políticas de bucket</a> para restringir o acesso a um endpoint específico, a uma VPC ou a um intervalo de endereço IP.</p>
            </li></ul></div>
        </li><li class="listitem">
          <p>As regras de saída do grupo de segurança para instâncias que acessam o Amazon S3 pelo endpoint de gateway devem permitir o tráfego para o Amazon S3. Você pode usar o ID da lista de prefixos do Amazon S3 como destino na regra de saída.</p>
        </li><li class="listitem">
          <p>Os endpoints de gateway são compatíveis somente com tráfego IPv4.</p>
        </li><li class="listitem">
          <p>Os endereços IPv4 de origem de instâncias nas sub-redes afetadas, tal como recebidos pelo Amazon S3, mudam de endereços IPv4 públicos para endereços IPv4 privados na VPC. Um endpoint troca as rotas de rede e desconecta as conexões TCP abertas. As conexões anteriores que usavam endereços IPv4 públicos não são retomadas. É recomendável não ter nenhuma tarefa essencial em execução ao criar ou modificar um endpoint; ou que você faça um teste para verificar se seu software consegue reconectar-se automaticamente ao Amazon S3 após a interrupção da conexão.</p>
        </li><li class="listitem">
          <p>Não é possível estender conexões de endpoint para fora de uma VPC. Recursos do outro lado de uma conexão VPN, uma conexão de emparelhamento da VPC, um gateway de trânsito ou uma conexão do AWS Direct Connect na VPC não podem usar um endpoint de gateway para se comunicar com o Amazon S3.</p>
        </li><li class="listitem">
          <p>Sua conta tem uma cota padrão de 20 endpoints de gateway por região, o que é ajustável. Há também um limite de 255 endpoints de gateway por VPC.</p>
        </li></ul></div>
     
      <h2 id="private-dns-s3">DNS privado</h2>
      <p>É possível configurar o DNS privado para otimizar os custos ao criar um endpoint de gateway e um endpoint de interface para o Amazon S3.</p>

       
        <h6>Route 53 Resolver</h6>
        <p>A Amazon fornece um servidor de DNS à VPC, o <a href="https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/resolver.html">Route 53 Resolver</a>. O Route 53 Resolver resolve automaticamente nomes de domínio de VPC locais e os registra em zonas hospedadas privadas. No entanto, não é possível usar o Route 53 Resolver de fora da sua VPC. O Route 53 fornece endpoints e regras de Resolver para que você possa usar o Route 53 Resolver por fora da VPC. Um <em>endpoint do Resolver de entrada</em> encaminha consultas de DNS da rede on-premises para o Route 53 Resolver. Um <em>endpoint do Resolver de saída</em> encaminha consultas de DNS do Route 53 Resolver para a rede on-premises.</p>
       
      <p>Quando você configura o endpoint da interface para o Amazon S3 para usar DNS privado somente para o endpoint do Resolver de entrada, criamos um endpoint do Resolver de entrada. O endpoint do Resolver de entrada resolve consultas de DNS para o Amazon S3 dos endereços IP on-premises para os endereços IP privados do endpoint da interface. Também adicionamos registros ALIAS do Route 53 Resolver à zona hospedada pública do Amazon S3 para que as consultas de DNS da sua VPC sejam resolvidas para os endereços IP públicos do Amazon S3, que roteia o tráfego para o endpoint do gateway.</p>
      
       
        <h6>DNS privado</h6>
        <p>Se você configurar o DNS privado para seu endpoint da interface para o Amazon S3, mas não configurar o DNS privado somente para o endpoint do Resolver de entrada, as solicitações da sua on-premises e da sua VPC usarão o endpoint da interface para acessar o Amazon S3. Portanto, você paga para usar o endpoint da interface para tráfego da VPC, em vez de usar o endpoint do gateway sem custo adicional.</p>
       
      <div class="mediaobject">
         
          <img src="images/s3-private-dns-default.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;          Gráfico conceitual que mostra como as solicitações do Amazon S3 são roteadas por padrão quando você tem ambos os tipos de endpoint.&#xA;        " />
         
         
      </div>
      
       
        <h6>DNS privado somente para o endpoint do Resolver de entrada</h6>
        <p>Se você configurar o DNS privado somente para o endpoint do Resolver de entrada, as solicitações da sua rede on-premises usarão o endpoint da interface para acessar o Amazon S3 e as solicitações da sua VPC usarão o endpoint do gateway para acessar o Amazon S3. Portanto, você otimiza seus custos, pois paga para usar o endpoint da interface somente para tráfego que não pode usar o endpoint do gateway.</p>
       
      <div class="mediaobject">
         
          <img src="images/s3-private-dns-inbound-endpoint.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;          Gráfico conceitual que mostra como as solicitações do Amazon S3 são roteadas quando você tem ambos os tipos de endpoint e configura o DNS privado com um endpoint do Resolver de entrada.&#xA;        " />
         
         
      </div>
      
       
        <h6>Configurar o DNS privado</h6>
        <p>É possível configurar o DNS privado para um endpoint de interface para o Amazon S3 ao criá-lo ou depois de criá-lo. Para obter mais informações, consulte <a href="./create-interface-endpoint.html#create-interface-endpoint-aws">Criar um VPC endpoint</a> (configurar durante a criação) ou <a href="./interface-endpoints.html#enable-private-dns-names">Habilitar nomes DNS privados</a> (configurar após a criação).</p>
       
     
      <h2 id="create-gateway-endpoint-s3">Criar um endpoint do gateway</h2>
      <p>Use o seguinte procedimento para criar um endpoint de gateway que se conecte ao Amazon S3.</p>
      <div class="procedure"><h6>Para criar um endpoint do gateway usando o console</h6><ol><li><p>Abra o console da Amazon VPC em <a href="https://console.aws.amazon.com/vpc/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/vpc/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
          <p>No painel de navegação, escolha <b>Endpoints</b>.</p>
        </li><li>
          <p>Escolha <b>Create endpoint (Criar endpoint)</b>.</p>
        </li><li>
          <p>Em <b>Service category</b> (Categoria de serviço), escolha <b>Serviços da AWS</b>.</p>
        </li><li>
          <p>Em <b>Services</b> (Serviços), adicione o filtro <b>Type: Gateway</b> (Tipo: gateway) e selecione <b>com.amazonaws.</b><code class="replaceable">region</code><b>.s3</b>.</p>
        </li><li>
          <p>Em <b>VPC</b>, selecione a VPC na qual deseja criar o endpoint.</p>
        </li><li>
          <p>Em <b>Route tables</b> (Tabelas de rotas), selecione as tabelas de rotas a serem usadas pelo endpoint. Adicionamos automaticamente uma rota que aponta o tráfego destinado ao serviço para a interface de rede do endpoint.</p>
        </li><li>
          <p>Em <b>Policy</b> (Política), selecione <b>Full access</b> (Acesso total) para permitir todas as operações de todas as entidades principais em todos os recursos no endpoint da VPC. Ou então selecione <b>Custom</b> (Personalizar) para anexar uma política de endpoint da VPC que controle as permissões das entidades principais para realizar ações em recursos sobre o endpoint da VPC.</p>
        </li><li>
          <p>(Opcional) Para adicionar uma tag, escolha <b>Add new tag</b> (Adicionar nova tag) e insira a chave e o valor da tag.</p>
        </li><li>
          <p>Escolha <b>Create endpoint (Criar endpoint)</b>.</p>
        </li></ol></div>
      <div class="itemizedlist">
        <h6>Para criar um endpoint de gateway usando a linha de comando</h6>
         
         
      <ul class="itemizedlist"><li class="listitem">
          <p><a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/create-vpc-endpoint.html">create-vpc-endpoint</a> (AWS CLI)</p>
        </li><li class="listitem">
          <p><a href="https://docs.aws.amazon.com/powershell/latest/reference/items/New-EC2VpcEndpoint.html">New-EC2VpcEndpoint</a> (ferramentas para Windows PowerShell)</p>
        </li></ul></div>
     
      <h2 id="bucket-policies-s3">Controlar acesso usando políticas de bucket</h2>
      <p>Você pode usar políticas de bucket para controlar o acesso a buckets de endpoints, VPCs, intervalos de endereço IP e Contas da AWS específicas.</p>
      <div class="example"><h6>exemplo Exemplo: restringir o acesso a um endpoint específico</h6><div class="example-contents"><p>Você pode criar uma política de bucket que restrinja o acesso a um endpoint da VPC específico usando a chave de condição <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#condition-keys-sourcevpce">aws:sourceVpce</a>. A seguinte política negará acesso ao bucket especificado, a menos que o endpoint de gateway especificado seja usado. Este exemplo supõe que também exista uma declaração de política que permite o acesso necessário para os seus casos de uso.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Id": "Access-to-bucket-using-specific-endpoint",
  "Statement": [
    <span>{</span>
      "Sid": "Access-to-specific-VPCE-only",
      "Effect": "Deny",
      "Principal": "*",
      "Action": "s3:*",
      "Resource": ["arn:aws:s3:::<code class="replaceable">bucket_name</code>",
                   "arn:aws:s3:::<code class="replaceable">bucket_name</code>/*"],
      "Condition": <span>{</span>
        "StringNotEquals": <span>{</span>
          "aws:sourceVpce": "<code class="replaceable">vpce-1a2b3c4d</code>"
        }
      }
    }
  ]
}</code></pre></div></div>
      <div class="example"><h6>exemplo Exemplo: restringir o acesso a uma VPC específica</h6><div class="example-contents"><p>Você pode criar uma política de bucket que restrinja o acesso a VPCs específicas usando a chave de condição <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#condition-keys-sourcevpc">aws:sourceVpc</a>. Isso será útil se houver vários endpoints configurados na mesma VPC. A seguinte política nega acesso ao bucket especificado e aos objetos que não venham da VPC especificada. Este exemplo supõe que também exista uma declaração de política que permite o acesso necessário para os seus casos de uso.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Id": "Access-to-bucket-using-specific-VPC",
  "Statement": [
    <span>{</span>
      "Sid": "Access-to-specific-VPC-only",
      "Effect": "Deny",
      "Principal": "*",
      "Action": "s3:*",
      "Resource": ["arn:aws:s3:::<code class="replaceable">example_bucket</code>",
                   "arn:aws:s3:::<code class="replaceable">example_bucket</code>/*"],
      "Condition": <span>{</span>
        "StringNotEquals": <span>{</span>
          "aws:sourceVpc": "<code class="replaceable">vpc-111bbb22</code>"
        }
      }
    }
  ]
}</code></pre></div></div>
      <div class="example"><h6>exemplo Exemplo: restringir o acesso a um intervalo de endereços IP específico</h6><div class="example-contents"><p>Você pode criar uma política que restrinja o acesso a intervalos de endereços IP específicos usando a chave de condição <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html#condition-keys-vpcsourceip">aws:VpcSourceIp</a>. A seguinte política nega acesso ao bucket especificado e aos objetos que não venham do endereço IP especificado. Este exemplo supõe que também exista uma declaração de política que permite o acesso necessário para os seus casos de uso.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Id": "Policy1415115909152",
  "Statement": [
    <span>{</span>
      "Sid": "Access-to-specific-VPC-CIDR-only",
      "Effect": "Deny",
      "Principal": "*",
      "Action": "s3:*",
      "Resource": ["arn:aws:s3:::<code class="replaceable">bucket_name</code>",
                   "arn:aws:s3:::<code class="replaceable">bucket_name</code>/*"],
      "Condition": <span>{</span>
        "NotIpAddress": <span>{</span>
          "aws:VpcSourceIp": "<code class="replaceable">172.31.0.0/16</code>"
        }
      }
    }
  ]
}</code></pre></div></div>
      <div class="example"><h6>exemplo Exemplo: restringir o acesso a buckets em uma Conta da AWS específica</h6><div class="example-contents"><p>Você pode criar uma política de bucket que restrinja o acesso a buckets do S3 em uma Conta da AWS específica usando a chave de condição <code class="code">s3:ResourceAccount</code>. A seguinte política nega o acesso a recursos que não pertençam à Conta da AWS especificada. Este exemplo supõe que também exista uma declaração de política que permite o acesso necessário para os seus casos de uso.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Id": "Policy1415115909152",
  "Statement": [
    <span>{</span>
      "Sid": "Access-to-bucket-in-specific-account-only",
      "Effect": "Deny",
      "Principal": "*",
      "Action": [
        "s3:GetObject",
        "s3:PutObject"
      ],
      "Resource": "arn:aws:s3:::*",
      "Condition": <span>{</span>
        "StringNotEquals": <span>{</span>
          "s3:ResourceAccount": "<code class="replaceable">111122223333</code>"
        }
      }
    }
  ]
}</code></pre></div></div>
     
      <h2 id="associate-route-tables-s3">Associar tabela de rotas</h2>
      <p>Você pode alterar tabelas de rotas associadas ao endpoint de gateway. Quando você associa uma tabela de rotas, adicionamos automaticamente uma rota que aponta o tráfego destinado ao serviço para a interface de rede do endpoint. Quando você desassocia uma tabela de rotas, removemos automaticamente a rota do endpoint da tabela de rotas.</p>
      <div class="procedure"><h6>Para associar tabelas de rotas usando o console</h6><ol><li><p>Abra o console da Amazon VPC em <a href="https://console.aws.amazon.com/vpc/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/vpc/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
          <p>No painel de navegação, escolha <b>Endpoints</b>.</p>
        </li><li>
          <p>Selecione o endpoint de gateway.</p>
        </li><li>
          <p>Escolha <b>Actions</b>, <b>Manage route tables</b>.</p>
        </li><li>
          <p>Selecione ou cancele a seleção das tabelas de rotas, conforme necessário.</p>
        </li><li>
          <p>Escolha <b>Modify route tables</b> (Modificar tabelas de rotas).</p>
        </li></ol></div>
      <div class="itemizedlist">
        <h6>Para associar tabelas de rotas usando a linha de comando</h6>
         
         
      <ul class="itemizedlist"><li class="listitem">
          <p><a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/modify-vpc-endpoint.html">modify-vpc-endpoint</a> (AWS CLI)</p>
        </li><li class="listitem">
          <p><a href="https://docs.aws.amazon.com/powershell/latest/reference/items/Edit-EC2VpcEndpoint.html">Edit-EC2VpcEndpoint</a> (ferramentas para Windows PowerShell)</p>
        </li></ul></div>
     
      <h2 id="edit-vpc-endpoint-policy-s3">Editar a política de endpoints da VPC</h2>
      <p>É possível editar a política de endpoint para um endpoint de gateway, que controla o acesso ao Amazon S3 da VPC até o endpoint. A política padrão permite acesso total. Para obter mais informações, consulte <a href="./vpc-endpoints-access.html#vpc-endpoint-policies">Políticas de VPC endpoint</a>.</p>
      <div class="procedure"><h6>Para alterar a política de endpoint usando o console</h6><ol><li><p>Abra o console da Amazon VPC em <a href="https://console.aws.amazon.com/vpc/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/vpc/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
          <p>No painel de navegação, escolha <b>Endpoints</b>.</p>
        </li><li>
          <p>Selecione o endpoint de gateway.</p>
        </li><li>
          <p>Escolha <b>Actions</b> (Ações), <b>Manage policy</b> (Gerenciar política).</p>
        </li><li>
          <p>Escolha <b>Full Access</b> (Acesso total) para permitir acesso total ao serviço ou escolha <b>Custom</b> (Personalizado) e anexe uma política personalizada.</p>
        </li><li>
          <p>Escolha <b>Save</b> (Salvar).</p>
        </li></ol></div>

      <p>Veja a seguir exemplos de políticas de endpoint para acessar o Amazon S3.</p>
      <div class="example"><h6>exemplo Exemplo: restringir acesso a um bucket específico</h6><div class="example-contents"><p>Você pode criar uma política que restrinja o acesso a somente alguns buckets do S3. Isso será útil se houver outros Serviços da AWS em sua VPC que usem buckets do S3.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Sid": "AccessToSpecificBucket",
  "Effect": "Allow",
  "Principal": "*",
  "Action": [
     "s3:ListBucket",
     "s3:GetObject",
     "s3:PutObject"
  ],
  "Resource": [
     "arn:aws:s3:::<code class="replaceable">bucket_name</code>",
     "arn:aws:s3:::<code class="replaceable">bucket_name</code>/*"
  ]
}</code></pre></div></div>
      <div class="example"><h6>exemplo Exemplo: restringir acesso a um perfil do IAM específico</h6><div class="example-contents"><p>Você pode criar uma política que restrinja o acesso a perfil do IAM específico. É necessário usar <code class="code">aws:PrincipalArn</code> para conceder acesso a uma entidade principal.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Sid": "Restrict-access-to-specific-IAM-role",
  "Effect": "Allow",
  "Principal": "*",
  "Action": "*",
  "Resource": "*",
  "Condition": <span>{</span>
    "ArnEquals": <span>{</span>
      "aws:PrincipalArn": "arn:aws:iam::<code class="replaceable">111122223333</code>:role/<code class="replaceable">role_name</code>"
    }
  }
}</code></pre></div></div>
      <div class="example"><h6>exemplo Exemplo: restringir o acesso a usuários em uma conta específica</h6><div class="example-contents"><p>Você pode criar uma política que restrinja o acesso a uma conta específica. É necessário usar <code class="code">aws:PrincipalArn</code> para conceder acesso a uma entidade principal.</p><pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copiar"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Sid": "AllowCallersFromAccount111122223333",
  "Effect": "Allow",
  "Principal": "*",
  "Action": "*",
  "Resource": "*",
  "Condition": <span>{</span>
    "StringEquals": <span>{</span>
      "aws:PrincipalArn": "<code class="replaceable">111122223333</code>"
    }
  }
}</code></pre></div></div>
     
      <h2 id="delete-gateway-endpoint-s3">Excluir um endpoint de gateway</h2>
      <p>Quando não precisar mais de um endpoint de gateway, você poderá excluí-lo. Quando você exclui um endpoint de gateway, removemos a rota do endpoint das tabelas de rotas da sub-rede.</p>
      <p>Não é possível excluir um endpoint de gateway quando o DNS privado está habilitado.</p>
      <div class="procedure"><h6>Para excluir um endpoint de gateway do cliente usando o console</h6><ol><li><p>Abra o console da Amazon VPC em <a href="https://console.aws.amazon.com/vpc/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/vpc/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>.</p></li><li>
          <p>No painel de navegação, escolha <b>Endpoints</b>.</p>
        </li><li>
          <p>Selecione o endpoint de gateway.</p>
        </li><li>
          <p>Escolha <b>Actions</b> (Ações), <b>Delete VPC endpoints</b> (Excluir endpoints da VPC). </p>
        </li><li>
          <p>Quando a confirmação for solicitada, insira <code class="userinput">delete</code>.</p>
        </li><li>
          <p>Escolha <b>Delete</b> (Excluir).</p>
        </li></ol></div>
      <div class="itemizedlist">
        <h6>Para excluir um endpoint de gateway do cliente usando a linha de comando</h6>
         
         
      <ul class="itemizedlist"><li class="listitem">
          <p><a href="https://docs.aws.amazon.com/cli/latest/reference/ec2/delete-vpc-endpoints.html">delete-vpc-endpoints</a> (AWS CLI)</p>
        </li><li class="listitem">
          <p><a href="https://docs.aws.amazon.com/powershell/latest/reference/items/Remove-EC2VpcEndpoint.html">Remove-EC2VpcEndpoint</a> (ferramentas para Windows PowerShell)</p>
        </li></ul></div>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Atenção" /> <strong>O Javascript está desativado ou não está disponível no seu navegador.</strong></p><p>Para usar a documentação da AWS, o Javascript deve estar ativado. Consulte as páginas de Ajuda do navegador para obter instruções.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Convenções do documento</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./gateway-endpoints.html">Endpoints de gateway</div><div id="next" class="next-link" accesskey="n" href="./vpc-endpoints-ddb.html">Endpoints para o DynamoDB</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Essa página foi útil? - Sim</div><div class="content"><p>Obrigado por nos informar que estamos fazendo um bom trabalho!</p><p>Se tiver tempo, conte-nos sobre o que você gostou para que possamos melhorar ainda mais.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=PrivateLink&amp;topic_url=https://docs.aws.amazon.com/pt_br/vpc/latest/privatelink/vpc-endpoints-s3.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Essa página foi útil? - Não</div><div class="content"><p>Obrigado por nos informar que precisamos melhorar a página. Lamentamos ter decepcionado você.</p><p>Se tiver tempo, conte-nos como podemos melhorar a documentação.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=PrivateLink&amp;topic_url=https://docs.aws.amazon.com/pt_br/vpc/latest/privatelink/vpc-endpoints-s3.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>