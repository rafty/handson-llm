<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="zh-TW"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>亞馬遜。 KendraSearchIntent - Amazon Lex</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="built-in-intent-kendra-search" /><meta name="default_state" content="built-in-intent-kendra-search" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_tw/lexv2/latest/dg/built-in-intent-kendra-search.html" /><meta name="description" content="若要搜尋已使用 Amazon Kendra 編製索引的文件，請使用 AMAZON.KendraSearchIntent 意圖。當 Amazon Lex V2 無法判斷與使用者交談中的下一個動作時，會觸發搜尋意圖。" /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon Lex" /><meta name="guide" content="V2 開發者指南" /><meta name="abstract" content="提供 Amazon Lex V2 的概念性概觀。包含使用各種功能 (例如串流交談) 的詳細說明，並提供 V2 API 的完整參考資料。" /><meta name="guide-locale" content="zh_tw" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_tw/lexv2/latest/dg/built-in-intent-kendra-search.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/lexv2/latest/dg/built-in-intent-kendra-search.html" hreflang="x-default" /><meta name="feedback-item" content="Lex" /><meta name="this_doc_product" content="Amazon Lex" /><meta name="this_doc_guide" content="V2 開發者指南" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'lex'}"></script><meta id="panorama-serviceSubSection" value="V2 開發者指南" /><meta id="panorama-serviceConsolePage" value="亞馬遜。 KendraSearchIntent" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>亞馬遜。 KendraSearchIntent - Amazon Lex</title><meta name="pdf" content="lex2.0.pdf#built-in-intent-kendra-search" /><meta name="rss" content="amazon-lex-v2-document-history.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=251" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lex&amp;topic_url=http://docs.aws.amazon.com/zh_tw/lexv2/latest/dg/built-in-intent-kendra-search.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/zh_tw/lexv2/latest/dg/built-in-intent-kendra-search.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/zh_tw/lexv2/latest/dg/built-in-intent-kendra-search.html" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon Lex",
        "item" : "https://docs.aws.amazon.com/lex/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "V2 開發者指南",
        "item" : "https://docs.aws.amazon.com/zh_tw/lexv2/latest/dg"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "建築機器人",
        "item" : "https://docs.aws.amazon.com/zh_tw/lexv2/latest/dg/building-bots.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "內建意圖和插槽類型",
        "item" : "https://docs.aws.amazon.com/zh_tw/lexv2/latest/dg/built-in.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "內建槽",
        "item" : "https://docs.aws.amazon.com/zh_tw/lexv2/latest/dg/howitworks-builtins-intents.html"
      },
      {
        "@type" : "ListItem",
        "position" : 7,
        "name" : "亞馬遜。 KendraSearchIntent",
        "item" : "https://docs.aws.amazon.com/zh_tw/lexv2/latest/dg/howitworks-builtins-intents.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="lex2.0.pdf#built-in-intent-kendra-search" target="_blank" rel="noopener noreferrer" title="開啟 PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">文件</a><a href="/lex/index.html">Amazon Lex</a><a href="what-is.html">V2 開發者指南</a></div><div id="page-toc-src"><a href="#kendra-search-iam">IAM 政策</a><a href="#kendra-search-filter">使用請求和工作階段屬性作為篩選條件</a><a href="#kendra-search-response">使用搜尋回應</a><a href="#kendra-search-lambda">使用 Lambda 函數來管理請求和回應</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><awsui-alert class="awsdocs-page-banner awsui-util-mb-l"><p>本文為英文版的機器翻譯版本，如內容有任何歧義或不一致之處，概以英文版為準。</p></awsui-alert><h1 class="topictitle" id="built-in-intent-kendra-search">亞馬遜。 KendraSearchIntent</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>若要搜尋已使用 Amazon Kendra 編製索引的文件，請使用<code class="code">AMAZON.KendraSearchIntent</code>意圖。當 Amazon Lex V2 無法判斷與使用者交談中的下一個動作時，會觸發搜尋意圖。</p><p>只<code class="code">AMAZON.KendraSearchIntent</code>有英文 (美國) (en-US) (en-US) (en-US) 及歐洲 (愛爾蘭) 及歐洲 (愛爾蘭) 及歐洲 (愛爾蘭) 區域</p><p>Amazon Kendra 是一種 machine-learning-based 搜索服務，用於索引自然語言文檔，如 PDF 文檔或微軟 Word 文件。它可以搜尋已編製索引的文件，並傳回下列類型的問題回覆：</p><div class="itemizedlist">
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>解答 </p>
                </li><li class="listitem">
                    <p>可能回答問題的常見問題項目</p>
                </li><li class="listitem">
                    <p>與問題相關的文件</p>
                </li></ul></div><p>如需使用 <code class="code">AMAZON.KendraSearchIntent</code> 的範例，請參閱<a href="./faq-bot-kendra-search.html">範例：為 Amazon Kendra 索引建立常見問題集機器人</a>。</p><p>如果您設定機器人的<code class="code">AMAZON.KendraSearchIntent</code>意圖，Amazon Lex V2 會在無法判斷使用者意圖的話語時呼叫意圖。如果沒有來自 Amazon Kendra 的回應，交談會依照機器人中的設定繼續進行。</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p> Amazon Lex V2 目前不支援插槽引出<code class="code">AMAZON.KendraSearchIntent</code>期間。如果 Amazon Lex V2 無法判斷插槽的使用者話語，它會呼叫<code class="code">AMAZON.FallbackIntent</code>.</p></div></div><p>當您在相同的機器人<code class="code">AMAZON.FallbackIntent</code>中<code class="code">AMAZON.KendraSearchIntent</code>搭配使用時，Amazon Lex V2 會使用意圖，如下所示：</p><div class="orderedlist">
                 
                 
                 
                 
            <ol><li>
                    <p>Amazon Lex V2 調用<code class="code">AMAZON.KendraSearchIntent</code>。意圖呼叫 Amazon Kendra<code class="code">Query</code> 操作。</p>
                </li><li>
                    <p>如果 Amazon Kendra 傳回回應，Amazon Lex V2 會向使用者顯示結果。</p>
                </li><li>
                    <p>如果沒有來自 Amazon Kendra 的回應，Amazon Lex V2 會重新提示用戶。下一個動作取決於來自使用者的回應。</p>
                    <div class="itemizedlist">
                         
                         
                    <ul class="itemizedlist"><li class="listitem">
                            <p>如果使用者的回應包含 Amazon Lex V2 可辨識的話語 (例如填入插槽值或確認意圖)，則與使用者的交談會按照機器人的設定繼續進行。</p>
                        </li><li class="listitem">
                            <p>如果使用者的回應不包含 Amazon Lex V2 可辨識的話語，Amazon Lex V2 會再次呼叫該<code class="code">Query</code>作業。</p>
                        </li></ul></div>
                </li><li>
                    <p>如果設定的重試次數後沒有回應，Amazon Lex V2 會呼叫<code class="code">AMAZON.FallbackIntent</code>並結束與使用者的對話。</p>
                </li></ol></div><p>有三種方法可以使用<code class="code">AMAZON.KendraSearchIntent</code>向 Amazon Kendra 發出請求：</p><div class="itemizedlist">
                 
                 
                 
            <ul class="itemizedlist"><li class="listitem">
                    <p>讓搜索意圖為您提出請求。Amazon Lex V2 調用 Amazon Kendra，並將用戶的話語作為搜索字符串。建立意圖時，您可以定義查詢篩選字串，以限制 Amazon Kendra 傳回的回應數量。Amazon Lex V2 會在查詢請求中使用篩選器。</p>
                </li><li class="listitem">
                    <p>使用 Lambda 函數將其他查詢參數新增至請求，以縮小搜尋結果範圍。您可以將包含 Amazon Kendra 查詢參數的<code class="code">kendraQueryFilterString</code>欄位新增至對<code class="code">delegate</code>話方塊動作。當您使用 Lambda 函數將查詢參數新增至請求時，它們的優先順序會高於您建立意圖時定義的查詢篩選器。</p>
                </li><li class="listitem">
                    <p>使用 Lambda 函數建立新查詢。您可以建立 Amazon Lex V2 傳送的完整亞馬遜肯德拉查詢請求。您可以在 <code class="code">delegate</code> 對話方塊動作的 <code class="code">kendraQueryRequestPayload</code> 欄位中指定查詢。<code class="code">kendraQueryRequestPayload</code> 欄位的優先順序高於 <code class="code">kendraQueryFilterString</code> 欄位。</p>
                </li></ul></div><p>若要在建立機器人時指定<code class="code">queryFilterString</code>參數，或在對話方塊 Lambda 函數中呼叫<code class="code">delegate</code>動作時指定<code class="code">kendraQueryFilterString</code>欄位，請指定用作 Amazon Kendra 查詢屬性篩選器的字串。如果字串不是有效的屬性篩選條件，則您會在執行時間取得 <code class="code">InvalidBotConfigException</code> 例外狀況。如需有關屬性篩選器的詳細資訊，請參閱 <em>Amazon Kendra 開發人員指南</em>中的<a href="https://docs.aws.amazon.com/kendra/latest/dg/filtering.html#search-filtering">使用文件屬性篩選查詢</a>。</p><p>若要控制 Amazon Lex V2 傳送至 Amazon Kendra 的查詢，您可以在 Lambda 函數的<code class="code">kendraQueryRequestPayload</code>欄位中指定查詢。如果查詢無效，Amazon Lex V2 會傳回<code class="code">InvalidLambdaResponseException</code>例外狀況。如需詳細資訊，請參閱 <em>Amazon Kendra 開發人員指南</em>中的<a href="https://docs.aws.amazon.com/kendra/latest/dg/API_Query.html">查詢操作</a>。</p><p>如需使用 <code class="code">AMAZON.KendraSearchIntent</code> 的範例，請參閱<a href="./faq-bot-kendra-search.html">範例：為 Amazon Kendra 索引建立常見問題集機器人</a>。</p>
                <h2 id="kendra-search-iam">Amazon Kendra 搜尋的 IAM 政策</h2>
                <p>若要使用<code class="code">AMAZON.KendraSearchIntent</code>意圖，您必須使用提供AWS Identity and Access Management (IAM) 政策的角色，讓 Amazon Lex V2 承擔具有呼叫 Amazon Kendra<code class="code">Query</code> 意圖之權限的執行階段角色。您使用的 IAM 設定取決於您是<code class="code">AMAZON.KendraSearchIntent</code>使用 Amazon Lex V2 主控台建立，還是使用 AWS 開發套件或AWS Command Line Interface (AWS CLI) 來建立。使用主控台時，您可以選擇新增將 Amazon Kendra 呼叫到 Amazon Lex V2 服務連結角色的權限，或使用專門用於呼叫 Amazon Kendra<code class="code">Query</code> 操作的角色。當您使用 AWS CLI 或開發套件建立意圖時，您必須使用專門用於呼叫 <code class="code">Query</code> 操作的角色。</p>
                 
                    <h3 id="kendra-iam-attach">連接許可 </h3>
                    <p>您可以使用主控台連接許可，將 Amazon Kendra<code class="code">Query</code> 操作存取到預設的 Amazon Lex V2 服務連結角色。將許可附加到服務連結角色時，您不需要建立和管理專門用於連線至 Amazon Kendra 索引的執行時期角色。</p>
                    <p>您用來存取 Amazon Lex V2 主控台的使用者、角色或群組必須具有管理角色政策的許可。將以下 IAM 政策連接至主控台存取角色。當您授與這些許可時，角色具有變更現有的服務連結角色政策的許可。</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "iam:AttachRolePolicy",
                "iam:PutRolePolicy",
                "iam:GetRolePolicy"
            ],
            "Resource": "arn:aws:iam::*:role/aws-service-role/lexv2.amazonaws.com/AWSServiceRoleForLexBots*"
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": "iam:ListRoles",
            "Resource": "*"
        }
    ]
}</code></pre>
                 
                 
                    <h3 id="kendra-iam-role">指定角色 </h3>
                    <p>您可以使用主控台AWS CLI、或 API 來指定呼叫 Amazon Kendra<code class="code">Query</code> 作業時要使用的執行階段角色。</p>
                    <p>您用來指定執行階段角色的使用者、角色或群組必須具有<code class="code">iam:PassRole</code>權限。下列政策會定義許可。您可以使用 <code class="code">iam:AssociatedResourceArn</code> 和 <code class="code">iam:PassedToService</code> 條件內容鍵來進一步限制許可的範圍。如需詳細資訊，請參閱<em>AWS Identity and Access Management使用指南</em>中的 <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_iam-condition-keys.html">IAM 和AWS STS條件內容金鑰</a>。</p>
                    <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": "iam:PassRole",
            "Resource": "arn:aws:iam::<code class="replaceable">account</code>:role/<code class="replaceable">role</code>"
        }
    ]
}</code></pre>
                    <p>Amazon Lex V2 需要用來呼叫 Amazon Kendra 的執行階段角色必須具有<code class="code">kendra:Query</code>許可。當您使用現有的 IAM 角色獲得呼叫 Amazon Kendra<code class="code">Query</code> 操作的許可時，該角色必須附加以下政策。</p>
                    <p>您可以使用 IAM 主控台、IAM API 或建AWS CLI立政策並將其連接至角色。這些指示會使用 AWS CLI 來建立角色和政策。</p>
                    <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>下列程式碼是針對 Linux 和 MacOS 格式化的。若為 Windows，請將接續字元 (\) 取代為插入符號 (^)。</p></div></div>
                    <div class="procedure"><h6>將查詢操作許可新增至角色</h6><ol><li>
                            <p>在目前目錄中建立一個稱為 <code class="userinput">KendraQueryPolicy.json</code> 的文件、將下列程式碼新增至其中，然後儲存它</p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "kendra:Query"
            ],
            "Resource": [
                "arn:aws:kendra:<code class="replaceable">region</code>:<code class="replaceable">account</code>:index/<code class="replaceable">index ID</code>"
            ]
        }
    ]
}</code></pre>
                        </li><li>
                            <p>在中AWS CLI，執行下列命令以建立用於執行 Amazon Kendra<code class="code">Query</code> 作業的 IAM 政策。</p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iam create-policy \
    --policy-name <code class="replaceable">query-policy-name</code> \
    --policy-document file://KendraQueryPolicy.json</code></pre>
                        </li><li>
                            <p>將政策連接至您用來呼叫該<code class="code">Query</code>操作的 IAM 角色。</p>
                            <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight">aws iam attach-role-policy \
    --policy-arn arn:aws:iam::<code class="replaceable">account-id</code>:policy/<code class="replaceable">query-policy-name</code>
    --role-name <code class="replaceable">role-name</code></code></pre>
                        </li></ol></div>
                    <p>您可以選擇更新 Amazon Lex V2 服務連結角色，或使用為機器人建立時建立<code class="code">AMAZON.KendraSearchIntent</code>的角色。以下程序會說明如何選擇要使用的 IAM 角色。</p>
                    <div class="procedure"><h6>若要指定 AMAZON 的執行階段角色。 KendraSearchIntent</h6><ol><li>
                            <p>登入，AWS Management Console並在 <a href="https://console.aws.amazon.com/lex/" rel="noopener noreferrer" target="_blank"><span>https://console.aws.amazon.com/lex/</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a> 開啟 Amazon Lex 主控台。</p>
                        </li><li>
                            <p>選擇您要新增 <code class="code">AMAZON.KendraSearchIntent</code> 的機器人。</p>
                        </li><li>
                            <p>選擇 <b>Intents (意圖)</b> 旁邊的加號 (+)。</p>
                        </li><li>
                            <p>在 <b>Add intent (新增意圖)</b> 中，選擇 <b>Search existing intents (搜尋現有的意圖)</b>。</p>
                        </li><li>
                            <p>在 <b>Search intents (搜尋意圖)</b> 中，輸入 <code class="userinput">AMAZON.KendraSearchIntent</code> 然後選擇 <b>Add (新增)</b>。</p>
                        </li><li>
                            <p>在 <b>Copy built-in intent (複製內建意圖)</b> 中，輸入意圖的名稱，例如 <code class="userinput">KendraSearchIntent</code>，然後選擇 <b>Add (新增)</b>。</p>
                        </li><li>
                            <p>開啟 <b>Amazon Kendra query (Amazon Kendra 查詢)</b> 部分。</p>
                        </li><li>
                            <p>在 <b>IAM role (IAM 角色)</b> 下，選擇以下其中一個選項：</p>
                            <div class="itemizedlist">
                                 
                                 
                            <ul class="itemizedlist"><li class="listitem">
                                    <p>若要更新 Amazon Lex V2 服務連結角色，讓您的機器人能夠查詢 Amazon Kendra 索引，請選擇新<b>增 Amazon Kendra 許</b>可。</p>
                                </li><li class="listitem">
                                    <p>若要使用具有呼叫 Amazon Kendra<code class="code">Query</code> 作業之權限的角色，請選擇「<b>使用現有角色</b>」。</p>
                                </li></ul></div>
                        </li></ol></div>
                 
             
                <h2 id="kendra-search-filter">使用請求和工作階段屬性作為篩選條件</h2>
                <p>若要篩選 Amazon Kendra 對與目前對話相關項目的回應，請在建立機器人時新增<code class="code">queryFilterString</code>參數，使用工作階段和請求屬性做為篩選器。您可以在建立意圖時指定屬性的預留位置，然後 Amazon Lex V2 會在呼叫 Amazon Kendra 之前替換值。如需請求屬性的詳細資訊，請參閱<a href="./context-mgmt-request-attribs.html">設定請求屬性</a>。如需工作階段屬性的詳細資訊，請參閱 <a href="./context-mgmt-session-attribs.html">工作階段屬性</a>。</p>
                <p>以下是使用字串篩選 Amazon Kendra 查詢的<code class="code">queryFilterString</code>參數範例。</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"<span>{</span>"equalsTo": <span>{</span>"key": "City", "value": <span>{</span>"stringValue": "Seattle"}}}"</code></pre>
                <p>以下是使用名<code class="code">"SourceURI"</code>為篩選 Amazon Kendra 查詢的工作階段屬性的<code class="code">queryFilterString</code>參數範例。</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"<span>{</span>"equalsTo": <span>{</span>"key": "SourceURI","value": <span>{</span>"stringValue": "[FileURL]"}}}"</code></pre>
                <p>以下是使用名為篩選 Amazon Kendra 查詢的請求<code class="code">"DepartmentName"</code>屬性的<code class="code">queryFilterString</code>參數範例。</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"<span>{</span>"equalsTo": <span>{</span>"key": "Department","value": <span>{</span>"stringValue": "((DepartmentName))"}}}"</code></pre>
                <p>這些<code class="code">AMAZON.KendraSearchInteng</code>篩選器使用與 Amazon Kendra 搜尋篩選器相同的格式。如需詳細資訊，請參閱 <em>Amazon Kendra 開發人員指南</em>中的<a href="https://docs.aws.amazon.com/kendra/latest/dg/filtering.html#search-filtering">使用文件屬性篩選搜尋結果</a>。</p>
                <p>搭配使用的查詢篩選字串<code class="code">AMAZON.KendraSearchIntent</code>必須為每個篩選器的第一個字母使用小寫字母。例如，以下是的有效查詢篩選器<code class="code">AMAZON.KendraSearchIntent</code>。</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "andAllFilters": [
        <span>{</span>
            "equalsTo": <span>{</span>
                "key": "City",
                "value": <span>{</span>
                    "stringValue": "Seattle"
                }
            }
        },
        <span>{</span>
            "equalsTo": <span>{</span>
                "key": "State",
                "value": <span>{</span>
                    "stringValue": "Washington"
                }
            }
        }
    ]
}</code></pre>
             
                <h2 id="kendra-search-response">使用搜尋回應</h2>
                <p>Amazon Kendra 會從意圖的<code class="code">IntentClosingSetting</code>陳述式回應中傳回搜尋的回應。除非 Lambda 函數產生結束回應訊息，否則意圖必須有<code class="code">closingResponse</code>陳述式。</p>
                <p>Amazon Kendra 有五種類型的回應。</p>
                <div class="itemizedlist">
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>下列兩個回應需要為您的 Amazon Kendra 索引設定常見問題集。如需詳細資訊，請參閱<a href="https://docs.aws.amazon.com/kendra/latest/dg/in-creating-faq.html">將問題和答案直接新增至索引</a>。</p>
                        <div class="itemizedlist">
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p> <code class="code">x-amz-lex:kendra-search-response-question_answer-question-&lt;N&gt;</code>— 來自與搜索匹配的常見問題解答的問題。</p>
                            </li><li class="listitem">
                                <p> <code class="code">x-amz-lex:kendra-search-response-question_answer-answer-&lt;N&gt;</code>— 來自與搜索匹配的常見問題解答的答案。</p>
                            </li></ul></div>                        
                    </li><li class="listitem">
                        <p>下列三個回應需要為 Amazon Kendra 索引設定資料來源。有關詳情，請參閱<a href="https://docs.aws.amazon.com/kendra/latest/dg/data-source.html">建立資料來源</a>。</p>
                        <div class="itemizedlist">
                             
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p><code class="code">x-amz-lex:kendra-search-response-document-&lt;N&gt;</code>— 摘錄自索引中的文件，該文件與語音文字相關。</p>
                            </li><li class="listitem">
                                <p><code class="code">x-amz-lex:kendra-search-response-document-link-&lt;N&gt;</code>— 索引中與語音文字相關的文件 URL。</p>
                            </li><li class="listitem">
                                <p><code class="code">x-amz-lex:kendra-search-response-answer-&lt;N&gt;</code>— 索引中文件摘錄，可回答問題。</p>
                            </li></ul></div>
                    </li></ul></div>
                <p>回應會以 <code class="code">request</code> 屬性傳回。每個屬性最多可有五個回應，編號為 1 到 5。如需有關回<a href="https://docs.aws.amazon.com/kendra/latest/dg/response-types.html">應的詳細資訊，請參閱 <em>Amazon Kendra 開發人員指南</em>中的回應類型</a>。</p>
                <p><code class="code">closingResponse</code> 陳述式必須有一或多個訊息群組。每個訊息群組都包含一或多個訊息。每個訊息都可以包含一或多個預留位置變數，這些變數會在 Amazon Kendra 回應中由請求屬性取代。訊息群組中必須至少有一個訊息，而訊息中的所有變數都會由執行時間回應中的請求屬性值取代，或是群組中必須具有無預留位置變數的訊息。請求屬性會以雙括號 ("((" "))") 括起來。下列訊息群組訊息符合來自 Amazon Kendra 的任何回應：</p>
                <div class="itemizedlist">
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>「我為您找到了一個常見問題解kendra-search-response-question答問題x-amz-lex：（（（：_ 答案-問題 -1）），答案是（（x-amz-lex：kendra-search-response-question答案 -1））」</p>
                    </li><li class="listitem">
                        <p>「我從一個有用的文檔中找到了摘錄 :(（x-amz-lex：kendra-search-response-document-1））」</p>
                    </li><li class="listitem">
                        <p>「我認為你的問題的答案是（（x-amz-lex：kendra-search-response-answer-1））」</p>
                    </li></ul></div>
             
                <h2 id="kendra-search-lambda">使用 Lambda 函數來管理請求和回應</h2>
                <p><code class="code">AMAZON.KendraSearchIntent</code>意圖可以使用您的對話方塊程式碼掛接和履行代碼勾點來管理傳送給 Amazon Kendra 的請求和回應。當您想要修改傳送至 Amazon Kendra 的查詢時，請使用對話方塊程式碼掛接 Lambda 函數，而當您要修改回應時，履行程式碼會掛接 Lambda 函數。</p>
                 
                    <h3 id="kendra-search-lambda-dialog">使用對話方塊程式碼掛勾建立查詢</h3>
                    <p>您可以使用對話方塊程式碼掛接來建立要傳送至 Amazon Kendra 的查詢。使用對話方塊程式碼掛勾是選用的。如果您未指定對話方塊程式碼勾點，Amazon Lex V2 會根據使用者的話語建構查詢，並使用您在設定意圖時提供的查詢 (如果您提供的話)。<code class="code">queryFilterString</code></p>
                    <p>您可以使用對話方塊程式碼勾點回應中的兩個欄位來修改 Amazon Kendra 的請求：</p>
                    <div class="itemizedlist">
                         
                         
                    <ul class="itemizedlist"><li class="listitem">
                            <p><code class="code">kendraQueryFilterString</code>— 使用此字串可指定 Amazon Kendra 請求的屬性篩選器。您可以使用索引中定義的任何索引欄位來篩選查詢。如需篩選字串的結構，請參閱 <em>Amazon Kendra 開發人員指南</em>中的<a href="https://docs.aws.amazon.com/kendra/latest/dg/filtering.html#search-filtering">使用文件屬性篩選查詢</a>。如果指定的篩選字串無效，您會取得 <code class="code">InvalidLambdaResponseException</code> 例外狀況。<code class="code">kendraQueryFilterString</code> 字串會覆寫為意圖所設定的 <code class="code">queryFilterString</code> 中指定的任何查詢字串。</p>
                        </li><li class="listitem">
                            <p><code class="code">kendraQueryRequestPayload</code>— 使用此字串可指定 Amazon Kendra 查詢。您的查詢可以使用 Amazon Kendra 的任何功能。如果您沒有指定有效的查詢，您會取得 <code class="code">InvalidLambdaResponseException</code> 例外狀況。如需詳細資訊，請參閱 <em>Amazon Kendra 開發人員指南</em>中的<a href="https://docs.aws.amazon.com/kendra/latest/dg/API_Query.html">查詢</a>。</p>
                        </li></ul></div>
                    <p>建立篩選器或查詢字串之後，您可以將回應傳送至 Amazon Lex V2，並將回應<code class="code">dialogAction</code>欄位設定為<code class="code">delegate</code>。Amazon Lex V2 會將查詢傳送至 Amazon Kendra，然後將查詢回應傳回至履行代碼勾點。</p>
                 
                 
                    <h3 id="kendra-search-lambda-fulfillment">針對回應使用履行程式碼掛勾</h3>
                    <p>Amazon Lex V2 將查詢傳送至 Amazon Kendra 之後，查詢回應就會傳回至<code class="code">AMAZON.KendraSearchIntent</code>履行 Lambda 函數。代碼鉤子的輸入事件包含來自 Amazon Kendra 的完整響應。查詢資料的結構與 Amazon Kendra<code class="code">Query</code> 作業傳回的資料結構相同。如需詳細資訊，請參閱 <em>Amazon Kendra 開發人員指南</em>中的<a href="https://docs.aws.amazon.com/kendra/latest/dg/API_Query.html#API_Query_ResponseSyntax">查詢回應語法</a>。</p>
                    <p>履行程式碼掛勾是選用的。如果不存在，或程式碼掛鉤未在回應中傳回訊息，Amazon Lex V2 會使用該<code class="code">closingResponse</code>陳述式進行回應。</p>
                 
            <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="警告" /> <strong>您的瀏覽器已停用或無法使用 Javascript。</strong></p><p>您必須啟用 Javascript，才能使用 AWS 文件。請參閱您的瀏覽器說明頁以取得說明。</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">文件慣用形式</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./built-in-intent-help.html">亞馬遜。 HelpIntent</div><div id="next" class="next-link" accesskey="n" href="./faq-bot-kendra-search.html">範例：為 Amazon Kendra 索引建立常見問題集機器人</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">此頁面是否有幫助？ - 是</div><div class="content"><p>感謝您，讓我們知道我們做得很好！</p><p>若您有空，歡迎您告知我們值得讚許的地方，這樣才能保持良好服務。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="意見回饋" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lex&amp;topic_url=https://docs.aws.amazon.com/zh_tw/lexv2/latest/dg/built-in-intent-kendra-search.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">此頁面是否有幫助？ - 否</div><div class="content"><p>感謝讓我們知道此頁面仍須改善。很抱歉，讓您失望。</p><p>若您有空，歡迎您提供改善文件的方式。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="意見回饋" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=Lex&amp;topic_url=https://docs.aws.amazon.com/zh_tw/lexv2/latest/dg/built-in-intent-kendra-search.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>