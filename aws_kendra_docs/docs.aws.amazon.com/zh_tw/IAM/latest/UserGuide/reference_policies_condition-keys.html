<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="zh-TW"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>AWS 全域條件內容索引鍵 - AWS Identity and Access Management</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="reference_policies_condition-keys" /><meta name="default_state" content="reference_policies_condition-keys" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference_policies_condition-keys.html" /><meta name="description" content="說明可用於 IAM 政策的每個 AWS 全域條件金鑰。" /><meta name="deployment_region" content="IAD" /><meta name="product" content="AWS Identity and Access Management" /><meta name="guide" content="使用者指南" /><meta name="abstract" content="透過使用者身分 (身分驗證) 和定義特定許可 (授權) 的政策，控制存取您的 AWS 資源。" /><meta name="guide-locale" content="zh_tw" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference_policies_condition-keys.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_policies_condition-keys.html" hreflang="x-default" /><meta name="feedback-item" content="IAM" /><meta name="this_doc_product" content="AWS Identity and Access Management" /><meta name="this_doc_guide" content="使用者指南" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'iam'}"></script><meta id="panorama-serviceSubSection" value="使用者指南" /><meta id="panorama-serviceConsolePage" value="AWS 全域條件內容索引鍵" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>AWS 全域條件內容索引鍵 - AWS Identity and Access Management</title><meta name="pdf" content="iam-ug.pdf#reference_policies_condition-keys" /><meta name="rss" content="aws-iam-release-notes.rss" /><meta name="forums" content="http://forums.aws.amazon.com/forum.jspa?forumID=76" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=http://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference_policies_condition-keys.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference_policies_condition-keys.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference_policies_condition-keys.html" /><meta name="keywords" content="IAM,AWS Identity and Access Management,IAM 使用者,使用者,IAM 群組,群組,IAM 角色,角色,許可政策,信任政策,政策,存取金鑰,密碼,資源 OU ID" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "AWS Identity and Access Management",
        "item" : "https://docs.aws.amazon.com/iam/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "使用者指南",
        "item" : "https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "AWS Identity and Access Management 的參考資訊。",
        "item" : "https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "IAM JSON 政策參考",
        "item" : "https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference_policies.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "AWS 全域條件內容索引鍵",
        "item" : "https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference_policies.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="iam-ug.pdf#reference_policies_condition-keys" target="_blank" rel="noopener noreferrer" title="開啟 PDF"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">文件</a><a href="/iam/index.html">AWS Identity and Access Management</a><a href="introduction.html">使用者指南</a></div><div id="page-toc-src"><a href="#condition-keys-calledvia">CalledVia</a><a href="#condition-keys-calledviafirst">CalledViaFirst</a><a href="#condition-keys-calledvialast">CalledViaLast</a><a href="#condition-keys-currenttime">CurrentTime</a><a href="#condition-keys-ec2instancesourcevpc">Ec2InstanceSourceVpc</a><a href="#condition-keys-ec2instancesourceprivateip4">Ec2InstanceSourcePrivateIPv4</a><a href="#condition-keys-epochtime">EpochTime</a><a href="#condition-keys-federatedprovider">FederatedProvider</a><a href="#condition-keys-multifactorauthage">MultiFactorAuthAge</a><a href="#condition-keys-multifactorauthpresent">MultiFactorAuthPresent</a><a href="#condition-keys-principalaccount">PrincipalAccount</a><a href="#condition-keys-principalarn">PrincipalArn</a><a href="#condition-keys-principalisawsservice">PrincipalIsAWSService</a><a href="#condition-keys-principalorgid">PrincipalOrgID</a><a href="#condition-keys-principalorgpaths">PrincipalOrgPaths</a><a href="#condition-keys-principalservicename">PrincipalServiceName</a><a href="#condition-keys-principalservicenameslist">PrincipalServiceNamesList</a><a href="#condition-keys-principaltag">PrincipalTag</a><a href="#condition-keys-principaltype">PrincipalType</a><a href="#condition-keys-referer">Referer</a><a href="#condition-keys-requestedregion">RequestedRegion</a><a href="#condition-keys-requesttag">RequestTag</a><a href="#condition-keys-resourceaccount">ResourceAccount</a><a href="#condition-keys-resourceorgid">ResourceOrgID</a><a href="#condition-keys-resourceorgpaths">ResourceOrgPaths</a><a href="#condition-keys-resourcetag">ResourceTag</a><a href="#condition-keys-securetransport">SecureTransport</a><a href="#condition-keys-sourceaccount">SourceAccount</a><a href="#condition-keys-sourcearn">SourceArn</a><a href="#condition-keys-sourceidentity">SourceIdentity</a><a href="#condition-keys-sourceip">SourceIp</a><a href="#condition-keys-sourcevpc">SourceVpc</a><a href="#condition-keys-sourcevpce">SourceVpce</a><a href="#condition-keys-tagkeys">TagKeys</a><a href="#condition-keys-tokenissuetime">TokenIssueTime</a><a href="#condition-keys-useragent">UserAgent</a><a href="#condition-keys-userid">Userid</a><a href="#condition-keys-username">使用者名稱</a><a href="#condition-keys-viaawsservice">ViaAWSService</a><a href="#condition-keys-vpcsourceip">VpcSourceIp</a><a href="#condition-keys-other">其他跨服務索引鍵</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="reference_policies_condition-keys">AWS 全域條件內容索引鍵</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>當<a href="./intro-structure.html#intro-structure-principal">主體</a>向 AWS 發出<a href="./intro-structure.html#intro-structure-request">請求</a>時，AWS 會將請求資訊收集到<a href="./intro-structure.html#intro-structure-request">請求內容</a>。您可以使用 JSON 政策的 <code class="code">Condition</code> 元素，來比較請求內容中的索引鍵和您在政策中指定的鍵值。若要進一步了解全域索引鍵包含在請求內容中的情況，請參閱每個全域條件金鑰的<b>可用性</b>資訊。如需有關如何 JSON 政策中使用 <code class="code">Condition</code> 元素的資訊，請參閱 <a href="./reference_policies_elements_condition.html">IAM JSON 政策元素：Condition</a>。</p><div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>如果您使用只能在一些情況下可用的條件金鑰，則可以使用條件運算子的 <a href="./reference_policies_elements_condition_operators.html#Conditions_IfExists">IfExists</a> 版本。如果請求內容中缺少條件金鑰，則政策可能會讓評估失敗。例如，搭配使用以下條件區塊與 <code class="code">...IfExists</code> 運算子，以在請求來自特定 IP 範圍或特定 VPC 時進行比對。若其中一個索引鍵，或兩者都不包含在請求內容中，條件仍會傳回 <code class="code">true</code>。只有在請求內容中包含指定索引鍵時，才會檢查值。</p><pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"Condition": <span>{</span>
    "IpAddressIfExists": <span>{</span>"aws:SourceIp" : ["xxx"] },
    "StringEqualsIfExists" : <span>{</span>"aws:SourceVpc" : ["yyy"]} 
}</code></pre></div></div><p>全域條件金鑰是具備 <code class="code">aws:</code> 字首的條件金鑰。AWS 服務可支援全域條件金鑰或提供包含服務字首的服務專屬索引鍵。例如，IAM 條件金鑰會包含 <code class="code">iam:</code> 字首。如需詳細資訊，請參閱<a href="reference_policies_actions-resources-contextkeys.html" rel="noopener noreferrer" target="_blank">適用於 AWS 服務的動作、資源和條件金鑰</a>，然後選擇您要檢視其索引鍵的服務。</p><div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>重要</h6></div><div class="awsdocs-note-text"><p>若要將您的條件與具有多個鍵值的請求內容進行比較，您必須使用 <code class="code">ForAllValues</code> 或 <code class="code">ForAnyValue</code> 設定運算子。只能將集合運算子與多值條件金鑰搭配使用。請勿將集合運算子與單一值條件金鑰搭配使用。如需更多詳細資訊，請參閱 <a href="./reference_policies_multi-value-conditions.html">建立具有多個索引鍵或值的條件</a>。</p></div></div>
        <h2 id="condition-keys-calledvia">aws:CalledVia</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵可將政策中的服務與代表 IAM 主體 (使用者或角色) 提出請求的服務進行比較。主體向 AWS 服務提出請求時，該服務可能會使用主體的憑證，向其他服務提出後續請求。<code class="code">aws:CalledVia</code> 索引鍵包含代表主體提出請求的鏈結中，每個服務的排序清單。</p>
        <p>例如，您可以使用 AWS CloudFormation 從 Amazon DynamoDB 資料表讀取和寫入。然後，DynamoDB 會使用由 AWS Key Management Service (AWS KMS) 提供的加密功能。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 支援 <code class="code">aws:CalledVia</code> 的服務使用 IAM 主體的憑證向其他服務提出請求時，此索引鍵即出現在請求中。若服務使用<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-role">服務角色</a>或<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-linked-role">服務連結角色</a>來代表主體呼叫，則此索引鍵不存在。若主體直接進行呼叫，此索引鍵亦不存在。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 多重值</p>
            </li></ul></div>
        <a id="calledvia-services"></a>
        <p>若要在政策中使用 <code class="code">aws:CalledVia</code> 條件金鑰，您必須提供服務主體以允許或拒絕 AWS 服務請求。AWS 支援以 <code class="code">aws:CalledVia</code> 使用下列服務主體。</p>
        <div class="table-container"><div class="table-contents"><table id="w339aac25c19c19c13c15"><thead>
                    <tr>
                        <th>服務主體</th>
                    </tr>
                </thead>
                    <tr>
                        <td>athena.amazonaws.com</td>
                    </tr>
                    <tr>
                        <td>cloud9.amazonaws.com</td>
                    </tr>
                    <tr>
                        <td>cloudformation.amazonaws.com</td>
                    </tr>
                    <tr>
                        <td>databrew.amazonaws.com</td>
                    </tr>
                    <tr>
                        <td>dataexchange.amazonaws.com</td>
                    </tr>
                    <tr>
                        <td>dynamodb.amazonaws.com</td>
                    </tr>
                    <tr>
                        <td>kms.amazonaws.com</td>
                    </tr>
                    <tr>
                        <td>servicecatalog-appregistry.amazonaws.com</td>
                    </tr>
                    <tr>
                        <td>sqlworkbench.amazonaws.com</td>
                    </tr>
                </table></div></div>
        <p>若要在<em>任何</em>服務使用主體憑證提出請求時，允許或拒絕存取，請使用 <code class="code"><a href="#condition-keys-viaawsservice">aws:ViaAWSService</a></code> 條件金鑰。該條件金鑰支援 AWS 服務。</p>
        <p><code class="code">aws:CalledVia</code> 索引鍵是<a href="./reference_policies_multi-value-conditions.html">多值索引鍵</a>。但是，您無法在條件中使用此索引鍵強制排序。使用上面的例子，<b>使用者 1</b> 向 AWS CloudFormation 發出請求，其中 AWS CloudFormation 會呼叫 DynamoDB，而 DynamoDB 呼叫 AWS KMS。這是三個獨立的請求。最後對 AWS KMS 的呼叫由使用者 1 <em>透過</em> AWS CloudFormation 再用 DynamoDB 執行。</p>
        <div class="mediaobject">
             
                <img src="images/condition-key-calledvia-example-diagram.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                使用 aws:CalledVia 的範例&#xA;            " style="max-width:100%" />
             
             
        </div>
        <p>在此情況下，請求環境中的 <code class="code">aws:CalledVia</code> 索引鍵會依該排序包括 <code class="code">cloudformation.amazonaws.com</code> 和 <code class="code">dynamodb.amazonaws.com</code>。如果您只在意呼叫是透過請求鏈結中的某處的 DynamoDB 進行，則可以在政策中使用此條件金鑰。</p>
        <p>例如，下列政策允許管理名為的 <code class="code">my-example-key</code> 的 AWS KMS 索引鍵，但前提是 DynamoDB 為請求服務之一。<code class="code"><a href="./reference_policies_multi-value-conditions.html#reference_policies_multi-key-or-value-conditions">ForAnyValue:StringEquals</a></code> 條件運算子確保 DynamoDB 為呼叫服務之一。若主體直接呼叫 AWS KMS，則條件會傳回 <code class="code">false</code>，且此政策不允許該請求。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "KmsActionsIfCalledViaDynamodb",
            "Effect": "Allow",
            "Action": [
                "kms:Encrypt",
                "kms:Decrypt",
                "kms:ReEncrypt*",
                "kms:GenerateDataKey",
                "kms:DescribeKey"
            ],
            "Resource": "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">111122223333</code>:key/<code class="replaceable">my-example-key</code>",
            "Condition": <span>{</span>
                "ForAnyValue:StringEquals": <span>{</span>
                    "aws:CalledVia": ["dynamodb.amazonaws.com"]
                }
            }
        }
    ]
}</code></pre>
        <p>如果您想強制執行鏈結中進行第一個或最後一個呼叫的服務，可以使用 <code class="code"><a href="#condition-keys-calledviafirst">aws:CalledViaFirst</a></code> 和 <code class="code"><a href="#condition-keys-calledviafirst">aws:CalledViaLast</a></code> 索引鍵。例如，下列政策允許管理 <code class="code">my-example-key</code> 中名為 AWS KMS 的索引鍵。僅限鏈結包含多個請求時，才允許這些 AWS KMS 操作。第一個請求必須透過 AWS CloudFormation 執行，而最後一個須透過 DynamoDB 進行。如果其他服務在鏈結中間發出請求，則仍允許該操作。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "KmsActionsIfCalledViaChain",
            "Effect": "Allow",
            "Action": [
                "kms:Encrypt",
                "kms:Decrypt",
                "kms:ReEncrypt*",
                "kms:GenerateDataKey",
                "kms:DescribeKey"
            ],
            "Resource": "arn:aws:kms:<code class="replaceable">region</code>:<code class="replaceable">111122223333</code>:key/<code class="replaceable">my-example-key</code>",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "aws:CalledViaFirst": "cloudformation.amazonaws.com",
                    "aws:CalledViaLast": "dynamodb.amazonaws.com"
                }
            }
        }
    ]
}</code></pre>
        <p>當服務使用 IAM 主體憑證來呼叫另一個服務時，<code class="code"><a href="#condition-keys-calledviafirst">aws:CalledViaFirst</a></code> 和 <code class="code"><a href="#condition-keys-calledviafirst">aws:CalledViaLast</a></code> 索引鍵即會出現在請求中。它們會指出在請求鏈中進行呼叫的第一個和最後一個服務。例如，假設 AWS CloudFormation 呼叫另一個名為 <code class="code">X
                Service</code> 的服務，則該服務會呼叫 DynamoDB，而後會呼叫 AWS KMS。最後對 AWS KMS 的呼叫由 <code class="code">User 1</code> <em>透過</em> AWS CloudFormation，接著用 <code class="code">X Service</code>，再用 DynamoDB 執行。這最初透過 AWS CloudFormation 呼叫，最後透過 DynamoDB 呼叫。</p>
        <div class="mediaobject">
             
                <img src="images/condition-key-calledviafirstlast-example-diagram.png" class="aws-docs-img-whiteBg aws-docs-img-padding" alt="&#xA;                使用 aws:CalledViaFirst 和 aws:CalledViaLast 的範例&#xA;            " style="max-width:100%" />
             
             
        </div>
        
     
        <h2 id="condition-keys-calledviafirst">aws:CalledViaFirst</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵可將政策中的服務與代表 IAM 主體 (使用者或角色) 提出請求的<em><b>第一個服務</b></em>進行比較。如需詳細資訊，請參閱 <code class="code"><a href="#condition-keys-calledvia">aws:CalledVia</a></code>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 服務使用 IAM 主體的憑證向不同服務提出至少一個其他請求時，此索引鍵即出現在請求中。若服務使用<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-role">服務角色</a>或<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-linked-role">服務連結角色</a>來代表主體呼叫，則此索引鍵不存在。若主體直接進行呼叫，此索引鍵亦不存在。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
     
        <h2 id="condition-keys-calledvialast">aws:CalledViaLast</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵可將政策中的服務與代表 IAM 主體 (使用者或角色) 提出請求的<em>最後一個服務</em>進行比較。如需詳細資訊，請參閱 <code class="code"><a href="#condition-keys-calledvia">aws:CalledVia</a></code>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 服務使用 IAM 主體的憑證向不同服務提出至少一個其他請求時，此索引鍵即出現在請求中。若服務使用<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-role">服務角色</a>或<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-linked-role">服務連結角色</a>來代表主體呼叫，則此索引鍵不存在。若主體直接進行呼叫，此索引鍵亦不存在。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
     
        <h2 id="condition-keys-currenttime">aws:CurrentTime</h2>
        <p>適用於<a href="./reference_policies_elements_condition_operators.html#Conditions_Date">日期運算子</a>。</p>
        <p>使用此索引鍵來將請求的日期和時間及您在政策中所指定的日期與時間進行比較。如要檢視使用此條件金鑰的範例政策，請參閱 <a href="./reference_policies_examples_aws-dates.html">AWS：允許根據日期和時間進行存取</a>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 此金鑰一律會包含在請求內容中。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
     
        <h2 id="condition-keys-ec2instancesourcevpc">aws:Ec2InstanceSourceVpc</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>此金鑰可識別要接收 Amazon EC2 IAM 角色憑證的 VPC。您可以在具有 <a href="#condition-keys-sourcevpc">aws:SourceVPC</a> 全域金鑰的政策中使用此金鑰，以檢查是否從與接收憑證之 VPC (<code class="code">aws:Ec2InstanceSourceVpc</code>) 相符的 VPC (<code class="code">aws:SourceVPC</code>) 進行呼叫。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 每當請求者使用 Amazon EC2 角色憑證簽署請求時，請求內容中會包含此金鑰。它可用於 IAM 政策、服務控制政策、VPC 端點政策和資源政策。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>此金鑰可與 VPC 識別符值搭配使用，但是當與 <code class="code">aws:SourceVpc</code> 內容金鑰一起用作變數時最有用。只有在請求者使用 VPC 端點提出請求時，請求內容中才會包含 <code class="code">aws:SourceVpc</code> 內容金鑰。搭配使用 <code class="code">aws:Ec2InstanceSourceVpc</code> 與 <code class="code">aws:SourceVpc</code> 可讓您更廣泛地使用 <code class="code">aws:Ec2InstanceSourceVpc</code>，因為其會比較通常一起變更的值。</p>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>此條件索引鍵在 EC2-Classic 中不可用。</p></div></div>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Sid": "RequireSameVPC",
      "Effect": "Deny",
      "Action": "*",
      "Resource": "*",
      "Condition": <span>{</span>
        "StringNotEquals": <span>{</span>
            "aws:SourceVpc": "$<span>{</span>aws:Ec2InstanceSourceVpc}"
        },
        "Null": <span>{</span>
          "ec2:SourceInstanceARN": "false"
        },
        "BoolIfExists": <span>{</span>
          "aws:ViaAWSService": "false"
        }
      }
    }
  ]
}</code></pre>
        <p>在上面的範例中，如果 <code class="code">aws:SourceVpc</code> 值不等於 <code class="code">aws:Ec2InstanceSourceVpc</code> 值，則會拒絕存取。政策聲明僅限於透過測試 <code class="code">ec2:SourceInstanceARN</code> 條件索引鍵是否存在，作為 Amazon EC2 執行個體角色使用的角色。</p>
        <p>政策使用 <code class="code">aws:ViaAWSService</code> 來允許 AWS 在代表 Amazon EC2 執行個體角色提出請求時授權請求。例如，當您從 Amazon EC2 執行個體向加密的 Amazon S3 儲存貯體提出請求時，Amazon S3 會代表您呼叫 AWS KMS。對 AWS KMS 提出請求時，某些索引鍵不存在。</p>
     
        <h2 id="condition-keys-ec2instancesourceprivateip4">aws:Ec2InstanceSourcePrivateIPv4</h2>
        <p>適用於 <a href="./reference_policies_elements_condition_operators.html#Conditions_IPAddress">IP 地址運算子</a>。</p>
        <p>此索引鍵可識別接收 Amazon EC2 IAM 角色憑證之主要彈性網路介面的私有 IPv4 地址。您必須搭配使用此條件索引鍵與其配套索引鍵 <code class="code">aws:Ec2InstanceSourceVpc</code>，以確保您擁有 VPC ID 和來源私有 IP 的全域唯一組合。搭配使用此索引鍵與 <code class="code">aws:Ec2InstanceSourceVpc</code>，來確保從接收憑證的相同私有 IP 地址提出請求。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 每當請求者使用 Amazon EC2 角色憑證簽署請求時，請求內容中會包含此金鑰。它可用於 IAM 政策、服務控制政策、VPC 端點政策和資源政策。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>重要</h6></div><div class="awsdocs-note-text"><p>此索引鍵不應該單獨在 <code class="code">Allow</code> 陳述式中使用。私有 IP 地址根據定義不是全域唯一的。每次使用 <code class="code">aws:Ec2InstanceSourcePrivateIPv4</code> 索引鍵指定可從中使用 Amazon EC2 執行個體憑證的 VPC 時，都應該使用 <code class="code">aws:Ec2InstanceSourceVpc</code> 索引鍵。</p></div></div>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>此條件索引鍵在 EC2-Classic 中不可用。</p></div></div>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Deny",
            "Action":  "*",
            "Resource": "*",
            "Condition": <span>{</span>
                "StringNotEquals": <span>{</span>
                    "aws:Ec2InstanceSourceVpc": "$<span>{</span>aws:SourceVpc}"
                },                
                "Null": <span>{</span>
                    "ec2:SourceInstanceARN": "false"
                },
                "BoolIfExists": <span>{</span>
                    "aws:ViaAWSService": "false"
                }
            }
        },
        <span>{</span>
            "Effect": "Deny",
            "Action":  "*",
            "Resource": "*",
            "Condition": <span>{</span>
                "StringNotEquals": <span>{</span>
                    "aws:Ec2InstanceSourcePrivateIPv4": "$<span>{</span>aws:VpcSourceIp}"
                },                               
                "Null": <span>{</span>
                    "ec2:SourceInstanceARN": "false"
                },
                "BoolIfExists": <span>{</span>
                    "aws:ViaAWSService": "false"
                }
            }
        }
    ]
}</code></pre>
     
        <h2 id="condition-keys-epochtime">aws:EpochTime</h2>
        <p>可和<a href="./reference_policies_elements_condition_operators.html#Conditions_Date">日期運算子</a>或<a href="./reference_policies_elements_condition_operators.html#Conditions_Numeric">數值運算子</a>搭配使用。</p>
        <p>使用此索引鍵來將請求的日期和時間 (epoch 或 Unix 時間) 與您在政策中所指定的日期與時間進行比較。此索引鍵也接受自 1970 年 1 月 1 日以來的秒數。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 此金鑰一律會包含在請求內容中。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
     
        <h2 id="condition-keys-federatedprovider">aws:FederatedProvider</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來將主體的發行身分提供者 (IdP) 與您在政策中所指定的 IdP 進行比較。這表示使用 <code class="code">AssumeRoleWithWebIdentity</code> 或 <code class="code">AssumeRoleWithSAML</code> AWS STS 操作擔任 IAM 角色。使用產生角色工作階段的暫時憑證提出要求時，要求內容會識別驗證原始聯合身分的 IdP。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 當主體是角色工作階段主體，且該工作階段是使用第三方身分提供者發佈時，就會出現此索引鍵。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>例如，如果使用者透過 Amazon Cognito 進行身分驗證，則要求內容包含值 <code class="code">cognito-identity.amazonaws.com</code>。同樣，如果使用者透過 Login with Amazon 進行身分驗證，則要求內容包含值 <code class="code">www.amazon.com</code>。</p>
        <p>您可以使用任何單一值條件金鑰作為<a href="./reference_policies_variables.html">變數</a>。以下範例資源型政策會使用 <code class="code">aws:FederatedProvider</code> 索引鍵作為資源的 ARN 中的政策變數。此政策允許使用 IdP 進行身分驗證的任何主體從 Amazon S3 儲存貯體中取得物件，並使用特定於發行身分提供者的路徑。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": <span>{</span>
    "Effect": "Allow",
    "Principal": "*",
    "Action": "s3:GetObject",
    "Resource": "arn:aws:s3:::<code class="replaceable"><code class="replaceable">DOC-EXAMPLE-BUCKET</code></code>/$<span>{</span>aws:FederatedProvider}/*"
  }
}</code></pre>
     
        <h2 id="condition-keys-multifactorauthage">aws:MultiFactorAuthAge</h2>
        <p>適用於<a href="./reference_policies_elements_condition_operators.html#Conditions_Numeric">數字運算子</a>。</p>
        <p>使用此索引鍵來將請求主體獲得授權使用 MFA 以來的秒數，與您在政策中所指定的數字進行比較。如需有關 MFA 的詳細資訊，請參閱 <a href="./id_credentials_mfa.html">使用 AWS 中的多重要素驗證 (MFA)</a>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 只有在進行呼叫的主體使用 MFA 進行身分驗證時，請求內容中才會包含此索引鍵。如果未使用 MFA，則此索引鍵不存在。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
     
        <h2 id="condition-keys-multifactorauthpresent">aws:MultiFactorAuthPresent</h2>
        <p>適用於<a href="./reference_policies_elements_condition_operators.html#Conditions_Boolean">布林運算子</a>。</p>
        <p>使用此索引鍵來檢查是否使用了多重要素驗證 (MFA) 來驗證發出請求的暫時安全憑證。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 只有在主體使用暫時憑證發出請求時，請求內容中才會包含此索引鍵。索引鍵不會出現在使用長期憑證發出的 AWS CLI、AWS API 或 AWS 開發套件請求中。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>暫時憑證會用來針對 IAM 角色、聯合身分使用者、具備 <code class="code">sts:GetSessionToken</code> 暫時權杖的 IAM 使用者，以及 AWS Management Console 使用者進行身分驗證。IAM 使用者存取索引鍵為長期憑證，但在某些情況下，AWS會代表 IAM 使用者建立臨時憑證以執行作業。在這些情況下，<code class="code">aws:MultiFactorAuthPresent</code> 索引鍵會出現在請求中，並設為 <code class="code">false</code> 值。在兩種常見的情況下可能會發生此情況：</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p>IAM 使用者在 AWS Management Console不知情的情況下使用臨時憑證。使用者會使用他們的使用者名稱和密碼 (長期憑證) 登入主控台。不過，主控台會在背景中代表使用者產生臨時憑證。</p>
            </li><li class="listitem">
                <p>如果 IAM 使用者呼叫 AWS 服務，則服務會重新使用該使用者的憑證，來向不同的服務提出另一個請求。例如，當呼叫 Athena 存取 Amazon S3 儲存貯體時，或使用 AWS CloudFormation 來建立 Amazon EC2 執行個體。針對後續的請求，AWS 會使用臨時憑證。</p>
            </li></ul></div>
        <p>若要了解哪些服務支援使用暫時憑證，請參閱<a href="./reference_aws-services-that-work-with-iam.html">可搭配 IAM 運作的 AWS 服務</a>。</p>
        <p><code class="code">aws:MultiFactorAuthPresent</code> 索引鍵在使用長期憑證 (例如使用者存取金鑰對) 呼叫 API 或 CLI 命令時，便不會出現。因此，我們建議您在檢查此索引鍵時使用條件運算子的 <code class="code"><a href="./reference_policies_elements_condition_operators.html#Conditions_IfExists">...IfExists</a></code> 版本。</p>
        <p>請務必了解，下列 <code class="code">Condition</code> 元素<em><b>不是</b></em>檢查是否使用 MFA 針對請求進行身分驗證的可靠方法。</p>
        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">#####   WARNING: NOT RECOMMENDED   #####
"Effect" : "Deny",
"Condition" : <span>{</span> "Bool" : <span>{</span> "aws:MultiFactorAuthPresent" : "false" } }</code></pre>
        <p>這個 <code class="code">Deny</code> 效果、<code class="code">Bool</code> 元素與 <code class="code">false</code> 值的組合會拒絕可使用 MFA 驗證但卻未驗證的請求。這僅適用於支援使用 MFA 的暫時憑證。此陳述式不會拒絕存取使用長期憑證所提出的請求，或是使用 MFA 進行身分驗證的請求。請小心使用本範例，因為其邏輯十分複雜，而且未測試是否實際使用 MFA 身分驗證。</p>
        <p>此外，請不要使用 <code class="code">Deny</code> 效果、<code class="code">Null</code> 元素與 <code class="code">true</code> 的組合，因為其行為相同，而邏輯更為複雜。</p>
         
            <h6>建議的組合</h6>
            <p>我們建議您使用 <a href="./reference_policies_elements_condition_operators.html#Conditions_IfExists">BoolIfExists</a> 運算子來檢查是否使用 MFA 驗證請求。</p>
         
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Effect" : "Deny",
"Condition" : <span>{</span> "BoolIfExists" : <span>{</span> "aws:MultiFactorAuthPresent" : "false" } }</code></pre>
        <p>這個 <code class="code">Deny</code>、<code class="code">BoolIfExists</code> 與 <code class="code">false</code> 的組合會拒絕未使用 MFA 驗證的請求。特別地是，它會拒絕來自未包含 MFA 之暫時憑證的請求。它也會拒絕使用長期憑證 (例如，使用存取索引鍵進行的 AWS CLI 或 AWS API 操作) 提出的請求。<code class="code">*IfExists</code> 運算子會檢查 <code class="code">aws:MultiFactorAuthPresent</code> 索引鍵是否存在以及它是否可能存在，如其存在所指出。當您想要拒絕任何未使用 MFA 驗證的請求時，請使用此項目。這個項目較安全，但可能會中斷任何使用存取索引鍵來存取 AWS CLI 或 AWS API 的程式碼或指令碼。</p>
         
            <h6>替代組合</h6>
            <p>您也可以使用 <a href="./reference_policies_elements_condition_operators.html#Conditions_IfExists">BoolIfExists</a> 運算子，以允許使用 MFA 進行身分驗證的請求，以及使用長期憑證提出的 AWS CLI 或 AWS API 請求。</p>
         
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json ">"Effect" : "Allow",
"Condition" : <span>{</span> "BoolIfExists" : <span>{</span> "aws:MultiFactorAuthPresent" : "true" } }</code></pre>
        <p>此條件會比對索引鍵是否存在，<b>或者</b>索引鍵是否不存在。這個 <code class="code">Allow</code>、<code class="code">BoolIfExists</code> 與 <code class="code">true</code> 的組合允許使用 MFA 驗證的請求，或允許無法使用 MFA 驗證的請求。這表示當申請者使用其長期存取索引鍵時，允許 AWS CLI、AWS API 和 AWS 開發套件操作。此組合不允許來自暫時憑證，且能夠包含 MFA 的請求但未這麼做的請求。</p>
        <p>當您使用 IAM 主控台視覺化編輯器建立政策並選擇 <b>MFA required</b> (需要 MFA) 時，即會套用此組合。此設定需要 MFA 來存取主控台，但允許不使用 MFA 進行程式設計存取。</p>
        <p>或者，您可以使用 <code class="code">Bool</code> 運算子，僅在使用 MFA 驗證時允許程式設計和主控台請求。</p>
        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">"Effect" : "Allow",
"Condition" : <span>{</span> "Bool" : <span>{</span> "aws:MultiFactorAuthPresent" : "true" } }</code></pre>
        <p>這個 <code class="code">Allow</code>、<code class="code">Bool</code> 與 <code class="code">true</code> 的組合只允許 MFA 驗證的請求。這僅適用於支援使用 MFA 的暫時憑證。此陳述式不允許存取使用長期存取索引鍵所提出的請求，或是使用暫時憑證但未使用 MFA 所提出的請求。</p>
        <p><b><em>請不要</em></b>使用與下列內容類似的政策建構來檢查是否存在 MFA 索引鍵：</p>
        <pre class="programlisting"><div class="code-btn-container"></div><code class="json ">#####   WARNING: USE WITH CAUTION   #####

"Effect" : "Allow",
"Condition" : <span>{</span> "Null" : <span>{</span> "aws:MultiFactorAuthPresent" : "false" } }</code></pre>
        <p>這個 <code class="code">Allow</code> 效果、<code class="code">Null</code> 元素與 <code class="code">false</code> 值的組合只允許可使用 MFA 驗證的請求，不論是否實際驗證請求都一樣。這會允許所有使用暫時憑證所提出的請求，並拒絕長期憑證的存取。請小心使用本範例，因為未測試是否實際使用 MFA 身分驗證。</p>
     
        <h2 id="condition-keys-principalaccount">aws:PrincipalAccount</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來將請求主體所屬的帳戶與您在政策中指定的帳戶識別碼進行比較。對於匿名請求，請求內容會返回 <code class="code">anonymous</code>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 此金鑰會包含在所有請求的請求內容中，包括匿名請求。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>以下範例中，除了帳號為 <code class="code">123456789012</code> 的主體之外，一律拒絕存取。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="JSON "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Sid": "DenyAccessFromPrincipalNotInSpecificAccount",
      "Action": "<code class="replaceable">service</code>:*",
      "Effect": "Deny",
      "Resource": [
        "arn:aws:<code class="replaceable">service:region:accountID:resource</code>"
      ],
      "Condition": <span>{</span>
        "StringNotEquals": <span>{</span>
          "aws:PrincipalAccount": [
            "123456789012"
          ]
        }
      }
    }
  ]
}
        </code></pre>

     
        <h2 id="condition-keys-principalarn">aws:PrincipalArn</h2>
        <p>搭配 <a href="./reference_policies_elements_condition_operators.html#Conditions_ARN">ARN 運算子和字串運算子</a>使用。</p>
        <p>使用此索引鍵來將提出請求主體的 <a href="./reference_identifiers.html#identifiers-arns">Amazon Resource Name (ARN)</a> 與您在政策中所指定的 ARN 進行比較。針對 IAM 角色，請求內容會傳回角色的 ARN，而非取得角色使用者的 ARN。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 此索引鍵會包含在所有簽章請求的請求內容中。匿名請求不包含此索引鍵。您可以在此條件金鑰中指定以下類型的主體：</p>
                <div class="itemizedlist">
                     
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>IAM 角色</p>
                    </li><li class="listitem">
                        <p>IAM 使用者</p>
                    </li><li class="listitem">
                        <p>AWS STS 聯合身分使用者工作階段</p>
                    </li><li class="listitem">
                        <p>AWS 帳戶 根使用者</p>
                    </li></ul></div>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>以下清單顯示您可以在 <code class="code">aws:PrincipalArn</code> 條件金鑰中指定的不同類型主體傳回的請求內容值：</p>
        <div class="itemizedlist">
             
             
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>IAM 角色</b> – 請求內容包含條件金鑰 <code class="code">aws:PrincipalArn</code> 的下列值。請勿將擔任角色工作階段 ARN 指定為此條件金鑰的值。如需有關擔任角色工作階段主體的詳細資訊，請參閱 <a href="./reference_policies_elements_principal.html#principal-role-session">角色工作階段主體</a>。</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="code" copy="true">arn:aws:iam::123456789012:role/role-name</code></code></pre>
            </li><li class="listitem">
                <p><b>IAM 使用者</b> – 請求內容包含條件金鑰 <code class="code">aws:PrincipalArn</code> 的下列值。</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="code" copy="true">arn:aws:iam::123456789012:user/<code class="replaceable">user-name</code></code></code></pre>
            </li><li class="listitem">
                <p><b>AWS STS 聯合身分使用者工作階段</b> – 請求內容包含條件金鑰 <code class="code">aws:PrincipalArn</code> 的下列值。</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="code" copy="true">arn:aws:sts::123456789012:federated-user/<code class="replaceable">user-name</code></code></code></pre>
            </li><li class="listitem">
                <p><b>AWS 帳戶 根使用者</b> – 請求內容包含條件金鑰 <code class="code">aws:PrincipalArn</code> 的下列值。將根使用者 ARN 指定為 <code class="code">aws:PrincipalArn</code> 條件金鑰的值時，僅會限制 AWS 帳戶 根使用者的許可。這不同於在資源型政策的主體元素中指定根使用者 ARN，後者將授權委派給 AWS 帳戶。如需在資源型政策的主體元素中指定根使用者 ARN 的相關資訊，請參閱 <a href="./reference_policies_elements_principal.html#principal-accounts">AWS 帳戶 主體</a>。</p>
                <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="nohighlight"><code class="code" copy="true">arn:aws:iam::123456789012:root</code></code></pre>
                <p>您可以將根使用者 ARN 指定為 AWS Organizations 服務控制政策 (SCP) 中條件金鑰 <code class="code">aws:PrincipalArn</code> 的值。SCP 是一種組織政策，用於管理您組織中的許可，並且僅會影響組織中的成員帳戶。SCP 會限制 IAM 使用者和成員帳戶中 IAM 使用者和角色的許可，包括成員帳戶的根使用者。如需 SCP 對許可的影響的詳細資訊，請參閱 <em>Organizations 使用者指南</em>中的 <a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_policies_scps.html#scp-effects-on-permissions">SCP 對許可的影響</a>。</p>
            </li></ul></div>
        
     
        <h2 id="condition-keys-principalisawsservice">aws:PrincipalIsAWSService</h2>
        <p>適用於<a href="./reference_policies_elements_condition_operators.html#Conditions_Boolean">布林運算子</a>。</p>
        <p>使用此索引鍵來檢查資源的呼叫是否直接由 AWS <a href="./reference_policies_elements_principal.html#principal-services">服務主體</a>進行。例如：AWS CloudTrail 使用服務主體 <code class="code">cloudtrail.amazonaws.com</code> 將日誌寫入至 Amazon S3 儲存貯體。當服務使用服務主體對您的資源執行直接動作時，請求內容索引鍵會設定為 true (真)。服務代表 IAM 主體使用主體的憑證來提出請求時，內容索引鍵設定為 false。若服務使用<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-role">服務角色</a>或<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-linked-role">服務連結角色</a>來代表主體呼叫，則也會設定為 false (偽)。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 對於所有使用 AWS 憑證的已簽署 API 請求，此索引鍵會出現在請求內容中。匿名請求不包含此索引鍵。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>您可以使用此條件金鑰來限制對信任身分和預期網路位置的存取，同時安全地授予 AWS 服務的存取許可。</p>
        <p>在下列 Amazon S3 儲存貯體政策範例中，存取儲存貯體會受到限制，除非請求來自 <code class="code">vpc-111bbb22</code> 或來自服務主體，例如 CloudTrail。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="JSON "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Sid": "Expected-network+service-principal",
      "Effect": "Deny",
      "Principal": "*",
      "Action": "s3:PutObject",
      "Resource": "arn:aws:s3:::<code class="replaceable"><code class="replaceable">DOC-EXAMPLE-BUCKET1</code></code>/AWSLogs/<code class="replaceable">AccountNumber</code>/*",
      "Condition": <span>{</span>
        "StringNotEqualsIfExists": <span>{</span>
          "aws:SourceVpc": "vpc-111bbb22"
        },
        "BoolIfExists": <span>{</span>
          "aws:PrincipalIsAWSService": "false"
        }
      }
    }
  ]
}</code></pre>
        
        <p>在下列影片中，進一步了解如何在政策中使用 <code class="code">aws:PrincipalIsAWSService</code> 條件金鑰。</p>
        <div class="mediaobject">
             
                <iframe width="720" height="330" frameborder="0" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" sandbox="allow-scripts allow-same-origin allow-popups" src="https://www.youtube-nocookie.com/embed/gv-_H8a42G4"></iframe>
             
             
        </div>
        
        
        
     
        <h2 id="condition-keys-principalorgid">aws:PrincipalOrgID</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來將請求主體所屬 AWS Organizations 中的組織識別碼，與政策中所指定的識別碼進行比較。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 只有在主體是組織的成員時，請求內容中才會包含此金鑰。匿名請求不包含此索引鍵。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>此全域索引鍵提供了列出組織中所有 AWS 帳戶的所有帳戶 ID 的替代方法。您可以使用此條件金鑰來簡化在<a href="./access_policies_identity-vs-resource.html">資源型政策</a>中指定 <code class="code">Principal</code> 元素。您可以在條件元素中指定<a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_org_details.html">組織 ID</a>。當您新增和移除帳戶時，包含 <code class="code">aws:PrincipalOrgID</code> 索引鍵的政策會自動包含正確的帳戶，不需要手動更新。</p>
        <p>例如，下列 Amazon S3 儲存貯體政策允許 <code class="code">o-xxxxxxxxxxx</code> 組織中任何帳戶的成員將物件新增至 <code class="code">policy-ninja-dev</code> 儲存貯體。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="JSON "> <span>{</span>
  "Version": "2012-10-17",
  "Statement": <span>{</span>
    "Sid": "AllowPutObject",
    "Effect": "Allow",
    "Principal": "*",
    "Action": "s3:PutObject",
    "Resource": "arn:aws:s3:::policy-ninja-dev/*",
    "Condition": <span>{</span>"StringEquals":
      <span>{</span>"aws:PrincipalOrgID":"o-xxxxxxxxxxx"}
    }
  }
}</code></pre>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>此全域條件也適用於 AWS 組織的管理帳戶。此政策可防止指定組織以外的所有主體存取 Amazon S3 儲存貯體。這包括與您的內部資源互動的任何 AWS 服務，例如將日誌資料傳送到 Amazon S3 儲存貯體的 AWS CloudTrail。若要了解如何安全地授予 AWS 服務存取權，請參閱 <a href="#condition-keys-principalisawsservice">aws:PrincipalIsAWSService</a>。</p></div></div>
        <p>如需有關 AWS Organizations 的詳細資訊，請參閱《AWS Organizations 使用者指南》<em></em>中的<a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_introduction.html">什麼是 AWS Organizations？</a>。</p>
     
        <h2 id="condition-keys-principalorgpaths">aws:PrincipalOrgPaths</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來比較正在向政策中路徑提出請求的主體 AWS Organizations 路徑。該主體可以是 IAM 使用者、IAM 角色、聯合身分使用者或 AWS 帳戶根使用者。在政策中，這項條件金鑰會確保申請者是在指定組織根或 AWS Organizations 中組織單位 (OU) 內的帳戶成員。AWS Organizations 路徑是 Organizations 實體結構的文字表示。如需有關使用和了解路徑的詳細資訊，請參閱 <a href="./access_policies_access-advisor-view-data-orgs.html#access_policies_access-advisor-viewing-orgs-entity-path">了解 AWS Organizations 實體路徑</a>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 只有在主體是組織的成員時，請求內容中才會包含此金鑰。匿名請求不包含此索引鍵。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 多重值</p>
            </li></ul></div>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>組織 ID 是全域唯一，但 OU ID 和根 ID 只有在組織內是唯一。這表示沒有兩個組織共用相同的組織 ID。不過，另一個組織的 OU 或根可能與您的 ID 相同。我們建議您在指定 OU 或根時，一律包含組織 ID。</p></div></div>
        
        <p>例如，以下條件會針對帳戶中的主體傳回 <code class="code">true</code>。這些帳戶是直接連接到 <code class="code">ou-ab12-22222222</code> OU，但並非其子 OU。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="">"Condition" : <span>{</span> "ForAnyValue:StringEquals" : <span>{</span>
     "aws:PrincipalOrgPaths":["o-a1b2c3d4e5/r-ab12/ou-ab12-11111111/ou-ab12-22222222/"]
}}</code></pre>
        
        <p>以下條件會針對帳戶中的主體傳回 <code class="code">true</code>。該帳戶是直接連接到 OU 或其任何的子 OU。當您包含萬用字元時，您必須使用 <code class="code">StringLike</code> 條件運算子。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="">"Condition" : <span>{</span> "ForAnyValue:StringLike" : <span>{</span>
     "aws:PrincipalOrgPaths":["o-a1b2c3d4e5/r-ab12/ou-ab12-11111111/ou-ab12-22222222/*"]
}}</code></pre>
        <p>對於直接連接到任何子 OU 但不直接連接到父 OU 的帳戶中的主體，以下條件將傳回 <code class="code">true</code>。先前的條件適用於 OU 或任何子系。以下條件僅適用於子系 (以及這些子系的任何子系)。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="">"Condition" : <span>{</span> "ForAnyValue:StringLike" : <span>{</span>
     "aws:PrincipalOrgPaths":["o-a1b2c3d4e5/r-ab12/ou-ab12-11111111/ou-ab12-22222222/ou-*"]
}}</code></pre>
        <p>以下條件會允許存取 <code class="code">o-a1b2c3d4e5</code> 組織中的任何主體，無論其父 OU 為何。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="">"Condition" : <span>{</span> "ForAnyValue:StringLike" : <span>{</span>
     "aws:PrincipalOrgPaths":["o-a1b2c3d4e5/*"]
}}</code></pre>
        <p><code class="code">aws:PrincipalOrgPaths</code> 是多重值條件金鑰。多重值金鑰在請求內容中可以擁有多個值。當您搭配 <code class="code">ForAnyValue</code> 條件運算子使用多個值時，主體的路徑必須符合政策列出的其中一個路徑。如需有關多重值條件金鑰的詳細資訊，請參閱 <a href="./reference_policies_multi-value-conditions.html#reference_policies_multi-key-or-value-conditions">使用多個金鑰和值</a>。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="">    "Condition": <span>{</span>
        "ForAnyValue:StringLike": <span>{</span>
            "aws:PrincipalOrgPaths": [
                "o-a1b2c3d4e5/r-ab12/ou-ab12-33333333/*",
                "o-a1b2c3d4e5/r-ab12/ou-ab12-22222222/*"
            ]
        }
    }</code></pre>
     
        <h2 id="condition-keys-principalservicename">aws:PrincipalServiceName</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵將政策中的<a href="./reference_policies_elements_principal.html#principal-services">服務主體</a>名稱，以及向您的資源提出請求的服務主體進行比較。您可以使用這個索引鍵來檢查這個呼叫是否由特定的服務主體進行比較。當服務主體直接向您的資源要求時，<code class="code">aws:PrincipalServiceName</code> 索引鍵會包含服務主體的名稱。例如，AWS CloudTrail 服務主體名稱為 <code class="code">cloudtrail.amazonaws.com</code>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>Availability</b> (可用性) – 當 AWS 服務主體呼叫時，請求中即會出現此索引鍵。此索引鍵在任何其他情況下都不存在，包括以下情況：</p>
                <div class="itemizedlist">
                     
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>若服務使用<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-role">服務角色</a>或<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-linked-role">服務連結角色</a>來代表主體呼叫。</p>
                    </li><li class="listitem">
                        <p>服務使用 IAM 主體的憑證代表主體提出請求。</p>
                    </li><li class="listitem">
                        <p>如果呼叫是由 IAM 主體直接進行。</p>
                    </li><li class="listitem">
                        <p>如果呼叫由匿名請求者發出。</p>
                    </li></ul></div>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>您可以使用此條件金鑰來限制對信任身分和預期網路位置的存取，同時安全地授予 AWS 服務的存取許可。</p>
        <p>在下列 Amazon S3 儲存貯體政策範例中，存取儲存貯體會受到限制，除非請求來自 <code class="code">vpc-111bbb22</code> 或來自服務主體，例如 CloudTrail。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Sid": "expected-network+service-principal",
      "Effect": "Deny",
      "Principal": "*",
      "Action": "s3:PutObject",
      "Resource": "arn:aws:s3:::<code class="replaceable"><code class="replaceable">DOC-EXAMPLE-BUCKET1</code></code>/AWSLogs/<code class="replaceable">AccountNumber</code>/*",
      "Condition": <span>{</span>
        "StringNotEqualsIfExists": <span>{</span>
          "aws:SourceVpc": "vpc-111bbb22",
          "aws:PrincipalServiceName": "cloudtrail.amazonaws.com"
        }
      }
    }
  ]
}
        </code></pre>
     
        <h2 id="condition-keys-principalservicenameslist">aws:PrincipalServiceNamesList</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>此索引鍵提供屬於該服務的所有<a href="./reference_policies_elements_principal.html#principal-services">服務主體</a>名稱清單。這是進階條件金鑰。您可以用其來限制服務僅從特定區域存取您的資源。某些服務可能會建立區域服務主體，以指示特定區域內服務的特定執行個體。您可以將資源的存取限制為服務的特定執行個體。當服務主體直接向您的資源要求時，<code class="code">aws:PrincipalServiceNamesList</code> 包含與服務區域執行個體相關聯的所有服務主體名稱的無序清單。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>Availability</b> (可用性) – 當 AWS 服務主體呼叫時，請求中即會出現此索引鍵。此索引鍵在任何其他情況下都不存在，包括以下情況：</p>
                <div class="itemizedlist">
                     
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>若服務使用<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-role">服務角色</a>或<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-linked-role">服務連結角色</a>來代表主體呼叫。</p>
                    </li><li class="listitem">
                        <p>服務使用 IAM 主體的憑證代表主體提出請求。</p>
                    </li><li class="listitem">
                        <p>如果呼叫是由 IAM 主體直接進行。</p>
                    </li><li class="listitem">
                        <p>如果呼叫由匿名請求者發出。</p>
                    </li></ul></div>
            </li><li class="listitem">
                <p><b>值類型</b> - 多重值</p>
            </li></ul></div>
        <p><code class="code">aws:PrincipalServiceNamesList</code> 是多重值條件金鑰。多重值金鑰在請求內容中可以擁有多個值。使用此金鑰時，您必須使用 <code class="code">ForAnyValue</code> 或 <code class="code">ForAllValues</code> 設定運算子搭配<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串條件運算子</a>。如需有關多重值條件金鑰的詳細資訊，請參閱 <a href="./reference_policies_multi-value-conditions.html#reference_policies_multi-key-or-value-conditions">使用多個金鑰和值</a>。</p>
     
        <h2 id="condition-keys-principaltag">aws:PrincipalTag/<em>tag-key</em></h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來將連接至提出請求主體的標籤，與您在政策中所指定的標籤進行比較。若主體連接的標籤超過一個，請求內容會針對每個連接的標籤鍵包含一個 <code class="code">aws:PrincipalTag</code> 索引鍵。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 若主體搭配連接標籤使用 IAM 使用者，此鍵會包含在請求內容中。其會針對主體，使用具備連接標籤或<a href="./id_session-tags.html">工作階段標籤</a>的 IAM 角色包含在其中。匿名請求不包含此索引鍵。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>您可以將自訂屬性以鍵值對的形式新增至使用者或角色。如需有關 IAM 標籤的詳細資訊，請參閱 <a href="./id_tags.html">標記 IAM 資源</a>。您可以使用 <code class="code">aws:PrincipalTag</code> 對 AWS 主體進行<a href="./access_iam-tags.html#access_iam-tags_control-principals">控制存取</a>。</p>
        <p>此範例會示範如何建立身分型政策，允許具有 <code class="userinput">department=hr</code> 標籤的使用者管理 IAM 使用者、群組或角色。若要使用此政策，請將範例政策中的<code class="replaceable">斜體預留位置文字</code>取代為您自己的資訊。然後，遵循<a href="./access_policies_create.html">建立政策</a>或<a href="./access_policies_manage-edit.html">編輯政策</a>中的指示進行操作。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Effect": "Allow",
      "Action": "iam:*",
      "Resource": "*",
      "Condition": <span>{</span>
        "StringEquals": <span>{</span>
          "aws:PrincipalTag/<code class="replaceable">department</code>": "<code class="replaceable">hr</code>"
        }
      }
    }
  ]
}</code></pre>
        <p>此範例會說明如何透過資源 ARN 中的 <code class="code">aws:PrincipalTag</code> 索引鍵建立資源型政策。當儲存貯體名稱以 <code class="code"><code class="replaceable">team</code></code> 主體標籤中的團隊名稱做為結尾時，政策才會允許執行 <code class="code">s3:GetObject</code> 動作。若要使用此政策，請將範例政策中的<code class="replaceable">斜體預留位置文字</code>取代為您自己的資訊。然後，遵循<a href="./access_policies_create.html">建立政策</a>或<a href="./access_policies_manage-edit.html">編輯政策</a>中的指示進行操作。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": <span>{</span>
    "Effect": "Allow",
    "Principal": "*",
    "Action": "s3:GetObject",
    "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>-$<span>{</span>aws:PrincipalTag/<code class="replaceable">team</code>}/"
  }
}</code></pre>
     
        <h2 id="condition-keys-principaltype">aws:PrincipalType</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來將發出請求的主體類型與您在政策中所指定的主體類型進行比較。如需更多詳細資訊，請參閱 <a href="./reference_policies_elements_principal.html#Principal_specifying">指定主體</a>。如需 <code class="code">principal</code> 鍵值的具體範例，請參閱 <a href="./reference_policies_variables.html#principaltable">主體索引鍵值</a>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 此金鑰會包含在所有請求的請求內容中，包括匿名請求。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
     
        <h2 id="condition-keys-referer">aws:Referer</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來將在用戶端瀏覽器中推薦請求的人員，與您在政策中所指定的推薦者進行比較。<code class="code">aws:referer</code> 請求內容的值會由呼叫者在 HTTP 標頭中提供。當您選取網頁上的連結時，<code class="code">Referer</code> 標頭會包含在 Web 瀏覽器請求中。<code class="code">Referer</code> 標頭包含選取連結的網頁 URL。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 僅當透過從瀏覽器中的網頁 URL 連結呼叫 AWS 資源的請求時，此索引鍵才會包含在請求內容中。程式設計請求不會包含此索引鍵，因為它不會使用瀏覽器連結來存取 AWS 資源。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>例如，您可以直接使用 URL 或使用直接 API 呼叫來存取 Amazon S3 物件。如需詳細資訊，請參閱<a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies.html#example-bucket-policies-use-case-4">直接使用 Web 瀏覽器的 Amazon S3 API 操作</a>。當您從存在於網頁中的 URL 存取 Amazon S3 物件時，會在 <code class="code">aws:referer</code> 中使用來源網頁的 URL。當您在瀏覽器中輸入 URL 來存取 Amazon S3 物件時，<code class="code">aws:referer</code> 不存在。當您直接呼叫 API 時，<code class="code">aws:referer</code> 也不存在。您可以使用政策中的 <code class="code">aws:referer</code> 條件金鑰來允許特定參照者提出的請求，例如公司網域中網頁上的連結。</p>
        <div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>警告</h6></div><div class="awsdocs-note-text"><p>應該小心使用此索引鍵。包含公開已知推薦者標頭值相當危險。未授權方可以使用修改的或自訂瀏覽器來提供他們選擇的任何 <code class="code">aws:referer</code> 值。因此，不應該使用 <code class="code">aws:referer</code> 來防止未經授權方提出直接 AWS 請求。它僅用於允許客戶保護其數位內容 (例如存放在 Amazon S3 中的內容)，使其不被未經授權的第三方網站參考。</p></div></div>
     
        <h2 id="condition-keys-requestedregion">aws:RequestedRegion</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來將請求中呼叫的 AWS 區域與您在政策中所指定的區域進行比較。您可以使用此全域條件金鑰來控制可接受請求的區域。若要檢視每個服務的 AWS 區域，請參閱 <em>Amazon Web Services 一般參考</em> 中的<a href="https://docs.aws.amazon.com/general/latest/gr/aws-service-information.html">服務端點和配額</a>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 此金鑰一律會包含在請求內容中。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>有些全域服務 (例如 IAM) 只會有單一端點。因為此端點實際位於美國東部 (維吉尼亞北部) 區域，所以一律會對 us-east-1 區域提出 IAM 呼叫。例如，如果您建立的政策拒絕存取所有服務 (如果請求的區域不是 us-west-2)，則 IAM 呼叫一律會失敗。若要檢視如何解決此問題的範例，請參閱<a href="./reference_policies_elements_notaction.html">帶拒絕的 NotAction</a>。</p>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p><code class="code">aws:RequestedRegion</code> 條件金鑰可讓您控制哪個端點叫用的服務，但不控制操作的影響。有些服務具有跨區域影響。例如，Amazon S3 有 API 操作，可控制跨區域複寫。您可以在一個區域 (受 <code class="code">s3:PutBucketReplication</code> 條件金鑰影響) 中叫用<code class="code">aws:RequestedRegion</code>，但其他區域會根據複寫組態設定而受到影響。</p></div></div>
        <p>您可以使用此內容索引鍵來限制對特定區域集內的 AWS 服務的存取。例如，下列政策可讓使用者在 AWS Management Console 中檢視所有 Amazon EC2 執行個體。不過，只允許他們對愛爾蘭 (eu-west-1)、倫敦 (eu-west-2) 或巴黎 (eu-west-3) 的執行個體進行變更。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "InstanceConsoleReadOnly",
            "Effect": "Allow",
            "Action": [
                "ec2:Describe*",
                "ec2:Export*",
                "ec2:Get*",
                "ec2:Search*"
            ],
            "Resource": "*"
        },
        <span>{</span>
            "Sid": "InstanceWriteRegionRestricted",
            "Effect": "Allow",
            "Action": [
                "ec2:Associate*",
                "ec2:Import*",
                "ec2:Modify*",
                "ec2:Monitor*",
                "ec2:Reset*",
                "ec2:Run*",
                "ec2:Start*",
                "ec2:Stop*",
                "ec2:Terminate*"
            ],
            "Resource": "*",
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "aws:RequestedRegion": [
                        "eu-west-1",
                        "eu-west-2",
                        "eu-west-3"
                    ]
                }
            }
        }
    ]
}       </code></pre>
     
        <h2 id="condition-keys-requesttag">aws:RequestTag/<em>tag-key</em></h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來將請求中傳遞的標籤鍵/值對與您在政策中所指定的標籤對進行比較。例如，您可以檢查請求是否包含標籤鍵 <code class="code">"Dept"</code> 並且其具有值 <code class="code">"Accounting"</code>。如需更多詳細資訊，請參閱 <a href="./access_tags.html#access_tags_control-requests">在 AWS 請求期間控制存取許可</a>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 在請求中傳遞標籤索引鍵/值對時，索引鍵會包含在請求內容中。在請求中傳遞多個標籤時，每個標籤鍵值對都會有一個內容索引鍵。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>此內容金鑰的格式為 <code class="code">"aws:RequestTag/<code class="replaceable">tag-key</code>":"<code class="replaceable">tag-value</code>"</code>，其中 <code class="replaceable">tag-key</code> 和 <code class="replaceable">tag-value</code> 是標籤鍵值組。標籤鍵與值皆不區分大小寫。這表示如果您在政策的條件元素中指定 <code class="code">"aws:RequestTag/TagKey1": "Value1"</code>，則該條件會符合名為 <code class="code">TagKey1</code> 或 <code class="code">tagkey1</code> 的要求標籤鍵 (但不會同時符合兩者)。</p>
        <p>此範例顯示雖然索引鍵為單一值，但如果索引鍵不同，您仍然可以在請求中使用多個索引鍵/值對。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": <span>{</span>
    "Effect": "Allow",
    "Action": "ec2:CreateTags",
    "Resource": "arn:aws:ec2:::instance/*",
    "Condition": <span>{</span>
      "StringEquals": <span>{</span>
        "aws:RequestTag/environment": [
          "preprod",
          "production"
        ],
        "aws:RequestTag/team": [
          "engineering"
        ]
      }
    }
  }
}
</code></pre>
     
        <h2 id="condition-keys-resourceaccount">aws:ResourceAccount</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來比較請求的資源所有者的 <a href="https://docs.aws.amazon.com/general/latest/gr/acct-identifiers.html">AWS 帳戶 ID</a> 與政策中的資源帳戶。然後，根據擁有該資源的帳戶來允許或拒絕對該資源的存取。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 此索引鍵一律會包含在大部分服務動作的請求內容中。下列動作不支援此索引鍵：</p>
                <div class="itemizedlist">
                     
                     
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>Amazon Elastic Block Store – 所有動作</p>
                    </li><li class="listitem">
                        <p>Amazon EC2</p>
                        <div class="itemizedlist">
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p><code class="code">ec2:AcceptTransitGatewayPeeringAttachment</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:AcceptVpcEndpointConnections</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:AcceptVpcPeeringConnection</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:CopySnapshot</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:CreateVolume</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:CreateVpcEndpoint</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:CreateVpcPeeringConnection</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:DeleteTransitGatewayPeeringAttachment</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:DeleteVpcPeeringConnection</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:RejectTransitGatewayPeeringAttachment</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:RejectVpcEndpointConnections</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:RejectVpcPeeringConnection</code></p>
                            </li></ul></div>
                    </li><li class="listitem">
                        <p>Amazon EventBridge — 所有動作</p>
                    </li><li class="listitem">
                        <p>Amazon Route 53</p>
                        <div class="itemizedlist">
                             
                             
                             
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p><code class="code">route53:AssociateVpcWithHostedZone</code></p>
                            </li><li class="listitem">
                                <p><code class="code">route53:CreateVPCAssociationAuthorization</code></p>
                            </li><li class="listitem">
                                <p><code class="code">route53:DeleteVPCAssociationAuthorization</code></p>
                            </li><li class="listitem">
                                <p><code class="code">route53:DisassociateVPCFromHostedZone</code></p>
                            </li><li class="listitem">
                                <p><code class="code">route53:ListHostedZonesByVPC</code></p>
                            </li></ul></div>
                    </li><li class="listitem">
                        <p>Amazon WorkSpaces</p>
                        <div class="itemizedlist">
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p><code class="code">workspaces:DescribeWorkspaceImages</code></p>
                            </li></ul></div>
                    </li></ul></div>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>如需上述不受支援動作的其他考量事項，請參閱<a href="https://github.com/aws-samples/data-perimeter-policy-examples" rel="noopener noreferrer" target="_blank"><span>資料周邊政策範例</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>儲存庫。</p></div></div>
        <p>此金鑰等於已在請求中評估其資源之帳戶的 AWS 帳戶 ID。</p>
        <p>對於您帳戶中的大部分資源，<a href="./reference_policies_elements_condition_operators.html#Conditions_ARN">ARN</a> 包含該資源的擁有者帳戶 ID。對於某些資源 (例如 Amazon S3 儲存貯體)，資源 ARN 不包含帳戶 ID。以下兩個範例顯示在 ARN 中具有帳戶 ID 的資源與沒有帳戶 ID 的 Amazon S3 ARN 之間的差異：</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><code class="code">arn:aws:iam::123456789012:role/AWSExampleRole</code> – 在帳戶 123456789012 中建立和擁有的 IAM 角色。</p>
            </li><li class="listitem">
                <p><code class="code">arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET2</code></code> – 在帳戶 <code class="code">111122223333</code> 中建立和擁有 Amazon S3 儲存貯體，不會顯示在 ARN 中。</p>
            </li></ul></div>
        <p>使用 AWS 主控台或 API 或 CLI，查找所有資源和對應的 ARN。</p>
        <p>您撰寫的政策會根據資源擁有者的帳戶 ID 拒絕資源許可。例如，如果<em>指定資源</em>不屬於<em>指定帳戶</em>，下列身分型政策會拒絕存取這些資源。</p>
        <p>若要使用此政策，請將<em>斜體預留位置文字</em>取代為您的帳戶資訊。</p>
        <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>重要</h6></div><div class="awsdocs-note-text"><p>此政策不允許任何動作。相反，它使用 <code class="code">Deny</code> 效果，明確拒絕存取陳述式中列出的不屬於所列帳戶的所有資源。將此政策與允許存取特定資源的其他政策結合使用。</p></div></div>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": [
    <span>{</span>
      "Sid": "DenyInteractionWithResourcesNotInSpecificAccount",
      "Action": "<code class="replaceable">service</code>:*",
      "Effect": "Deny",
      "Resource": [
        "arn:aws:<code class="replaceable">service</code>:<code class="replaceable">region</code>:<code class="replaceable">account</code>:<code class="replaceable">*</code>"
      ],
      "Condition": <span>{</span>
        "StringNotEquals": <span>{</span>
          "aws:ResourceAccount": [
            "<code class="replaceable">account</code>"
          ]
        }
      }
    }
  ]
}</code></pre>
        <p>此政策拒絕存取特定 AWS 服務的所有資源，除非指定 AWS 帳戶 擁有資源。</p>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>一些 AWS 服務要求存取託管在另一個 AWS中的 AWS 帳戶 擁有的資源。在身分型政策中使用 <code class="code">aws:ResourceAccount</code>，可能會影響您的身分存取這些資源。</p></div></div>
        <p>某些 AWS 服務，例如 AWS Data Exchange，依賴於存取您的 AWS 帳戶 以外的資源進行正常操作。如果在政策中使用元素 <code class="code">aws:ResourceAccount</code>，請包含其他陳述式來建立這些服務的豁免。範例政策 <a href="./reference_policies_examples_resource_account_data_exch.html">AWS：拒絕存取您帳戶以外的 Amazon S3 資源，但 AWS Data Exchange 除外</a> 示範如何在定義服務所擁有資源的例外狀況時，根據資源帳戶拒絕存取。</p>
        <p>使用此政策範例作為建立您自己的自訂政策的範本。如需詳細資訊，請參閱您的服務<a href="https://docs.aws.amazon.com/index.html">文件</a>。</p>
     
        <h2 id="condition-keys-resourceorgid">aws:ResourceOrgID</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來比較請求的資源所屬的 AWS 組織中的組織識別碼與政策中指定的識別碼。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 只有在擁有資源的帳戶是組織成員時，請求內容中才會包含此金鑰。此全域條件金鑰不支援下列動作：</p>
                <div class="itemizedlist">
                     
                     
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>Amazon Elastic Block Store – 所有動作</p>
                    </li><li class="listitem">
                        <p>Amazon EC2</p>
                        <div class="itemizedlist">
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p><code class="code">ec2:AcceptTransitGatewayPeeringAttachment</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:AcceptVpcEndpointConnections</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:AcceptVpcPeeringConnection</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:CopySnapshot</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:CreateVolume</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:CreateVpcEndpoint</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:CreateVpcPeeringConnection</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:DeleteTransitGatewayPeeringAttachment</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:DeleteVpcPeeringConnection</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:RejectTransitGatewayPeeringAttachment</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:RejectVpcEndpointConnections</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:RejectVpcPeeringConnection</code></p>
                            </li></ul></div>
                    </li><li class="listitem">
                        <p>Amazon EventBridge — 所有動作</p>
                    </li><li class="listitem">
                        <p>Amazon Route 53</p>
                        <div class="itemizedlist">
                             
                             
                             
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p><code class="code">route53:AssociateVpcWithHostedZone</code></p>
                            </li><li class="listitem">
                                <p><code class="code">route53:CreateVPCAssociationAuthorization</code></p>
                            </li><li class="listitem">
                                <p><code class="code">route53:DeleteVPCAssociationAuthorization</code></p>
                            </li><li class="listitem">
                                <p><code class="code">route53:DisassociateVPCFromHostedZone</code></p>
                            </li><li class="listitem">
                                <p><code class="code">route53:ListHostedZonesByVPC</code></p>
                            </li></ul></div>
                    </li><li class="listitem">
                        <p>Amazon WorkSpaces</p>
                        <div class="itemizedlist">
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p><code class="code">workspaces:DescribeWorkspaceImages</code></p>
                            </li></ul></div>
                    </li></ul></div>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>如需上述不受支援動作的其他考量事項，請參閱<a href="https://github.com/aws-samples/data-perimeter-policy-examples" rel="noopener noreferrer" target="_blank"><span>資料周邊政策範例</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>儲存庫。</p></div></div>
        <p>此全域索引鍵會傳回指定請求的資源組織 ID。它可讓您建立規則，這些規則適用於<a href="./access_policies_identity-vs-resource.html">身分型政策</a>的 <code class="code">Resource</code> 元素中指定的組織中的所有資源。您可以在條件元素中指定<a href="https://docs.aws.amazon.com/organizations/latest/userguide/orgs_manage_org_details.html">組織 ID</a>。當您新增和移除帳戶時，包含 <code class="code">aws:ResourceOrgID</code> 索引鍵的政策會自動包含正確的帳戶，您無需手動更新它。</p>
        <p>例如，下列政策可避免主體將物件新增至 <code class="code">policy-genius-dev</code> 資源，除非 Amazon S3 資源屬於與提出請求的主體相同的組織。</p>
        <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>重要</h6></div><div class="awsdocs-note-text"><p>此政策不允許任何動作。相反，它使用 <code class="code">Deny</code> 效果，明確拒絕存取陳述式中列出的不屬於所列帳戶的所有資源。將此政策與允許存取特定資源的其他政策結合使用。</p></div></div>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
  "Version": "2012-10-17",
  "Statement": <span>{</span>
    "Sid": "DenyPutObjectToS3ResourcesOutsideMyOrganization",
    "Effect": "Deny",
    "Action": "s3:PutObject",
    "Resource": "arn:<code class="replaceable">partition</code>:s3:::policy-genius-dev/*",
    "Condition": <span>{</span>
      "StringNotEquals": <span>{</span>
        "aws:ResourceOrgID": "$<span>{</span>aws:PrincipalOrgID}"
      }
    }
  }
}</code></pre>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>一些 AWS 服務要求存取託管在另一個 AWS中的 AWS 帳戶 擁有的資源。在身分型政策中使用 <code class="code">aws:ResourceOrgID</code>，可能會影響您的身分存取這些資源。</p></div></div>
        
        <p>某些 AWS 服務，例如 AWS Data Exchange，依賴於存取您的 AWS 帳戶 以外的資源進行正常操作。如果在政策中使用 <code class="code">aws:ResourceOrgID</code> 索引鍵，請包含其他陳述式來建立這些服務的豁免。範例政策 <a href="./reference_policies_examples_resource_account_data_exch.html">AWS：拒絕存取您帳戶以外的 Amazon S3 資源，但 AWS Data Exchange 除外</a> 示範如何在定義服務所擁有資源的例外狀況時，根據資源帳戶拒絕存取。您可以建立類似的政策，使用 <code class="code">aws:ResourceOrgID</code> 索引鍵來限制組織內資源的存取，同時考量服務擁有的資源。</p>
        <p>使用此政策範例作為建立您自己的自訂政策的範本。如需詳細資訊，請參閱您的服務<a href="https://docs.aws.amazon.com/index.html">文件</a>。</p>
        
        <p>在下列影片中，進一步了解如何在政策中使用 <code class="code">aws:ResourceOrgID</code> 條件金鑰。</p>
        <div class="mediaobject">
             
                <iframe width="720" height="330" frameborder="0" allowfullscreen="" webkitallowfullscreen="" mozallowfullscreen="" sandbox="allow-scripts allow-same-origin allow-popups" src="https://www.youtube-nocookie.com/embed/cWVW0xAiWwc"></iframe>
             
             
        </div>
        
        
        
     
        <h2 id="condition-keys-resourceorgpaths">aws:ResourceOrgPaths</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來比較所存取資源的 AWS Organizations 路徑與政策中的路徑。在政策中，此條件金鑰會確保資源屬於指定組織根帳戶或 AWS Organizations 中組織單位 (OU) 內的帳戶成員。AWS Organizations 路徑是 Organizations 實體結構的文字表示。如需有關使用和了解路徑的詳細資訊，請參閱 <a href="./access_policies_access-advisor-view-data-orgs.html#access_policies_access-advisor-viewing-orgs-entity-path">了解 AWS Organizations 實體路徑</a>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 只有在擁有資源的帳戶是組織成員時，請求內容中才會包含此金鑰。此全域條件金鑰不支援下列動作：</p>
                <div class="itemizedlist">
                     
                     
                     
                     
                     
                <ul class="itemizedlist"><li class="listitem">
                        <p>Amazon Elastic Block Store – 所有動作</p>
                    </li><li class="listitem">
                        <p>Amazon EC2</p>
                        <div class="itemizedlist">
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p><code class="code">ec2:AcceptTransitGatewayPeeringAttachment</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:AcceptVpcEndpointConnections</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:AcceptVpcPeeringConnection</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:CopySnapshot</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:CreateVolume</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:CreateVpcEndpoint</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:CreateVpcPeeringConnection</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:DeleteTransitGatewayPeeringAttachment</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:DeleteVpcPeeringConnection</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:RejectTransitGatewayPeeringAttachment</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:RejectVpcEndpointConnections</code></p>
                            </li><li class="listitem">
                                <p><code class="code">ec2:RejectVpcPeeringConnection</code></p>
                            </li></ul></div>
                    </li><li class="listitem">
                        <p>Amazon EventBridge — 所有動作</p>
                    </li><li class="listitem">
                        <p>Amazon Route 53</p>
                        <div class="itemizedlist">
                             
                             
                             
                             
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p><code class="code">route53:AssociateVpcWithHostedZone</code></p>
                            </li><li class="listitem">
                                <p><code class="code">route53:CreateVPCAssociationAuthorization</code></p>
                            </li><li class="listitem">
                                <p><code class="code">route53:DeleteVPCAssociationAuthorization</code></p>
                            </li><li class="listitem">
                                <p><code class="code">route53:DisassociateVPCFromHostedZone</code></p>
                            </li><li class="listitem">
                                <p><code class="code">route53:ListHostedZonesByVPC</code></p>
                            </li></ul></div>
                    </li><li class="listitem">
                        <p>Amazon WorkSpaces</p>
                        <div class="itemizedlist">
                             
                        <ul class="itemizedlist"><li class="listitem">
                                <p><code class="code">workspaces:DescribeWorkspaceImages</code></p>
                            </li></ul></div>
                    </li></ul></div>
            </li><li class="listitem">
                <p><b>值類型</b> - 多重值</p>
            </li></ul></div>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>如需上述不受支援動作的其他考量事項，請參閱<a href="https://github.com/aws-samples/data-perimeter-policy-examples" rel="noopener noreferrer" target="_blank"><span>資料周邊政策範例</span><awsui-icon class="awsdocs-link-icon" name="external"></awsui-icon></a>儲存庫。</p></div></div>
        <p><code class="code">aws:ResourceOrgPaths</code> 是多重值條件金鑰。多重值金鑰在請求內容中可以擁有多個值。使用此金鑰時，您必須使用 <code class="code">ForAnyValue</code> 或 <code class="code">ForAllValues</code> 設定運算子搭配<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串條件運算子</a>。如需有關多重值條件金鑰的詳細資訊，請參閱 <a href="./reference_policies_multi-value-conditions.html#reference_policies_multi-key-or-value-conditions">使用多個金鑰和值</a>。</p>
        <p>例如，下列條件會對屬於組織 <code class="code">o-a1b2c3d4e5</code> 的資源傳回 <code class="code">True</code>。當您包含萬用字元時，您必須使用 <a href="./reference_policies_elements_condition_operators.html">StringLike</a> 條件運算子。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="">"Condition": <span>{</span> 
      "ForAnyValue:StringLike": <span>{</span>
             "aws:ResourceOrgPaths":["o-a1b2c3d4e5/*"]
   }
}</code></pre>
        <p>針對具有 OU ID <code class="code">ou-ab12-11111111</code> 的資源，下列條件會傳回 <code class="code">True</code>。該條件會比對連接至 OU ou-ab12-11111111 或任何子 OU 的帳戶所擁有的資源。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="">"Condition": <span>{</span> "ForAnyValue:StringLike" : <span>{</span>
     "aws:ResourceOrgPaths":["o-a1b2c3d4e5/r-ab12/ou-ab12-11111111/*"]
}}</code></pre>
        <p>下列條件會對直接連接至 OU ID <code class="code">ou-ab12-22222222</code> 但未連接至子 OU 的帳戶所擁有的資源傳回 <code class="code">True</code>。下列範例會使用 <a href="./reference_policies_elements_condition_operators.html">StringEquals</a> 條件運算子來指定 OU ID 的精確比對要求，而非萬用字元比對。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="">"Condition": <span>{</span> "ForAnyValue:StringEquals" : <span>{</span>
     "aws:ResourceOrgPaths":["o-a1b2c3d4e5/r-ab12/ou-ab12-11111111/ou-ab12-22222222/"]
}}</code></pre>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p>一些 AWS 服務要求存取託管在另一個 AWS中的 AWS 帳戶 擁有的資源。在身分型政策中使用 <code class="code">aws:ResourceOrgPaths</code>，可能會影響您的身分存取這些資源。</p></div></div>
        
        <p>某些 AWS 服務，例如 AWS Data Exchange，依賴於存取您的 AWS 帳戶 以外的資源進行正常操作。如果在政策中使用 <code class="code">aws:ResourceOrgPaths</code> 索引鍵，請包含其他陳述式來建立這些服務的豁免。範例政策 <a href="./reference_policies_examples_resource_account_data_exch.html">AWS：拒絕存取您帳戶以外的 Amazon S3 資源，但 AWS Data Exchange 除外</a> 示範如何在定義服務所擁有資源的例外狀況時，根據資源帳戶拒絕存取。您可以建立類似的政策，使用 <code class="code">aws:ResourceOrgPaths</code> 索引鍵來限制組織單位 (OU) 內資源的存取，同時考量服務擁有的資源。</p>
        <p>使用此政策範例作為建立您自己的自訂政策的範本。如需詳細資訊，請參閱您的服務<a href="https://docs.aws.amazon.com/index.html">文件</a>。</p>
     
        <h2 id="condition-keys-resourcetag">aws:ResourceTag/<em>tag-key</em></h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來將您在政策中所指定的標籤鍵值對與連接到資源的鍵值對進行比較。例如，您可以要求只在資源擁有連接標籤鍵 <code class="code">"Dept"</code> 和值 <code class="code">"Marketing"</code> 時才允許資源的存取。如需更多詳細資訊，請參閱 <a href="./access_tags.html#access_tags_control-resources">控制 AWS 資源的存取許可</a>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 當所請求資源已連接標籤時，此索引鍵包含在請求內容中，或者包含在使用所連接標籤建立資源的請求中。只有在資源<a href="./reference_aws-services-that-work-with-iam.html">支援以標籤為基礎的授權</a>時，才會傳回此索引鍵。每個標籤鍵值對都會有一個內容索引鍵。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>此內容金鑰的格式為 <code class="code">"aws:ResourceTag/<code class="replaceable">tag-key</code>":"<code class="replaceable">tag-value</code>"</code>，其中 <code class="replaceable">tag-key</code> 和 <code class="replaceable">tag-value</code> 是標籤鍵值組。標籤鍵與值皆不區分大小寫。這表示如果您在政策的條件元素中指定 <code class="code">"aws:ResourceTag/TagKey1": "Value1"</code>，則該條件會符合名為 <code class="code">TagKey1</code> 或 <code class="code">tagkey1</code> 的資源標籤鍵 (但不會同時符合兩者)。</p>
        <p>如需使用 <code class="code">aws:ResourceTag</code> 索引鍵來控制 IAM 資源存取的範例，請參閱 <a href="./access_tags.html#access_tags_control-resources">控制 AWS 資源的存取許可</a>。</p>
        <p>如需使用 <code class="code">aws:ResourceTag</code> 索引鍵來控制其他 AWS 資源存取的範例，請參閱 <a href="./access_tags.html">使用標籤控制對 AWS 資源的存取權</a>。</p>
        <p>如需有關使用屬性型存取控制 (ABAC) 之 <code class="code">aws:ResourceTag</code> 條件金鑰的教程，請參閱 <a href="./tutorial_attribute-based-access-control.html">IAM 教學課程：根據標籤定義存取 AWS 資源的許可</a>。</p>
     
        <h2 id="condition-keys-securetransport">aws:SecureTransport</h2>
        <p>適用於<a href="./reference_policies_elements_condition_operators.html#Conditions_Boolean">布林運算子</a>。</p>
        <p>使用此索引鍵來檢查請求是否使用 SSL 進行傳送。請求內容會傳回 <code class="code">true</code> 或 <code class="code">false</code>。在政策中，您可以允許只有在請求使用 SSL 傳送時，才能進行特定動作。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 此金鑰一律會包含在請求內容中。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
     
        <h2 id="condition-keys-sourceaccount">aws:SourceAccount</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵，將提出服務對服務請求之資源的帳戶 ID 與您在政策中所指定的帳戶 ID 進行比較。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 只有在存取的資源觸發 AWS 服務代替資源擁有者呼叫另一個服務時，請求內容中才會包含此索引鍵。呼叫服務必須將來源的資源帳戶 ID 傳遞給呼叫的服務。此帳戶 ID 包含來源帳戶 ID。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>您可以使用此條件金鑰，來防止在服務之間的交易處理期間將 AWS 服務作為<a href="./confused-deputy.html">混淆代理人</a>使用。將此條件金鑰的值設定為請求中資源的帳戶。例如，當 Amazon S3 儲存貯體更新觸發 Amazon SNS 主題文章時，Amazon S3 服務會呼叫 <code class="code">sns:Publish</code> API 操作。在允許 <code class="code">sns:Publish</code> 操作的政策中，將條件金鑰的值設定為 Amazon S3 儲存貯體的帳戶 ID。如需如何和何時建議這些條件金鑰的詳細資訊，請參閱您正在使用的 AWS 服務的相關文件。</p>
     
        <h2 id="condition-keys-sourcearn">aws:SourceArn</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_ARN">ARN 運算子</a>和<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。AWS 建議您在比較 ARN 時使用 ARN 運算子，而不是字串運算子。</p>
        <p>使用此索引鍵，將提出服務對服務請求之資源的 <a href="./reference_identifiers.html#identifiers-arns">Amazon Resource Name (ARN)</a> 與您在政策中所指定的 ARN 進行比較。</p>
        <p>此索引鍵不適用提出請求的主體 ARN。請改用 <a href="#condition-keys-principalarn">aws:PrincipalArn</a>。來源的 ARN 包括帳戶 ID，因此不需要搭配 <code class="code">aws:SourceAccount</code> 使用 <code class="code">aws:SourceArn</code>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 只有在存取的資源觸發 AWS 服務代替資源擁有者呼叫另一個服務時，請求內容中才會包含此索引鍵。呼叫服務必須將原始資源的 ARN 傳遞給呼叫的服務。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>您可以使用此條件金鑰，來防止在服務之間的交易處理期間將 AWS 服務作為<a href="./confused-deputy.html">混淆代理人</a>使用。將此條件金鑰的值設定為請求中資源的 ARN。例如，當 Amazon S3 儲存貯體更新觸發 Amazon SNS 主題文章時，Amazon S3 服務會呼叫 <code class="code">sns:Publish</code> API 操作。在允許 <code class="code">sns:Publish</code> 操作的政策中，將條件金鑰的值設定為 Amazon S3 儲存貯體的 ARN。如需如何和何時建議這些條件金鑰的詳細資訊，請參閱您正在使用的 AWS 服務的相關文件。</p>
     
        <h2 id="condition-keys-sourceidentity">aws:SourceIdentity</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來將主體所設定的來源身分與您在政策中所指定的來源身分進行比較。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> –當使用任何 AWS STS 擔任角色 CLI 命令或 AWS STS <code class="code">AssumeRole</code> API 操作擔任角色時，在設定來源身分後，請求中即會出現此索引鍵。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>您可以在政策中使用此索引鍵，以允許在擔任角色時設定來源身分的主體在 AWS 中執行動作。<a href="./cloudtrail-integration.html#cloudtrail-integration_signin-tempcreds">AWS CloudTrail</a> 中會顯示角色指定來源身分的活動。這可讓系統管理員更容易判斷何者在 AWS 中執行具有角色的動作。</p>
        <p>與 <a href="./reference_policies_iam-condition-keys.html#ck_rolesessionname">sts:RoleSessionName</a> 不同，在設定來源身分之後，就無法變更值。這會出現在由角色所採取的所有動作的請求內容中。當您使用工作階段憑證來擔任另一個角色時，此值仍然存在於後續角色工作階段。從另一個角色取得及擔任角色稱為<a href="./id_roles_terms-and-concepts.html#iam-term-role-chaining">角色鏈結</a>。</p>
        <p>當主體在使用任何 AWS STS 擔任角色 CLI 命令或 AWS STS <code class="code">AssumeRole</code> API 操作承擔角色時最初設定來源身分時，請求中即會出現 <a href="./reference_policies_iam-condition-keys.html#ck_sourceidentity">sts:SourceIdentity</a> 索引鍵。針對具有來源身分集的角色工作階段所採取的任何動作，<code class="code">aws:SourceIdentity</code> 索引鍵會出現在請求中。</p>
        <p>下列在帳戶 <code class="code">111122223333</code> 中的 <code class="code">CriticalRole</code> 角色信任政策包含針對 <code class="code">aws:SourceIdentity</code> 的條件，可防止沒有設定為 Saanvi 或 Diego 的來源身分的主體擔任角色。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "AssumeRoleIfSourceIdentity",
            "Effect": "Allow",
            "Principal": <span>{</span>"AWS": "arn:aws:iam::123456789012:role/CriticalRole"},
            "Action": [
                "sts:AssumeRole",
                "sts:SetSourceIdentity"
            ],
            "Condition": <span>{</span>
                "StringLike": <span>{</span>
                    "aws:SourceIdentity": ["Saanvi","Diego"]
                }
            }
        }
    ]
}
</code></pre>
        <p>若要進一步了解有關使用來源身分的詳細資訊，請參閱 <a href="./id_credentials_temp_control-access_monitor.html">監控並控制使用擔任角色所採取的動作</a>。</p>
     
        <h2 id="condition-keys-sourceip">aws:SourceIp</h2>
        <p>適用於 <a href="./reference_policies_elements_condition_operators.html#Conditions_IPAddress">IP 地址運算子</a>。</p>
        <p>使用此索引鍵來將申請者的 IP 地址和您在政策中所指定的 IP 地址進行比較。<code class="code">aws:SourceIp</code> 條件金鑰僅可用於公有 IP 地址範圍。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 此索引鍵會包含在請求內容中，但當申請者使用 VPC 端點提出請求時則除外。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p><code class="code">aws:SourceIp</code> 條件金鑰可用在政策中，只允許主體在指定的 IP 範圍內提出請求。不過，如果 AWS 服務代表主體進行呼叫，則此政策會拒絕存取。在此情況下，您可以將 <code class="code">aws:SourceIp</code> 搭配 <code class="code"><a href="#condition-keys-viaawsservice">aws:ViaAWSService</a></code> 索引鍵使用，以確保來源 IP 限制僅適用於主體的直接請求。</p>
        <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>注意</h6></div><div class="awsdocs-note-text"><p> <code class="code">aws:SourceIp</code> 同時支援 IPv4 和 IPv6 IP 地址或者 IP 地址範圍。如需詳細資訊，請參閱<a href="https://docs.aws.amazon.com/marketplace/latest/buyerguide/buyer-security-ipv6-upgrade.html">將 IAM 政策升級為 IPv6</a>。</p></div></div>
        <p>例如，您可以將以下政策連接到 IAM 使用者。若 <code class="code"><code class="replaceable">DOC-EXAMPLE-BUCKET3</code></code> Amazon S3 儲存貯體從指定的 IP 地址進行呼叫，則此政策允許使用者直接將物件放入這兩個儲存貯體中。不過，如果使用者發出另一個請求，導致服務呼叫 Amazon S3，則不會套用 IP 地址限制。僅在請求不是由服務提出時，<code class="code">PrincipalPutObjectIfIpAddress</code> 陳述式才會限制 IP 地址。如果請求是由服務提出，則 <code class="code">ServicePutObject</code> 陳述式允許操作，不受 IP 地址限制。</p>
        <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="複製"><awsui-icon name="copy"></awsui-icon></div></div><code class="json "><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Sid": "PrincipalPutObjectIfIpAddress",
            "Effect": "Allow",
            "Action": "s3:PutObject",
            "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET3</code>/*",
            "Condition": <span>{</span>
                "Bool": <span>{</span>"aws:ViaAWSService": "false"},
                "IpAddress": <span>{</span>"aws:SourceIp": "<code class="replaceable">203.0.113.0</code>"}
            }
        },
        <span>{</span>
            "Sid": "ServicePutObject",
            "Effect": "Allow",
            "Action": "s3:PutObject",
            "Resource": "arn:aws:s3:::<code class="replaceable">DOC-EXAMPLE-BUCKET</code>/*",
            "Condition": <span>{</span>
                "Bool": <span>{</span>"aws:ViaAWSService": "true"}
            }
        }
    ]
}</code></pre>
        <p>如果請求來自使用 Amazon VPC 端點的主機，則 <code class="code">aws:SourceIp</code> 索引鍵不可用。建議您改為使用 VPC 專屬索引鍵，例如 aws:VpcSourceIp。如需有關使用 VPC 端點的詳細資訊，請參閱 <em>AWS PrivateLink 指南</em>中的 <a href="https://docs.aws.amazon.com/vpc/latest/privatelink/vpc-endpoints-iam.html">VPC 端點和 VPC 端點服務的身分與存取管理</a>。</p>
     
        <h2 id="condition-keys-sourcevpc">aws:SourceVpc</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來檢查請求是否來自您在政策中所指定的 VPC。在政策中，您可以使用此索引鍵，只允許存取特定 VPC。如需詳細資訊，請參閱 <em>Amazon Simple Storage Service 使用者指南</em>中的<a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies-vpc-endpoint.html#example-bucket-policies-restrict-access-vpc">限制特定 VPC 的存取</a>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 只有在申請者使用 VPC 端點提出請求時，請求內容中才會包含此金鑰。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
     
        <h2 id="condition-keys-sourcevpce">aws:SourceVpce</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來將請求的 VPC 端點識別碼與您在政策中所指定的端點 ID 進行比較。在政策中，您可以使用此索引鍵來將存取限制在特定 VPC 端點。如需詳細資訊，請參閱 <em>Amazon Simple Storage Service 使用者指南</em>中的<a href="https://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies-vpc-endpoint.html#example-bucket-policies-restrict-access-vpc-endpoint">限制特定 VPC 端點的存取</a>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 只有在申請者使用 VPC 端點提出請求時，請求內容中才會包含此金鑰。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
     
        <h2 id="condition-keys-tagkeys">aws:TagKeys</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來將請求中的標籤鍵與您在政策中所指定的索引鍵進行比較。當使用政策來控制使用標籤的存取時，建議您使用 <code class="code">aws:TagKeys</code> 條件金鑰來定義允許的標籤金鑰。如需範例政策和詳細資訊，請參閱 <a href="./access_tags.html#access_tags_control-tag-keys">根據標籤索引鍵控制存取權限</a>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 如果操作支援在請求中傳遞標籤，則此索引鍵會包含在請求內容中。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 多重值</p>
            </li></ul></div>
        <p>此內容索引鍵的格式為 <code class="code">"aws:TagKeys":"<code class="replaceable">tag-key</code>"</code>，其中 <code class="replaceable">tag-key</code> 是沒有值的標籤鍵清單 (例如，<code class="code">["Dept","Cost-Center"]</code>)。</p>
        <p>由於您可以在請求中包含多個標籤鍵值對，因此請求內容可能會是<a href="./reference_policies_multi-value-conditions.html">多值</a>請求。在這種情況下，您必須使用 <code class="code">ForAllValues</code> 或 <code class="code">ForAnyValue</code> 設定運算子。如需詳細資訊，請參閱 <a href="./reference_policies_multi-value-conditions.html#reference_policies_multi-key-or-value-conditions">使用多個金鑰和值</a>。</p>
        <p>有些服務支援標記搭配資源操作，如建立、修改或刪除資源。若要允許標記和操作作為單一呼叫，您必須建立一個政策，同時包括標記動作和資源修改動作。然後，您可以使用 <code class="code">aws:TagKeys</code> 條件金鑰以強制執行在請求中使用特定的標籤鍵。例如，若要在某人建立 Amazon EC2 快照時限制標籤，您必須在政策中包含 <code class="code">ec2:CreateSnapshot</code> 建立動作<em><b>和</b></em> <code class="code">ec2:CreateTags</code> 標記動作。若要檢視適用於此案例 (使用 <code class="code">aws:TagKeys</code>) 的政策，請參閱 <em>Amazon EC2 Linux 執行個體使用者指南</em>中的<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ExamplePolicies_EC2.html#iam-creating-snapshot-with-tags">使用標籤建立快照</a>。</p>
     
        <h2 id="condition-keys-tokenissuetime">aws:TokenIssueTime</h2>
        <p>適用於<a href="./reference_policies_elements_condition_operators.html#Conditions_Date">日期運算子</a>。</p>
        <p>使用此索引鍵來將發行暫時性安全憑證的日期和時間與您在政策中所指定的日期和時間進行比較。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 只有在主體使用暫時憑證發出請求時，請求內容中才會包含此索引鍵。在使用存取索引鍵的 AWS CLI、AWS API 或 AWS 開發套件請求中不存在此索引鍵。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>若要了解哪些服務支援使用暫時憑證，請參閱<a href="./reference_aws-services-that-work-with-iam.html">可搭配 IAM 運作的 AWS 服務</a>。</p>
     
        <h2 id="condition-keys-useragent">aws:UserAgent</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來將申請者的用戶端應用程式與您在政策中指定的應用程式進行比較。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 此金鑰一律會包含在請求內容中。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <div class="awsdocs-note awsdocs-warning"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>警告</h6></div><div class="awsdocs-note-text"><p>應該小心使用此索引鍵。由於<code class="code">aws:UserAgent</code> 值由 HTTP 標頭中的呼叫者提供，未授權方可以使用修改的或自訂瀏覽器來提供他們選擇的任何 <code class="code">aws:UserAgent</code> 值。因此，不應該使用 <code class="code">aws:UserAgent</code> 來防止未經授權方提出直接 AWS 請求。您可以使用它僅允許特定用戶端應用程式，而且只在測試政策之後才能使用。</p></div></div>
     
        <h2 id="condition-keys-userid">aws:userid</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵來將申請者的主體識別碼與您在政策中所指定的 ID 進行比較。針對 IAM 使用者，請求內容值是使用者 ID。針對 IAM 角色，此值的格式可能會不同。如需針對不同主體資訊顯示方式的詳細資訊，請參閱 <a href="./reference_policies_elements_principal.html#Principal_specifying">指定主體</a>。如需 <code class="code">principal</code> 鍵值的具體範例，請參閱 <a href="./reference_policies_variables.html#principaltable">主體索引鍵值</a>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 此金鑰會包含在所有請求的請求內容中，包括匿名請求。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
     
        <h2 id="condition-keys-username">aws:username</h2>
        <p>使用<a href="./reference_policies_elements_condition_operators.html#Conditions_String">字串運算子</a>。</p>
        <p>使用此索引鍵將申請者的使用者名稱與您在政策中所指定的使用者名稱進行比較。如需針對不同主體資訊顯示方式的詳細資訊，請參閱 <a href="./reference_policies_elements_principal.html#Principal_specifying">指定主體</a>。如需 <code class="code">principal</code> 鍵值的具體範例，請參閱 <a href="./reference_policies_variables.html#principaltable">主體索引鍵值</a>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 此索引鍵一律會包含在 IAM 使用者的請求內容中。匿名請求和使用 AWS 帳戶根使用者 或 IAM 角色提出的請求不會包含此索引鍵。使用 IAM Identity Center 憑證提出的請求不會在內容中包含此索引鍵。若要了解如何控制對 IAM Identity Center 使用者的存取，請參閱<a href="https://docs.aws.amazon.com/singlesignon/latest/userguide/using-predefined-attributes.html">使用 IAM Identity Center 身分識別存放區中的預先定義屬性以取得 AWS 存取控制</a>中的 <code class="code">identitystore:UserId</code>。IAM Identity Center 中的使用者是您員工中需要存取 AWS 帳戶 或雲端應用程式的人員。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
     
        <h2 id="condition-keys-viaawsservice">aws:ViaAWSService</h2>
        <p>適用於<a href="./reference_policies_elements_condition_operators.html#Conditions_Boolean">布林運算子</a>。</p>
        <p>使用此索引鍵來檢查 AWS 服務是否代表您向另一個服務發出請求。</p>
        <p>服務代表 IAM 主體使用主體的憑證來提出請求時，請求環境索引鍵即傳回 <code class="code">true</code>。若服務使用<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-role">服務角色</a>或<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-linked-role">服務連結角色</a>來代表主體呼叫，則環境索引鍵即傳回 <code class="code">false</code>。主體直接進行呼叫時，請求環境索引鍵也會傳回 <code class="code">false</code>。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 此金鑰一律會包含在請求內容中。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>您可以使用此條件金鑰，根據請求是否由服務提出，允許或拒絕存取。若要檢視政策範例，請參閱 <a href="./reference_policies_examples_aws_deny-ip.html">AWS：拒絕根據來源 IP 存取 AWS</a>。</p>
     
        <h2 id="condition-keys-vpcsourceip">aws:VpcSourceIp</h2>
        <p>適用於 <a href="./reference_policies_elements_condition_operators.html#Conditions_IPAddress">IP 地址運算子</a>。</p>
        <p>使用此索引鍵來將提出請求的 IP 地址與您在政策中所指定的 IP 地址進行比較。在政策中，只有在請求來自指定 IP 地址並且透過 VPC 端點時，此索引鍵才會相符。</p>
        <div class="itemizedlist">
             
             
        <ul class="itemizedlist"><li class="listitem">
                <p><b>可用性</b> – 只有在請求是使用 VPC 端點提出時，請求內容中才會包含此索引鍵。</p>
            </li><li class="listitem">
                <p><b>值類型</b> - 單一值</p>
            </li></ul></div>
        <p>如需詳細資訊，請參閱 <em>Amazon VPC 使用者指南</em>中的<a href="https://docs.aws.amazon.com/vpc/latest/userguide/vpc-endpoints-access.html">使用 VPC 端點控制服務的存取</a>。</p>
     
        <h2 id="condition-keys-other">其他跨服務條件金鑰</h2>
        <p>全域條件金鑰是帶有 <code class="code">aws:</code> 字首的條件金鑰。個別服務可以建立自己的條件金鑰。這些服務特定條件金鑰包含符合服務名稱的字首，例如 <code class="code">iam:</code> 或 <code class="code">sts:</code>。</p>
        <p>服務可以建立可在其他服務的請求內容中使用的服務特定索引鍵。這些索引鍵可跨多個服務使用，但不是全域條件金鑰。例如，AWS STS 支援 <a href="./reference_policies_iam-condition-keys.html#condition-keys-saml">SAML 型聯合條件金鑰</a>。當使用 SAML 進行聯合的使用者在其他服務中執行 AWS 操作時，便可使用這些索引鍵。其他範例包括 <code class="code"><a href="https://docs.aws.amazon.com/singlesignon/latest/userguide/using-predefined-attributes.html">identitystore:UserId</a></code> 和 <code class="code"><a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-policy-structure.html#amazon-ec2-keys">ec2:SourceInstanceArn</a></code>。</p>
        <p>若要檢視服務的服務特定條件金鑰，請參閱<a href="https://docs.aws.amazon.com/service-authorization/latest/reference/reference_policies_actions-resources-contextkeys.html">AWS 服務的動作、資源和條件金鑰</a>並選擇您想要檢視其索引鍵的服務。</p>
    <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="警告" /> <strong>您的瀏覽器已停用或無法使用 Javascript。</strong></p><p>您必須啟用 Javascript，才能使用 AWS 文件。請參閱您的瀏覽器說明頁以取得說明。</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">文件慣用形式</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./access_policies_job-functions_create-policies.html">建立角色和連接政策 (主控台)</div><div id="next" class="next-link" accesskey="n" href="./reference_policies_iam-condition-keys.html">IAM 條件索引鍵</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">此頁面是否有幫助？ - 是</div><div class="content"><p>感謝您，讓我們知道我們做得很好！</p><p>若您有空，歡迎您告知我們值得讚許的地方，這樣才能保持良好服務。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="意見回饋" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference_policies_condition-keys.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">此頁面是否有幫助？ - 否</div><div class="content"><p>感謝讓我們知道此頁面仍須改善。很抱歉，讓您失望。</p><p>若您有空，歡迎您提供改善文件的方式。</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="意見回饋" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=IAM&amp;topic_url=https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/reference_policies_condition-keys.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>