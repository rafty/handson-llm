<!DOCTYPE html>
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Using service-linked roles for Amazon FSx - Amazon FSx for Windows File Server</title><meta name="viewport" content="width=device-width,initial-scale=1" /><meta name="assets_root" content="/assets" /><meta name="target_state" content="using-service-linked-roles" /><meta name="default_state" content="using-service-linked-roles" /><link rel="icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="shortcut icon" type="image/ico" href="/assets/images/favicon.ico" /><link rel="canonical" href="https://docs.aws.amazon.com/fsx/latest/WindowsGuide/using-service-linked-roles.html" /><meta name="description" content="How to use service-linked roles to give Amazon FSx access to resources in your AWS account." /><meta name="deployment_region" content="IAD" /><meta name="product" content="Amazon FSx for Windows File Server" /><meta name="guide" content="Windows User Guide" /><meta name="abstract" content="This is the official Amazon Web Services documentation for Amazon FSx for Windows File Server. Amazon FSx is an AWS service that makes it easier to launch and run shared file storage for Microsoft Windows workloads in the AWS Cloud. These workloads can include your business applications, home directories, web serving environments, and software build setups." /><meta name="guide-locale" content="en_us" /><meta name="tocs" content="toc-contents.json" /><link rel="canonical" href="https://docs.aws.amazon.com/fsx/latest/WindowsGuide/using-service-linked-roles.html" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="id-id" /><link rel="alternative" href="https://docs.aws.amazon.com/id_id/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="id" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="de-de" /><link rel="alternative" href="https://docs.aws.amazon.com/de_de/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="de" /><link rel="alternative" href="https://docs.aws.amazon.com/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="en-us" /><link rel="alternative" href="https://docs.aws.amazon.com/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="en" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="es-es" /><link rel="alternative" href="https://docs.aws.amazon.com/es_es/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="es" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="fr-fr" /><link rel="alternative" href="https://docs.aws.amazon.com/fr_fr/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="fr" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="it-it" /><link rel="alternative" href="https://docs.aws.amazon.com/it_it/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="it" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="ja-jp" /><link rel="alternative" href="https://docs.aws.amazon.com/ja_jp/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="ja" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="ko-kr" /><link rel="alternative" href="https://docs.aws.amazon.com/ko_kr/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="ko" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="pt-br" /><link rel="alternative" href="https://docs.aws.amazon.com/pt_br/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="pt" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_cn/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="zh-cn" /><link rel="alternative" href="https://docs.aws.amazon.com/zh_tw/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="zh-tw" /><link rel="alternative" href="https://docs.aws.amazon.com/fsx/latest/WindowsGuide/using-service-linked-roles.html" hreflang="x-default" /><meta name="feedback-item" content="FSx" /><meta name="this_doc_product" content="Amazon FSx for Windows File Server" /><meta name="this_doc_guide" content="Windows User Guide" /><script defer="" src="/assets/r/vendor4.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor3.js?version=2021.12.02"></script><script defer="" src="/assets/r/vendor1.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-common.js?version=2021.12.02"></script><script defer="" src="/assets/r/awsdocs-doc-page.js?version=2021.12.02"></script><link href="/assets/r/vendor4.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-common.css?version=2021.12.02" rel="stylesheet" /><link href="/assets/r/awsdocs-doc-page.css?version=2021.12.02" rel="stylesheet" /><script async="" id="awsc-panorama-bundle" type="text/javascript" src="https://prod.pa.cdn.uis.awsstatic.com/panorama-nav-init.js" data-config="{'appEntity':'aws-documentation','region':'us-east-1','service':'fsx'}"></script><meta id="panorama-serviceSubSection" value="Windows User Guide" /><meta id="panorama-serviceConsolePage" value="Using service-linked roles for Amazon FSx" /></head><body class="awsdocs awsui"><div class="awsdocs-container"><awsdocs-header></awsdocs-header><awsui-app-layout id="app-layout" class="awsui-util-no-gutters" ng-controller="ContentController as $ctrl" header-selector="awsdocs-header" navigation-hide="false" navigation-width="$ctrl.navWidth" navigation-open="$ctrl.navOpen" navigation-change="$ctrl.onNavChange($event)" tools-hide="$ctrl.hideTools" tools-width="$ctrl.toolsWidth" tools-open="$ctrl.toolsOpen" tools-change="$ctrl.onToolsChange($event)"><div id="guide-toc" dom-region="navigation"><awsdocs-toc></awsdocs-toc></div><div id="main-column" dom-region="content" tabindex="-1"><awsdocs-view class="awsdocs-view"><div id="awsdocs-content"><head><title>Using service-linked roles for Amazon FSx - Amazon FSx for Windows File Server</title><meta name="pdf" content="/pdfs/fsx/latest/WindowsGuide/WindowsGuide.pdf#using-service-linked-roles" /><meta name="github" content="https://github.com/awsdocs/amazon-fsx-windows-user-guide/tree/main/doc_source/using-service-linked-roles.md" /><meta name="rss" content="WindowsGuide.rss" /><meta name="feedback" content="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=FSx&amp;topic_url=http://docs.aws.amazon.com/en_us/fsx/latest/WindowsGuide/using-service-linked-roles.html" /><meta name="feedback-yes" content="feedbackyes.html?topic_url=http://docs.aws.amazon.com/en_us/fsx/latest/WindowsGuide/using-service-linked-roles.html" /><meta name="feedback-no" content="feedbackno.html?topic_url=http://docs.aws.amazon.com/en_us/fsx/latest/WindowsGuide/using-service-linked-roles.html" /><script type="application/ld+json">
{
    "@context" : "https://schema.org",
    "@type" : "BreadcrumbList",
    "itemListElement" : [
      {
        "@type" : "ListItem",
        "position" : 1,
        "name" : "AWS",
        "item" : "https://aws.amazon.com"
      },
      {
        "@type" : "ListItem",
        "position" : 2,
        "name" : "Amazon FSx",
        "item" : "https://docs.aws.amazon.com/fsx/index.html"
      },
      {
        "@type" : "ListItem",
        "position" : 3,
        "name" : "Windows User Guide",
        "item" : "https://docs.aws.amazon.com/fsx/latest/WindowsGuide"
      },
      {
        "@type" : "ListItem",
        "position" : 4,
        "name" : "Security in Amazon FSx",
        "item" : "https://docs.aws.amazon.com/fsx/latest/WindowsGuide/security.html"
      },
      {
        "@type" : "ListItem",
        "position" : 5,
        "name" : "Identity and Access Management for Amazon FSx for Windows File Server",
        "item" : "https://docs.aws.amazon.com/fsx/latest/WindowsGuide/security-iam.html"
      },
      {
        "@type" : "ListItem",
        "position" : 6,
        "name" : "Using service-linked roles for Amazon FSx",
        "item" : "https://docs.aws.amazon.com/fsx/latest/WindowsGuide/security-iam.html"
      }
    ]
}
</script></head><body><div id="main"><div style="display: none"><a href="/pdfs/fsx/latest/WindowsGuide/WindowsGuide.pdf#using-service-linked-roles" target="_blank" rel="noopener noreferrer" title="Open PDF"></a><a href="https://github.com/awsdocs/amazon-fsx-windows-user-guide/tree/main/doc_source/using-service-linked-roles.md" target="_blank" rel="noopener noreferrer" title="Edit this page on GitHub"></a></div><div id="breadcrumbs" class="breadcrumb"><a href="https://aws.amazon.com">AWS</a><a href="/index.html">Documentation</a><a href="/fsx/index.html">Amazon FSx</a><a href="what-is.html">Windows User Guide</a></div><div id="page-toc-src"><a href="#slr-permissions">Service-linked role permissions for Amazon FSx</a><a href="#create-slr">Creating a service-linked role for Amazon FSx</a><a href="#edit-slr">Editing a service-linked role for Amazon FSx</a><a href="#delete-slr">Deleting a service-linked role for Amazon FSx</a><a href="#slr-regions">Supported regions for Amazon FSx service-linked
               roles</a></div><div id="main-content" class="awsui-util-container"><div id="main-col-body"><awsdocs-language-banner data-service="$ctrl.pageService"></awsdocs-language-banner><h1 class="topictitle" id="using-service-linked-roles">Using service-linked roles for
            Amazon FSx</h1><div class="awsdocs-page-header-container"><awsdocs-page-header></awsdocs-page-header><awsdocs-filter-selector id="awsdocs-filter-selector"></awsdocs-filter-selector></div><p>Amazon FSx for Windows File Server uses AWS Identity and Access Management (IAM)<a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_terms-and-concepts.html#iam-term-service-linked-role">
         service-linked roles</a>. A service-linked role is a unique type of IAM role that is
         linked directly to Amazon FSx. Service-linked roles are predefined by Amazon FSx and
         include all the permissions that the service requires to call other AWS services on your
         behalf. </p><p>A service-linked role makes setting up Amazon FSx easier because you don’t have to
         manually add the necessary permissions. Amazon FSx defines the permissions of its
         service-linked roles, and unless defined otherwise, only Amazon FSx can assume its roles.
         The defined permissions include the trust policy and the permissions policy, and that
         permissions policy cannot be attached to any other IAM entity.</p><p>You can delete a service-linked role only after first deleting their related resources.
         This protects your Amazon FSx resources because you can't inadvertently remove permission
         to access the resources.</p><p>For information about other services that support service-linked roles, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/reference_aws-services-that-work-with-iam.html">AWS Services That Work
         with IAM</a> and look for the services that have <b>Yes </b>in
         the <b>Service-Linked Role</b> column. Choose a <b>Yes</b> with a link to view the service-linked role documentation for
         that service.</p>
         <h2 id="slr-permissions">Service-linked role permissions for Amazon FSx</h2>
         
         <p>Amazon FSx uses the service-linked role named <code class="code">AWSServiceRoleForAmazonFSx</code>
            – Which performs certain actions in your account, like creating Elastic Network
            Interfaces for your file systems in your VPC.</p>
         <p>The role permissions policy allows Amazon FSx to complete the following actions on
            the all applicable AWS resources:</p>
         
         
         <pre class="programlisting"><div class="code-btn-container"><div class="btn-copy-code" title="Copy"><awsui-icon name="copy"></awsui-icon></div></div><code class=""><span>{</span>
    "Version": "2012-10-17",
    "Statement": [
        <span>{</span>
            "Effect": "Allow",
            "Action": [                
                "cloudwatch:PutMetricData",
                "ds:AuthorizeApplication",  
                "ds:GetAuthorizedApplicationDetails",
                "ds:UnauthorizeApplication",                 
                "ec2:CreateNetworkInterface",  
                "ec2:CreateNetworkInterfacePermission",   
                "ec2:DeleteNetworkInterface", 
                "ec2:DescribeAddresses",
                "ec2:DescribeDhcpOptions",
                "ec2:DescribeNetworkInterfaces",
                "ec2:DescribeRouteTables",
                "ec2:DescribeSecurityGroups", 
                "ec2:DescribeSubnets", 
                "ec2:DescribeVPCs",
                "ec2:DisassociateAddress",                
                "route53:AssociateVPCWithHostedZone"
            ],
            "Resource": "*"
        },
        <span>{</span>            
            "Effect": "Allow",
            "Action": [
                "ec2:CreateTags"
            ],
            "Resource": [
                "arn:aws:ec2:*:*:network-interface/*"
            ],
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "ec2:CreateAction": "CreateNetworkInterface"
                },
                "ForAllValues:StringEquals": <span>{</span>
                    "aws:TagKeys": "AmazonFSx.FileSystemId"
                }
            }
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [
                "ec2:AssignPrivateIpAddresses",
                "ec2:ModifyNetworkInterfaceAttribute",
                "ec2:UnassignPrivateIpAddresses"
            ],
            "Resource": [
                "arn:aws:ec2:*:*:network-interface/*"
            ],
            "Condition": <span>{</span>
                "Null": <span>{</span>
                    "aws:ResourceTag/AmazonFSx.FileSystemId": "false"
                }
            }
        },
        <span>{</span>            
            "Effect": "Allow",
            "Action": [
                "ec2:CreateRoute",
                "ec2:ReplaceRoute",
                "ec2:DeleteRoute"
            ],
            "Resource": [
                "arn:aws:ec2:*:*:route-table/*"
            ],
            "Condition": <span>{</span>
                "StringEquals": <span>{</span>
                    "aws:ResourceTag/AmazonFSx": "ManagedByAmazonFSx"
                }
            }
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [                
                "logs:DescribeLogGroups",
                "logs:DescribeLogStreams",
                "logs:PutLogEvents"
            ],
            "Resource": "arn:aws:logs:*:*:log-group:/aws/fsx/*"
        },
        <span>{</span>
            "Effect": "Allow",
            "Action": [                
                "firehose:DescribeDeliveryStream",
                "firehose:PutRecord",
                "firehose:PutRecordBatch"
            ],
            "Resource": "arn:aws:firehose:*:*:deliverystream/aws-fsx-*"
        }
    ]
}</code></pre>
         <p>You must configure permissions to allow an IAM entity (such as a user, group, or role)
            to create, edit, or delete a service-linked role. For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/using-service-linked-roles.html#service-linked-role-permissions">Service-Linked Role Permissions</a> in the
            <em>IAM User Guide</em>.</p>
       
         <h2 id="create-slr">Creating a service-linked role for Amazon FSx</h2>
         
         <p>You don't need to manually create a service-linked role. When you create a file system
            in the AWS Management Console, the IAM CLI, or the IAM API, Amazon FSx creates the service-linked
            role for you. </p>
         <div class="awsdocs-note awsdocs-important"><div class="awsdocs-note-title"><awsui-icon name="status-warning" variant="error"></awsui-icon><h6>Important</h6></div><div class="awsdocs-note-text"><p>This service-linked role can appear in your account if you completed an action in
               another service that uses the features supported by this role. To learn more, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/troubleshoot_roles.html#troubleshoot_roles_new-role-appeared">A New
                  Role Appeared in My IAM Account</a>.</p></div></div>
         <p>If you delete this service-linked role, and then need to create it again, you can use
            the same process to recreate the role in your account. When you create a file system,
            Amazon FSx creates the service-linked role for you again. </p>
       
         <h2 id="edit-slr">Editing a service-linked role for Amazon FSx</h2>
         <p>Amazon FSx does not allow you to edit the  service-linked role. After you
            create a service-linked role, you cannot change the name of the role because various
            entities might reference the role. However, you can edit the description of the role using
            IAM. For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/using-service-linked-roles.html#edit-service-linked-role">Editing a
               Service-Linked Role</a> in the <em>IAM User Guide</em>.</p>
       
         <h2 id="delete-slr">Deleting a service-linked role for Amazon FSx</h2>
         <p>If you no longer need to use a feature or service that requires a service-linked role,
            we recommend that you delete that role. That way you don’t have an unused entity that is not
            actively monitored or maintained. However, you must delete all of your file systems and
            backups before you can manually delete the service-linked role.</p>
         <div class="awsdocs-note"><div class="awsdocs-note-title"><awsui-icon name="status-info" variant="link"></awsui-icon><h6>Note</h6></div><div class="awsdocs-note-text"><p>If the Amazon FSx service is using the role when you try to delete the resources,
               then the deletion might fail. If that happens, wait for a few minutes and try the
               operation again.</p></div></div>
         
         <p><b>To manually delete the service-linked role using
            IAM</b></p>
         <p>Use the IAM console, the IAM CLI, or the IAM API to delete the 
            service-linked role. For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/using-service-linked-roles.html#delete-service-linked-role">Deleting a
               Service-Linked Role</a> in the <em>IAM User Guide</em>.</p>
       
         <h2 id="slr-regions">Supported regions for Amazon FSx service-linked
               roles</h2>
         
         <p>Amazon FSx supports using service-linked roles in all of the regions where the
            service is available. For more information, see <a href="https://docs.aws.amazon.com/general/latest/gr/rande.html">AWS Regions and Endpoints</a>.</p>
      <awsdocs-copyright class="copyright-print"></awsdocs-copyright><awsdocs-thumb-feedback right-edge="{{$ctrl.thumbFeedbackRightEdge}}"></awsdocs-thumb-feedback></div><noscript><div><div><div><div id="js_error_message"><p><img src="https://d1ge0kk1l5kms0.cloudfront.net/images/G/01/webservices/console/warning.png" alt="Warning" /> <strong>Javascript is disabled or is unavailable in your browser.</strong></p><p>To use the Amazon Web Services Documentation, Javascript must be enabled. Please refer to your browser's Help pages for instructions.</p></div></div></div></div></noscript><div id="main-col-footer" class="awsui-util-font-size-0"><div id="doc-conventions"><a target="_top" href="/general/latest/gr/docconventions.html">Document Conventions</a></div><div class="prev-next"><div id="previous" class="prev-link" accesskey="p" href="./using-tags-fsx.html">Using tags with Amazon FSx</div><div id="next" class="next-link" accesskey="n" href="./fsx-compliance.html">Compliance Validation</div></div></div><awsdocs-page-utilities></awsdocs-page-utilities></div><div id="quick-feedback-yes" style="display: none;"><div class="title">Did this page help you? - Yes</div><div class="content"><p>Thanks for letting us know we're doing a good job!</p><p>If you've got a moment, please tell us what we did right so we can do more of it.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=FSx&amp;topic_url=https://docs.aws.amazon.com/en_us/fsx/latest/WindowsGuide/using-service-linked-roles.html"></awsui-button></p></div></div><div id="quick-feedback-no" style="display: none;"><div class="title">Did this page help you? - No</div><div class="content"><p>Thanks for letting us know this page needs work. We're sorry we let you down.</p><p>If you've got a moment, please tell us how we can make the documentation better.</p><p><awsui-button id="fblink" rel="noopener noreferrer" target="_blank" text="Feedback" click="linkClick($event)" href="https://docs.aws.amazon.com/forms/aws-doc-feedback?hidden_service_name=FSx&amp;topic_url=https://docs.aws.amazon.com/en_us/fsx/latest/WindowsGuide/using-service-linked-roles.html"></awsui-button></p></div></div></div></body></div></awsdocs-view><div class="page-loading-indicator" id="page-loading-indicator"><awsui-spinner size="large"></awsui-spinner></div></div><div id="tools-panel" dom-region="tools"><awsdocs-tools-panel id="awsdocs-tools-panel"></awsdocs-tools-panel></div></awsui-app-layout><awsdocs-cookie-banner class="doc-cookie-banner"></awsdocs-cookie-banner></div></body></html>